[{"categories":null,"content":"å‰ç½®æ¦‚å¿µ - æ™¶æŒ¯ã€‚**å‹ç”µæ•ˆåº”ï¼Œç”¨æ¥äº§ç”Ÿé«˜ç²¾åº¦æŒ¯è¡é¢‘ç‡çš„ä¸€ç§ç”µå­å™¨ä»¶** - RC æŒ¯è¡å™¨ã€‚ç”µå®¹å¯ä»¥å……æ”¾ç”µçš„ç‰¹ç‚¹ï¼Œåˆ©ç”¨è¿™ä¸€ç‰¹æ€§å¯ä»¥**è¾“å‡ºæŒ¯è¡ä¿¡å·**ã€‚ Clock Source HSEï¼ˆHigh Frequency Source externalï¼‰ é«˜é€Ÿå¤–éƒ¨æ—¶é’Ÿï¼šä¸€èˆ¬æ¥æ™¶æŒ¯ã€‚ä¸€èˆ¬åœ¨ 4~24MHzã€‚ HSIï¼ˆHigh Frequency Source Internalï¼‰é«˜é€Ÿå†…éƒ¨æ—¶é’Ÿï¼š RC æŒ¯è¡å™¨äº§ç”Ÿçš„ï¼Œé¢‘ç‡ä¸€èˆ¬ 8M å·¦å³ï¼Œä¸æ˜¯å¾ˆç¨³å®šã€‚ LSEï¼ˆLow Frequency Source externalï¼‰ä½é€Ÿå¤–éƒ¨æ—¶é’Ÿï¼š æ¥å¤–éƒ¨æ™¶æŒ¯çš„ï¼Œé¢‘ç‡ä¸º 32.768KHzã€‚ ä¸ºä»€ä¹ˆæ˜¯è¿™ä¹ˆä¸€ä¸²å¥‡æ€ªçš„æ•°å­—ï¼ˆå¹¶ä¸ï¼Œ 32768 å¾ˆæ•´çš„å¥½ä¹ˆï¼‰ã€‚å®ƒæ˜¯ 2 çš„ 15 æ¬¡æ–¹ã€‚åˆ†é¢‘ 15 æ¬¡æ°å¥½æ˜¯ 1HZã€‚1 ç§’ 1 æ¬¡ã€‚ç”¨äº RTCã€‚ LSIï¼ˆLow Frequency Source Internalï¼‰ï¼Œä½é€Ÿå†…éƒ¨æ—¶é’Ÿï¼š è¿™ä¸ªä¹Ÿæ˜¯ RC æŒ¯è¡å™¨äº§ç”Ÿçš„ï¼Œä¹Ÿå¯ä»¥ç»™ RTCï¼Œæ—¶é’Ÿé¢‘ç‡åœ¨ 40KHz å·¦å³ã€‚ ğŸ‘†ğŸ»è¿™äº›å§‹ç»ˆæœ€é«˜ä¸è¿‡å‡ å MHzï¼ŒSoC å†…éƒ¨åŸºæœ¬éƒ½æ˜¯å‡ ç™¾ MHz å¾€ä¸Šçš„é«˜é€Ÿæ—¶é’Ÿä¿¡å·æ˜¯æ€ä¹ˆæ¥çš„å‘¢ã€‹\nä¸€èˆ¬æ¥è®²éœ€è¦è·‘ \u003e16MHz æ—¶é’Ÿçš„èŠ¯ç‰‡é‡Œï¼Œè¦æœ‰ä¸€ä¸ªç”¨æ¥å€é¢‘çš„éƒ¨åˆ†ã€‚\næ‰€æœ‰ä¸ºä»€ä¹ˆè¦ç”¨ PLL å‘¢ï¼Ÿå› ä¸ºå¤–éƒ¨æ™¶æŒ¯å¸¸è§çš„å°± 16MHz ä»¥ä¸‹ã€‚è™½ç„¶ä¹Ÿæœ‰ 200MHz çš„æ™¶æŒ¯ï¼Œä½†ä¸€æ–¹é¢ä»·æ ¼éå¸¸è´µï¼Œä¸é€‚åˆäº§å“æ§åˆ¶æˆæœ¬ï¼Œå¦ä¸€æ–¹é¢ï¼Œè¿™ä¹ˆå¿«çš„æ—¶é’Ÿä»ç‰‡å¤–è¾“å…¥ä¸æ˜¯å¾ˆç¨³å®šã€‚\nPLL (phase-locked-loop) é”ç›¸ç¯ é«˜é€Ÿçš„å€é¢‘æ—¶é’Ÿã€‚ PLL æ˜¯åšåœ¨èŠ¯ç‰‡å†…éƒ¨çš„ä¸€ä¸ªæ¨¡å—ï¼Œä½ ä¸éœ€è¦æ¸…æ¥šå†…éƒ¨åŸç†ï¼Œä½†æ˜¯ä½ éœ€è¦çŸ¥é“å®ƒå¯ä»¥äº§ç”Ÿç¨³å®šçš„å€é¢‘æ—¶é’Ÿã€‚\nä¾‹å¦‚ä¸€å¤´æ¥åœ¨ 16MHz çš„ HSE ä¸Šï¼ŒPLLCLK å°±èƒ½è·å¾— 32MHz, 64MHz ç­‰ç­‰é«˜é€Ÿæ—¶é’Ÿã€‚\næ—¶é’ŸåŸŸ ç®€å•æ¥è¯´ï¼Œæ—¶é’ŸåŸŸå°±æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—å…±ç”¨ä¸€ä¸ªæ—¶é’Ÿã€‚ SoC é‡Œæœ‰é«˜é€Ÿè®¾å¤‡å¦‚ CPUï¼ŒMemoryï¼ŒBus ç­‰ï¼Œä¹Ÿæœ‰ä½é€Ÿè®¾å¤‡ï¼Œå¦‚å„ç§å¤–è®¾è®¾å¤‡ï¼ŒI2Cï¼ŒUSBï¼ŒUART... æ‰€ä»¥éœ€è¦å¤šä¸ªæ—¶é’ŸåŸŸã€‚\næ—¶é’Ÿå’Œæ—¶é’Ÿé¢‘ç‡ä¼šæå¤§å½±å“åŠŸè€—ã€‚ç‰¹åˆ«æ˜¯è¾¹ç¼˜ç«¯ä½åŠŸè€—çš„èŠ¯ç‰‡ï¼Œéœ€è¦çš„ä¸åŒæ—¶é’ŸåŸŸè‡³å°‘æœ‰ï¼š\nä¸»æ—¶é’ŸåŸŸï¼š è®¡ç®—æ ¸å¿ƒç»„å’Œæ•°æ®å¤–è®¾ç»„ä½äºä¸»æ—¶é’ŸåŸŸã€‚è¯¥æ—¶é’ŸåŸŸåœ¨è¿è¡Œæ—¶é€Ÿåº¦è¾ƒå¿«ï¼Œä¸€èˆ¬æ¥è®²è¿è¡Œäº 8M-100M ä¹‹é—´ã€‚\nå¸¸å¼€æ—¶é’ŸåŸŸï¼š ä¸»è¦ç”¨äºç³»ç»Ÿå¤–è®¾ç»„ã€‚é¢‘ç‡å€¼æ˜¯ 32.768KHzã€‚\nä¸€å…±éœ€è¦å¤–æ¥ä¸¤ä¸ªæ™¶æŒ¯ï¼Œä¸€ä¸ªæ˜¯ 24MHz çš„ HSE, å¦ä¸€ä¸ªæ˜¯ 32.768KHz çš„ LSEã€‚æ‰€æœ‰æ—¶é’Ÿå‡æœ‰ CLKGEN æ¨¡å—æ¥ç®¡ç†ã€‚\nClock Generate Unit ![[clock-generate-unit-simple.jpg]]\næ—¶é’Ÿç®¡ç†æ¨¡å—å…¶å®åˆ†ä¸ºä¸¤éƒ¨åˆ†çš„ï¼Œç”¨æ¥äº§ç”Ÿé«˜é€Ÿæ—¶é’Ÿçš„ HCLKGEN å’Œç”¨æ¥äº§ç”Ÿä½é€Ÿæ—¶é’Ÿçš„ LCLKGENã€‚\nCGU ä¸»è¦å°±æ˜¯å¤šè·¯é€‰æ‹©å™¨ï¼Œç”¨äºé€‰æ‹©å¯¹åº”çš„æ—¶é’Ÿã€‚å¯¹äº LCLK éœ€è¦é€‰æ‹©ç‰‡å†…è¿˜æ˜¯ç‰‡å¤–ã€‚å¯¹äº HCLK éœ€è¦é€‰æ‹© HSE, PLL è¿˜æ˜¯ HSIã€‚åŒæ—¶è¦ä¸ºäº†æ›´çµæ´»çš„æ—¶é’Ÿé…ç½®ï¼Œéœ€è¦é…ç½®ä¸¤ä¸ªåˆ†é¢‘å™¨ï¼Œå¾—åˆ°å¯¹åº”çš„æ—¶é’Ÿé¢‘ç‡ã€‚\næ—¶é’Ÿæ ‘ Clock Tree ä¸€èˆ¬ SoC é‡Œçš„æ—¶é’Ÿï¼ŒæŒ‡çš„æ˜¯å…¨å±€æ—¶é’Ÿï¼Œå…¨å±€æ—¶é’Ÿåœ¨èŠ¯ç‰‡ä¸­çš„ä½“ç°å½¢å¼æ˜¯æ—¶é’Ÿæ ‘ã€‚\nç†æƒ³æƒ…å†µä¸‹ï¼ŒåŒæ—¶é’ŸåŸŸä¸­çš„æ‰€æœ‰å¯„å­˜å™¨çš„æ—¶é’Ÿè¾¹æ²¿åŒæ—¶åŒæ—¶åˆ°è¾¾ã€‚ä½†æ˜¯åœ¨å®é™…çš„ç”µè·¯ä¸­ï¼Œè¿™æ˜¯ä¸å¯èƒ½å®ç°çš„ã€‚è¿æ¥åˆ°å„ä¸ªæ¨¡å—çš„æ—¶é’Ÿä¿¡å·çº¿æœ‰é•¿æœ‰çŸ­ï¼Œå¦‚ä½•ä¿è¯æ—¶é’Ÿä¿¡å·çš„åŒæ­¥ï¼Ÿ\n![[clock-tree-without-clock-buffer.jpg]]\nå› æ­¤å°±éœ€è¦å¯¹æ—¶é’ŸåŸŸä¸­çš„æ—¶é’Ÿä¿¡å·è¿›è¡Œç®¡ç†ï¼Œæ—¶é’Ÿæ ‘å¯ä»¥ä¿è¯æ—¶é’ŸåŸŸä¸­çš„å¯„å­˜å™¨çš„æ—¶é’Ÿè¾¹æ²¿åæœ€å°ï¼Œä»è€Œä¿è¯è‰¯å¥½çš„æ—¶åºç‰¹æ€§ã€‚\næ—¶é’Ÿæ ‘å¹¶ä¸æ˜¯ç”¨æ¥ç¼©çŸ­æ—¶é’Ÿä¿¡å·åˆ°è¾¾å„ä¸ªå¯„å­˜å™¨çš„æ—¶é—´ï¼Œè€Œæ˜¯ä¿è¯è¿™äº›å¯„å­˜å™¨ä¹‹é—´çš„æ—¶é—´å·®æœ€å°ï¼Œå³ç¡®ä¿æ—¶é’Ÿä¿¡å·å°½é‡åŒæ—¶åˆ°è¾¾ã€‚\næ³¨æ„æ—¶é’Ÿçš„é©±åŠ¨èƒ½åŠ›æ˜¯æœ‰é™çš„ï¼Œå¦‚æœä¸€ä¸ªæ—¶é’ŸåŸŸé‡Œé¢æœ‰å¤šä¸ªéœ€è¦æ—¶é’Ÿä¿¡å·é©±åŠ¨çš„æ¨¡å—ï¼Œæ—¶é’Ÿä¿¡å·çš„è´Ÿè½½ä¼šè¶…è¿‡é©±åŠ¨èƒ½åŠ›ï¼Œè¿™ä¼šé€ æˆä¿¡å·è´¨é‡çš„ä¸‹é™ã€‚è¿™ä¼šé€ æˆåŠŸèƒ½çš„é”™è¯¯ã€‚\n![[clock-tree-with-buffer.jpg]]\nç®€å•æ¥è¯´ï¼Œæ—¶é’Ÿæ ‘ä½œç”¨æ¥ç¡®ä¿æ—¶é’Ÿä¿¡å·çš„è´¨é‡å’Œæ—¶åºï¼ˆåŒæ­¥çŠ¶æ€ï¼‰ã€‚\nå…¶ä»– ä¸Šç”µæ—¶ä¸€èˆ¬æ¥è®²ä¼šå…ˆä½¿ç”¨ç‰‡å†…çš„ HSIï¼Œå› ä¸ºèµ·æŒ¯æ›´å¿«ã€‚æœ€åå†åˆ‡æ¢åˆ° HSEï¼Œå› ä¸ºæ›´ç¨³å®šã€‚ å¦‚æœæ¯”è¾ƒæè‡´çš„åšæ³•æ˜¯æŠŠ HCLKGEN å•ç‹¬ä½œä¸ºä¸€ä¸ªå¤–è®¾æŒ‚åˆ°ä¸»æ—¶é’ŸåŸŸè€Œä¸æ˜¯åƒæ­¤å¤„åˆæˆä¸€ä¸ªæ¨¡å—æ”¾åœ¨å¸¸å¼€æ—¶é’ŸåŸŸã€‚ IP çº§çš„ power gating ä¸€èˆ¬ä¼šåšåœ¨ IP å†…éƒ¨ï¼Œä¾‹å¦‚ RISC-V å’Œ AI CORE å†…éƒ¨ï¼Œè€Œä¸æ˜¯åšåœ¨è¿™ä¸ªç³»ç»Ÿçº§çš„ CLKGEN é‡Œé¢ å‚è€ƒ RISCV AI SOCå®æˆ˜ï¼ˆäºŒï¼ŒSOCçš„æ—¶é’Ÿç®¡ç†ï¼‰ - çŸ¥ä¹ æ—¶é’Ÿæ ‘ç®€ä»‹ - çŸ¥ä¹ ","description":"","tags":["SoC","Clock"],"title":"SoC æ—¶é’Ÿæ¦‚å¿µæ‰«ç›²","uri":"/blog/posts/SoC/soc-clock-system-101/"},{"categories":null,"content":"å®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œå®Œæˆä¸€æ®µä»£ç ç¼–å†™ï¼Œèƒ½åšåˆ° bug free çš„ç¨‹åº¦å¯¹äºåˆå­¦è€…æ¥è¯´æ˜¯ä¸å¤ªå¯èƒ½çš„äº‹æƒ…ã€‚é™¤éç¼–ç çš„å†…å®¹æä¸ºç®€å•ï¼Œéšç€é€»è¾‘å’Œå¢åŠ å’Œå¤æ‚åº¦çš„å¢é•¿ï¼Œå‡ºé”™ï¼Œæœªè€ƒè™‘åˆ°çš„é€»è¾‘çš„æ¦‚ç‡å¤§å¤§å¢åŠ ã€‚æ‰€ä»¥è°ƒè¯•ä»£ç æ˜¯æ¯ä¸ªç¼–ç¨‹è€…éƒ½éœ€è¦é¢å¯¹çš„é—®é¢˜ã€‚\nä¸ºäº†é¿å…â€œç¼–ç¨‹ 5 åˆ†é’Ÿï¼Œè°ƒè¯• 2 å°æ—¶â€ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€äº›åŸºæœ¬çš„è°ƒè¯•ä»£ç çš„æ–¹æ³•ã€‚\né€‰æ‹©ä¸€ä¸ªå¥½çš„ IDE IDE èƒ½å¤Ÿæœ€å¤§ç¨‹åº¦çš„é¿å…ä½çº§é”™è¯¯ã€‚\nä½œä¸ºåˆå­¦è€…ï¼Œå æ®é—®é¢˜ä¸€èˆ¬ä»¥ä¸Šå¾€å¾€æ˜¯ä½çº§é”™è¯¯ã€‚æ¯”å¦‚\nç¼©è¿›é”™è¯¯ï¼ˆç©ºæ ¼ã€tabæ··ç”¨ï¼‰\nå˜é‡å‰åå‘½åä¸ä¸€è‡´ï¼ˆæ‹¼å†™é”™è¯¯ï¼‰\nå‡½æ•°è°ƒç”¨æ—¶ä¼ é€’çš„å‚æ•°ä¸å…¨æˆ–ä¸å¯¹\nå°‘å¼•å·æ‹¬å·ã€ç”¨äº†ä¸­æ–‡å…¨è§’\nç­‰ç­‰ã€‚è¿™äº›äººçœ¼å¾ˆéš¾ä¸€ä¸‹å‘ç°çš„é”™è¯¯ï¼Œä»£ç ç¼–è¾‘å™¨å¯ä»¥åœ¨å†™ä»£ç çš„æ—¶å€™å°±ç»™ä½ æç¤ºå‡ºæ¥ã€‚\nä»¥åŠæä¾›çš„\næ™ºèƒ½æç¤º è¯­æ³•é«˜äº® è‡ªåŠ¨è¡¥å…¨ ç­‰ç‰¹æ€§ï¼Œèƒ½å¤Ÿæå¤§ç¨‹åº¦å¸®åŠ©æé«˜ç¼–å†™æ•ˆç‡å’Œå‡å°‘å‡ºç°ä½çº§é”™è¯¯ã€‚\né‡ç‚¹æ˜¯ error ä¿¡æ¯\nå¤§å¤šæ•°ç¨‹åºæŠ¥é”™çš„åŒæ—¶éƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯æ˜¯å®šä½ bug è¿½æ ¹æº¯æºçš„èµ·ç‚¹ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¸€ä¸ªä¾‹å­ï¼š\nç¼–ç¨‹åä¹ æƒ¯ï¼šåœ¨ debug è¿‡ç¨‹ä¸çœ‹é”™è¯¯ä¿¡æ¯\nä¸€å®šè¦çœ‹æŠ¥é”™ä¿¡æ¯ã€‚å®³æ€•çœ‹æŠ¥é”™ä¿¡æ¯æ˜¯åˆå­¦è€…ä¸­æœ€å¤§çš„å›°éš¾ï¼Œä¹Ÿè®¸é”™è¯¯çš„åŸå› åƒå¥‡ç™¾æ€ªï¼Œå¾€å¾€é”™è¯¯ç±»å‹æ— éå°±é‚£äº›ï¼Œå¤šçœ‹å‡ æ¬¡å¤§æ¦‚å°±èƒ½å¤Ÿç†Ÿæ‚‰äº†ã€‚\næœ‰äº›æŠ¥é”™çš„ä½ç½®ä¹Ÿè®¸çœ‹ä¸å‡ºé—®é¢˜ï¼Œè¿™æ—¶è¦è€ƒè™‘æ‰§è¡Œçš„çŠ¶æ€ï¼Œç»“åˆä¸Šä¸‹æ–‡æ¥åˆ¤æ–­æ‰§è¡Œè¿‡ç¨‹ã€‚è¯•ç€å¾€ä»£ç æ®µå‰é¢çœ‹çœ‹ã€‚\nStack Overflow å¯ä»¥æœç´¢ä½ çš„é”™è¯¯ä¿¡æ¯ï¼Œé‡Œé¢å¾€å¾€ä¼šæœ‰ä¸€äº›è§£ç­”ã€‚\nè°ƒè¯•æ–¹å¼å’Œå·¥å…· print print æ˜¯æœ€ä¸‡èƒ½çš„ã€‚ç”¨æ¥æ‰“å°å½“å‰å˜é‡çš„å€¼æˆ–çŠ¶æ€ã€‚\n**ç¡®å®šç¨‹åºçš„è¿è¡Œè·¯å¾„ã€‚**ä¸€ä¸ªå‡½æ•°æœ‰æ²¡æœ‰è¢«è°ƒç”¨ï¼Œä¸€ä¸ª if å—æœ‰æ²¡æœ‰è¢«æ‰§è¡Œï¼Œä¸€ä¸ª while å¾ªç¯æ‰§è¡Œäº†å‡ æ¬¡ï¼Œåˆ°äº†å“ªä¸€æ­¥ä¸­æ–­äº†ï¼Œéƒ½å¯ä»¥é€šè¿‡ print å‡ºç›¸å…³ä¿¡æ¯æ¥æŸ¥çœ‹ã€‚\n**æŸ¥çœ‹å˜é‡çš„çŠ¶æ€ã€‚**ç¨‹åºè‡ªèº«çš„æŠ¥é”™ä¼šå‘Šè¯‰ä½ å‘ç”Ÿäº†ä»€ä¹ˆé”™è¯¯ï¼Œä½†ä½ è¿˜éœ€è¦æ‰¾å‡ºä¸ºä»€ä¹ˆä¼šå‘ç”Ÿé”™è¯¯ã€‚é€šè¿‡ print è¾“å‡ºå‡ºé”™è¯­å¥æ¶‰åŠåˆ°çš„ç›¸å…³å˜é‡çš„å€¼å’Œç±»å‹ï¼Œå¯ä»¥å¸®åŠ©åˆ†æå‡ºé”™åŸå› ã€‚\n**æ‰¾å‡ºå‡ºé”™ä½ç½®ã€‚**å¾€å¾€é”™è¯¯çš„åŸå› å¹¶ä¸åœ¨æŠ¥é”™çš„ä½ç½®ï¼Œæ‰€ä»¥å¤šè¾“å‡ºä¸€äº›æ ‡è®°ï¼Œå¤š print ä¸åŒä½ç½®çš„å˜é‡å€¼ï¼ŒæŸ¥çœ‹å˜é‡åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å€¼çš„å˜åŒ–æƒ…å†µï¼Œå¯ä»¥è§‚å¯Ÿæ˜¯åœ¨å“ªé‡Œå‘ç”Ÿäº†é—®é¢˜ã€‚\nç”¨printæœ€å¤§çš„åå¤„æ˜¯å°†æ¥è¿˜å¾—åˆ æ‰å®ƒã€‚æƒ³æƒ³ç¨‹åºé‡Œåˆ°å¤„éƒ½æ˜¯printï¼Œè¿è¡Œç»“æœä¹Ÿä¼šåŒ…å«å¾ˆå¤šå†—ä½™ä¿¡æ¯ã€‚\nassert æ–­è¨€ assert é€‚ç”¨äºæˆ‘ä»¬å·²ç»çŸ¥é“ä»£ç æ‰§è¡Œçš„é¢„æœŸç»“æœï¼Œassert åé¢è·Ÿä¸€ä¸ªè¡¨è¾¾å¼ã€‚\nassert çš„å®è´¨æ˜¯ï¼š\n1 2 if not expression: raise AssertionError åœ¨ä½¿ç”¨ assert çš„é—®é¢˜åœ¨äºï¼Œä¸€æ—¦ä»£ç æ‰§è¡Œçš„ç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œå°±ä¼šå¼•å‘é”™è¯¯ã€‚å¯¹å¼‚å¸¸å¤„ç†ç¼ºä¹çµæ´»æ€§ã€‚\nlogging å’Œassertæ¯”ï¼Œloggingä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè€Œä¸”å¯ä»¥è¾“å‡ºåˆ°æ–‡ä»¶ã€‚ç›¸æ¯”äºprintè¯­å¥æœ‰äº†æ›´å¥½çš„æ§åˆ¶ï¼Œä¾›äº†æ—¥å¿—ä¿¡æ¯çš„åˆ†çº§ï¼Œæ ¼å¼åŒ–ï¼Œè¿‡æ»¤ç­‰åŠŸèƒ½ã€‚\nlogging æ¨¡å—ä¸ºé”™è¯¯çš„ä¸¥é‡ç¨‹åº¦æä¾›äº†ä¸åŒå±‚çº§ï¼Œä»ä½åˆ°é«˜ä¾æ¬¡ä¸ºï¼š\nç­‰çº§ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ DEBUG è¯¦ç»†ä¿¡æ¯ï¼Œé€šå¸¸ä»…åœ¨Debugæ—¶ä½¿ç”¨ã€‚ INFO ç¨‹åºæ­£å¸¸è¿è¡Œæ—¶è¾“å‡ºçš„ä¿¡æ¯ã€‚ WARNING è¡¨ç¤ºæœ‰äº›é¢„æœŸä¹‹å¤–çš„æƒ…å†µå‘ç”Ÿï¼Œæˆ–è€…åœ¨å°†æ¥å¯èƒ½å‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚ç¨‹åºä¾ç„¶èƒ½æŒ‰ç…§é¢„æœŸè¿è¡Œã€‚ ERROR å› ä¸ºä¸€äº›ä¸¥é‡çš„é—®é¢˜ï¼Œç¨‹åºçš„æŸäº›åŠŸèƒ½æ— æ³•ä½¿ç”¨äº†ã€‚ CRITICAL å‘ç”Ÿäº†ä¸¥é‡çš„é”™è¯¯ï¼Œç¨‹åºå·²ç»æ— æ³•è¿è¡Œã€‚ pdbï¼ˆäº†è§£ï¼‰ pdb æ˜¯ Python Debuggerï¼Œ è®©ç¨‹åºä»¥å•æ­¥æ–¹å¼è¿è¡Œï¼Œå¯ä»¥éšæ—¶æŸ¥çœ‹è¿è¡ŒçŠ¶æ€ã€‚\nIDE æ–­ç‚¹è°ƒè¯•ï¼ˆå®‰åˆ©ï¼‰ ç°ä»£ IDE æä¾›äº†éå¸¸å¼ºå¤§çš„è°ƒè¯•å·¥å…·ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯æˆ‘ä»¬ä¼šç»å¸¸ç”¨åˆ°çš„æ–­ç‚¹è°ƒè¯•ã€‚\næ–­ç‚¹è°ƒè¯•çš„æ­¥éª¤åˆ†ä¸º 3 æ­¥ï¼š\næ ‡è®°æ–­ç‚¹\næ‰€è°“æ–­ç‚¹(Breakpoint)ï¼Œå³ä¸ºä½ æƒ³è¦ç¨‹åºè¿è¡Œåˆ°ä½•å¤„æš‚åœçš„ä½ç½®ã€‚\nè¿›å…¥æ–­ç‚¹ä½ç½®\nç¨‹åºè¿è¡Œåˆ°æ–­ç‚¹çš„ä½ç½®ï¼Œè¿™ä¸ªæ—¶å€™ç¨‹åºä¼šæš‚åœï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰ç¯å¢ƒä¸‹å„ç§æ•°æ®çš„ä¿¡æ¯ã€‚\nä»æ–­ç‚¹å¤„å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°æ‰¾åˆ°ä¸é¢„æœŸè¡Œä¸ºä¸ç¬¦åˆçš„ä½ç½®\nä»æ–­ç‚¹å¤„å¯ä»¥å•æ­¥æ‰§è¡Œï¼Œæ¯æ‰§è¡Œä¸€æ­¥å¯ä»¥è§‚å¯Ÿå˜åŒ–æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œç›´åˆ°æ‰¾åˆ°ç¨‹åºæ‰§è¡Œä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚\næ–­ç‚¹è°ƒè¯•å¯ä»¥è®©æˆ‘ä»¬æ·±å…¥åˆ°ç¨‹åºé‡Œï¼Œè§‚å¯Ÿæ¯ä¸€è¡Œä»£ç çš„æ‰§è¡Œã€‚\nPyCharm æ–­ç‚¹è°ƒè¯• PyCharm Debug Docs\nä»¥ PyCharm ä¸ºä¾‹ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 def reverse(x: 'int') -\u003e 'int': negative = (x \u003c 0) x = abs(x) if 10 \u003e x \u003e -10: return x res = 0 while x != 0: digit = x % 10 x //= 10 res = (10 * res) + digit if res \u003e 2**31 - 1: return 0 return res if not negative else -res if __name__ == '__main__': nums = [1283, -9527] for num in nums: print(reverse(num)) å‡è®¾æˆ‘ä»¬æƒ³è¦äº†è§£ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬æŠŠæ–­ç‚¹è®¾ç½®åœ¨ while è¯­å¥å‰ï¼š\næ¥ä¸‹æ¥è¿›å…¥è°ƒè¯•æ¨¡å¼ï¼š\nå¯ä»¥å¾ˆæ¸…æ¥šåœ°çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š\nçº¿ç¨‹ä¿¡æ¯ æ‰§è¡Œåˆ°æ–­ç‚¹å¤„æ‰€æœ‰å˜é‡ä¿¡æ¯ æ­¤å¤–ï¼Œæœ€é‡è¦çš„æ˜¯æ­¤æ—¶èƒ½å¤Ÿæ‰§è¡Œçš„æ“ä½œï¼Œä»å·¦åˆ°å³ä¾æ¬¡ä¸ºï¼š\nStep Over\nè·³è¿‡å½“å‰ä»£ç è¡Œå¹¶å¸¦æ‚¨åˆ°ä¸‹ä¸€è¡Œï¼Œå³ä½¿çªå‡ºæ˜¾ç¤ºçš„è¡Œä¸­æœ‰æ–¹æ³•è°ƒç”¨ã€‚æ–¹æ³•çš„å®ç°è¢«è·³è¿‡ï¼Œæ‚¨ç›´æ¥ç§»åŠ¨åˆ°è°ƒç”¨è€…æ–¹æ³•çš„ä¸‹ä¸€è¡Œã€‚\nStep Into\næ­¥å…¥è¯¥æ–¹æ³•ä»¥æ˜¾ç¤ºå…¶å†…éƒ¨å‘ç”Ÿçš„æƒ…å†µã€‚å½“æ‚¨ä¸ç¡®å®šè¯¥æ–¹æ³•æ˜¯å¦è¿”å›æ­£ç¡®ç»“æœæ—¶ï¼Œè¯·ä½¿ç”¨æ­¤é€‰é¡¹\nStep Into My Code\nåªæ­¥å…¥è‡ªå·±çš„ä»£ç å¹¶é˜²æ­¢è°ƒè¯•å™¨è¿›å…¥åº“ç±»\nForce Step Into\nçŠ¶æ€ä¸ºç°è‰²çš„æŒ‰é’®\nStep Out\nè·³å‡ºå½“å‰æ–¹æ³•å¹¶å¸¦æ‚¨è¿›å…¥è°ƒç”¨æ–¹æ–¹æ³•\nRun to Cursor\nç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°åˆ°è¾¾æ’å…¥ç¬¦å·çš„ä½ç½®ã€‚æ‰€éœ€è¦æŸ¥çœ‹ä½ç½®é‡Œæ–­ç‚¹ä½ç½®å¤ªè¿œæ—¶ï¼Œæ­¤æ“ä½œéå¸¸æœ‰ç”¨\næ¥ä¸‹æ¥æˆ‘ä»¬åªä½¿ç”¨ Step Into çš„æ–¹å¼ï¼Œä¸€æ­¥æ­¥æ‰§è¡Œå¹¶æŸ¥çœ‹å˜é‡å˜åŒ–è¿‡ç¨‹ã€‚\nVsCode æ–­ç‚¹è°ƒè¯• VSCode Debug Docs\nVsCode ä¹Ÿæä¾›äº†è°ƒè¯•åŠŸèƒ½ã€‚ç±»ä¼¼åœ°ï¼Œåœ¨ä»£ç è¡Œæ•°å­—æ—è¾¹æ ‡è®°å¥½æ–­ç‚¹ï¼Œ\nç‚¹å‡» è¿è¡Œ-\u003e å¯åŠ¨è°ƒè¯• æˆ– æŒ‰ä¸‹ F5ï¼Œè¿›å…¥è°ƒè¯•æ¨¡å¼\nå˜é‡åŒºå’Œæ“ä½œå»ä¸ä¸Šé¢ PyCharm åŸºæœ¬ä¸€è‡´\nè°ƒè¯•æ€è·¯ä¸å…¶ä»– é—®é¢˜å®šä½ ä¸é¢„æœŸè¡Œä¸ºçš„æ¯”è¾ƒ çŒœæƒ³å‡ºé”™åŸå›  æµ‹è¯•éªŒè¯ é¦–å…ˆçš„æ˜¯è¿›è¡Œé—®é¢˜å®šä½ã€‚\nå¦‚æœç¨‹åºæ‰§è¡Œå‡ºé”™é€€å‡ºï¼Œè¿™ç§é”™è¯¯æ˜¯â€œæ˜¾å¼é”™è¯¯â€ã€‚é€šè¿‡ IDE å¯¹é”™è¯¯ä¿¡æ¯çš„æè¿°ï¼Œå¯ä»¥çŸ¥é“é—®é¢˜å‡ºé”™çš„ä½ç½®ã€‚\nä½†é€ æˆé”™è¯¯çš„ root cause å¾ˆå¯èƒ½æ½œè—åœ¨æ›´æ·±å¤„çš„åœ°æ–¹ï¼Œè€Œè¿™é‡ŒæŠ¥é”™çš„å®šä½æ˜¯æœ€é‡è¦çš„çº¿ç´¢ï¼Œæˆ‘ä»¬ä¼šä»è¿™é‡Œåˆ‡å…¥å»æ‰¾åˆ°çœŸç›¸ã€‚\næ²¡æœ‰å¼‚å¸¸ä¿¡æ¯çš„â€œé”™è¯¯â€ï¼Œå¯ä»¥ç§°ä¹‹ä¸ºâ€œéšå¼é”™è¯¯â€ï¼Œåœ¨ç¨‹åºè¿è¡Œçš„å±‚é¢ä¸Šçœ‹æ¥ï¼Œå®ƒæ­£åœ¨æ‰§è¡Œä¸€æ¡æ¡æ­£ç¡®çš„è¯­å¥ï¼Œç„¶è€Œç»“æœå¹¶ä¸ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚\nç¬¬äºŒæ­¥æ˜¯å¯¹é¢„æœŸè¡Œä¸ºçš„æ¯”è¾ƒã€‚è°ƒè¯•çš„è¡Œä¸ºæ˜¯è§‚å¯Ÿç¨‹åºæ‰§è¡Œçš„æ­¥éª¤ï¼Œå½“ç¨‹åºè¿è¡Œçš„ç»“æœä¸é¢„æœŸçš„è¡Œä¸ºä¸ä¸€è‡´æ—¶ï¼Œå®ƒä¸€å®šæœ‰ä¸€ä¸ªåˆç†çš„è§£é‡Šã€‚è‡³äºä¸ºä»€ä¹ˆä¼šè¿™æ ·çš„åŸå› å¯èƒ½é™é™åœ°èººåœ¨æŸä¸ªåœ°æ–¹ï¼Œç­‰å¾…ç€ä½ æ‰¾åˆ°å®ƒã€‚\nä½œå‡ºçŒœæµ‹ï¼Œç„¶åéªŒè¯ã€‚è¿™ä¸ªè¡Œä¸ºå°†å æ®è°ƒè¯•è¡Œä¸ºçš„å¤§éƒ¨åˆ†æ—¶é—´ï¼Œè®¸å¤šé”™è¯¯çš„æ ¹æºæˆªç„¶ä¸åŒï¼Œä½†æ˜¯è¡¨å±‚æ˜¾ç¤ºå‡ºçš„è¡Œä¸ºç¼ºå³ä¸ºç›¸ä¼¼ã€‚\nDebug å°±åƒæ˜¯æ‰®æ¼”ä¾¦æ¢ï¼Œéœ€è¦æ”¶é›†å„ç§ç»†èŠ‚ï¼Œå¯¹ä¸€äº›å¸¸è§çš„â€œçŠ¯ç½ªæ‰‹æ³•â€æœ‰è¿™è¶³å¤Ÿçš„äº†è§£ï¼Œè¶Šç†Ÿæ‚‰â€œæ¡ˆä»¶â€ï¼ˆç¨‹åºï¼‰ï¼Œâ€œä½œæ¡ˆå·¥å…·â€ï¼ˆç¼–ç¨‹è¯­è¨€ï¼‰çš„è¯ï¼Œä¹Ÿå°±è¶Šå®¹æ˜“æ‰¾åˆ°â€œç½ªçŠ¯â€ï¼ˆBugï¼‰ã€‚\n","description":"","tags":["debug","pycharm","vscode"],"title":"å¦‚ä½•åœ¨ IDE ä¸­è°ƒè¯•ä»£ç ","uri":"/blog/posts/how-to-debug-in-ide/"},{"categories":null,"content":"\nç›®çš„ è§„èŒƒä»£ç æ ¼å¼ï¼Œæå‡ä»£ç è´¨é‡ å‡å°‘å›¢é˜Ÿåä½œæ—¶ç†è§£æˆæœ¬ è®¾ç½®é€šç”¨è§„èŒƒ CodeStyle PEP 8 æ˜¯ Python ä»£ç é£æ ¼è§„èŒƒã€‚å®ƒè§„å®šäº†ç±»ä¼¼è¡Œ\né•¿åº¦ ç¼©è¿› å¤šè¡Œè¡¨è¾¾å¼ å˜é‡å‘½åçº¦å®š ç­‰ç­‰\nä»£ç é£æ ¼è§„èŒƒçš„ç›®æ ‡éƒ½æ˜¯åœ¨ä»£ç åº“ä¸­å¼ºåˆ¶å®æ–½ä¸€è‡´çš„æ ‡å‡†ï¼Œä½¿ä»£ç çš„å¯è¯»æ€§æ›´å¼ºã€æ›´æ˜“äºç»´æŠ¤ã€‚\nè™½ç„¶ PEP8 åªæ˜¯ä½œä¸º Python å®˜æ–¹æ¨èçš„è§„èŒƒï¼Œä½†åœ¨å®é™…ä¸Šå®ƒå·²ç»æˆä¸ºæœ€å¹¿æ³›è®¤åŒçš„ Python ä»£ç é£æ ¼æ ‡å‡†ã€‚\nä»¥ä¸‹æ ‡å‡†ä¹Ÿæ˜¯å¹¿æ³›æµè¡Œçš„ Python ä»£ç é£æ ¼:\nChromium Python Style Guide Google Python Style Guide Pylint Pylint æ˜¯ä¸€ä¸ªç”¨æ¥æ£€æŸ¥æ˜¯å¦ç¬¦åˆä»£ç è§„èŒƒå’Œå¸¸è§é”™è¯¯çš„åº“ã€‚é‡Œé¢é»˜è®¤ PEP8 è§„èŒƒï¼Œä¹Ÿå¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚æ¥è‡ªå®šä¹‰ä¸€å¥—è§„èŒƒã€‚\nå®ƒå¯ä»¥ä»¥å‘½ä»¤è¡Œæ–¹å¼æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ’ä»¶é›†æˆåœ¨ IDE ä¸­ã€‚\nå®ƒé‡Œé¢åŒ…å«äº†è®¸å¤š check_listï¼Œæ ¹æ®å½±å“ç¨‹åº¦è¿›è¡Œäº†åˆ†ç±»ï¼š\nC convention related checks (å…¬çº¦) R refactoring related checks (é‡æ„) W various warnings (è­¦å‘Š) E errors, for probable bugs in the code (é”™è¯¯) F fatal, if an error occurred which prevented pylint from doing further processing. (å½±å“ç¨‹åºæ‰§è¡Œ) å®‰è£… 1 pip install pylint ä½¿ç”¨ 1 2 pylint [OPTION] FILE pylint [OPTION] DIR é…ç½® Pylint æä¾›å¯é…ç½®çš„ check é¡¹ï¼Œå¯è‡ªå®šä¹‰ Enable/Disable æŒ‡å®šçš„ checkã€‚\nå…¨éƒ¨çš„ check é¡¹è¯·å‚é˜…ï¼šPylint Checker Features\n1 2 pylint --list-msgs # æ‰“å°æ‰€æœ‰çš„ check é¡¹ pylint --list-msgs-enabled # å¼€å¯çš„ check é¡¹ é…ç½®æ–‡ä»¶åŠ è½½é¡ºåºï¼š\nå½“å‰ç›®å½•ä¸‹å­˜åœ¨ pylintrcï¼Œ.pylintrc ç¯å¢ƒå˜é‡ PYLINTRC ä¸»ç›®å½•ä¸‹ .pylintrcï¼Œ .config/pylintrc Yapf Yapf æ˜¯ â€œYet another python formatterâ€ æ˜¯ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»£ç æ ¼å¼åŒ–å·¥å…·ã€‚\nç¬¦åˆ PEP8 çš„ä»£ç å¹¶ä¸ä»£è¡¨ä»£ç çœ‹èµ·æ¥ç¾è§‚ã€‚yapf ç”¨æ¥å°†ä»£ç é‡æ–°æ ¼å¼åŒ–ä¸ºç¬¦åˆä»£ç æ ·å¼æŒ‡å—çš„æœ€ä½³æ ¼å¼ï¼Œé’ˆå¯¹ä»£ç åº“å¯ä»¥è®©æ ·å¼åœ¨æ•´ä¸ªé¡¹ç›®ä¸­ä¿æŒä¸€è‡´ï¼Œè®©å¤§å®¶ä¸ç”¨å†ä¸ºä»£ç æ ·å¼äº‰è®ºã€‚\nå®‰è£… 1 pip install yapf ä½¿ç”¨ 1 2 3 4 5 6 7 yapf [OPTION] [file [files...]] -d, --diff æ˜¾ç¤ºåŸä»£ç å’Œæ ¼å¼åŒ–åçš„å·®å¼‚ -i, --in-place åœ¨æ–‡ä»¶ä¸Šç›´æ¥ä¿®æ”¹ -r, --recursive åœ¨ç›®å½•ä¸Šé€’å½’è¿è¡Œ -e PATTERN æ’é™¤æ–‡ä»¶ --style STYLE æŒ‡å®šæ ·å¼ï¼Œä¾‹å¦‚ \"pep8\", \"google\" é…ç½® yapf ä¸»è¦æœ‰ä¸¤ç§é…ç½®\n.yapfignore å¿½ç•¥æ— éœ€æ ¼åŒ–çš„æ–‡ä»¶ .style.yapf yapf é…ç½®æ–‡ä»¶ æŸ¥çœ‹ yapf é…ç½®é¡¹ï¼š\n1 2 yapf --style-help yapf --style-help \u003e style.yapf # ç”Ÿæˆé…ç½®æ–‡ä»¶ Radon [Radon]*(https://radon.readthedocs.io/en/latest/) æ˜¯ç”¨æ¥é‡åŒ–ä»£ç è´¨é‡æŒ‡æ ‡çš„å·¥å…·ã€‚å®ƒæä¾›ä»¥ä¸‹æŒ‡æ ‡\nåŸå§‹æŒ‡æ ‡ï¼šSLOCï¼Œæ³¨é‡Šè¡Œï¼Œç©ºç™½è¡Œ\nSLOT (Source lines of code) ä»£ç è¡Œæ•°\nåœˆå¤æ‚åº¦\nHalsteadæŒ‡æ ‡ï¼ˆæ‰€æœ‰æŒ‡æ ‡ï¼‰\nå¯ç»´æŠ¤æ€§æŒ‡æ•°\nä¸Šè¿°æŒ‡æ ‡çš„è§£é‡Šå¯è§ Radon Metrics\nä½¿ç”¨ 1 radon [cc,raw,mi,hal] ... cc\nAnalyze the given Python modules and compute Cyclomatic Complexity (CC).\nraw\nAnalyze the given Python modules and compute raw metrics.\nmi\nAnalyze the given Python modules and compute the Maintainability Index.\nhal\nAnalyze the given Python modules and compute their Halstead metrics.\né›†æˆ IDE ä¸ PyCharm é›†æˆ pylint æ’ä»¶å®‰è£…å’Œä½¿ç”¨ yapf æ’ä»¶å®‰è£…å’Œä½¿ç”¨ Radon ä½œä¸ºå¤–éƒ¨å·¥å…·çš„é…ç½®å’Œä½¿ç”¨ ","description":"","tags":["python","codestyle"],"title":"Python ä»£ç è´¨é‡å·¥å…·ä»‹ç»","uri":"/blog/posts/Python/python-code-quality-tools-intro/"},{"categories":null,"content":"Python å¦‚ä½•æ‰§è¡Œå¹¶å‘ä»»åŠ¡ Python ä¸­æœ‰ concurrent æ¨¡å—ç”¨æ¥ä½œä¸ºå¯¹å¹¶è¡Œæ”¯æŒï¼Œç›®å‰ï¼Œæ­¤åŒ…ä¸­åªæœ‰ä¸€ä¸ªæ¨¡å—ï¼š\nconcurrent.futures â€”â€” å¯åŠ¨å¹¶è¡Œä»»åŠ¡ concurrent.futures æ¨¡å—æä¾›å¼‚æ­¥æ‰§è¡Œå›è°ƒé«˜å±‚æ¥å£ã€‚\né‡Œé¢æœ‰ä»€ä¹ˆï¼Ÿ è¿™ä¸ªæ¨¡å—é‡Œé¢åŒ…å«äº†ä»€ä¹ˆï¼Ÿä¸€ä¸ªæ¥å£ç±»/æŠ½è±¡ç±»ï¼Œä¸¤ä¸ªä¸åŒçš„å®ç°å­ç±»ã€‚\nä¸€ä¸ªæ¥å£ç±»/æŠ½è±¡ç±»\nconcurrent.futures.Executor\nExecutor æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼ŒæŠ½è±¡ç±»æä¾›å¼‚æ­¥æ‰§è¡Œè°ƒç”¨æ–¹æ³•ã€‚è¦é€šè¿‡å®ƒçš„å­ç±»è°ƒç”¨ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨ã€‚\nä¸¤ä¸ªä¸åŒçš„å®ç°å­ç±»\nThreadPoolExecutor å’Œ ProcessPoolExecutor\nå®ƒä»¬å®ç°äº† Executor ç±»ï¼Œå®ƒä»¬éƒ½å¯ä»¥è¿›è¡Œå¼‚æ­¥æ‰§è¡Œè°ƒç”¨ã€‚\nå¼‚æ­¥æ‰§è¡Œå¯ä»¥ç”± ThreadPoolExecutor ä½¿ç”¨çº¿ç¨‹æˆ–ç”± ProcessPoolExecutor ä½¿ç”¨å•ç‹¬çš„è¿›ç¨‹æ¥å®ç°ã€‚ ä¸¤è€…éƒ½æ˜¯å®ç°æŠ½åƒç±» Executor å®šä¹‰çš„æ¥å£ã€‚\nFuture\nFuture ç±»å°†å¯è°ƒç”¨å¯¹è±¡å°è£…ä¸ºå¼‚æ­¥æ‰§è¡Œã€‚Future å®ä¾‹ç”± Executor.submit() åˆ›å»ºã€‚\nä»€ä¹ˆæ˜¯ Futureï¼Ÿä¸ºä»€ä¹ˆè®¾è®¡å®ƒï¼Ÿå®ƒæ˜¯æ€æ ·å®ç°çš„ï¼Ÿ\nPEP 3148\nä»¥åŠä¸€äº› Exception ç±»ã€‚\nä½¿ç”¨çº¿ç¨‹æ± å’Œè¿›ç¨‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ\nå®ƒä½¿ç”¨è¿›ç¨‹æ± æ¥å¼‚æ­¥åœ°æ‰§è¡Œè°ƒç”¨ã€‚ ProcessPoolExecutor ä¼šä½¿ç”¨ multiprocessing æ¨¡å—ï¼Œè¿™å…è®¸å®ƒç»•è¿‡ å…¨å±€è§£é‡Šå™¨é” ä½†ä¹Ÿæ„å‘³ç€åªå¯ä»¥å¤„ç†å’Œè¿”å›å¯å°å­˜çš„å¯¹è±¡ã€‚\npython concurrent.futures æ–‡æ¡£\nå¦‚ä½•ä½¿ç”¨ = = ï¼Œä¼¼ä¹å¿˜è®°ä»‹ç»é‡Œé¢çš„æ–¹æ³•äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆè¦çœ‹çœ‹ Executor ç±»æ‰€æä¾›çš„æ¥å£æ–¹æ³•ï¼š\nsubmit(fn, /, *args, **kargs)\nè°ƒåº¦å¯è°ƒç”¨å¯¹è±¡ fnï¼Œä»¥ fn(*args **kwargs) æ–¹å¼æ‰§è¡Œå¹¶è¿”å› Future å¯¹è±¡ä»£è¡¨å¯è°ƒç”¨å¯¹è±¡çš„æ‰§è¡Œ\nmap(func, *iterables, timeout=None, chunksize=1)\nç±»ä¼¼äº map(func, *iterables) å‡½æ•°ï¼Œé™¤äº†ä»¥ä¸‹ä¸¤ç‚¹ï¼š\niterables æ˜¯ç«‹å³æ‰§è¡Œè€Œä¸æ˜¯å»¶è¿Ÿæ‰§è¡Œçš„ï¼› func æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå¯¹ func çš„å¤šä¸ªè°ƒç”¨å¯ä»¥å¹¶å‘æ‰§è¡Œã€‚ è¿™é‡Œå¦‚ä½•åˆ¤æ–­ func èƒ½ä¸èƒ½å¹¶å‘æ‰§è¡Œ\nshutdown(wait=True, *, cancel_futures=Flase)\nä½¿ç”¨ with è¯­å¥å¯ä»¥é¿å…æ˜¾å¼è°ƒç”¨\nä½¿ç”¨ ThreadPoolExecutor ThreadPoolExecutor(max_workers=None, thread_name_prefix='', initializer=None, initargs=())\nå‡å¦‚æˆ‘ä»¬æƒ³è¦åŒæ—¶ä¸‹è½½å¾ˆå¤šå¾ˆå¤šå›¾ç‰‡ï¼Œè€Œç°åœ¨æˆ‘ä»¬å·²ç»æœ‰è¿™äº›å›¾ç‰‡çš„ urlsã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 import requests import concurrent.future def download_image(img_url): img_bytes = requests.get(img_url).content img_name = img_url.split('/')[3] img_name = f'{img_name}.jpg' with open(img_name, 'wb') as img_file: img_file.write(img_bytes) print(f'{img_name} was downloaded...') with concurrent.futures.ThreadPoolExecutor() as executor: executor.map(download_image, img_urls) ä½¿ç”¨ ProcessPoolExecutor ProcessPoolExecutor(max_workers=None, mp_context=None, initializer=None, initargs=())\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 import concurrent.futures import math PRIMES = [ 112272535095293, 112582705942171, 112272535095293, 115280095190773, 115797848077099, 1099726899285419] def is_prime(n): if n \u003c 2: return False if n == 2: return True if n % 2 == 0: return False sqrt_n = int(math.floor(math.sqrt(n))) for i in range(3, sqrt_n + 1, 2): if n % i == 0: return False return True def main(): with concurrent.futures.ProcessPoolExecutor() as executor: for number, prime in zip(PRIMES, executor.map(is_prime, PRIMES)): print('%d is prime: %s' % (number, prime)) if __name__ == '__main__': main() ","description":"","tags":["python","concurrent"],"title":"Python Concurrent æ¨¡å—æ¢ç©¶","uri":"/blog/posts/Python/python-concurrent-module-analysis/"},{"categories":null,"content":" ä¸€ä¸ªç®€å•çš„è¯†åˆ«å›¾å¡çš„ä»»åŠ¡ã€‚å¯ä»¥åŸºæœ¬æ¶µç›– opencv tutorial é‡Œé¢ä½¿ç”¨çš„ä¸œè¥¿ã€‚\nOpenCV çš„æ–‡æ¡£è¯¦å®ä¸°å¯Œï¼Œå¦‚æœè§‰å¾—é˜…è¯»å®˜æ–¹æ–‡æ¡£æ¯”è¾ƒåƒåŠ›ï¼Œ OpenCV 4.0 ä¸­æ–‡æ–‡æ¡£ ä¼šå¯¹ä½ éå¸¸æœ‰å¸®åŠ©ã€‚\nä¸€ä¸ªç®€å•çš„ä»»åŠ¡æƒ…æ™¯ æˆ‘ä»¬æœ‰ä¸€äº›å›¾å¡éœ€è¦è¢«è¯†åˆ«ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç¨å¾®ç®€å•åŒ–ä¸€ä¸‹æƒ…æ™¯ï¼š\næœ‰ä¸€é¢çº¯è‰²çš„èƒŒæ™¯å¢™ï¼Œå›¾å¡å°±åƒæŒ‚ç…§ç‰‡ä¸€æ ·æŒ‚ç½®åœ¨å¢™ä¸Šï¼Œæœ‰ä¸€ä¸ª camera å¯¹å‡†è¿™é¢å¢™å£ï¼Œ é‚£ä¹ˆç°åœ¨æˆ‘ä»¬å¦‚ä½•è¯†åˆ«å‡ºå›¾å¡çš„åŒºåŸŸï¼Œå¹¶ä¸”è£å‰ªå‡ºæ¥ã€‚\nå›¾ç‰‡å¤„ç†æµç¨‹ æ˜æ™°äº†è¿™ä¸ªç®€å•çš„åœºæ™¯ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹èµ·æ¥ä¸€ä¸ªåŸºæœ¬çš„å›¾ç‰‡å¤„ç†çš„æ¡†æ¶ã€‚\nè¿™ä¸ªåœºæ™¯çš„ä¸»è¦çš„åŠŸèƒ½å…¶å®æ˜¯å›¾åƒè£å‰ªã€‚\nè¯»å…¥ camera çš„è§†é¢‘å¸§\n1 2 3 4 5 6 7 8 9 # è¯»å…¥ä¸€å¼ å›¾ç‰‡ img = cv.imread('path/to/img') # è¯»å…¥ä¸€å¸§ cap = cv.VideoCapture(0) ret, frame = cap.read() if ret: # handle frame ç®€åŒ–è¿ç®—é‡ï¼Œè½¬ä¸ºç°åº¦å›¾åƒã€‚\ncv.cvtColor(img, cv.COLOR_BGR2GRAY)\nå¤§å¤šæ•°çš„å›¾åƒå¤„ç†çš„ç¬¬ä¸€æ­¥å°±æ˜¯æŠŠè‰²å½©è½¬ä¸ºç°åº¦ï¼Œå› ä¸ºé™ä½é€šé“æ•°å¯ä»¥æœ‰æ•ˆå‡å°‘è¿ç®—é‡ï¼Œè€Œä¸”ç°åº¦å›¾åƒä¸­ä¹Ÿä¿å­˜äº†å®Œæ•´çš„æ¢¯åº¦ä¿¡æ¯ï¼Œè€Œæ¢¯åº¦ä¿¡æ¯å¯¹åé¢å¤„ç†è½®å»“è‡³å…³é‡è¦ã€‚é™ä½å™ªå£°ï¼Œè¿™é‡Œæœ‰è®¸å¤šä¸­æ»¤æ³¢æ–¹å¼ï¼ˆé«˜æ–¯æ»¤æ³¢ï¼Œä¸­å€¼æ»¤æ³¢\nè¾¹ç¼˜æ£€æµ‹\nè¾¹ç¼˜æ£€æµ‹å®é™…æ˜¯è®¡ç®—å›¾åƒçš„æ¢¯åº¦ä¿¡æ¯ï¼Œå¸¸è§çš„å¤„ç†æ–¹å¼æœ‰ cannyï¼Œsobel ç®—å­ã€‚\nSobel ç®—å­åæ˜¯ç°åº¦å›¾åƒï¼Œéœ€è¦å†è¿›è¡Œé˜ˆå€¼å¤„ç†å¾—åˆ°äºŒå€¼åŒ–å›¾åƒ\nCanny ç®—å­åèƒ½å¤Ÿç›´æ¥å¾—åˆ°äºŒå€¼åŒ–å›¾åƒã€‚ä¸€èˆ¬æƒ…å†µä¸‹æ¨èä½¿ç”¨canny ç®—å­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 def sobel_edges(input): gradX = cv.Sobel(input, ddepth=cv.CV_32F, dx=1, dy=0, ksize=-1) gradY = cv.Sobel(input, ddepth=cv.CV_32F, dx=0, dy=1, ksize=-1) # subtract the y-gradient from the x-gradient gradient = cv.subtract(gradX, gradY) gradient = cv.convertScaleAbs(gradient) blurred = cv.blur(gradient, (5, 5)) # cv.threshhold ä¸ cv.adaptiveThresholud åŒºåˆ« # å…¨å±€é˜ˆå€¼ä¸è‡ªé€‚åº”é˜ˆå€¼ _, thresh = cv.threshold(blurred, 127, 255, cv.THRESH_BINARY) # thresh = cv.adaptiveThreshold( # input, 255, cv.ADAPTIVE_THRESH_MEAN_C, cv.THRESH_BINARY, 11, 2) return thresh def canny_edges(input): canny = cv.Canny(input, 0, 255) return canny å½¢æ€è½¬æ¢ã€‚ä¸Šé¢ä¸€æ­¥å¾—åˆ°äº†è¾¹ç¼˜ä¿¡æ¯ï¼Œæœ‰æ—¶è¾¹ç¼˜ä¿¡æ¯ä¼šæ¯”è¾ƒä¸ç¨³å®šï¼Œå—åˆ°å…‰çº¿ç­‰å½±å“ï¼Œè¿™é‡Œä½¿ç”¨é—­è¿ç®—ï¼Œä½¿å¾—çº¿æ¡æ›´åŠ è†¨èƒ€ï¼ˆç¨³å®šï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 def handle_edges(input): # è†¨èƒ€å’Œè…èš€æ“ä½œçš„æ ¸å‡½æ•° MORPH_RECT | MORH_ELLIPSE | MORPH_CROSS # åˆ†åˆ«ä»£è¡¨ çŸ©å½¢ | æ¤­åœ†å‹ | äº¤å‰å‹ element1 = cv.getStructuringElement(cv.MORPH_ELLIPSE, (5, 5)) element2 = cv.getStructuringElement(cv.MORPH_RECT, (9, 7)) kernel = cv.getStructuringElement(cv.MORPH_ELLIPSE, (9, 9)) closed = cv.morphologyEx(input, cv.MORPH_CLOSE, kernel, iterations=3) open = cv.morphologyEx(closed, cv.MORPH_OPEN, kernel) # è†¨èƒ€ä¸€æ¬¡ï¼Œè®©è½®å»“çªå‡º dilation = cv.dilate(closed, element2, iterations=1) # è…èš€ä¸€æ¬¡ï¼Œå»æ‰ç»†èŠ‚ erosion = cv.erode(dilation, element1, iterations=1) # å†æ¬¡è†¨èƒ€ï¼Œè®©è½®å»“æ˜æ˜¾ä¸€äº› dilation2 = cv.dilate(erosion, element2, iterations=1) return closed è·å–æœ€å¤§è½®å»“\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 def get_edge_max_contour(input): contours, hierarchy = cv.findContours( input, cv.RETR_TREE, # RETR_TREE | RETR_LIST | RETR_EXTERNAL cv.CHAIN_APPROX_SIMPLE) filtered_contours = [ cnt for cnt in contours if cv.contourArea(cnt) \u003e cv.arcLength(cnt, True) ] if len(filtered_contours) \u003c 2: return False sorted_contours = sorted(filtered_contours, key=cv.contourArea, reverse=True) max_contour = sorted_contours[1] return max_contour å¡«å……è½®å»“ï¼Œå¹¶å»ºé®ç½©å±‚\n1 2 3 4 5 6 7 8 9 def get_mask(input, contour): mask = np.zeros(input.shape[:2], np.uint8) cv.drawContours(mask, contour, -1, 255, -1) mask = cv.GaussianBlur(mask, (5, 5), 0) masked = cv.bitwise_and(input.copy(), input.copy(), mask=mask) return masked canny_mask = cv.drawContours(canny, [canny_max_contour], -1, 255, cv.FILLED) å½¢æ€å­¦è½¬æ¢ï¼Œè…èš€æ‰å™ªç‚¹ï¼Œè¿›è¡Œå¼€è¿ç®—\n1 2 3 4 def handle_area(input): kernel = cv.getStructuringElement(cv.MORPH_ELLIPSE, (9, 9)) closed = cv.morphologyEx(input, cv.MORPH_OPEN, kernel, iterations=3) return closed è·å–é®ç½©å±‚æœ€å¤§è½®å»“\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 def get_area_max_contour(input): contours, hierarchy = cv.findContours( input, cv.RETR_EXTERNAL, # RETR_TREE | RETR_LIST | RETR_EXTERNAL cv.CHAIN_APPROX_SIMPLE) filtered_contours = [ cnt for cnt in contours if cv.contourArea(cnt) \u003e cv.arcLength(cnt, True) ] if len(filtered_contours) \u003c 1: return False sorted_contours = sorted(filtered_contours, key=cv.contourArea, reverse=True) max_contour = sorted_contours[0] return max_contour ç»˜åˆ¶æ–¹æ¡†ï¼Œä»¥åŠå…¶ä»–ä¸€äº›ä¿¡æ¯åœ¨å›¾åƒä¸Š\nç°åœ¨æˆ‘ä»¬è·å¾—çš„æ˜¯å½“å‰å›¾åƒä¸Šï¼Œé¢ç§¯æœ€å¤§çš„è½®å»“ã€‚\nè½®å»“å¤„ç†çš„ä¸€èˆ¬æµç¨‹ï¼š\néœ€è¦æ³¨æ„çš„æ˜¯cv2.findContours()å‡½æ•°æ¥å—çš„å‚æ•°ä¸ºäºŒå€¼å›¾ï¼Œå³é»‘ç™½çš„ï¼ˆä¸æ˜¯ç°åº¦å›¾ï¼‰ï¼Œæ‰€ä»¥è¯»å–çš„å›¾åƒè¦å…ˆè½¬æˆç°åº¦çš„ï¼Œå†è½¬æˆäºŒå€¼å›¾ã€‚ï¼Œå‚è§4ã€5ä¸¤è¡Œã€‚ç¬¬å…­è¡Œæ˜¯æ£€æµ‹è½®å»“ï¼Œç¬¬ä¸ƒè¡Œæ˜¯ç»˜åˆ¶è½®å»“ã€‚\n1 2 3 4 5 6 7 8 9 import cv2 img = cv2.imread('D:\\\\test\\\\contour.jpg') gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY) ret, binary = cv2.threshold(gray,127,255,cv2.THRESH_BINARY) contours, hierarchy = cv2.findContours(binary,cv2.RETR_TREE,cv2.CHAIN_APPROX_SIMPLE) cv2.drawContours(img,contours,-1,(0,0,255),3) cv2.imshow(\"img\", img) cv2.waitKey(0) OpenCVä¸­è½®å»“ç­‰çº§çš„è¡¨ç¤º:\nå¦‚æœæˆ‘ä»¬æ‰“å°å‡ºcv2.findContours()å‡½æ•°çš„è¿”å›å€¼hierarchyï¼Œä¼šå‘ç°å®ƒæ˜¯ä¸€ä¸ªåŒ…å«4ä¸ªå€¼çš„æ•°ç»„ï¼š[Next, Previous, First Child, Parent] - Next: ä¸å½“å‰è½®å»“å¤„äºåŒä¸€å±‚çº§çš„ä¸‹ä¸€æ¡è½®å»“ï¼Œæ²¡æœ‰ä¸º-1ã€‚ - Previous: ä¸å½“å‰è½®å»“å¤„äºåŒä¸€å±‚çº§çš„ä¸Šä¸€æ¡è½®å»“ï¼Œæ²¡æœ‰ä¸º-1ã€‚ - Firtst Child: å½“å‰è½®å»“çš„ç¬¬ä¸€æ¡å­è½®å»“ï¼Œæ²¡æœ‰ä¸º-1ã€‚ - Parent: å½“å‰è½®å»“çš„çˆ¶è½®å»“ï¼Œæ²¡æœ‰ä¸º-1ã€‚\nè½®å»“çš„å››ç§å¯»æ‰¾æ–¹å¼ï¼š\nRETR_LISTï¼šæ‰€æœ‰è½®å»“å±äºåŒä¸€å±‚çº§ RETR_TREE: å®Œæ•´å»ºç«‹è½®å»“çš„å„å±æ€§ RETR_EXTERNAL: åªå¯»æ‰¾æœ€é«˜å±‚çº§çš„è½®å»“ RETR_CCOMP: æ‰€æœ‰è½®å»“åˆ†2ä¸ªå±‚çº§ï¼Œä¸æ˜¯å¤–ç•Œå°±æ˜¯æœ€é‡Œå±‚ è½®å»“çš„æ€§è´¨ä¸ç‰¹å¾\nè®¡ç®—ç‰©ä½“çš„å‘¨é•¿ã€é¢ç§¯ã€è´¨å¿ƒã€æœ€å°å¤–æ¥çŸ©å½¢ç­‰\nOpenCVå‡½æ•°ï¼šcv2.contourArea(), cv2.arcLength(), cv2.approxPolyDP()\nå¯»æ‰¾ç­‰é«˜çº¿çš„æ—¶å€™ï¼Œä¸ºä½•æˆ‘æ¨èä½¿ç”¨è¾¹ç¼˜æ£€æµ‹è€Œéé˜ˆå€¼å¤„ç†ä½œä¸ºäºŒå€¼å›¾ï¼Ÿ\nï¼ˆå…·ä½“è§ï¼šhttps://zhuanlan.zhihu.com/p/38739563ï¼‰\næˆ‘å‚è€ƒçš„åšå®¢é‡Œé¢ä½¿ç”¨é˜ˆå€¼å‡½æ•°cv2.threshold()å¤„ç†å›¾ç‰‡å¾—åˆ°äºŒå€¼å›¾ï¼Œä¸è¿‡æˆ‘å»ºè®®ï¼šåœ¨æ€§èƒ½å…è®¸çš„æƒ…å†µä¸‹ï¼Œå½“æˆ‘ä»¬éœ€è¦æ¡†å‡ºçš„æ˜¯ç›®æ ‡çš„è½®å»“ï¼Œé‚£ä¹ˆä½¿ç”¨cv2.Canny() æ›´å¥½ï¼Œç†ç”±ï¼š\næå–è¾¹ç¼˜ä¸é˜ˆå€¼å¤„ç†ä¸åŒï¼Œè¾¹ç¼˜æå–å¯ä»¥è¯†åˆ«å›¾ç‰‡ä¸­ç›®æ ‡çš„å½¢çŠ¶ã€è½®å»“ï¼Œè€Œä¸æ˜¯ç®€å•çš„åŒºåˆ†å‡ºå›¾ç‰‡ä¸­çš„é«˜å…‰ä¸æš—è°ƒï¼Œå¯ä»¥ç®€å•åœ°æå›¾ç‰‡ä¸­é¢œè‰²åˆ†å¸ƒä½äºä¸­é—´è°ƒçš„ä¸Šç›®æ ‡ï¼›\nä½¿ç”¨Cannyè¾¹ç¼˜æ£€æµ‹ï¼Œæå–ç»“æœçš„ç™½ç‚¹æ•°é‡æ›´å°‘ï¼Œå¯¹ç­‰é«˜çº¿æ£€æµ‹çš„æ··æ·†å› ç´ å‡å°‘ï¼ˆçŒœæµ‹ï¼‰ï¼›\næˆ‘å¯¹æ¯”äº†ä¸€äº›è¾¹ç¼˜æ£€æµ‹ç®—æ³•ï¼ŒCannyè¾¹ç¼˜æ£€æµ‹æ•ˆæœå¥½ï¼ˆè™½ç„¶å¯¹æ€§èƒ½è¦æ±‚é«˜ï¼‰ï¼›\nå¦‚æœåˆ©ç”¨è¾¹æ²¿æ£€æµ‹(æˆ–äºŒå€¼å›¾)â€”\u003eè½®å»“â€”\u003eæ©ç â€”\u003eæŠ å›¾\n(è§ï¼š OpenCV ä¸­çš„è½®å»“åº”ç”¨ ä¸­ç¬¬äºŒä¸ªåº”ç”¨,æœ‰pythonä»£ç )\næ­¥éª¤ï¼š\nä½¿ç”¨ Canny è¾¹ç¼˜æ£€æµ‹ï¼Œå¾—åˆ°äºŒå€¼å›¾ï¼Œç„¶åå¯¹å…¶è¿›è¡Œè†¨èƒ€å’Œè…èš€æ“ä½œï¼Œæ–¹ä¾¿ç¨åæå–è½®å»“ å…ˆä½¿ç”¨ cv2.findContours è·å–æ‰€æœ‰è½®å»“ï¼Œ å†æ ¹æ®è½®å»“é¢ç§¯è¿›è¡Œé™åºæ’åˆ—ï¼Œå¹¶è·å–åˆ°é¢ç§¯æœ€å¤§çš„è½®å»“ï¼Œå³å›¾ä¸­äººç‰©çš„è½®å»“ ã€‚ æ¥ä¸‹æ¥é€šè¿‡ cv2.arcLength å¾—åˆ°è½®å»“å‘¨é•¿ï¼Œå¹¶å°†å‘¨é•¿çš„0.1%ä½œä¸ºè¿‘ä¼¼è½®å»“çš„ç²¾åº¦ã€‚ç„¶åå†ä½¿ç”¨ cv2.approxPolyDP å¾—åˆ°è¿‘ä¼¼è½®å»“ã€‚ ç„¶å æ ¹æ®è¿‘ä¼¼è½®å»“å»ºç«‹ä¸€ä¸ªè½®å»“çš„æ©ç maskï¼Œåœ¨å…¶ä¸Šç»˜åˆ¶å‡ºæœ€å¤§è½®å»“å¯¹åº”çš„å¡«å……å¤šè¾¹å½¢ï¼Œç”¨äºä¸‹ä¸€æ­¥æŠ å›¾ ã€‚ å¯¹æ©ç è¿›è¡Œé«˜æ–¯æ¨¡ç³Šç”¨äºå¹³æ»‘è¾¹ç¼˜ï¼Œå¯ä»¥æ¶ˆé™¤é”¯é½¿ã€‚ æœ€åä¸€æ­¥å°±æ˜¯å°†æ©ç å’ŒåŸå›¾åƒè¿›è¡Œæ±‚ä¸è¿ç®—ï¼Œå³å¾—åˆ°æœ€ç»ˆç»“æœã€‚ å®Œæ•´ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 # encoding:utf-8 from glob import glob import time import cv2 as cv import stackprinter as sp import numpy as np import matplotlib.pyplot as plt TIMESTAMP_FORMAT = '%Y-%m-%d %H:%M:%S' TIMESTAMP_FILE_FORMAT = '%m%d_%H%M_%S' CAPTURE_TIMES_PER_TASK = 5 def compare_img_hist(img1, img2): img1 = cv.imread(img1) img2 = cv.imread(img2) # Get the histogram data of image 1, then using normalize the picture for better compare img1_hist = cv.calcHist([img1], [1], None, [256], [0, 256]) img1_hist = cv.normalize(img1_hist, img1_hist, 0, 1, cv.NORM_MINMAX, -1) img2_hist = cv.calcHist([img2], [1], None, [256], [0, 256]) img2_hist = cv.normalize(img2_hist, img2_hist, 0, 1, cv.NORM_MINMAX, -1) similarity = cv.compareHist(img1_hist, img2_hist, 0) return similarity def denoising(input): # é«˜æ–¯å¹³æ»‘ å»å™ª gaussian = cv.GaussianBlur(input, (3, 3), 0, 0, cv.BORDER_DEFAULT) # ä¸­å€¼æ»¤æ³¢ median = cv.medianBlur(gaussian, 5) return gaussian, median def get_edges(input, edge_type='sobel'): if edge_type == 'sobel': gradX = cv.Sobel(input, ddepth=cv.CV_32F, dx=1, dy=0, ksize=-1) gradY = cv.Sobel(input, ddepth=cv.CV_32F, dx=0, dy=1, ksize=-1) # subtract the y-gradient from the x-gradient gradient = cv.subtract(gradX, gradY) gradient = cv.convertScaleAbs(gradient) blurred = cv.blur(gradient, (5, 5)) # cv.threshhold ä¸ cv.adaptiveThresholud åŒºåˆ« # å…¨å±€é˜ˆå€¼ä¸è‡ªé€‚åº”é˜ˆå€¼ _, thresh = cv.threshold(blurred, 127, 255, cv.THRESH_BINARY) # thresh = cv.adaptiveThreshold( # input, 255, cv.ADAPTIVE_THRESH_MEAN_C, cv.THRESH_BINARY, 11, 2) return thresh else: canny = cv.Canny(input, 0, 255) return canny def sobel_edges(input): gradX = cv.Sobel(input, ddepth=cv.CV_32F, dx=1, dy=0, ksize=-1) gradY = cv.Sobel(input, ddepth=cv.CV_32F, dx=0, dy=1, ksize=-1) # subtract the y-gradient from the x-gradient gradient = cv.subtract(gradX, gradY) gradient = cv.convertScaleAbs(gradient) blurred = cv.blur(gradient, (5, 5)) # cv.threshhold ä¸ cv.adaptiveThresholud åŒºåˆ« # å…¨å±€é˜ˆå€¼ä¸è‡ªé€‚åº”é˜ˆå€¼ _, thresh = cv.threshold(blurred, 127, 255, cv.THRESH_BINARY) # thresh = cv.adaptiveThreshold( # input, 255, cv.ADAPTIVE_THRESH_MEAN_C, cv.THRESH_BINARY, 11, 2) return thresh def canny_edges(input): canny = cv.Canny(input, 0, 255) return canny def get_edge_max_contour(input): contours, hierarchy = cv.findContours( input, cv.RETR_TREE, # RETR_TREE | RETR_LIST | RETR_EXTERNAL cv.CHAIN_APPROX_SIMPLE) filtered_contours = [ cnt for cnt in contours if cv.contourArea(cnt) \u003e cv.arcLength(cnt, True) ] if len(filtered_contours) \u003c 2: return False sorted_contours = sorted(filtered_contours, key=cv.contourArea, reverse=True) max_contour = sorted_contours[1] return max_contour def get_area_max_contour(input): contours, hierarchy = cv.findContours( input, cv.RETR_EXTERNAL, # RETR_TREE | RETR_LIST | RETR_EXTERNAL cv.CHAIN_APPROX_SIMPLE) filtered_contours = [ cnt for cnt in contours if cv.contourArea(cnt) \u003e cv.arcLength(cnt, True) ] if len(filtered_contours) \u003c 1: return False sorted_contours = sorted(filtered_contours, key=cv.contourArea, reverse=True) max_contour = sorted_contours[0] return max_contour def get_mask(input, contour): mask = np.zeros(input.shape[:2], np.uint8) cv.drawContours(mask, contour, -1, 255, -1) mask = cv.GaussianBlur(mask, (5, 5), 0) masked = cv.bitwise_and(input.copy(), input.copy(), mask=mask) return masked def handle_edges(input): # è†¨èƒ€å’Œè…èš€æ“ä½œçš„æ ¸å‡½æ•° MORPH_RECT | MORH_ELLIPSE | MORPH_CROSS # åˆ†åˆ«ä»£è¡¨ çŸ©å½¢ | æ¤­åœ†å‹ | äº¤å‰å‹ element1 = cv.getStructuringElement(cv.MORPH_ELLIPSE, (5, 5)) element2 = cv.getStructuringElement(cv.MORPH_RECT, (9, 7)) kernel = cv.getStructuringElement(cv.MORPH_ELLIPSE, (9, 9)) closed = cv.morphologyEx(input, cv.MORPH_CLOSE, kernel, iterations=3) open = cv.morphologyEx(closed, cv.MORPH_OPEN, kernel) # è†¨èƒ€ä¸€æ¬¡ï¼Œè®©è½®å»“çªå‡º dilation = cv.dilate(closed, element2, iterations=1) # è…èš€ä¸€æ¬¡ï¼Œå»æ‰ç»†èŠ‚ erosion = cv.erode(dilation, element1, iterations=1) # å†æ¬¡è†¨èƒ€ï¼Œè®©è½®å»“æ˜æ˜¾ä¸€äº› dilation2 = cv.dilate(erosion, element2, iterations=1) return closed def handle_area(input): kernel = cv.getStructuringElement(cv.MORPH_ELLIPSE, (9, 9)) closed = cv.morphologyEx(input, cv.MORPH_OPEN, kernel, iterations=3) return closed def handle_mask(input): # å»ºç«‹ä¸€ä¸ªæ¤­åœ†æ ¸å‡½æ•° kernel = cv.getStructuringElement(cv.MORPH_ELLIPSE, (25, 25)) # kernel = cv.getStructuringElement(cv.MORPH_ELLIPSE, (3, 3)) # æ‰§è¡Œå›¾åƒå½¢æ€å­¦, ç»†èŠ‚ç›´æ¥æŸ¥æ–‡æ¡£ï¼Œå¾ˆç®€å• closed = cv.morphologyEx(input, cv.MORPH_CLOSE, kernel, iterations=3) # closed = cv.erode(closed, None, iterations=3) # closed = cv.dilate(closed, None, iterations=3) return closed def calc_osd(input, contour): # epsilon = cv.arcLength(contour, True) * 0.01 # approx = cv.approxPolyDP(contour, epsilon, True) area = cv.contourArea(contour) M = cv.moments(contour) cx = int(M['m10'] / M['m00']) cy = int(M['m01'] / M['m00']) rx, ry, rw, rh = cv.boundingRect(contour) h, w = input.shape[:2] offset = (w // 2 - cx, h // 2 - cy) angle = 0 area_ratio = round(area / input.size * 100, 4) # rect = cv.minAreaRect(approx) # box = np.int0(cv.boxPoints(rect)) # print('center point: ', (round(rect_center_x), round(rect_center_y))) if area_ratio \u003c 10: return input # ç»˜åˆ¶å›¾å¡åŒºåŸŸæ¡† dst = cv.rectangle(input, (rx, ry), (rx + rw, ry + rh), (0, 255, 0), 2) # ç»˜åˆ¶å›¾å¡å†…å®¹æ¡† dst = cv.drawContours(dst, [contour], 0, (255, 0, 0), 3) osd_timestamp = time.strftime(TIMESTAMP_FORMAT, time.localtime()) dst = draw_osd(dst, area_ratio, offset, angle, osd_timestamp) dst = draw_crossline(dst, (w // 2, h // 2), 40, (0, 255, 0)) dst = draw_crossline(dst, (cx, cy), 40, (255, 0, 0)) return dst def img2(imgs, h=1080, w=1920): for i, img in enumerate(imgs): imgs[i] = np.array(img[:h:2, :w:2]) img = np.concatenate(imgs[:2], 1) return img def img4(imgs, h=1080, w=1920): for i, img in enumerate(imgs): imgs[i] = img[:h:2, :w:2] row1 = np.concatenate(imgs[:2], 1) row2 = np.concatenate(imgs[2:4], 1) img = np.concatenate([row1, row2], 0) return img def img6(imgs, h=1080, w=1920): for i, img in enumerate(imgs): imgs[i] = img[:h:3, :w:3] row1 = np.concatenate(imgs[:3], 1) row2 = np.concatenate(imgs[3:6], 1) img = np.concatenate([row1, row2], 0) return img def img9(imgs, h=1080, w=1920): for i, img in enumerate(imgs): imgs[i] = img[:h:3, :w:3] row1 = np.concatenate(imgs[:3], 1) row2 = np.concatenate(imgs[3:6], 1) row3 = np.concatenate(imgs[6:], 1) img = np.concatenate([row1, row2, row3], 0) return img def draw_osd(img, ratio, offset, angle, timestamp): x, y = offset font = cv.FONT_HERSHEY_SIMPLEX text = f'area ratio: {ratio} %\\n' \\ f'offset x: {x} \\n' \\ f'offset y: {y} \\n' \\ f'angle: {angle} \\n' \\ f'time: {timestamp}' y0, dy = 50, 40 dst = None for i, line in enumerate(text.split('\\n')): y = y0 + i * dy dst = cv.putText(img, line, (50, y), font, 1, (0, 255, 0), 2) return dst def draw_osd_fps(img, fps): dst = cv.putText(img, f'fps: {fps}', (50, 200), cv.FONT_HERSHEY_SIMPLEX, 1, (0, 255, 0), 2) return dst def draw_crossline(img, pt, length, color): x, y = pt pt_x1 = x - length, y pt_x2 = x + length, y pt_y1 = x, y - length pt_y2 = x, y + length dst = cv.line(img, pt_x1, pt_x2, color, 5) dst = cv.line(img, pt_y1, pt_y2, color, 5) return dst def plot_all(imgs): titles = [ 'Source Image', 'Gray Image', 'gaussian Image', 'median Image', 'Sobel Image', 'Binary Image', 'dilation Image', 'Mask', 'After Mask' ] for i in range(9): plt.subplot(3, 3, i + 1), plt.imshow(imgs[i], 'gray') plt.title(titles[i]) plt.xticks([]), plt.yticks([]) plt.show() def save_capture(input, filename): cv.imwrite(filename, input) def detect(input, task=None): # æ ¹æ®inputç±»å‹ç¡®è®¤æ˜¯frameè¿˜æ˜¯å›¾åƒ if isinstance(input, str): input = cv.imread(input) # è½¬æ¢è‰²å½©ç©ºé—´, opencvé»˜è®¤çš„imreadæ˜¯ä»¥BGRçš„æ–¹å¼è¿›è¡Œå­˜å‚¨çš„ input = cv.cvtColor(input, cv.COLOR_BGR2RGB) gray = cv.cvtColor(input, cv.COLOR_BGR2GRAY) gaussian, median = denoising(gray) # canny è¾¹ç¼˜æ£€æµ‹ canny = canny_edges(gaussian) # è¾¹ç¼˜å¤„ç†, æ ¹æ® å¼€/é—­ æ“ä½œå»é™¤æ¸¸ç¦»çº¿æ¡ canny_closed = handle_edges(canny) canny_max_contour = get_edge_max_contour(canny_closed) if canny_max_contour is False: return input canny_mask = cv.drawContours(canny, [canny_max_contour], -1, 255, cv.FILLED) canny_mask = handle_area(canny_mask) canny_max_contour = get_area_max_contour(canny_mask) if canny_max_contour is False: return input dst = calc_osd(input, canny_max_contour) dst = cv.resize(dst, (960, 540)) return dst sobel = sobel_edges(gaussian) sobel_closed = handle_edges(sobel) sobel_max_contour = get_edge_max_contour(sobel_closed) if sobel_max_contour is False: return input sobel_mask = cv.drawContours(sobel, [sobel_max_contour], -1, 255, cv.FILLED) sobel_mask = handle_mask(sobel_mask) sobel_max_contour = get_area_max_contour(sobel_mask) mask_compare = [canny_mask, sobel_mask] # closed_compare = [canny_closed, sobel_closed] # area_filled_compare = [canny_mask, sobel_mask] return sobel_mask def start_detect(): cap = cv.VideoCapture(0) last = cv.getTickCount() while True: ret, frame = cap.read() if ret: dst = detect(frame) # now = cv.getTickFrequency() # time = (now - last) / cv.getTickFrequency() # dst = draw_osd_fps(dst, round(1 / time, 2)) try: cv.imshow('dst', dst) except: sp.show(style='darkbg', source_lines=4) # last = now if cv.waitKey(1) \u0026 0xFF == ord('q'): cv.destroyAllWindows() break if cv.waitKey(1) \u0026 0xFF == ord('s') and ret: cv.imwrite('dst', frame) continue cap.release() if __name__ == \"__main__\": # images = glob('classify/charts/*') # images = glob('images/stepchart/*') # images = [ # # 'images/sfr/4K_1M.bmp', # # 'images/sfr/1080P_2M.png', # 'images/sfr/100lux.png', # ] # for image in images: # detect_chart_type(image) # detect(image) start_detect() æ›´è¿›ä¸€æ­¥çš„ä»»åŠ¡ï¼Œå¦‚ä½•è¯†åˆ«å›¾åƒç±»åˆ« ç°åœ¨æˆ‘ä»¬å·²ç»è£å‰ªå‡ºäº†æˆ‘ä»¬æ„Ÿå…´è¶£çš„å›¾å¡å†…å®¹ï¼Œè¿™é‡Œéœ€è¦åšæ›´è¿›ä¸€æ­¥çš„å¤„ç†ï¼Œæ¯”å¦‚å¯¹äºå›¾å¡å†…å®¹çš„åˆ†ç±»ã€‚\nå‡è®¾å›¾å¡å‡ºç°çš„ç‰©ä½“éƒ½æ˜¯å·²çŸ¥çš„ï¼Œè€Œä¸”æˆ‘ä»¬æœ‰æ‰€æœ‰çš„å›¾å¡å›¾ç‰‡ï¼Œé‚£ä¹ˆè¦æ”¹å¦‚ä½•å»ºç«‹åˆ¤æ–­å‘¢ï¼Ÿ\nä¸€ä¸ªç®€å•çš„æ€è·¯æ˜¯ï¼Œæ—¢ç„¶æˆ‘ä»¬å·²ç»æœ‰äº†æ‰€æœ‰å›¾ç‰‡çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆé€‰å–ä¸€å¼ æ‹å¾—æ¯”è¾ƒæ ‡å‡†çš„ä½œä¸ºå‚ç…§ï¼Œå…¶ä»–çš„å›¾ç‰‡å’Œå®ƒè¿›è¡Œæ¯”è¾ƒï¼Œåˆ¤æ–­ç›¸ä¼¼åº¦ï¼Œç›¸ä¼¼åº¦æœ€é«˜çš„å°±æ˜¯æœ€æœ‰å¯èƒ½çš„åˆ†ç±»ã€‚\nè¿™é‡Œå¼•å…¥ä¸€äº›å›¾åƒç›¸ä¼¼åº¦ç®—æ³•çš„å†…å®¹ï¼š\nç›¸å…³èµ„æ–™ æ–‡æ¡£\nOpenCV 4.0 ä¸­æ–‡æ–‡æ¡£ OpenCV å®˜æ–¹ Tutorial å›¾åƒæ¢¯åº¦ç‰¹å¾ï¼šè½®å»“\nè¾¹ç¼˜æ£€æµ‹ï¼Œæ¡†å‡ºç‰©ä½“çš„è½®å»“(ä½¿ç”¨opencv-python)\nOpenCV ä¸­çš„è½®å»“åº”ç”¨\næ„Ÿå…´è¶£åŒºåŸŸçš„ç§»åŠ¨ç‰©ä½“æ£€æµ‹ï¼Œæ¡†å‡ºç§»åŠ¨ç‰©ä½“çš„è½®å»“ (å›ºå®šæ‘„åƒå¤´, opencv-python)\nOpenCVå›¾åƒå¤„ç†-è½®å»“å’Œè½®å»“ç‰¹å¾\nå›¾åƒäºŒå€¼åŒ–\nOpenCVâ€”å›¾åƒäºŒå€¼åŒ–\nå›¾åƒäºŒå€¼åŒ–,é˜ˆå€¼å¤„ç†(å)\nç›¸å…³æ¦‚å¿µï¼š\næ•°å­¦å½¢æ€å­¦æ“ä½œ\nOpenCVå›¾åƒå¤„ç†|1.11 å½¢æ€å­¦æ“ä½œ\nå›¾åƒå·ç§¯ã€è¾¹ç¼˜æå–å’Œæ»¤æ³¢å»å™ª\nå›¾åƒè¾¹ç¼˜æ£€æµ‹ - å›¾åƒæ¢¯åº¦ä¸Cannyç®—å­\nOpenCVå›¾åƒå¤„ç†-Canyã€Sobelã€Laplacianç®—å­å’Œå›¾åƒé‡‘å­—å¡”\nOpenCVâ€”python å›¾åƒæ˜¾è‘—æ€§æ£€æµ‹ç®—æ³•â€”HC/RC/LC/FT\n","description":"","tags":["python","opencv"],"title":"ä½¿ç”¨ Opencv æ­å»ºå›¾ç‰‡è¯†åˆ«åº”ç”¨","uri":"/blog/posts/Python/object-detect-using-opencv/"},{"categories":null,"content":" æœ€è¿‘é‡åˆ°ä¸€ä¸ªæƒ…æ™¯ï¼š\néœ€è¦é€šè¿‡ä¸²å£å‘æ§åˆ¶å™¨å‘é€æ§åˆ¶å‘½ä»¤ï¼Œå…¶ä¸­æ§åˆ¶å‘½ä»¤éƒ½æ˜¯ 16 è¿›åˆ¶çš„å­—ç¬¦ä¸²ï¼Œåƒè¿™æ · AA 1A 00 03 00 00 00 00 22 11 A2 42 0E 00 20 00 40 00 40 00 01 14 7B 40 97 BEï¼Œé‡Œé¢æœ‰ä¸€äº›å­—æ®µæ˜¯ int è½¬ä¸º hexã€‚\nè¿™é‡Œé¢æ¶‰åŠåˆ°åœ¨ Python ä¸­çš„è¿›åˆ¶çš„è½¬æ¢ï¼Œç”±äº Python ä¸­çš„å˜é‡èµ‹å€¼ä¸éœ€è¦ç±»å‹å£°æ˜ã€‚æ‰€ä»¥éœ€è¦ä¸€äº›è‡ªå®šä¹‰çš„å‡½æ•°æ¥æ§åˆ¶è½¬æ¢ä¸ºæŒ‡å®šé•¿åº¦çš„ hexã€‚\nè¿›åˆ¶è½¬æ¢ Python æœ¬èº«æä¾›äº†è¿›åˆ¶è½¬æ¢çš„å†…ç½®å‡½æ•°ï¼š\nbin() oct() int() hex() format() 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 \u003e\u003e\u003e n = 1024 \u003e\u003e\u003e bin(n) '0b10000000000' \u003e\u003e\u003e oct(n) '0o2000' \u003e\u003e\u003e hex(n) '0x400' \u003e\u003e\u003e format(n, 'b') '10000000000' \u003e\u003e\u003e format(n, 'o') '2000' \u003e\u003e\u003e format(n, 'x') '400' å¯ä»¥çœ‹åˆ°ï¼ŒPython ä¸­è¿›åˆ¶åœ¨è½¬æ¢åéƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè€Œbin(), oct(), hex() ä¼šåˆ†åˆ«å¸¦æœ‰ 0b, 0o, 0x çš„å‰ç¼€ã€‚\nä¸éœ€è¦å‰ç¼€å¯ä»¥ä½¿ç”¨ format() å‡½æ•°ï¼Œå…¶å£°æ˜ä¸ºformat(value[, format_spec])\nä¸ªäººè§‰å¾—ä½¿ç”¨ format() æ›´ä¸ºæ–¹ä¾¿\nç°åœ¨æ¥çœ‹çœ‹å½“å€¼å‡ºç°è´Ÿæ•°çš„æƒ…å†µ\n1 2 3 4 \u003e\u003e\u003e n = -1024 \u003e\u003e\u003e format(n, 'x') '-400' è¿™é‡Œå¸¦æœ‰ç¬¦å·ä½ï¼Œåé¢çš„å€¼ä¸æ­£æ•°çš„è¿›åˆ¶è½¬æ¢åç»“æœç›¸åŒã€‚\nè®¡ç®—è¡¥ç  åœ¨è®¡ç®—æœºä¸­æ‰€æœ‰æ•°å€¼æ˜¯é€šè¿‡è¡¥ç æ¥è¡¨ç¤ºçš„ï¼Œè¡¥ç çš„è½¬æ¢æ³•åˆ™æ˜¯åŸç å–åå+1ã€‚\nå‡è®¾æ•°å€¼çš„å­˜å‚¨é•¿åº¦ä¸º 16 ä½ï¼Œå®ƒå¯ä»¥è¡¨ç¤º -32768 åˆ° 32767çš„æ•° ã€‚é‚£ä¹ˆç°åœ¨æ¥çœ‹ä¸€ä¸ªè´Ÿæ•°çš„è¡¥ç å½¢å¼ï¼Œå¯¹åº”çš„ 16 è¿›åˆ¶çš„å€¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 \u003e\u003e\u003e # 16 ä½è¡¥ç  \u003e\u003e\u003e n = -1024 \u003e\u003e\u003e bin(((1 \u003c\u003c 16) - 1) \u0026 n) # ç”¨ 16 ä½é•¿åº¦Bit AND '0b1111110000000000' \u003e\u003e\u003e comp = bin(((1 \u003c\u003c 16) - 1) \u0026 n) \u003e\u003e\u003e comp '0b1111110000000000' \u003e\u003e\u003e int16 = int(comp, 2) \u003e\u003e\u003e int16 64512 \u003e\u003e\u003e hex(int16) '0xfc00' è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œå¦‚æœä½ çŸ¥é“è¡¥ç çœŸæ­£çš„å«ä¹‰çš„è¯ï¼Œç›´æ¥ç”¨ 2 ** 16 + nï¼Œå¾—åˆ°çš„å°±æ˜¯è¡¥ç çš„æ— ç¬¦å·ä½è¡¨ç¤ºã€‚\nå¯¹åº”åœ°å¯æ±‚å‡º 32 ä½è¡¥ç çš„å€¼\nå®šé•¿çš„è¿›åˆ¶è½¬æ¢ å¦‚ä½•åšå®šé•¿çš„è¿›åˆ¶è½¬æ¢å‘¢ï¼Ÿè¿™ä¼šç”¨åˆ° zfill() å‡½æ•°\n1 2 3 4 5 \u003e\u003e\u003e n = 1024 \u003e\u003e\u003e format(n, 'x') '400' \u003e\u003e\u003e format(n, 'x').zfill(4) '0400' è¿™æ ·å°±å¯ä»¥å¾ˆå¥½çš„æŠŠè¿›åˆ¶è½¬åŒ–ä¸º c é£æ ¼çš„è¿›åˆ¶äº†ã€‚\n1 2 3 4 5 6 7 8 def int2hex(n, bit_len=16, hex_len=0): comp = (2 ** bit_len + n) % 2 ** bit_len return format(comp, 'x').zfill(hex_len) def hex2int(n, bit_len=16): if int(n, 16) \u003c 2 ** (bit_len - 1): return int(n, 16) return int(n, 16) - 2 ** bit_len æˆ‘ä»¬è¿˜å¯ä»¥å†™å‡ºå…¶ä»–çš„é•¿åº¦è¿›åˆ¶è½¬æ¢ã€‚ä½†ç°åœ¨å°±æ­¤æ‰“ä½ã€‚\næ€»ç»“ Python ä¸­çš„è¿›åˆ¶è½¬æ¢ç›¸å…³çš„å‡½æ•° å¦‚ä½•è®¡ç®—è¡¥ç  å¦‚ä½•åšå®šé•¿çš„è¿›åˆ¶è½¬æ¢ ","description":"","tags":["python"],"title":"Python ä¸­å¦‚ä½•è¿›åˆ¶è½¬æ¢","uri":"/blog/posts/Python/how-to-convert-number-in-python/"},{"categories":null,"content":"\nè½¬è½½è‡ª Writing a small static site generator\nå¦‚æœä½ æœ‰å†™åšå®¢çš„ä¹ æƒ¯ä»¥åŠå°è¯•è¿‡è‡ªå»ºåšå®¢æœåŠ¡ï¼Œæƒ³å¿…ä¼šå¯¹ Hexoï¼ŒHugo ç­‰ç”Ÿæˆé™æ€é¡µé¢çš„æ¡†æ¶ä¸é™Œç”Ÿã€‚\né‚£ä¹ˆå¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå·±çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨å‘¢ï¼Œæœ¬æ–‡ç”¨æå…¶å°‘é‡ Python ä»£ç å®ç°\nç›®å‰å¤§æ¦‚æœ‰ä¸Šç™¾ç§ç”¨Pythonç¼–å†™çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼ˆè¿˜æœ‰æ›´å¤šå…¶ä»–è¯­è¨€ç¼–å†™çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼‰ã€‚\næ‰€ä»¥æˆ‘å†³å®šå†™æˆ‘è‡ªå·±çš„ã€‚\nä¸ºä»€ä¹ˆï¼Ÿ\nå¥½å§ï¼Œæˆ‘åªæ˜¯å¸Œæœ›å°†åšå®¢ä» Ghost è¿ç§»ï¼Œå¹¶ä¸”å¸Œæœ›ä¿æŒçœŸæ­£çš„ç®€çº¦æ€§ã€‚\næˆ‘å†³å®šä½¿ç”¨GitHub Pagesæ‰˜ç®¡ï¼Œå› ä¸ºä»–ä»¬æœ€è¿‘å®£å¸ƒæ”¯æŒè‡ªå®šä¹‰åŸŸçš„SSLã€‚\næ¸²æŸ“å†…å®¹ æ¯ä¸ªé™æ€ç½‘ç«™ç”Ÿæˆå™¨éƒ½éœ€è¦é‡‡ç”¨æŸç§æºæ ¼å¼ï¼ˆä¾‹å¦‚Markdownæˆ–ReStructuredTextï¼‰å¹¶å°†å…¶è½¬æ¢ä¸ºHTMLã€‚æˆ‘å†³å®šåšæŒ Markdownã€‚\nè‡ªä»æˆ‘æœ€è¿‘å°† Githubé£æ ¼çš„Markdown æ¸²æŸ“é›†æˆåˆ° Warehouseä¸­ ä»¥æ¥ï¼Œæˆ‘å†³å®šä½¿ç”¨ä¸ºcmarkgfm åˆ›å»ºçš„åŸºç¡€åº“ã€‚ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å°†Markdownæ¸²æŸ“ä¸ºHTML ï¼š\n1 2 3 4 5 6 7 8 import cmarkgfm def render_markdown(content: str) -\u003e str: content = cmarkgfm.markdown_to_html_with_extensions( content, extensions=['table', 'autolink', 'strikethrough']) return content cmarkgfmç¡®å®æœ‰ä¸€ä¸ªç§°ä¸ºçš„ä¾¿æ·æ–¹æ³•github_flavored_markdown_to_htmlï¼Œä½†æ˜¯å®ƒä½¿ç”¨äº†GitHubçš„tagfilteræ‰©å±•ï¼Œå½“æˆ‘è¦å°†è„šæœ¬å’Œå†…å®¹åµŒå…¥åˆ°å¸–å­ä¸­æ—¶ï¼Œè¿™æ˜¯ä¸å¸Œæœ›çš„ã€‚å› æ­¤ï¼Œæˆ‘åªæ˜¯é€‰æ‹©äº†æˆ‘æƒ³ä½¿ç”¨çš„æ‰©å±•ã€‚\néå† å¥½çš„ï¼Œæˆ‘ä»¬æœ‰ä¸€ç§æ¸²æŸ“Markdownçš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦ä¸€ç§æ”¶é›†æ‰€æœ‰æºæ–‡ä»¶çš„æ–¹æ³•ã€‚æˆ‘å†³å®šå°†æ‰€æœ‰æ¥æºå­˜å‚¨åœ¨ä¸‹./srcã€‚æˆ‘ä»¬å¯ä»¥pathlibç”¨æ¥æ”¶é›†å®ƒä»¬ï¼š\n1 2 3 4 5 6 import pathlib from typing import Iterator def get_sources() -\u003e Iterator[pathlib.Path]: return pathlib.Path('.').glob('srcs/*.md') Front Matter è®¸å¤šé™æ€ç½‘ç«™ç”Ÿæˆå™¨éƒ½æœ‰ Front Matter çš„æ¦‚å¿µ â€”â€” ä¸€ç§ä¸ºæ¯ä¸ªæºæ–‡ä»¶è®¾ç½®å…ƒæ•°æ®ç­‰çš„æ–¹æ³•ã€‚\næˆ‘æƒ³æ”¯æŒ frontmatterï¼Œä»¥ä¾¿è®©æˆ‘ä¸ºæ¯ä¸ªå¸–å­è®¾ç½®æ—¥æœŸå’Œæ ‡é¢˜ã€‚çœ‹èµ·æ¥åƒè¿™æ ·ï¼š\n1 2 3 4 5 6 --- title: Post time date: 2018-05-11 --- # Markdown content here. å¯¹äºfrontmatteræœ‰ä¸€ä¸ªéå¸¸å¥½çš„å’Œç®€å•çš„ç°æœ‰åº“ï¼Œç§°ä¸ºpython-frontmatterã€‚æˆ‘å¯ä»¥ä½¿ç”¨å®ƒæ¥æå– frontmatter å’ŒåŸå§‹å†…å®¹ï¼š\n1 2 3 4 5 6 import frontmatter def parse_source(source: pathlib.Path) -\u003e frontmatter.Post: post = frontmatter.load(str(source)) return post è¿”å›çš„postå¯¹è±¡å…·æœ‰.contentå…·æœ‰å‘å¸ƒå†…å®¹çš„å±æ€§ï¼Œå¦åˆ™å……å½“å­—å…¸ä»¥è·å–å‰é¡¹é”®ã€‚\næ¸²æŸ“ ç°åœ¨æˆ‘ä»¬æœ‰äº†å¸–å­çš„å†…å®¹å’Œè¦ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æ¸²æŸ“å®ƒä»¬ã€‚æˆ‘å†³å®šä½¿ç”¨jinja2å°†cmarkgfmæ¸²æŸ“åçš„Markdownå’ŒFrontmatteræ”¾å…¥ä¸€ä¸ªç®€å•çš„HTMLæ¨¡æ¿ä¸­ã€‚\nè¿™æ˜¯æ¨¡æ¿ï¼š\n1 2 3 4 5 6 7 8 9 10 11 \u003c!doctype html\u003e \u003chtml\u003e \u003chead\u003e\u003ctitle\u003e{{post.title}}\u003c/title\u003e\u003c/head\u003e \u003cbody\u003e \u003ch1\u003e{{post.title}}\u003c/h1\u003e \u003cem\u003ePosted on {{post.date.strftime('%B %d, %Y')}}\u003c/em\u003e \u003carticle\u003e {{content}} \u003c/article\u003e \u003c/body\u003e \u003c/html\u003e è¿™æ˜¯æ¸²æŸ“å®ƒçš„Pythonä»£ç ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 import jinja2 jinja_env = jinja2.Environment( loader=jinja2.FileSystemLoader('templates'), ) def write_post(post: frontmatter.Post, content: str): path = pathlib.Path(\"./docs/{}.html\".format(post['stem'])) template = jinja_env.get_template('post.html') rendered = template.render(post=post, content=content) path.write_text(rendered) è¯·æ³¨æ„ï¼Œæˆ‘å°†å‘ˆç°çš„HTMLå­˜å‚¨åœ¨ä¸­./docsã€‚è¿™æ˜¯å› ä¸ºæˆ‘å°†GitHub Pagesé…ç½®ä¸ºå‘å¸ƒdocç›®å½•ä¸­çš„å†…å®¹ã€‚\nç°åœ¨æˆ‘ä»¬å¯ä»¥å‘ˆç°å•ä¸ªå¸–å­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨get_sourcesä¸Šé¢åˆ›å»ºçš„å‡½æ•°éå†æ‰€æœ‰å¸–å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 from typing import Sequence def write_posts() -\u003e Sequence[frontmatter.Post]: posts = [] sources = get_sources() for source in sources: # Get the Markdown and frontmatter. post = parse_source(source) # Render the markdown to HTML. content = render_markdown(post.content) # Write the post content and metadata to the final HTML file. post['stem'] = source.stem write_post(post, content) posts.append(post) return posts ç´¢å¼•é¡µé¢ ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ¸²æŸ“å¸–å­ï¼Œä½†æˆ‘ä»¬ä¹Ÿåº”è¯¥æ¸²æŸ“index.htmlåˆ—å‡ºæ‰€æœ‰å¸–å­çš„é¡¶å±‚ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªjinja2æ¨¡æ¿ä»¥åŠä»è¿”å›çš„å¸–å­åˆ—è¡¨æ¥æ‰§è¡Œæ­¤æ“ä½œwrite_postsã€‚\nè¿™æ˜¯æ¨¡æ¿ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u003c!doctype html\u003e \u003chtml\u003e \u003cbody\u003e \u003ch1\u003eMy blog posts\u003c/h1\u003e \u003col\u003e {% for post in posts %} \u003cli\u003e \u003ca href=\"/{{post.stem}}\"\u003e{{post.title}}\u003c/a\u003e \u003cli\u003e {% endfor %} \u003c/ol\u003e \u003c/body\u003e \u003c/html\u003e è¿™æ˜¯æ¸²æŸ“å®ƒçš„Pythonä»£ç ï¼š\n1 2 3 4 5 6 7 def write_index(posts: Sequence[frontmatter.Post]): # Sort the posts from newest to oldest. posts = sorted(posts, key=lambda post: post['date'], reverse=True) path = pathlib.Path(\"./docs/index.html\") template = jinja_env.get_template('index.html') rendered = template.render(posts=posts) path.write_text(rendered) æ•´æ´» ç°åœ¨å‰©ä¸‹çš„å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªmainå‡½æ•°å°†å…¶è¿æ¥èµ·æ¥ã€‚\n1 2 3 4 5 6 7 def main(): posts = write_posts() write_index(posts) if __name__ == '__main__': main() æºç  æ‚¨å¯ä»¥åœ¨theacodes / blog.thea.codesä¸ŠæŸ¥çœ‹å®Œæ•´çš„æºä»£ç ï¼ŒåŒ…æ‹¬è¯­æ³•é«˜äº®æ˜¾ç¤ºæ”¯æŒã€‚\n","description":"","tags":["web"],"title":"ç¼–å†™ä¸€ä¸ªå°å‹é™æ€ç½‘ç«™ç”Ÿæˆå™¨","uri":"/blog/posts/write-a-small-static-site-generator/"},{"categories":null,"content":" ä½œä¸ºåŸºæœ¬åœ¨ Linux/Unix ç¯å¢ƒä¸‹å¹²æ´»çš„æ¥è¯´ï¼Œé…ç¯å¢ƒå°±æ˜¯å®¶å¸¸ä¾¿é¥­ã€‚\næœ‰æ—¶ä½ éœ€è¦æŠŠä¸€å°æœºå™¨çš„ç¯å¢ƒåœ¨å¦å¤–ä¸€å°æœºå™¨é‡æ–°é…ç½®ï¼Œè¿™å°±å¾ˆçƒ¦å•Šâ€¦...\nAPT è½¯ä»¶åŒ…å¤‡ä»½ ä½¿ç”¨ apt-clone åŒ…å°±èƒ½å¤‡ä»½ç³»ç»Ÿä¸Šå·²å®‰è£…è½¯ä»¶åˆ—è¡¨\nå®‰è£… apt-clone 1 sudo apt install apt-clone å¤‡ä»½ æ–°å»ºä¸ªæ–‡ä»¶å¤¹ä¿å­˜å¤‡ä»½æ–‡ä»¶ï¼Œä¹‹åç›´æ¥å¼€å§‹å¤‡ä»½å°±å¥½äº†\n1 2 3 4 5 mkdir ~/mypackages sudo apt-clone clone ~/mypackages not installable: sogoupinyin, atom, lantern version mismatch: libwebkit2gtk-4.0-37, unattended-upgrades, liblouis-data, firefox-locale-en, ubuntu-release-upgrader-core, ubuntu-release-upgrader-gtk, gir1.2-webkit2-4.0, update-manager-core, firefox-locale-zh-hans, python3-louis, update-manager, python3-distupgrade, libjavascriptcoregtk-4.0-18, gir1.2-javascriptcoregtk-4.0, python3-update-manager, firefox, liblouis14 Note that you can use --with-dpkg-repack to include those packges in the clone file. ~/mypackagesæ–‡ä»¶å¤¹ä¸‹åº”è¯¥æœ‰ä¸€ä¸ªåä¸ºapt-clone-state-*.tar.gzå‹ç¼©åŒ…\n1 2 cd ~/mypackages tar -xvf apt-clone-state-ubuntu.tar.gz è§£å‹ä¹‹åæ–‡ä»¶å¤¹ç»“æ„å¤§æ¦‚å¦‚ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 . â”œâ”€â”€ etc â”‚ â””â”€â”€ apt â”‚ â”œâ”€â”€ preferences.d â”‚ â”œâ”€â”€ sources.list â”‚ â”œâ”€â”€ sources.list.d â”‚ â”‚ â”œâ”€â”€ google-chrome.list â”‚ â”‚ â”œâ”€â”€ notepadqq-team-ubuntu-notepadqq-bionic.list â”‚ â”‚ â”œâ”€â”€ numix-ubuntu-ppa-bionic.list â”‚ â”‚ â”œâ”€â”€ sogoupinyin.list â”‚ â”‚ â”œâ”€â”€ vscode.list â”‚ â”‚ â””â”€â”€ webupd8team-ubuntu-atom-bionic.list â”‚ â”œâ”€â”€ trusted.gpg â”‚ â””â”€â”€ trusted.gpg.d â”‚ â”œâ”€â”€ microsoft.gpg â”‚ â”œâ”€â”€ notepadqq-team_ubuntu_notepadqq.gpg â”‚ â”œâ”€â”€ numix_ubuntu_ppa.gpg â”‚ â”œâ”€â”€ sogou-archive-keyring.gpg -\u003e /usr/share/keyrings/sogou-archive-keyring.gpg â”‚ â”œâ”€â”€ ubuntu-keyring-2012-archive.gpg â”‚ â”œâ”€â”€ ubuntu-keyring-2012-cdimage.gpg â”‚ â””â”€â”€ webupd8team_ubuntu_atom.gpg â””â”€â”€ var â””â”€â”€ lib â””â”€â”€ apt-clone â”œâ”€â”€ extended_states â”œâ”€â”€ foreign.pkgs â”œâ”€â”€ installed.pkgs â””â”€â”€ uname 8 directories, 19 files å…¶ä¸­ var/lib/apt-clone/installed.pkgs è®°å½•å·²å®‰è£…çš„åŒ…ï¼Œå¦å¤– apt-clone è¿˜ä¼šå¤‡ä»½è½¯ä»¶æºç­‰å…¶ä»–ä¸€äº›è®¾ç½®ã€‚\næ¢å¤ 1 2 # æŸ¥çœ‹å¤‡ä»½åŒ…ä¿¡æ¯ apt-clone info mypackages/apt-clone-state-ubuntu.tar.gz ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤åœ¨æ–°ç³»ç»Ÿä¸­æ¢å¤å®‰è£…å¤‡ä»½çš„è½¯ä»¶åŒ…\n1 sudo apt-clone restore apt-clone-state-ubuntu.tar.gz å‚è€ƒ Backup Installed Packages And Restore Them On Freshly Installed Ubuntu System ","description":"","tags":["linux"],"title":"å¤‡ä»½ä¸é‡è£… Apt è½¯ä»¶åŒ…","uri":"/blog/posts/backup-apt-packages/"},{"categories":["Tool"],"content":"\nranger is a console file manager with VI key bindings. It provides a minimalistic and nice curses interface with a view on the directory hierarchy. It ships with rifle, a file launcher that is good at automatically finding out which program to use for what file type.\nRangeræ˜¯å…·æœ‰VIé”®ç»‘å®šçš„æ§åˆ¶å°æ–‡ä»¶ç®¡ç†å™¨ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç®€å•è€Œç¾è§‚çš„cursesç•Œé¢ï¼Œå¹¶å…·æœ‰ç›®å½•å±‚æ¬¡ç»“æ„çš„è§†å›¾ã€‚å®ƒå¸¦æœ‰rifleä¸€ä¸ªæ–‡ä»¶å¯åŠ¨å™¨ï¼Œè¯¥æ–‡ä»¶å¯åŠ¨å™¨æ“…é•¿è‡ªåŠ¨æ‰¾å‡ºè¦ç”¨äºå“ªç§æ–‡ä»¶ç±»å‹çš„ç¨‹åºã€‚\næœ¬æ–‡å°†ä»‹ç» ranger çš„ç”¨æ³•ä»¥åŠå¦‚ä½•é…ç½® ranger\nç‰¹æ€§ UTF-8æ”¯æŒï¼ˆå¦‚æœæ‚¨çš„Pythonæ”¯æŒå®ƒï¼‰ å¤šåˆ—æ˜¾ç¤º é¢„è§ˆæ‰€é€‰æ–‡ä»¶/ç›®å½• å¸¸ç”¨æ–‡ä»¶æ“ä½œï¼ˆåˆ›å»º/ æ›´æ”¹æƒé™ /å¤åˆ¶/åˆ é™¤/ ...ï¼‰ ä¸€æ¬¡é‡å‘½åå¤šä¸ªæ–‡ä»¶ ç±»ä¼¼äºVIMçš„æ§åˆ¶å°å’Œçƒ­é”® è‡ªåŠ¨ç¡®å®šæ–‡ä»¶ç±»å‹å¹¶ä½¿ç”¨æ­£ç¡®çš„ç¨‹åºè¿è¡Œå®ƒä»¬ é€€å‡ºrangeråæ›´æ”¹å¤–å£³ç›®å½• æ ‡ç­¾ï¼Œä¹¦ç­¾ï¼Œé¼ æ ‡æ”¯æŒ... ä¾èµ– Python (\u003e=2.6 æˆ– \u003e=3.1) with the curses module and (optionally) wide-unicode support A pager (less by default) å¯é€‰ä¾èµ– ä¸€èˆ¬ç”¨é€”ï¼š\nfile ç”¨äºç¡®å®šæ–‡ä»¶ç±»å‹ chardet ï¼ˆPythonè½¯ä»¶åŒ…ï¼‰ç”¨äºæ”¹è¿›æ–‡æœ¬æ–‡ä»¶çš„ç¼–ç æ£€æµ‹ sudo ä½¿ç”¨â€œä»¥rootç”¨æˆ·è¿è¡Œâ€åŠŸèƒ½ python-bidi ï¼ˆPythonè½¯ä»¶åŒ…ï¼‰ä»¥æ­£ç¡®æ˜¾ç¤ºä»å³åˆ°å·¦çš„æ–‡ä»¶åï¼ˆå¸Œä¼¯æ¥è¯­ï¼Œé˜¿æ‹‰ä¼¯è¯­ï¼‰ å¯¹äºå¢å¼ºçš„æ–‡ä»¶é¢„è§ˆï¼ˆå¸¦æœ‰scope.shï¼‰ï¼š\nimg2txtï¼ˆæ¥è‡ªcaca-utilsï¼‰ç”¨äºASCIIå›¾åƒé¢„è§ˆ w3mimgdisplayï¼Œueberzugï¼Œmpvï¼ŒiTerm2ï¼Œkittyï¼Œterminologyæˆ–urxvtç”¨äºå›¾åƒé¢„è§ˆ convertï¼ˆä»imagemagickï¼‰ä»¥è‡ªåŠ¨æ—‹è½¬å›¾åƒå¹¶è¿›è¡ŒSVGé¢„è§ˆ ffmpegthumbnailer ç”¨äºè§†é¢‘ç¼©ç•¥å›¾ highlightï¼Œbatæˆ–pygmentizeç”¨äºä»£ç çš„è¯­æ³•çªå‡ºæ˜¾ç¤º atoolï¼Œbsdtarï¼Œunrarå’Œ/æˆ–7zé¢„è§ˆæ¡£æ¡ˆ bsdtarï¼Œtarï¼Œunrarï¼Œunzipå’Œ/æˆ–zipinfoï¼ˆå’Œsedï¼‰å¯¹é¢„è§ˆæ¡£æ¡ˆä½œä¸ºå…¶ç¬¬ä¸€å›¾åƒ lynxï¼Œw3mæˆ–elinksé¢„è§ˆhtmlé¡µé¢ pdftotextæˆ–mutoolï¼ˆå’Œfmtï¼‰è¿›è¡Œæ–‡æœ¬pdfé¢„è§ˆï¼Œpdftoppmä»¥å›¾åƒé¢„è§ˆ djvutxtç”¨äºæ–‡æœ¬DjVué¢„è§ˆï¼Œddjvuä»¥å›¾åƒé¢„è§ˆ calibreæˆ–epub-thumbnailerç”¨äºç”µå­ä¹¦çš„å›¾åƒé¢„è§ˆ transmission-show ç”¨äºæŸ¥çœ‹BitTorrentä¿¡æ¯ mediainfoæˆ–exiftoolç”¨äºæŸ¥çœ‹æœ‰å…³åª’ä½“æ–‡ä»¶çš„ä¿¡æ¯ odt2txtä¸ºOpenDocumentæ–‡æœ¬æ–‡ä»¶ï¼ˆodtï¼Œodsï¼Œodpå’Œsxwï¼‰ pythonæˆ–jqJSONæ–‡ä»¶ fontimage ç”¨äºå­—ä½“é¢„è§ˆ openscadå¯¹äº3Dæ¨¡å‹é¢„è§ˆï¼ˆstlï¼Œoffï¼Œdxfï¼Œscadï¼Œcsgï¼‰ å®‰è£… é€šè¿‡ pip å®‰è£… 1 pip install ranger-fm é€šè¿‡åŒ…ç®¡ç†å™¨\n1 2 3 4 5 6 7 8 # macOS brew install ranger # ubuntu apt install ranger # arch pacman -Sy ranger ç”¨æ³• é€‰é¡¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 renger --help Options: --version show program's version number and exit -h, --help show this help message and exit -d, --debug activate debug mode -c, --clean don't touch/require any config files. --logfile=file log file to use, '-' for stderr --cachedir=dir change the cache directory. (/Users/Xiaoy/.cache/ranger) -r dir, --confdir=dir change the configuration directory. (/Users/Xiaoy/.config/ranger) --datadir=dir change the data directory. (/Users/Xiaoy/.local/share/ranger) --copy-config=which copy the default configs to the local config directory. Possible values: all, rc, rifle, commands, commands_full, scope --choosefile=OUTFILE Makes ranger act like a file chooser. When opening a file, it will quit and write the name of the selected file to OUTFILE. --choosefiles=OUTFILE Makes ranger act like a file chooser for multiple files at once. When opening a file, it will quit and write the name of all selected files to OUTFILE. --choosedir=OUTFILE Makes ranger act like a directory chooser. When ranger quits, it will write the name of the last visited directory to OUTFILE --selectfile=filepath Open ranger with supplied file selected. --show-only-dirs Show only directories, no files or links --list-unused-keys List common keys which are not bound to any action. --list-tagged-files=tag List all files which are tagged with the given tag, default: * --profile Print statistics of CPU usage on exit. --cmd=COMMAND Execute COMMAND after the configuration has been read. Use this option multiple times to run multiple é€‰é¡¹ è¯´æ˜ -d, --debug è°ƒè¯•æ¨¡å¼ï¼šå½“å‘ç”Ÿé”™è¯¯æ—¶ï¼ŒRanger ä¼šé€€å‡ºå¹¶æ‰“å°å›æº¯ã€‚ -c, --clean å¹²å‡€æ¨¡å¼ï¼šRanger ä¸ä¼šè¯»å–æˆ–è€…åˆ›é€ ä»»ä½•é…ç½®æ–‡ä»¶ï¼Œä¸ä¼šåœ¨ç³»ç»Ÿå†…ç•™ä¸‹ä»»ä½•ç—•è¿¹ã€‚ -r dir, --confdir=dir å°† Ranger çš„é…ç½®æ–‡ä»¶å¤¹ä» ~/.config/ranger æ”¹ä¸º dirã€‚ --copy-config=file å¤åˆ¶ä¸€ä»½é»˜è®¤çš„é…ç½®æ–‡ä»¶åˆ° Ranger çš„é…ç½®æ–‡ä»¶å¤¹å†…ï¼Œå·²å­˜åœ¨çš„ä¸ä¼šè¢«ç›–å†™ã€‚file åŒ…æ‹¬ allã€commandsã€commands_fullã€rcã€rifle å’Œ scopeã€‚ --choosefile=targetfile å…è®¸ä½ ä½¿ç”¨ Ranger é€‰æ‹©ä¸€ä¸ª targetfile æ–‡ä»¶ï¼Œå½“ä½ ç”¨åœ¨ Ranger ä¸­ç”¨ r å‘½ä»¤æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼ŒRanger ä¼šé€€å‡ºï¼Œå¹¶å°†è¿™ä¸ªæ–‡ä»¶çš„ç»å¯¹è·¯å¾„å†™å…¥ targetfile æ–‡ä»¶ã€‚ --choosefiles=targetfile å¯ä»¥é€‰æ‹©å¤šä¸ªæ–‡ä»¶çš„ç»å¯¹è·¯å¾„å†™å…¥ targetfile æ–‡ä»¶ï¼Œæ¯ä¸€ä¸ªå ä¸€è¡Œï¼ŒæŒ‰å­—æ¯å‡åºæ’åˆ—ã€‚ --choosedir=targetfile å°†é€€å‡º Ranger åçš„æœ€åä¸€ä¸ªè®¿é—®è¿‡çš„æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å†™å…¥ targetfile æ–‡ä»¶ã€‚ --selectfile=targetfile Ranger çš„å…‰æ ‡è·³è½¬åˆ° targetfile æ–‡ä»¶ã€‚ --list-unused-Keys åˆ—å‡ºåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­æœªç»‘å®šä»»ä½•åŠ¨ä½œçš„æŒ‰é”® --list-tagged-files=tag åˆ—å‡ºç”¨ç»™å®š tag æ ‡è®°çš„æ‰€æœ‰æ–‡ä»¶ã€‚æ³¨æ„ï¼šæ ‡ç­¾æ˜¯å•ä¸ªå­—ç¬¦ï¼Œé»˜è®¤æ ‡è®°ä¸º *ã€‚ --profile é€€å‡ºæ—¶æ‰“å° CPU ä½¿ç”¨æƒ…å†µçš„ç»Ÿè®¡ä¿¡æ¯ã€‚ --cmd=command åœ¨é…ç½®æ–‡ä»¶è¯»å–å®Œæˆåæ‰§è¡Œ command å‘½ä»¤ã€‚å¤šæ¬¡ä½¿ç”¨æ­¤é€‰é¡¹è¿è¡Œå¤šä¸ªå‘½ä»¤ã€‚ --version æ‰“å°ç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡º -h, --help æ‰“å°æ­¤é€‰é¡¹åˆ—è¡¨å¹¶é€€å‡º é¢„è§ˆ é»˜è®¤æƒ…å†µä¸‹ï¼Œåªèƒ½é¢„è§ˆæ–‡æœ¬æ–‡ä»¶ï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡è®¾å®šé…ç½® use_preview_script å’Œ preview_files ä¸º true æ¥å¢åŠ å¯ä»¥é¢„è§ˆçš„æ–‡ä»¶ç±»å‹ã€‚é»˜è®¤çš„é¢„è§ˆè„šæœ¬æ˜¯ ~/.config/ranger/scope.shï¼Œå®‰è£…å¦‚ä¸‹å·¥å…·ï¼ˆæ¯ç§ç±»å‹åªéœ€è¦ä¸€ä¸ªï¼‰å°±é¢„è§ˆå¯¹åº”çš„æ–‡ä»¶ç±»å‹ï¼Œscope.sh ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒä»¬ï¼š\nå·¥å…· é¢„è§ˆæ–‡ä»¶ç±»å‹ å®‰è£… lynx****elinks w3m ç½‘é¡µ sudo apt install lynxsudo apt install elinkssudo apt install w3m highlight****pygmentize é«˜äº®ä»£ç  sudo apt install highlightpip install pygmentize img2txt å›¾ç‰‡ sudo apt install caca-utils atoolbsdtarunrar****7z å‹ç¼©åŒ… sudo apt install atoolsudo apt install libarchive-toolssudo apt install unrarsudo apt install p7zip pdftotext****mutool PDF sudo apt install poppler-utils\n\u003cbr /\u003esudo apt install mupdf-tools` mediainfo****exiftool åª’ä½“ sudo apt install mediainfo\nsudo apt install libimage-exiftool-perl ffmpegthumbnailer è§†é¢‘ç¼©ç•¥å›¾ sudo apt install ffmpegthumbnailer fontimage å­—ä½“ sudo apt install fontforge transmission-show ç§å­ sudo apt install transmission-cli ç‹¬ç«‹äº preview scriptï¼Œæœ‰ä¸€ä¸ªé€šè¿‡å°†å›¾åƒç”¨å­—ç¬¦ç”»çš„å½¢å¼ç›´æ¥ç»˜åˆ¶åˆ°ç»ˆç«¯ä¸­çš„é¢„è§ˆåŠŸèƒ½ã€‚è¦å¯ç”¨æ­¤åŠŸèƒ½ï¼Œå°† preview_images é€‰é¡¹è®¾ç½®ä¸º true å¹¶å°† preview_images_method é€‰é¡¹è®¾ç½®ä¸ºä¸€ç§å›¾åƒé¢„è§ˆæ¨¡å¼ï¼ˆéœ€è¦å®‰è£…è¿™äº›å·¥å…·ï¼‰ï¼š\né¢„è§ˆæ¨¡å¼ æ˜¯å¦é€‚ç”¨äº ssh æ³¨æ„ è®¾ç½® preview_images_method ä¸º w3m å¦ ä¸ tmux ä¸å…¼å®¹ï¼ˆå°½ç®¡å®ƒå¯ä»¥å·¥ä½œï¼‰ã€‚ w3m iTerm2 æ˜¯ iTerm2 ç¼–è¯‘æ—¶å¿…é¡»æ·»åŠ  image preview support é€‰é¡¹ã€‚ iterm2 urxvt å¦ urxvt ç¼–è¯‘æ—¶å¿…é¡»æ·»åŠ  pixbuf support é€‰é¡¹ã€‚æ­¤æ¨¡å¼æœ¬è´¨ä¸Šæ˜¯å°†å›¾åƒæš‚æ—¶è®¾ç½®ä¸ºç»ˆç«¯èƒŒæ™¯ï¼Œè¿™æ ·å®ƒå°†ç ´åä»¥å‰è®¾ç½®çš„ä»»ä½•å›¾åƒèƒŒæ™¯ã€‚ urxvt urxvt-full å¦ ä¸ urxvt ç›¸åŒï¼Œä½†ä½¿ç”¨æ•´ä¸ªç»ˆç«¯çª—å£é¢„è§ˆå›¾ç‰‡ã€‚ urxvt-full é€‰æ‹© é€‰æ‹©è¢«å®šä¹‰ä¸º**å¦‚æœæœ‰æ ‡è®°ï¼Œåˆ™æ˜¯æ‰€æœ‰æ ‡è®°çš„æ–‡ä»¶ï¼Œå¦åˆ™æ˜¯å…‰æ ‡å¤„çš„æ–‡ä»¶ã€‚**åœ¨ä½¿ç”¨ :delete å‘½ä»¤æ—¶ä¸€å®šè¦æ³¨æ„è¿™ä¸€ç‚¹ï¼Œå®ƒæŒ‡åˆ é™¤é€‰æ‹©çš„æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹ã€‚ä½ å¯ä»¥é€šè¿‡æŒ‰ SPACEã€v ç­‰æ¥æ ‡è®°æ–‡ä»¶ã€‚é»„è‰²çš„ Mrk ç¬¦å·ä½äºç»ˆç«¯å³ä¸‹è§’ï¼Œè¡¨ç¤ºæ­¤æ–‡ä»¶å¤¹é‡Œæœ‰æ ‡è®°çš„æ–‡ä»¶ã€‚é»„è‰²çš„ Mrk å¹¶ä¸ä¼šå› ä¸ºåˆ‡æ¢ç›®å½•è€Œæ¶ˆå¤±ã€‚\nç¯å¢ƒå˜é‡ Ranger ä¸­æœ‰å¦‚ä¸‹ç¯å¢ƒå˜é‡ï¼š\nç¯å¢ƒå˜é‡ è¯´æ˜ RANGER_LEVEL Ranger å°†æ­¤ç¯å¢ƒå˜é‡è®¾ç½®ä¸º 1ï¼Œå¦‚æœå®ƒå·²ç»å­˜åœ¨ï¼Œåˆ™å°†å…¶é€’å¢ã€‚å¤–éƒ¨ç¨‹åºå¯ä»¥é€šè¿‡æ£€æŸ¥è¿™ä¸ªå˜é‡æ¥ç¡®å®šå®ƒä»¬æ˜¯å¦æ˜¯ç”± Ranger å¯åŠ¨çš„ã€‚ RANGER_LOAD_DEFAULT_RC å¦‚æœå°†è¯¥å˜é‡è®¾ç½®ä¸º falseï¼ŒRanger å°†ä¸ä¼šåŠ è½½é»˜è®¤çš„ rc.confã€‚å¦‚æœå°†æ•´ä¸ª rc.conf å¤åˆ¶åˆ° ~/.config/ranger/ï¼Œåˆ™æ ¹æœ¬ä¸éœ€è¦é»˜è®¤å€¼ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœæ—¶é—´ã€‚ EDITOR è®¾ç½®ç”¨äº E é”®çš„ç¼–è¾‘å™¨ã€‚é»˜è®¤ä¸º nanoã€‚ SHELL è®¾ç½® Ranger åœ¨ :shell å‘½ä»¤å’Œ S é”®ä½¿ç”¨çš„ Shellã€‚é»˜è®¤ä¸º /bin/shã€‚ TERMCMD è®¾ç½® Ranger åœ¨ :terminal å‘½ä»¤å’Œ t è¿è¡Œæ ‡å¿—ä½¿ç”¨çš„ç»ˆç«¯ä»¿çœŸå™¨å‘½ä»¤ã€‚é»˜è®¤ä¸º xtermã€‚ XDG_CONFIG_HOME æŒ‡å®šé…ç½®æ–‡ä»¶çš„ç›®å½•ã€‚é»˜è®¤ä¸º $HOME/.configã€‚ PYTHONOPTIMIZE è¿™ä¸ªå˜é‡å†³å®šäº†pythonçš„ä¼˜åŒ–çº§åˆ«ã€‚ä½¿ç”¨ PYTHONOPTIMIZE=1ï¼ˆåŒ python -Oï¼‰å°†ä½¿ Python æ”¾å¼ƒæ–­è¨€è¯­å¥,ä½ å°†ä¸¢å¤±ä¸€äº›è°ƒè¯•ä¿¡æ¯ã€‚ä½¿ç”¨ PYTHONOPTIMIZE=2ï¼ˆåŒ python -OOï¼‰å°†å¦å¤–ä¸¢å¼ƒä»»ä½•æ–‡æ¡£å­—ç¬¦ä¸²ã€‚ä½¿ç”¨æ­¤é€‰é¡¹å°†ç¦ç”¨ F1 æŒ‰é”®ã€‚ W3MIMGDISPLAY_PATH è®¾ç½®å›¾åƒé¢„è§ˆçš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ã€‚é»˜è®¤è®¾ç½®ä¸º /usr/lib/w3m/w3mimgdisplayã€‚ å¸®åŠ©æ–‡æ¡£ æŒ‰é”® è¯´æ˜ ? æˆ–è€… F1 æŸ¥çœ‹å¸®åŠ© ?m èœå•é¡µ ?k æŸ¥çœ‹å¿«æ·é”® ?c æŸ¥çœ‹å‘½ä»¤ ?s æŸ¥çœ‹è®¾ç½® æ“ä½œ Ranger ä¸­æœ‰æŒ‰é”®å’Œå‘½ä»¤ä¸¤ç§æ“ä½œæ–¹å¼ï¼ŒæŒ‰é”®æ˜¯ç›´æ¥é”®å…¥é”®ç›˜ä¸Šçš„é”®å®ŒæˆæŸä¸ªæ“ä½œï¼Œå‘½ä»¤åˆ™éœ€å‰è¾“å…¥ :ï¼Œç„¶åè¾“å…¥ç›¸åº”çš„å‘½ä»¤ã€‚å¿«æ·é”®åœ¨æ–‡ä»¶ ranger/config/rc.conf ä¸­å®šä¹‰ï¼ŒæŸ¥çœ‹æ­¤æ–‡ä»¶ä»¥è·å–æ‰€æœ‰å¿«æ·é”®çš„åˆ—è¡¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ ranger --copy-config=rc é€‰é¡¹å°†å…¶å¤åˆ¶åˆ°æœ¬åœ°é…ç½®ç›®å½•ä¸­ã€‚\nè®¸å¤šå¿«æ·é”®éƒ½æœ‰ä¸€ä¸ªé¢å¤–çš„æ•°å­—å‚æ•°ã€‚é”®å…¥ 5j å‘ä¸‹ç§»åŠ¨ 5 è¡Œï¼Œ2l ä»¥æ¨¡å¼ 2 æ‰“å¼€æ–‡ä»¶ï¼Œ10 + SPACE è¿ç»­æ ‡è®° 10 ä¸ªæ–‡ä»¶ã€‚\nä¸‹é¢åˆ—å‡ºå¸¸ç”¨æ“ä½œçš„å¿«æ·é”®ï¼Œå…¶ä¸­ ^ ä»£è¡¨ CTRLï¼Œ! ä»£è¡¨ ALTã€‚\nCheatsheet ç§»åŠ¨å…‰æ ‡ æŒ‰é”® è¯´æ˜ h j k l\næ–¹å‘é”® å·¦ï¼ˆå›åˆ°çˆ¶æ–‡ä»¶å¤¹ï¼‰ä¸‹ä¸Šå³ï¼ˆè¿›å…¥å…‰æ ‡æ‰€åœ¨æ–‡ä»¶å¤¹æˆ–æ‰“å¼€å…‰æ ‡å¤„æ–‡ä»¶ï¼‰ ^u æˆ–è€… K ^d æˆ–è€… J å‘ä¸Šç¿»åŠé¡µå‘ä¸‹ç¿»åŠé¡µ ^b æˆ–è€… PAGEUP ^f æˆ–è€… PAGEDOWN å‘ä¸Šç¿»ä¸€é¡µå‘ä¸‹ç¿»ä¸€é¡µ HL åé€€åˆ°ä¸Šä¸€ä¸ªå†å²è®°å½•å‰è¿›åˆ°ä¸‹ä¸€ä¸ªå†å²è®°å½• gg æˆ–è€… HOME G æˆ–è€… END è·³è½¬åˆ°é¡¶ç«¯è·³è½¬åˆ°åº•ç«¯ [] çˆ¶ç›®å½•ä¸Šç§»çˆ¶ç›®å½•ä¸‹ç§» g + å¯¹åº”å­—æ¯ è·³è½¬åˆ°ç›¸åº”çš„ç›®å½•ï¼Œå¦‚ï¼šghï¼šè·³è½¬åˆ° ~ ç›®å½• g?ï¼šè·³è½¬åˆ° /usr/share/doc/ranger ç›®å½• gRï¼šè·³è½¬åˆ° /usr/lib/python2.7/dist-packages/ranger ç›®å½• gdï¼šè·³è½¬åˆ° /dev ç›®å½• geï¼šè·³è½¬åˆ° /etc ç›®å½• gmï¼šè·³è½¬åˆ° /media ç›®å½• gMï¼šè·³è½¬åˆ° /mnt ç›®å½• goï¼šè·³è½¬åˆ° /opt ç›®å½• gsï¼šè·³è½¬åˆ° /srv ç›®å½• guï¼šè·³è½¬åˆ° /usr ç›®å½• gvï¼šè·³è½¬åˆ° /var ç›®å½• gr æˆ–è€… g/ï¼šè·³è½¬åˆ° / ç›®å½• glgL å¦‚æœå½“å‰æ¡ç›®æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ˆæœ‰ -\u003e ç¬¦å·ï¼‰ï¼Œé‚£ä¹ˆè·³è½¬åˆ°å®ƒçš„åŸå§‹ä½ç½®ã€‚ cd åŒ :cd é€‰æ‹©æ¡ç›® Ranger å¯ä»¥æ–¹ä¾¿å¿«é€Ÿåœ°é€‰æ‹©å¤šä¸ªæ¡ç›®ï¼ˆåŒ…æ‹¬æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼‰ã€‚\næŒ‰é”® è¯´æ˜ SPACE é€‰æ‹©/å–æ¶ˆé€‰æ‹©ä¸€ä¸ªæ¡ç›®ï¼Œä¹‹åå…‰æ ‡ä¼šè‡ªåŠ¨è·³åˆ°ä¸‹ä¸€ä¸ªæ¡ç›®ã€‚ä¸ä¼šå› ä¸ºåˆ‡æ¢ç›®å½•è€Œå¤±æ•ˆã€‚ v åé€‰ V å¼€å¯/å…³é—­è§†è§‰æ¨¡å¼ã€‚åœ¨è§†è§‰æ¨¡å¼ä¸‹ï¼Œç§»åŠ¨å…‰æ ‡å³å¯é€‰æ‹©æ¡ç›®ã€‚ä¹Ÿå¯ä»¥æŒ‰ uV æˆ–è€… ESC é€€å‡ºã€‚ uv å–æ¶ˆæ‰€æœ‰é€‰æ‹© å¿«é€Ÿé€‰æ‹©å½“å‰ä½ç½®åˆ°é¡¶ç«¯çš„æ‰€æœ‰æ¡ç›®ï¼šV + gg å¿«é€Ÿé€‰æ‹©å½“å‰ä½ç½®åˆ°åº•ç«¯çš„æ‰€æœ‰æ¡ç›®ï¼šV + G åˆ é™¤æ¡ç›® æŒ‰é”® è¯´æ˜ dD æˆ–è€… F8 åˆ é™¤æ¡ç›®ï¼ˆæ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹ï¼‰ï¼Œæˆ–è€… : + deleteã€‚ DD å°†æ¡ç›®ç§»åŠ¨åˆ°å›æ”¶ç«™é‡Œã€‚ æ–°å»ºæ¡ç›® æŒ‰é”® è¯´æ˜ F7 æ–°å»ºæ–‡ä»¶å¤¹ï¼Œç­‰åŒäº :mkdirâ€‚ã€‚ INSERT æ–°å»ºæ–‡ä»¶ï¼Œç­‰åŒäº :touchâ€‚ã€‚ é‡å‘½å æŒ‰é”® è¯´æ˜ cw é‡å‘½åï¼ˆå«åç¼€åï¼‰ I é‡å‘½åï¼Œå…‰æ ‡åœ¨æœ€å‰ A é‡å‘½åï¼Œå…‰æ ‡åœ¨æœ€åï¼ˆå«åç¼€åï¼‰ a é‡å‘½åï¼Œå…‰æ ‡åœ¨æœ€åï¼ˆä¸å«åç¼€åï¼‰ å¤åˆ¶ æŒ‰é”® è¯´æ˜ yy æˆ–è€… F5 å¤åˆ¶ ya add æ¨¡å¼ï¼Œæ·»åŠ å…‰æ ‡å¤„æ–‡ä»¶åˆ°å¤åˆ¶é˜Ÿåˆ—ä¸­ï¼ˆæ–‡ä»¶å¤¹æ— æ•ˆï¼‰ã€‚ yr remove æ¨¡å¼ï¼Œä»å¤åˆ¶é˜Ÿåˆ—ä¸­ç§»é™¤å…‰æ ‡å¤„æ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹æ— æ•ˆï¼‰ã€‚ yt toggle æ¨¡å¼ï¼Œåˆ‡æ¢å…‰æ ‡å¤„æ–‡ä»¶æ˜¯å¦åœ¨å¤åˆ¶é˜Ÿåˆ—ä¸­ï¼ˆæ–‡ä»¶å¤¹æ— æ•ˆï¼‰ã€‚ yk å°†å…‰æ ‡å¤„æ–‡ä»¶å’Œä¸Šä¸€æ–‡ä»¶æ·»åŠ åˆ°å¤åˆ¶é˜Ÿåˆ—ä¸­ï¼ˆæ–‡ä»¶å¤¹æ— æ•ˆï¼‰ã€‚ yj å°†å…‰æ ‡å¤„æ–‡ä»¶å’Œä¸‹ä¸€æ–‡ä»¶æ·»åŠ åˆ°å¤åˆ¶é˜Ÿåˆ—ä¸­ï¼ˆæ–‡ä»¶å¤¹æ— æ•ˆï¼‰ã€‚ ygg å°†å…‰æ ‡å¤„åˆ°é¡¶ç«¯çš„æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°å¤åˆ¶é˜Ÿåˆ—ä¸­ï¼ˆæ–‡ä»¶å¤¹æ— æ•ˆï¼‰ yG å°†å…‰æ ‡å¤„åˆ°åº•ç«¯çš„æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°å¤åˆ¶é˜Ÿåˆ—ä¸­ï¼ˆæ–‡ä»¶å¤¹æ— æ•ˆï¼‰ å‰ªåˆ‡ æŒ‰é”® è¯´æ˜ dd æˆ–è€… F6 å‰ªåˆ‡ da add æ¨¡å¼ï¼ŒåŒå¤åˆ¶ã€‚ dr remove æ¨¡å¼ï¼ŒåŒå¤åˆ¶ã€‚ dt toggle æ¨¡å¼ï¼ŒåŒå¤åˆ¶ã€‚ dk åŒå¤åˆ¶ dj åŒå¤åˆ¶ dgg åŒå¤åˆ¶ dG åŒå¤åˆ¶ ud æˆ–è€… uy å–æ¶ˆå‰ªåˆ‡ ç²˜è´´ æŒ‰é”® è¯´æ˜ pp ç²˜è´´ï¼Œé»˜è®¤ append æ¨¡å¼ pP append æ¨¡å¼ï¼Œå¦‚æœè¯¥ç›®å½•ä¸­æœ‰åŒåæ¡ç›®ï¼Œåˆ™åœ¨æ¡ç›®åé¢åŠ ä¸Š _ã€_0ã€_1â€¦â€¦ã€‚å¦‚æœæ¡ç›®æ˜¯æ–‡ä»¶ï¼Œåˆ™åœ¨æ–‡ä»¶åç¼€åååŠ å…¥ã€‚ po overwrite æ¨¡å¼ï¼Œå¦‚æœè¯¥ç›®å½•ä¸­æœ‰åŒåæ¡ç›®ï¼Œåˆ™è¦†ç›–åŸæ¥çš„æ¡ç›®ã€‚ pO append æ¨¡å¼ + overwrite æ¨¡å¼ã€‚ pl ç²˜è´´ä¸ºç¬¦å·é“¾æ¥ï¼Œä¸åœ¨çŠ¶æ€æ æ˜¾ç¤ºç›®æ ‡æ¡ç›®çš„ç›¸å¯¹è·¯å¾„ã€‚ pL ç²˜è´´ä¸ºç¬¦å·é“¾æ¥ï¼ˆç›¸å¯¹è·¯å¾„ï¼‰ï¼Œåœ¨çŠ¶æ€æ æ˜¾ç¤ºç›®æ ‡æ¡ç›®çš„ç›¸å¯¹è·¯å¾„ã€‚ phl ç²˜è´´ä¸ºç¡¬é“¾æ¥ pht ç²˜è´´ä¸ºç¡¬é“¾æ¥çš„å­ç›®å½•ï¼ˆhardlinked subtreeï¼‰ æƒé™æ›´æ”¹ æŒ‰é”® è¯´æ˜ + æ˜¾ç¤ºå¢åŠ æƒé™åˆ—è¡¨ - æ˜¾ç¤ºå–æ¶ˆæƒé™åˆ—è¡¨ = è¾“å…¥æ•°å­—èµ‹äºˆæƒé™ u è¡¨ç¤ºè¯¥æ–‡ä»¶çš„æ‹¥æœ‰è€…ï¼ˆUserï¼‰ï¼Œg è¡¨ç¤ºä¸è¯¥æ–‡ä»¶çš„æ‹¥æœ‰è€…å±äºåŒä¸€ä¸ªç¾¤ä½“ï¼ˆGroupï¼‰è€…ï¼Œo è¡¨ç¤ºå…¶ä»–ä»¥å¤–çš„äººï¼ˆOtherï¼‰ï¼Œa è¡¨ç¤ºè¿™ä¸‰è€…çš†æ˜¯ï¼ˆAllï¼‰ã€‚å›¾ç‰‡ä¸­å·¦ä¸‹è§’ä»å·¦åˆ°å³ï¼Œç¬¬ä¸€ä¸ª d ä»£è¡¨æ–‡ä»¶å¤¹ï¼Œå¦åˆ™æ˜¯ -ï¼Œç„¶åä¾æ¬¡æ˜¾ç¤º uã€gã€o çš„ rwx æƒé™ã€‚ + è¡¨ç¤ºå¢åŠ æƒé™ã€- è¡¨ç¤ºå–æ¶ˆæƒé™ã€= è¡¨ç¤ºå”¯ä¸€è®¾å®šæƒé™ã€‚ - è¡¨ç¤ºä¸å…·å¤‡ä»»ä½•æƒé™ï¼Œr è¡¨ç¤ºå¯è¯»å–ï¼ˆæ–‡ä»¶å¤¹å†…å¯æ·»åŠ å’Œåˆ é™¤æ–‡ä»¶ï¼‰ï¼Œw è¡¨ç¤ºå¯å†™å…¥ï¼Œx è¡¨ç¤ºå¯æ‰§è¡Œï¼ŒX è¡¨ç¤ºåªæœ‰å½“è¯¥æ–‡ä»¶æ˜¯ä¸ªå­ç›®å½•æˆ–è€…è¯¥æ–‡ä»¶å·²ç»è¢«è®¾å®šè¿‡ä¸ºå¯æ‰§è¡Œï¼Œs è¡¨ç¤ºèµ‹äºˆç¨‹åº sudo æƒé™ï¼Œt è¡¨ç¤ºè¯¥æ–‡ä»¶å¤¹ä¸­èƒ½å¤Ÿæ·»åŠ æ–‡ä»¶ä½†åŒæ—¶ä¸èƒ½åˆ é™¤æ–‡ä»¶ã€‚ chmod ugo fileï¼Œå…¶ä¸­ r=4ï¼Œw=2ï¼Œx=1ï¼Œåˆ™ è‹¥è¦ rwx å±æ€§åˆ™ 4+2+1=7ï¼› è‹¥è¦ rw- å±æ€§åˆ™ 4+2=6ï¼› è‹¥è¦ r-x å±æ€§åˆ™ 4+1=5ã€‚ æ ‡è®° æ ‡è®°æ˜¯æ˜¾ç¤ºåœ¨æ–‡ä»¶åå·¦ä¾§çš„å•ä¸ªå­—ç¬¦ã€‚ä½ å¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨æ ‡è®°ã€‚æŒ‰ t å¯åˆ‡æ¢æ ‡ç­¾ï¼ŒæŒ‰ ut å¯åˆ é™¤æ‰€é€‰å†…å®¹çš„æ‰€æœ‰æ ‡è®°ã€‚é»˜è®¤æ ‡è®°æ˜¯æ˜Ÿå·ï¼ˆ*ï¼‰ï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡é”®å…¥ \" + Tag æ¥ä½¿ç”¨ä»»ä½•æ ‡è®°ã€‚\næŒ‰é”® è¯´æ˜ t æ ‡è®°/å–æ¶ˆæ ‡è®°æ¡ç›®ï¼Œæ ‡è®°åå…‰æ ‡ä¸‹ç§»ï¼Œé»˜è®¤ *ã€‚æ–‡ä»¶ä¸æ–‡ä»¶å¤¹çš„æ ‡è®°é¢œè‰²ä¸åŒï¼Œä¸åŒæ–‡ä»¶ä¹Ÿä¸åŒã€‚ ut å–æ¶ˆæ ‡è®° \" + Tag ç”¨ Tag æ ‡è®°æ¡ç›®ï¼ŒTag ä¸ºä»»æ„å­—ç¬¦ï¼Œå¦‚ @ã€‚å¦‚æœä¸€ä¸ªæ¡ç›®çš„æ ‡è®°ä¸º @ï¼Œé‚£ä¹ˆé”®å…¥ \"@ åˆ™å–æ¶ˆæ ‡è®°ï¼Œé”®å…¥ t æˆ–è€… \"# åˆ™åˆ‡æ¢æ ‡è®°ã€‚ æœç´¢ æŒ‰é”® è¯´æ˜ / æ‰“å¼€æœç´¢æ¡†ï¼Œè¾“å…¥è¦æœç´¢çš„å­—ç¬¦ä¸²ï¼Œå›è½¦åå¼€å§‹æœç´¢ã€‚ f æŸ¥æ‰¾ï¼Œç­‰åŒäºè¿è¡Œæ»¡è¶³æ¡ä»¶çš„æ–‡ä»¶æˆ–è€…æ‰“å¼€æ»¡è¶³æ¡ä»¶çš„æ–‡ä»¶å¤¹ã€‚ zf ä¸å‘½ä»¤è¡Œ filter ä½œç”¨ä¸€æ ·ï¼Œåªæ˜¾ç¤ºç¬¦åˆæ¡ä»¶çš„æ¡ç›®ï¼ŒåŒºåˆ†å¤§å°å†™ã€‚ nN æŸ¥æ‰¾ä¸‹ä¸€ä¸ªæœç´¢ç»“æœæŸ¥æ‰¾ä¸Šä¸€ä¸ªæœç´¢ç»“æœ c + å¯¹åº”å­—æ¯ é€šè¿‡å¯¹åº”å±æ€§ä¾æ¬¡éå†ï¼Œå¦‚ï¼šcaï¼šé€šè¿‡ atimeå±æ€§ä¾æ¬¡éå† ccï¼šé€šè¿‡ ctime å±æ€§ä¾æ¬¡éå† ciï¼šé€šè¿‡ mimetype å±æ€§ä¾æ¬¡éå† cmï¼šé€šè¿‡ mtime å±æ€§ä¾æ¬¡éå† csï¼šé€šè¿‡ size å±æ€§ä¾æ¬¡éå† ctï¼šé€šè¿‡ tag å±æ€§ä¾æ¬¡éå† atime è¡¨ç¤ºï¼šè®¿é—®æ—¶é—´ï¼ˆaccess timeï¼‰ ctime è¡¨ç¤ºï¼šçŠ¶æ€ä¿®æ”¹æ—¶é—´ï¼ˆchange timeï¼‰ mimetype è¡¨ç¤ºï¼šMIME ç±»å‹ï¼ˆåŒ…æ‹¬æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ä»¥åŠå…¶ä»–åº”ç”¨ç¨‹åºä¸“ç”¨çš„æ•°æ®ï¼‰ mtime è¡¨ç¤ºï¼šå†…å®¹ä¿®æ”¹æ—¶é—´ï¼ˆmodify timeï¼‰ size è¡¨ç¤ºï¼šæ–‡ä»¶å¤§å° tag è¡¨ç¤ºï¼šæ ‡ç­¾ zf åˆ é€‰å®Œæ¡ç›®åï¼Œå¯ä»¥æŒ‰ ^r æ˜¾ç¤ºæ‰€æœ‰æ¡ç›®ã€‚ æ˜¾ç¤ºæ¨¡å¼ é¼ æ ‡æ“ä½œ Ranger æ”¯æŒé¼ æ ‡æ“ä½œï¼ŒåŒ…æ‹¬å·¦é”®ã€å³é”®å’Œæ»šè½®ã€‚å¦‚æœé¼ æ ‡ä¸èƒ½å·¥ä½œï¼Œåœ¨ Ranger çš„æµè§ˆå™¨ç•Œé¢é”®å…¥ zm å¼€å¯é¼ æ ‡åŠŸèƒ½ã€‚\nå·¦é”® ç‚¹å‡»ä¸»æ çš„æ¡ç›®ï¼Œåˆ™å…‰æ ‡è·³è½¬åˆ°æ¡ç›®ä¸Šï¼› ç‚¹å‡»å·¦æ çš„çˆ¶ç›®å½•ä¸Šçš„æ¡ç›®ï¼Œåˆ™ä¸»æ è·³è½¬åˆ°çˆ¶ç›®å½•ï¼Œå¹¶ä¸”å…‰æ ‡è·³è½¬åˆ°åˆšæ‰ç‚¹å‡»çš„æ¡ç›®ä¸Šï¼› ç‚¹å‡»å³æ çš„å­ç›®å½•ä¸Šçš„æ¡ç›®ï¼Œåˆ™ä¸»æ è·³è½¬åˆ°å­ç›®å½•ï¼Œå¹¶ä¸”å…‰æ ‡è·³è½¬åˆ°åˆšæ‰ç‚¹å‡»çš„æ¡ç›®ä¸Šï¼› ç‚¹å‡»å³æ çš„é¢„è§ˆçª—å£ï¼Œåˆ™ç”¨ç³»ç»Ÿé»˜è®¤çš„ç¨‹åºæ‰“å¼€è¯¥æ–‡ä»¶ï¼› ç‚¹å‡»æ ‡ç­¾é¡µï¼Œåˆ™è·³è½¬åˆ°ç›¸åº”çš„æ ‡ç­¾é¡µï¼› ç‚¹å‡»å·¦ä¸Šè§’çš„ç”¨æˆ·åï¼Œåˆ™è·³è½¬åˆ° / ç›®å½•ã€‚ å³é”® ç‚¹å‡»ä¸»æ æ–‡ä»¶å¤¹ï¼Œè¿›å…¥æ–‡ä»¶å¤¹ï¼ˆå·¦æ å’Œå³æ æ— æ•ˆï¼‰ï¼› ç‚¹å‡»æ–‡ä»¶ï¼Œç”¨é»˜è®¤ç¨‹åºè¿è¡Œæ–‡ä»¶ï¼› ç‚¹å‡»å³æ çš„é¢„è§ˆçª—å£ï¼Œåˆ™ç”¨ç³»ç»Ÿé»˜è®¤çš„ç¨‹åºæ‰“å¼€è¯¥æ–‡ä»¶ã€‚ æ»šè½® åœ¨ä¸»æ ä¸­ï¼Œå…‰æ ‡ä¸Šä¸‹ç§»åŠ¨ï¼› åœ¨å·¦æ ä¸­ï¼Œåˆ‡æ¢æ–‡ä»¶å¤¹ï¼ŒåŒ [ å’Œ ]ï¼› å³æ æ— æ•ˆã€‚ é…ç½® é¦–å…ˆå¤åˆ¶é…ç½®æ–‡ä»¶åˆ°ä¸»ç›®å½•\n1 2 3 4 5 6 7 8 9 10 11 12 $ ranger --copy-config=all creating: /Users/Xiaoy/.config/ranger/rifle.conf creating: /Users/Xiaoy/.config/ranger/commands.py creating: /Users/Xiaoy/.config/ranger/commands_full.py creating: /Users/Xiaoy/.config/ranger/rc.conf creating: /Users/Xiaoy/.config/ranger/scope.sh \u003e Please note that configuration files may change as ranger evolves. It's completely up to you to keep them up to date. \u003e To stop ranger from loading both the default and your custom rc.conf, please set the environment variable RANGER_LOAD_DEFAULT_RC to FALSE. å…¶ä¸­æ¯ä¸ªæ–‡ä»¶ä»£è¡¨ï¼š\næ–‡ä»¶å å†…å®¹ bookmarks ä¹¦ç­¾åˆ—è¡¨ï¼Œå¯ä»¥åœ¨æ­¤æ–‡ä»¶é‡Œç›´æ¥æ‰¹é‡æ·»åŠ ä¹¦ç­¾ã€‚ commands.py ç”¨æˆ·è‡ªå®šä¹‰æ§åˆ¶å°å‘½ä»¤ï¼Œç”¨ Python ç¼–å†™ã€‚ commands_full.py Ranger é»˜è®¤çš„æ§åˆ¶å°å‘½ä»¤ã€‚ history æ§åˆ¶å°å‘½ä»¤çš„å†å²è®°å½•ï¼Œé»˜è®¤ 50 æ¡ï¼Œæœ€åé¢çš„å‘½ä»¤æœ€æ–°ï¼Œéœ€è¦é‡å¯ Ranger æ‰èƒ½æ›´æ–°æ–‡ä»¶ã€‚ rc.conf ä¸»è¦çš„é…ç½®æ–‡ä»¶ rifle.conf é…ç½®é¢„è§ˆåŠŸèƒ½ scope.sh é¢„è§ˆè„šæœ¬ï¼Œé”®å…¥zv å¯åŠ¨/å…³é—­ã€‚ tagged æ ‡è®°æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ è¿˜æœ‰ä¸¤ä¸ªæœªæ˜¾ç¤ºçš„æ–‡ä»¶å¤¹ï¼š\næ–‡ä»¶å¤¹å å†…å®¹ colorschemes/ é¢œè‰²ä¸»é¢˜æ–‡ä»¶ plugins/ æ’ä»¶æ–‡ä»¶å¤¹ æ‰€æœ‰çš„è®¾ç½®éƒ½åœ¨ ~/.config/ranger/rc.conf ä¸­è¿›è¡Œï¼Œæˆ–è€…ç”¨æŒ‰é”® z + ç›¸åº”å­—æ¯ åˆ‡æ¢é…ç½®ã€‚\nå¤–è§‚ è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ column_ratios 1,3,4(default)1,1,1,15,3,1ç­‰ç­‰ è®¾ç½®æµè§ˆå™¨ç•Œé¢æœ‰å¤šå°‘æ ï¼Œæ¯”å¦‚ 1,1,1 è¡¨ç¤ºä¸€å…±ä¸‰æ ï¼Œå¹¶ä¸”ç­‰å®½ï¼Œè€Œ 1,2 è¡¨ç¤ºä¸€å…±ä¸¤æ ï¼Œå³æ å®½åº¦æ˜¯å·¦æ çš„ä¸¤å€ã€‚ colorscheme defaultjunglesnow é€‰æ‹©é¢œè‰²ä¸»é¢˜ï¼Œsnow æ˜¯å•è‰²ä¸»é¢˜ï¼Œjungle å°†æ–‡ä»¶å¤¹çš„é¢œè‰²ä»è“è‰²æ›¿æ¢ä¸ºç»¿è‰²ï¼Œä»¥ä¾¿åœ¨æŸäº›ç»ˆç«¯ä¸Šæ›´å¥½åœ°æ˜¾ç¤ºã€‚ update_title truefalse(default) æ˜¯å¦è®¾ç½®çª—å£æ ‡é¢˜ã€‚ shorten_title n (n âˆˆ Z+)0 å¦‚æœçª—å£å˜å¤§ï¼Œæ˜¯å¦ä¿®å‰ªå…¶æ ‡é¢˜ã€‚æ•°å­—è¡¨ç¤ºä¸€æ¬¡æ˜¾ç¤ºå¤šå°‘æ–‡ä»¶å¤¹ï¼Œé»˜è®¤ 3ï¼Œå€¼ä¸º 0 è¡¨ç¤ºå…³é—­æ­¤åŠŸèƒ½ã€‚ tilde_in_titlebar truefalse(default) æ˜¯å¦ç”¨ ~ ä»£æ›¿åœ¨ Ranger çš„æ ‡é¢˜æ ä¸Šçš„ $HOMEã€‚ unicode_ellipsis truefalse(default) æ˜¯å¦ç”¨ ... ä»£æ›¿ ~ è¡¨ç¤ºå› ä¸ºçª—å£è¿‡å°è€Œæ˜¾ç¤ºä¸å…¨çš„æ–‡ä»¶åã€‚ update_tmux_title truefalse(default) æ˜¯å¦åœ¨ Tmux ç¨‹åºä¸­å°†æ ‡é¢˜è®¾ç½®ä¸º Rangerã€‚ dirname_in_tabs truefalse(default) æ˜¯å¦åœ¨æ ‡ç­¾é¡µæ˜¾ç¤ºæ–‡ä»¶å¤¹åã€‚ automatically_count_files true(default)false æ˜¯å¦åœ¨æ–‡ä»¶å¤¹å³è¾¹å’ŒçŠ¶æ€æ ä¸Šæ˜¾ç¤ºä¸‹ä¸€çº§çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ€»æ•°ã€‚ æ ç›® è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ draw_borders truefalse(default) æ˜¯å¦ä¸ºæ¯ä¸ªæ ç»˜åˆ¶è¾¹æ¡†ã€‚ line_numbers true(default)false æ˜¯å¦åœ¨ä¸»æ ä¸Šæ˜¾ç¤ºè¡Œå·ã€‚ display_size_in_main_column true(default)false åœ¨ä¸»æ ä¸Šæ˜¾ç¤ºæ–‡ä»¶å¤§å°ã€‚ display_tags_in_all_columns true(default)false åœ¨æ‰€æœ‰æ ä¸­æ˜¾ç¤ºæ ‡è®°ã€‚ çŠ¶æ€æ  è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ status_bar_on_top truefalse(default) è®¾ç½®çŠ¶æ€æ æ˜¯å¦åœ¨é¡¶ç«¯ã€‚ autoupdate_cumulative_size truefalse(default) åœ¨çŠ¶æ€æ å³ä¸‹è§’å®æ—¶æ˜¾ç¤ºç›®å½•çš„ç´¯è®¡å¤§å°ã€‚é”®å…¥ dc åŒæ•ˆã€‚ display_size_in_status_bar true(default)false åœ¨çŠ¶æ€æ æ˜¾ç¤ºæ–‡ä»¶å¤§å°ã€‚ draw_progress_bar_in_status_bar true(default)false åœ¨çŠ¶æ€æ ä¸­ç»˜åˆ¶è¿›åº¦æ¡ï¼Œè¯¥è¿›åº¦æ¡æ˜¾ç¤ºæ”¯æŒè¿›åº¦æ¡çš„æ‰€æœ‰å½“å‰è¿è¡Œä»»åŠ¡çš„å¹³å‡çŠ¶æ€ã€‚ æ’åº è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ sort atimebasenamectimeextensionmtimenatural(default)typesizerandom æŒ‰ä»€ä¹ˆåŸåˆ™æ’åºï¼ŒåŒ z + ç›¸å…³å­—æ¯ sort_directories_first true(default)false æ’åºæ—¶æ–‡ä»¶å¤¹æ˜¯å¦åœ¨æ–‡ä»¶å‰é¢ã€‚é”®å…¥ zd åŒæ•ˆã€‚ sort_case_insensitive true(default)false æ’åˆ—æ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ a åœ¨ B å‰é¢ï¼Œå³ä½¿ a çš„ ASCII å€¼æ›´å¤§ã€‚é”®å…¥ zc åŒæ•ˆã€‚ sort_unicode truefalse(default) å½“æ ¹æ®æŸä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ’åºæ—¶ï¼Œæ˜¯å¦åº”è¯¥æ¯”è¾ƒ Unicode å­—ç¬¦ï¼Œè€Œä¸æ˜¯æŸ¥çœ‹åŸå§‹å­—ç¬¦å€¼ä»¥èŠ‚çœæ—¶é—´ã€‚ sort_reverse truefalse(default) åå‘æ’åºï¼Œä¸ or åŒæ•ˆã€‚ é¢„è§ˆ è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ preview_files true(default)false æ˜¯å¦å¼€å¯é¢„è§ˆæ–‡ä»¶åŠŸèƒ½ã€‚é”®å…¥ zp åŒæ•ˆã€‚ preview_directories true(default)false æ˜¯å¦å¼€å¯é¢„è§ˆæ–‡ä»¶å¤¹åŠŸèƒ½ã€‚é”®å…¥ zP åŒæ•ˆã€‚ use_preview_script true(default)false æ˜¯å¦é‡‡ç”¨é¢„è§ˆè„šæœ¬é¢„è§ˆæ–‡ä»¶ã€‚é”®å…¥ zv åŒæ•ˆã€‚ preview_script é¢„è§ˆè„šæœ¬è·¯å¾„none è®¾ç½®é¢„è§ˆè„šæœ¬ï¼Œé»˜è®¤ scope.shã€‚å¦‚æœè®¾ç½®çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–è€…è®¾ç½® noneï¼ŒRanger å°†åªæ‰“å°å†…å®¹æ¥å¤„ç†é¢„è§ˆã€‚ preview_images truefalse(default) æ˜¯å¦å¼€å¯é¢„è§ˆå›¾ç‰‡åŠŸèƒ½ã€‚é”®å…¥ zi åŒæ•ˆã€‚ preview_images_method w3m(default)iterm2urxvturxvt-full è®¾ç½®é»˜è®¤çš„å›¾ç‰‡é¢„è§ˆç¨‹åºã€‚ collapse_preview true(default)false å½“æ–‡ä»¶é¢„è§ˆä¸å¯è§æ—¶ï¼Œæ˜¯å¦åº”è¯¥æŠ˜å å³æ ï¼Œä½¿ä¸»æ æ‰©å¤§ã€‚é”®å…¥ zc åŒæ•ˆã€‚ padding_right true(default)false å½“ collapse_preview å¤„äºå¼€å¯çŠ¶æ€ä¸”æ— é¢„è§ˆç»“æœæ—¶ï¼Œæ˜¯å¦ä¿ç•™å³æ ã€‚å¦‚æœæ˜¯ï¼Œåˆ™ä½ å¯ä»¥å•å‡»å³æ æ¥è¿è¡Œæ–‡ä»¶ã€‚ preview_max_size n (n âˆˆ Z+)0 è®¾ç½®é¢„è§ˆæ–‡ä»¶å¤§å°çš„æœ€å¤§å€¼ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œä½¿ç”¨å€¼ 0 ç¦ç”¨æ­¤åŠŸèƒ½ï¼Œé»˜è®¤ç¦æ­¢ã€‚ ç‰ˆæœ¬æ§åˆ¶ è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ vcs_aware truefalse(default) æ˜¯å¦æ”¶é›†å’Œæ˜¾ç¤ºæœ‰å…³ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„æ•°æ®ã€‚ vcs_backend_git disabledlocalenabled(default) è®¾ç½®ç‰ˆæœ¬æ§åˆ¶çš„çŠ¶æ€ï¼Œdisabled è¡¨ç¤ºä¸æ˜¾ç¤ºä¿¡æ¯ï¼Œlocal è¡¨ç¤ºåªæ˜¾ç¤ºæœ¬åœ°çŠ¶æ€ï¼Œenabled è¡¨ç¤ºæ˜¾ç¤ºæœ¬åœ°å’Œè¿œç¨‹çš„çŠ¶æ€ï¼ŒHg å’Œ Bzr æ¯”è¾ƒæ…¢ã€‚ vcs_backend_hg disabled(default)localenabled åŒ vcs_backend_git vcs_backend_bzr disabled(default)localenabled åŒ vcs_backend_git å†å²è®°å½• è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ save_console_history true(default)false è®¾ç½®é€€å‡º Ranger æ—¶æ˜¯å¦ä¿å­˜æ§åˆ¶å°å†å²è®°å½•ã€‚å¦‚æœç¦ç”¨ï¼Œé‡æ–°å¯åŠ¨ Ranger æ—¶å°†é‡ç½®æ§åˆ¶å°å†å²è®°å½•ã€‚ max_console_history_size n (n âˆˆ Z+)none æ§åˆ¶å°å†å²çš„æ•°ç›®æœ€å¤§å€¼ï¼Œé»˜è®¤ 50 æ¡ï¼Œnone è¡¨ç¤ºç¦æ­¢è®°å½•ã€‚ max_history_size n (n âˆˆ Z+)none ç›®å½•æ›´æ”¹å†å²çš„æ•°ç›®æœ€å¤§å€¼ï¼Œé»˜è®¤ 20 æ¡ï¼Œnone è¡¨ç¤ºç¦æ­¢è®°å½•ã€‚ éšè—æ–‡ä»¶ è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ show_hidden truefalse(default) æ˜¯å¦æ˜¾ç¤ºéšè—æ–‡ä»¶ã€‚é”®å…¥ zh æˆ–è€… ^h åŒæ•ˆã€‚ hidden_filter æ­£åˆ™è¡¨è¾¾å¼ ç”¨æ­£åˆ™è¡¨è¾¾å¼é€‰æ‹©å“ªäº›æ–‡ä»¶éœ€è¦è¢«éšè—ï¼Œå¦‚ `set hidden_filter ^. ä¹¦ç­¾ è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ autosave_bookmarks true(default)false ç«‹å³ä¿å­˜ä¹¦ç­¾ï¼Œè¿™æœ‰åŠ©äºåœ¨å¤šä¸ª Ranger å®ä¾‹ä¹‹é—´åŒæ­¥ä¹¦ç­¾ï¼Œä½†ä¼šå¯¼è‡´è½»å¾®çš„æ€§èƒ½æŸå¤±ã€‚å¦‚æœä¸º falseï¼Œåˆ™åœ¨é€€å‡º Ranger æ—¶ä¿å­˜ä¹¦ç­¾ã€‚ cd_bookmarks true(default)false è®¾ç½®è¾“å…¥æ§åˆ¶å°å‘½ä»¤ cd æ—¶æ˜¯å¦å¯ä»¥è‡ªåŠ¨è¡¥å…¨ä¹¦ç­¾çš„åœ°å€ã€‚ show_hidden_bookmarks true(default)false åœ¨ä¹¦ç­¾é¢„è§ˆçª—å£ä¸­æ˜¾ç¤º ` æ–‡ä»¶ã€‚ é¼ æ ‡ è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ mouse_enabled true(default)false æ˜¯å¦å¼€å¯é¼ æ ‡åŠŸèƒ½ã€‚é”®å…¥ zm åŒæ•ˆã€‚ show_cursor true(default)false æ˜¯å¦åœ¨ç»ˆç«¯æ˜¾ç¤ºé¼ æ ‡ç®­å¤´ã€‚ æ‚é¡¹ è®¾ç½®é¡¹ æœ‰æ•ˆå€¼ è¯´æ˜ confirm_on_delete alwaysnevermultiple(default) è¿è¡Œ :delete å‘½ä»¤æ—¶æ˜¯å¦è¦ç¡®è®¤ï¼Œç”¨ multipleï¼ŒRanger åªä¼šåœ¨ä½ åŒæ—¶åˆ é™¤å¤šä¸ªæ–‡ä»¶æ—¶è¯¢é—®ä½ ã€‚ scroll_offset n (n âˆˆ Z+) æ»šåŠ¨æ—¶,å…‰æ ‡ä¸ä¸‹è¾¹ç•Œä¿æŒå¤šå°‘ä¸ªç©ºæ ¼çš„è·ç¦»ï¼Œé»˜è®¤å€¼ä¸º 8ã€‚ xterm_alt_key truefalse(default) å¦‚æœå¸¦ ALT é”®çš„ç»„åˆé”®å¯¹ä¸èµ·ä½œç”¨ï¼Œåˆ™å¯ç”¨æ­¤é€‰é¡¹ã€‚ï¼ˆå°¤å…¶æ˜¯åœ¨ Xterm ä¸Šï¼‰ clear_filters_on_dir_change truefalse(default) å¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™åœ¨ç¦»å¼€ç›®å½•æ—¶å°†æ¸…é™¤ç­›é€‰ç»“æœã€‚ flushinput true(true)false æ¯æ¬¡æŒ‰é”®åæ˜¯å¦åˆ·æ–°è¾“å…¥ï¼Œä¸€ä¸ªä¼˜ç‚¹æ˜¯å½“ç”¨ j å‘ä¸‹æ»šåŠ¨ï¼Œå¦‚æœä½ æ¾å¼€ jï¼Œä¼šç«‹å³åœæ­¢æ»šåŠ¨ã€‚ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼Œå½“ä½ ç›²ç›®åœ°è¾“å…¥å‘½ä»¤æ—¶ï¼Œä¸€äº›é”®å¯èƒ½ä¼šä¸¢å¤±ã€‚é”®å…¥ zI åŒæ•ˆã€‚ idle_delay 100n (n âˆˆ Z+) Ranger ç­‰å¾…ç”¨æˆ·è¾“å…¥çš„å»¶è¿Ÿï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œä¸º 100 çš„æ•´æ•°å€ã€‚è¾ƒä½çš„å»¶è¿Ÿå‡å°‘äº†ç›®å½•æ›´æ–°ä¹‹é—´çš„å»¶è¿Ÿï¼Œä½†å¢åŠ äº† CPU è´Ÿè½½ï¼Œé»˜è®¤å€¼ä¸º 2000ã€‚ metadata_deep_search truefalse(false) å½“å…ƒæ•°æ®ç®¡ç†å™¨æ¨¡å—æŸ¥æ‰¾å…ƒæ•°æ®æ—¶ï¼Œå®ƒåº”è¯¥åªåœ¨å½“å‰ç›®å½•ä¸­æŸ¥æ‰¾ .metadata.json æ–‡ä»¶ï¼Œè¿˜æ˜¯åº”è¯¥æ·±å…¥æœç´¢å¹¶æ£€æŸ¥å½“å‰ç›®å½•ä¹‹ä¸Šçš„æ‰€æœ‰ç›®å½•ã€‚ å¢å¼º Ranger çš„åŠŸèƒ½ æ’ä»¶ Ranger çš„æ’ä»¶ç³»ç»Ÿç”± Python æ–‡ä»¶ç»„æˆï¼Œè¿™äº›æ–‡ä»¶ä½äº ~/.config/ranger/plugins/ ä¸­ï¼Œåœ¨å¯åŠ¨ Ranger æ—¶æŒ‰å­—æ¯é¡ºåºå¯¼å…¥ã€‚æ’ä»¶é€šè¿‡è¦†ç›–æˆ–æ‰©å±• Ranger ä½¿ç”¨çš„å‡½æ•°æ¥æ›´æ”¹ Ranger çš„è¡Œä¸ºã€‚è¿™å…è®¸æ‚¨æ›´æ”¹ Ranger çš„å‡ ä¹æ‰€æœ‰éƒ¨åˆ†ï¼Œä½†ä¸èƒ½ä¿è¯éšç€æºä»£ç çš„å‘å±•ï¼Œå°†æ¥çš„ç‰ˆæœ¬ä¸­è¿˜ä¼šç»§ç»­å·¥ä½œã€‚\né™¤éæ‚¨çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œå¦åˆ™ä¸åº”è¯¥ç®€å•åœ°è¦†ç›–ä¸€ä¸ªå‡½æ•°ã€‚ç›¸åï¼Œä¿å­˜ç°æœ‰å‡½æ•°å¹¶ä»æ–°å‡½æ•°è°ƒç”¨å®ƒã€‚è¿™æ ·ï¼Œå¤šä¸ªæ’ä»¶å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªé’©å­ã€‚åœ¨ /usr/share/doc/ranger/examples/ ç›®å½•ä¸­æœ‰å‡ ä¸ªç¤ºä¾‹æ’ä»¶ã€‚\nå¤åˆ¶ä¸‹é¢çš„ä»£ç ï¼ŒPython æ–‡ä»¶åæ ¼å¼ä¸º plugin_ + æ’ä»¶åå­— + .pyï¼Œç„¶åå°†æ–‡ä»¶å¤åˆ¶åˆ° ~/.config/ranger/plugins/ ä¸­ï¼Œæœ€åé‡å¯ Ranger å³å¯ç”Ÿæ•ˆã€‚\nçŠ¶æ€æ æ˜¾ç¤ºæ¬¢è¿è¯­ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 # plugin_welcome.py # # Compatible with ranger 1.6.0 through 1.7.* # # This is a sample plugin that displays \"Hello World\" in ranger's console after # it started. # We are going to extend the hook \"ranger.api.hook_ready\", so first we need # to import ranger.api: import ranger.api # Save the previously existing hook, because maybe another module already # extended that hook and we don't want to lose it: old_hook_ready = ranger.api.hook_ready # Create a replacement for the hook that... def hook_ready(fm): # ...does the desired action... fm.notify(\"Welcome to Ranger! Huang Pan\") # ...and calls the saved hook. If you don't care about the return value, # simply return the return value of the previous hook to be safe. return old_hook_ready(fm) Finally, \"monkey patch\" the existing hook_ready function with our replacement: ranger.api.hook_ready=hook_ready ç»™æ¡ç›®æ·»åŠ ç±»å‹ç¬¦å· æŒ‚è½½å’Œå¸è½½å¿«æ·é”®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 # plugin_pmount.py # # Tested with ranger 1.7.2 # # This plugin creates a bunch of keybindings used to mount and unmount # the devices using pmount(1). # # alt+m \u003cletter\u003e \u003cdigit\u003e: mount /dev/sd\u003cletter\u003e\u003cdigit\u003e # alt+m \u003cuppercase letter\u003e : mount /dev/sd\u003cletter\u003e # alt+shift+m \u003cletter\u003e \u003cdigit\u003e: unmount /dev/sd\u003cletter\u003e\u003cdigit\u003e # alt+shift+m \u003cuppercase letter\u003e : unmount /dev/sd\u003cletter\u003e # alt+shift+n : list the devices import ranger.api MOUNT_KEY = '\u003calt\u003em' UMOUNT_KEY = '\u003calt\u003eM' LIST_MOUNTS_KEY = '\u003calt\u003eN' old_hook_init = ranger.api.hook_init def hook_init(fm): try: fm.execute_console(\"map {key} shell -p lsblk\".format(key=LIST_MOUNTS_KEY)) for disk in \"abcdefgh\": fm.execute_console(\"map {key}{0} chain shell pmount sd{1}; cd /media/sd{1}\".format(disk.upper(), disk, key=MOUNT_KEY)) fm.execute_console(\"map {key}{0} chain cd; chain shell pumount sd{1}\".format(disk.upper(), disk, key=UMOUNT_KEY)) for part in \"123456789\": fm.execute_console(\"map {key}{0}{1} chain shell pmount sd{0}{1}; cd /media/sd{0}{1}\".format(disk, part, key=MOUNT_KEY)) fm.execute_console(\"map {key}{0}{1} chain cd; shell pumount sd{0}{1}\".format(disk, part, key=UMOUNT_KEY)) finally: return old_hook_init(fm) ranger.api.hook_init = hook_init å‚è€ƒ ranger ä»“åº“ ranger å®˜æ–¹æ–‡æ¡£ ","description":"","tags":["tools","command-line-tool"],"title":"ranger ä½¿ç”¨æŒ‡å—","uri":"/blog/posts/Tool/ranger-use-guide/"},{"categories":["Tool"],"content":"\næœ¬æ–‡æ¥æºè‡ª rsync ç”¨æ³•æ•™ç¨‹ ä½œè€… é˜®ä¸€å³°\nrsync æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ Linux åº”ç”¨ç¨‹åºï¼Œç”¨äºæ–‡ä»¶åŒæ­¥ã€‚\nå®ƒå¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºä¸è¿œç¨‹è®¡ç®—æœºä¹‹é—´ï¼Œæˆ–è€…ä¸¤ä¸ªæœ¬åœ°ç›®å½•ä¹‹é—´åŒæ­¥æ–‡ä»¶ï¼ˆä½†ä¸æ”¯æŒä¸¤å°è¿œç¨‹è®¡ç®—æœºä¹‹é—´çš„åŒæ­¥ï¼‰ã€‚å®ƒä¹Ÿå¯ä»¥å½“ä½œæ–‡ä»¶å¤åˆ¶å·¥å…·ï¼Œæ›¿ä»£cpå’Œmvå‘½ä»¤ã€‚\nå®ƒåç§°é‡Œé¢çš„ræŒ‡çš„æ˜¯ remoteï¼Œrsync å…¶å®å°±æ˜¯\"è¿œç¨‹åŒæ­¥\"ï¼ˆremote syncï¼‰çš„æ„æ€ã€‚ä¸å…¶ä»–æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼ˆå¦‚ FTP æˆ– scpï¼‰ä¸åŒï¼Œrsync çš„æœ€å¤§ç‰¹ç‚¹æ˜¯ä¼šæ£€æŸ¥å‘é€æ–¹å’Œæ¥æ”¶æ–¹å·²æœ‰çš„æ–‡ä»¶ï¼Œä»…ä¼ è¾“æœ‰å˜åŠ¨çš„éƒ¨åˆ†ï¼ˆé»˜è®¤è§„åˆ™æ˜¯æ–‡ä»¶å¤§å°æˆ–ä¿®æ”¹æ—¶é—´æœ‰å˜åŠ¨ï¼‰ã€‚\nå®‰è£… å¦‚æœæœ¬æœºæˆ–è€…è¿œç¨‹è®¡ç®—æœºæ²¡æœ‰å®‰è£… rsyncï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤å®‰è£…ã€‚\n1 2 3 4 5 6 7 8 # Debian $ sudo apt-get install rsync # Red Hat $ sudo yum install rsync # Arch Linux $ sudo pacman -S rsync æ³¨æ„ï¼Œä¼ è¾“çš„åŒæ–¹éƒ½å¿…é¡»å®‰è£… rsyncã€‚\nåŸºæœ¬ç”¨æ³• -r å‚æ•° æœ¬æœºä½¿ç”¨ rsync å‘½ä»¤æ—¶ï¼Œå¯ä»¥ä½œä¸ºcpå’Œmvå‘½ä»¤çš„æ›¿ä»£æ–¹æ³•ï¼Œå°†æºç›®å½•åŒæ­¥åˆ°ç›®æ ‡ç›®å½•ã€‚\n1 $ rsync -r source destination ä¸Šé¢å‘½ä»¤ä¸­ï¼Œ-rè¡¨ç¤ºé€’å½’ï¼Œå³åŒ…å«å­ç›®å½•ã€‚æ³¨æ„ï¼Œ-ræ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ rsync è¿è¡Œä¸ä¼šæˆåŠŸã€‚sourceç›®å½•è¡¨ç¤ºæºç›®å½•ï¼Œdestinationè¡¨ç¤ºç›®æ ‡ç›®å½•ã€‚\nå¦‚æœæœ‰å¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•éœ€è¦åŒæ­¥ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚\n1 $ rsync -r source1 source2 destination ä¸Šé¢å‘½ä»¤ä¸­ï¼Œsource1ã€source2éƒ½ä¼šè¢«åŒæ­¥åˆ°destinationç›®å½•ã€‚\n-a å‚æ•° -aå‚æ•°å¯ä»¥æ›¿ä»£-rï¼Œé™¤äº†å¯ä»¥é€’å½’åŒæ­¥ä»¥å¤–ï¼Œè¿˜å¯ä»¥åŒæ­¥å…ƒä¿¡æ¯ï¼ˆæ¯”å¦‚ä¿®æ”¹æ—¶é—´ã€æƒé™ç­‰ï¼‰ã€‚ç”±äº rsync é»˜è®¤ä½¿ç”¨æ–‡ä»¶å¤§å°å’Œä¿®æ”¹æ—¶é—´å†³å®šæ–‡ä»¶æ˜¯å¦éœ€è¦æ›´æ–°ï¼Œæ‰€ä»¥-aæ¯”-ræ›´æœ‰ç”¨ã€‚ä¸‹é¢çš„ç”¨æ³•æ‰æ˜¯å¸¸è§çš„å†™æ³•ã€‚\n$ rsync -a source destination\nç›®æ ‡ç›®å½•destinationå¦‚æœä¸å­˜åœ¨ï¼Œrsync ä¼šè‡ªåŠ¨åˆ›å»ºã€‚æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤åï¼Œæºç›®å½•sourceè¢«å®Œæ•´åœ°å¤åˆ¶åˆ°äº†ç›®æ ‡ç›®å½•destinationä¸‹é¢ï¼Œå³å½¢æˆäº†destination/sourceçš„ç›®å½•ç»“æ„ã€‚\nå¦‚æœåªæƒ³åŒæ­¥æºç›®å½•sourceé‡Œé¢çš„å†…å®¹åˆ°ç›®æ ‡ç›®å½•destinationï¼Œåˆ™éœ€è¦åœ¨æºç›®å½•åé¢åŠ ä¸Šæ–œæ ã€‚\n$ rsync -a source/ destination\nä¸Šé¢å‘½ä»¤æ‰§è¡Œåï¼Œsourceç›®å½•é‡Œé¢çš„å†…å®¹ï¼Œå°±éƒ½è¢«å¤åˆ¶åˆ°äº†destinationç›®å½•é‡Œé¢ï¼Œå¹¶ä¸ä¼šåœ¨destinationä¸‹é¢åˆ›å»ºä¸€ä¸ªsourceå­ç›®å½•ã€‚\n-n å‚æ•° å¦‚æœä¸ç¡®å®š rsync æ‰§è¡Œåä¼šäº§ç”Ÿä»€ä¹ˆç»“æœï¼Œå¯ä»¥å…ˆç”¨-næˆ–--dry-runå‚æ•°æ¨¡æ‹Ÿæ‰§è¡Œçš„ç»“æœã€‚\n$ rsync -anv source/ destination\nä¸Šé¢å‘½ä»¤ä¸­ï¼Œ-nå‚æ•°æ¨¡æ‹Ÿå‘½ä»¤æ‰§è¡Œçš„ç»“æœï¼Œå¹¶ä¸çœŸçš„æ‰§è¡Œå‘½ä»¤ã€‚-vå‚æ•°åˆ™æ˜¯å°†ç»“æœè¾“å‡ºåˆ°ç»ˆç«¯ï¼Œè¿™æ ·å°±å¯ä»¥çœ‹åˆ°å“ªäº›å†…å®¹ä¼šè¢«åŒæ­¥ã€‚\n--delete å‚æ•° é»˜è®¤æƒ…å†µä¸‹ï¼Œrsync åªç¡®ä¿æºç›®å½•çš„æ‰€æœ‰å†…å®¹ï¼ˆæ˜ç¡®æ’é™¤çš„æ–‡ä»¶é™¤å¤–ï¼‰éƒ½å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚å®ƒä¸ä¼šä½¿ä¸¤ä¸ªç›®å½•ä¿æŒç›¸åŒï¼Œå¹¶ä¸”ä¸ä¼šåˆ é™¤æ–‡ä»¶ã€‚å¦‚æœè¦ä½¿å¾—ç›®æ ‡ç›®å½•æˆä¸ºæºç›®å½•çš„é•œåƒå‰¯æœ¬ï¼Œåˆ™å¿…é¡»ä½¿ç”¨--deleteå‚æ•°ï¼Œè¿™å°†åˆ é™¤åªå­˜åœ¨äºç›®æ ‡ç›®å½•ã€ä¸å­˜åœ¨äºæºç›®å½•çš„æ–‡ä»¶ã€‚\n1 $ rsync -av --delete source/ destination ä¸Šé¢å‘½ä»¤ä¸­ï¼Œ--deleteå‚æ•°ä¼šä½¿å¾—destinationæˆä¸ºsourceçš„ä¸€ä¸ªé•œåƒã€‚\næ’é™¤æ–‡ä»¶ --exclude å‚æ•° æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åŒæ­¥æ—¶æ’é™¤æŸäº›æ–‡ä»¶æˆ–ç›®å½•ï¼Œè¿™æ—¶å¯ä»¥ç”¨--excludeå‚æ•°æŒ‡å®šæ’é™¤æ¨¡å¼ã€‚\n1 2 3 $ rsync -av --exclude='*.txt' source/ destination # æˆ–è€… $ rsync -av --exclude '*.txt' source/ destination ä¸Šé¢å‘½ä»¤æ’é™¤äº†æ‰€æœ‰ TXT æ–‡ä»¶ã€‚\næ³¨æ„ï¼Œrsync ä¼šåŒæ­¥ä»¥\"ç‚¹\"å¼€å¤´çš„éšè—æ–‡ä»¶ï¼Œå¦‚æœè¦æ’é™¤éšè—æ–‡ä»¶ï¼Œå¯ä»¥è¿™æ ·å†™--exclude=\".*\"ã€‚\nå¦‚æœè¦æ’é™¤æŸä¸ªç›®å½•é‡Œé¢çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä½†ä¸å¸Œæœ›æ’é™¤ç›®å½•æœ¬èº«ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚\n1 $ rsync -av --exclude 'dir1/*' source/ destination å¤šä¸ªæ’é™¤æ¨¡å¼ï¼Œå¯ä»¥ç”¨å¤šä¸ª--excludeå‚æ•°ã€‚\n1 $ rsync -av --exclude 'file1.txt' --exclude 'dir1/*' source/ destination å¤šä¸ªæ’é™¤æ¨¡å¼ä¹Ÿå¯ä»¥åˆ©ç”¨ Bash çš„å¤§æ‰©å·çš„æ‰©å±•åŠŸèƒ½ï¼Œåªç”¨ä¸€ä¸ª--excludeå‚æ•°ã€‚\n1 $ rsync -av --exclude={'file1.txt','dir1/*'} source/ destination å¦‚æœæ’é™¤æ¨¡å¼å¾ˆå¤šï¼Œå¯ä»¥å°†å®ƒä»¬å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ¨¡å¼ä¸€è¡Œï¼Œç„¶åç”¨--exclude-fromå‚æ•°æŒ‡å®šè¿™ä¸ªæ–‡ä»¶ã€‚\n1 $ rsync -av --exclude-from='exclude-file.txt' source/ destination --include å‚æ•° --includeå‚æ•°ç”¨æ¥æŒ‡å®šå¿…é¡»åŒæ­¥çš„æ–‡ä»¶æ¨¡å¼ï¼Œå¾€å¾€ä¸--excludeç»“åˆä½¿ç”¨ã€‚\n1 $ rsync -av --include=\"*.txt\" --exclude='*' source/ destination ä¸Šé¢å‘½ä»¤æŒ‡å®šåŒæ­¥æ—¶ï¼Œæ’é™¤æ‰€æœ‰æ–‡ä»¶ï¼Œä½†æ˜¯ä¼šåŒ…æ‹¬ TXT æ–‡ä»¶ã€‚\nè¿œç¨‹åŒæ­¥ SSH åè®® rsync é™¤äº†æ”¯æŒæœ¬åœ°ä¸¤ä¸ªç›®å½•ä¹‹é—´çš„åŒæ­¥ï¼Œä¹Ÿæ”¯æŒè¿œç¨‹åŒæ­¥ã€‚å®ƒå¯ä»¥å°†æœ¬åœ°å†…å®¹ï¼ŒåŒæ­¥åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚\n1 $ rsync -av source/ username@remote_host:destination ä¹Ÿå¯ä»¥å°†è¿œç¨‹å†…å®¹åŒæ­¥åˆ°æœ¬åœ°ã€‚\n1 $ rsync -av username@remote_host:source/ destination rsync é»˜è®¤ä½¿ç”¨ SSH è¿›è¡Œè¿œç¨‹ç™»å½•å’Œæ•°æ®ä¼ è¾“ã€‚\nç”±äºæ—©æœŸ rsync ä¸ä½¿ç”¨ SSH åè®®ï¼Œéœ€è¦ç”¨-eå‚æ•°æŒ‡å®šåè®®ï¼Œåæ¥æ‰æ”¹çš„ã€‚æ‰€ä»¥ï¼Œä¸‹é¢-e sshå¯ä»¥çœç•¥ã€‚\n1 $ rsync -av -e ssh source/ user@remote_host:/destination ä½†æ˜¯ï¼Œå¦‚æœ ssh å‘½ä»¤æœ‰é™„åŠ çš„å‚æ•°ï¼Œåˆ™å¿…é¡»ä½¿ç”¨-eå‚æ•°æŒ‡å®šæ‰€è¦æ‰§è¡Œçš„ SSH å‘½ä»¤ã€‚\n1 $ rsync -av -e 'ssh -p 2234' source/ user@remote_host:/destination ä¸Šé¢å‘½ä»¤ä¸­ï¼Œ-eå‚æ•°æŒ‡å®š SSH ä½¿ç”¨2234ç«¯å£ã€‚\nrsync åè®® é™¤äº†ä½¿ç”¨ SSHï¼Œå¦‚æœå¦ä¸€å°æœåŠ¡å™¨å®‰è£…å¹¶è¿è¡Œäº† rsync å®ˆæŠ¤ç¨‹åºï¼Œåˆ™ä¹Ÿå¯ä»¥ç”¨rsync://åè®®ï¼ˆé»˜è®¤ç«¯å£873ï¼‰è¿›è¡Œä¼ è¾“ã€‚å…·ä½“å†™æ³•æ˜¯æœåŠ¡å™¨ä¸ç›®æ ‡ç›®å½•ä¹‹é—´ä½¿ç”¨åŒå†’å·åˆ†éš”::ã€‚\n1 $ rsync -av source/ 192.168.122.32::module/destination æ³¨æ„ï¼Œä¸Šé¢åœ°å€ä¸­çš„moduleå¹¶ä¸æ˜¯å®é™…è·¯å¾„åï¼Œè€Œæ˜¯ rsync å®ˆæŠ¤ç¨‹åºæŒ‡å®šçš„ä¸€ä¸ªèµ„æºåï¼Œç”±ç®¡ç†å‘˜åˆ†é…ã€‚\nå¦‚æœæƒ³çŸ¥é“ rsync å®ˆæŠ¤ç¨‹åºåˆ†é…çš„æ‰€æœ‰ module åˆ—è¡¨ï¼Œå¯ä»¥æ‰§è¡Œä¸‹é¢å‘½ä»¤ã€‚\n1 $ rsync rsync://192.168.122.32 rsync åè®®é™¤äº†ä½¿ç”¨åŒå†’å·ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨rsync://åè®®æŒ‡å®šåœ°å€ã€‚\n1 $ rsync -av source/ rsync://192.168.122.32/module/destination å¢é‡å¤‡ä»½ rsync çš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯å®ƒå¯ä»¥å®Œæˆå¢é‡å¤‡ä»½ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤åªå¤åˆ¶æœ‰å˜åŠ¨çš„æ–‡ä»¶ã€‚\né™¤äº†æºç›®å½•ä¸ç›®æ ‡ç›®å½•ç›´æ¥æ¯”è¾ƒï¼Œrsync è¿˜æ”¯æŒä½¿ç”¨åŸºå‡†ç›®å½•ï¼Œå³å°†æºç›®å½•ä¸åŸºå‡†ç›®å½•ä¹‹é—´å˜åŠ¨çš„éƒ¨åˆ†ï¼ŒåŒæ­¥åˆ°ç›®æ ‡ç›®å½•ã€‚\nå…·ä½“åšæ³•æ˜¯ï¼Œç¬¬ä¸€æ¬¡åŒæ­¥æ˜¯å…¨é‡å¤‡ä»½ï¼Œæ‰€æœ‰æ–‡ä»¶åœ¨åŸºå‡†ç›®å½•é‡Œé¢åŒæ­¥ä¸€ä»½ã€‚ä»¥åæ¯ä¸€æ¬¡åŒæ­¥éƒ½æ˜¯å¢é‡å¤‡ä»½ï¼ŒåªåŒæ­¥æºç›®å½•ä¸åŸºå‡†ç›®å½•ä¹‹é—´æœ‰å˜åŠ¨çš„éƒ¨åˆ†ï¼Œå°†è¿™éƒ¨åˆ†ä¿å­˜åœ¨ä¸€ä¸ªæ–°çš„ç›®æ ‡ç›®å½•ã€‚è¿™ä¸ªæ–°çš„ç›®æ ‡ç›®å½•ä¹‹ä¸­ï¼Œä¹Ÿæ˜¯åŒ…å«æ‰€æœ‰æ–‡ä»¶ï¼Œä½†å®é™…ä¸Šï¼Œåªæœ‰é‚£äº›å˜åŠ¨è¿‡çš„æ–‡ä»¶æ˜¯å­˜åœ¨äºè¯¥ç›®å½•ï¼Œå…¶ä»–æ²¡æœ‰å˜åŠ¨çš„æ–‡ä»¶éƒ½æ˜¯æŒ‡å‘åŸºå‡†ç›®å½•æ–‡ä»¶çš„ç¡¬é“¾æ¥ã€‚\n--link-destå‚æ•°ç”¨æ¥æŒ‡å®šåŒæ­¥æ—¶çš„åŸºå‡†ç›®å½•ã€‚\n1 $ rsync -a --delete --link-dest /compare/path /source/path /target/path ä¸Šé¢å‘½ä»¤ä¸­ï¼Œ--link-destå‚æ•°æŒ‡å®šåŸºå‡†ç›®å½•/compare/pathï¼Œç„¶åæºç›®å½•/source/pathè·ŸåŸºå‡†ç›®å½•è¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾å‡ºå˜åŠ¨çš„æ–‡ä»¶ï¼Œå°†å®ƒä»¬æ‹·è´åˆ°ç›®æ ‡ç›®å½•/target/pathã€‚é‚£äº›æ²¡å˜åŠ¨çš„æ–‡ä»¶åˆ™ä¼šç”Ÿæˆç¡¬é“¾æ¥ã€‚è¿™ä¸ªå‘½ä»¤çš„ç¬¬ä¸€æ¬¡å¤‡ä»½æ—¶æ˜¯å…¨é‡å¤‡ä»½ï¼Œåé¢å°±éƒ½æ˜¯å¢é‡å¤‡ä»½äº†ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªè„šæœ¬ç¤ºä¾‹ï¼Œå¤‡ä»½ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 #!/bin/bash # A script to perform incremental backups using rsync set -o errexit set -o nounset set -o pipefail readonly SOURCE_DIR=\"${HOME}\" readonly BACKUP_DIR=\"/mnt/data/backups\" readonly DATETIME=\"$(date '+%Y-%m-%d_%H:%M:%S')\" readonly BACKUP_PATH=\"${BACKUP_DIR}/${DATETIME}\" readonly LATEST_LINK=\"${BACKUP_DIR}/latest\" mkdir -p \"${BACKUP_DIR}\" rsync -av --delete \\ \"${SOURCE_DIR}/\" \\ --link-dest \"${LATEST_LINK}\" \\ --exclude=\".cache\" \\ \"${BACKUP_PATH}\" rm -rf \"${LATEST_LINK}\" ln -s \"${BACKUP_PATH}\" \"${LATEST_LINK}\" ä¸Šé¢è„šæœ¬ä¸­ï¼Œæ¯ä¸€æ¬¡åŒæ­¥éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°ç›®å½•${BACKUP_DIR}/${DATETIME}ï¼Œå¹¶å°†è½¯é“¾æ¥${BACKUP_DIR}/latestæŒ‡å‘è¿™ä¸ªç›®å½•ã€‚ä¸‹ä¸€æ¬¡å¤‡ä»½æ—¶ï¼Œå°±å°†${BACKUP_DIR}/latestä½œä¸ºåŸºå‡†ç›®å½•ï¼Œç”Ÿæˆæ–°çš„å¤‡ä»½ç›®å½•ã€‚æœ€åï¼Œå†å°†è½¯é“¾æ¥${BACKUP_DIR}/latestæŒ‡å‘æ–°çš„å¤‡ä»½ç›®å½•ã€‚\nä¸ƒã€é…ç½®é¡¹ -aã€--archiveå‚æ•°è¡¨ç¤ºå­˜æ¡£æ¨¡å¼ï¼Œä¿å­˜æ‰€æœ‰çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚ä¿®æ”¹æ—¶é—´ï¼ˆmodification timeï¼‰ã€æƒé™ã€æ‰€æœ‰è€…ç­‰ï¼Œå¹¶ä¸”è½¯é“¾æ¥ä¹Ÿä¼šåŒæ­¥è¿‡å»ã€‚\n--appendå‚æ•°æŒ‡å®šæ–‡ä»¶æ¥ç€ä¸Šæ¬¡ä¸­æ–­çš„åœ°æ–¹ï¼Œç»§ç»­ä¼ è¾“ã€‚\n--append-verifyå‚æ•°è·Ÿ--appendå‚æ•°ç±»ä¼¼ï¼Œä½†ä¼šå¯¹ä¼ è¾“å®Œæˆåçš„æ–‡ä»¶è¿›è¡Œä¸€æ¬¡æ ¡éªŒã€‚å¦‚æœæ ¡éªŒå¤±è´¥ï¼Œå°†é‡æ–°å‘é€æ•´ä¸ªæ–‡ä»¶ã€‚\n-bã€--backupå‚æ•°æŒ‡å®šåœ¨åˆ é™¤æˆ–æ›´æ–°ç›®æ ‡ç›®å½•å·²ç»å­˜åœ¨çš„æ–‡ä»¶æ—¶ï¼Œå°†è¯¥æ–‡ä»¶æ›´ååè¿›è¡Œå¤‡ä»½ï¼Œé»˜è®¤è¡Œä¸ºæ˜¯åˆ é™¤ã€‚æ›´åè§„åˆ™æ˜¯æ·»åŠ ç”±--suffixå‚æ•°æŒ‡å®šçš„æ–‡ä»¶åç¼€åï¼Œé»˜è®¤æ˜¯~ã€‚\n--backup-dirå‚æ•°æŒ‡å®šæ–‡ä»¶å¤‡ä»½æ—¶å­˜æ”¾çš„ç›®å½•ï¼Œæ¯”å¦‚--backup-dir=/path/to/backupsã€‚\n--bwlimitå‚æ•°æŒ‡å®šå¸¦å®½é™åˆ¶ï¼Œé»˜è®¤å•ä½æ˜¯ KB/sï¼Œæ¯”å¦‚--bwlimit=100ã€‚\n-cã€--checksumå‚æ•°æ”¹å˜rsyncçš„æ ¡éªŒæ–¹å¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œrsync åªæ£€æŸ¥æ–‡ä»¶çš„å¤§å°å’Œæœ€åä¿®æ”¹æ—¥æœŸæ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœå‘ç”Ÿå˜åŒ–ï¼Œå°±é‡æ–°ä¼ è¾“ï¼›ä½¿ç”¨è¿™ä¸ªå‚æ•°ä»¥åï¼Œåˆ™é€šè¿‡åˆ¤æ–­æ–‡ä»¶å†…å®¹çš„æ ¡éªŒå’Œï¼Œå†³å®šæ˜¯å¦é‡æ–°ä¼ è¾“ã€‚\n--deleteå‚æ•°åˆ é™¤åªå­˜åœ¨äºç›®æ ‡ç›®å½•ã€ä¸å­˜åœ¨äºæºç›®æ ‡çš„æ–‡ä»¶ï¼Œå³ä¿è¯ç›®æ ‡ç›®å½•æ˜¯æºç›®æ ‡çš„é•œåƒã€‚\n-eå‚æ•°æŒ‡å®šä½¿ç”¨ SSH åè®®ä¼ è¾“æ•°æ®ã€‚\n--excludeå‚æ•°æŒ‡å®šæ’é™¤ä¸è¿›è¡ŒåŒæ­¥çš„æ–‡ä»¶ï¼Œæ¯”å¦‚--exclude=\"*.iso\"ã€‚\n--exclude-fromå‚æ•°æŒ‡å®šä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ï¼Œé‡Œé¢æ˜¯éœ€è¦æ’é™¤çš„æ–‡ä»¶æ¨¡å¼ï¼Œæ¯ä¸ªæ¨¡å¼ä¸€è¡Œã€‚\n--existingã€--ignore-non-existingå‚æ•°è¡¨ç¤ºä¸åŒæ­¥ç›®æ ‡ç›®å½•ä¸­ä¸å­˜åœ¨çš„æ–‡ä»¶å’Œç›®å½•ã€‚\n-hå‚æ•°è¡¨ç¤ºä»¥äººç±»å¯è¯»çš„æ ¼å¼è¾“å‡ºã€‚\n-hã€--helpå‚æ•°è¿”å›å¸®åŠ©ä¿¡æ¯ã€‚\n-iå‚æ•°è¡¨ç¤ºè¾“å‡ºæºç›®å½•ä¸ç›®æ ‡ç›®å½•ä¹‹é—´æ–‡ä»¶å·®å¼‚çš„è¯¦ç»†æƒ…å†µã€‚\n--ignore-existingå‚æ•°è¡¨ç¤ºåªè¦è¯¥æ–‡ä»¶åœ¨ç›®æ ‡ç›®å½•ä¸­å·²ç»å­˜åœ¨ï¼Œå°±è·³è¿‡å»ï¼Œä¸å†åŒæ­¥è¿™äº›æ–‡ä»¶ã€‚\n--includeå‚æ•°æŒ‡å®šåŒæ­¥æ—¶è¦åŒ…æ‹¬çš„æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸--excludeç»“åˆä½¿ç”¨ã€‚\n--link-destå‚æ•°æŒ‡å®šå¢é‡å¤‡ä»½çš„åŸºå‡†ç›®å½•ã€‚\n-må‚æ•°æŒ‡å®šä¸åŒæ­¥ç©ºç›®å½•ã€‚\n--max-sizeå‚æ•°è®¾ç½®ä¼ è¾“çš„æœ€å¤§æ–‡ä»¶çš„å¤§å°é™åˆ¶ï¼Œæ¯”å¦‚ä¸è¶…è¿‡200KBï¼ˆ--max-size='200k'ï¼‰ã€‚\n--min-sizeå‚æ•°è®¾ç½®ä¼ è¾“çš„æœ€å°æ–‡ä»¶çš„å¤§å°é™åˆ¶ï¼Œæ¯”å¦‚ä¸å°äº10KBï¼ˆ--min-size=10kï¼‰ã€‚\n-nå‚æ•°æˆ–--dry-runå‚æ•°æ¨¡æ‹Ÿå°†è¦æ‰§è¡Œçš„æ“ä½œï¼Œè€Œå¹¶ä¸çœŸçš„æ‰§è¡Œã€‚é…åˆ-vå‚æ•°ä½¿ç”¨ï¼Œå¯ä»¥çœ‹åˆ°å“ªäº›å†…å®¹ä¼šè¢«åŒæ­¥è¿‡å»ã€‚\n-På‚æ•°æ˜¯--progresså’Œ--partialè¿™ä¸¤ä¸ªå‚æ•°çš„ç»“åˆã€‚\n--partialå‚æ•°å…è®¸æ¢å¤ä¸­æ–­çš„ä¼ è¾“ã€‚ä¸ä½¿ç”¨è¯¥å‚æ•°æ—¶ï¼Œrsyncä¼šåˆ é™¤ä¼ è¾“åˆ°ä¸€åŠè¢«æ‰“æ–­çš„æ–‡ä»¶ï¼›ä½¿ç”¨è¯¥å‚æ•°åï¼Œä¼ è¾“åˆ°ä¸€åŠçš„æ–‡ä»¶ä¹Ÿä¼šåŒæ­¥åˆ°ç›®æ ‡ç›®å½•ï¼Œä¸‹æ¬¡åŒæ­¥æ—¶å†æ¢å¤ä¸­æ–­çš„ä¼ è¾“ã€‚ä¸€èˆ¬éœ€è¦ä¸--appendæˆ–--append-verifyé…åˆä½¿ç”¨ã€‚\n--partial-dirå‚æ•°æŒ‡å®šå°†ä¼ è¾“åˆ°ä¸€åŠçš„æ–‡ä»¶ä¿å­˜åˆ°ä¸€ä¸ªä¸´æ—¶ç›®å½•ï¼Œæ¯”å¦‚--partial-dir=.rsync-partialã€‚ä¸€èˆ¬éœ€è¦ä¸--appendæˆ–--append-verifyé…åˆä½¿ç”¨ã€‚\n--progresså‚æ•°è¡¨ç¤ºæ˜¾ç¤ºè¿›å±•ã€‚\n-rå‚æ•°è¡¨ç¤ºé€’å½’ï¼Œå³åŒ…å«å­ç›®å½•ã€‚\n--remove-source-fileså‚æ•°è¡¨ç¤ºä¼ è¾“æˆåŠŸåï¼Œåˆ é™¤å‘é€æ–¹çš„æ–‡ä»¶ã€‚\n--size-onlyå‚æ•°è¡¨ç¤ºåªåŒæ­¥å¤§å°æœ‰å˜åŒ–çš„æ–‡ä»¶ï¼Œä¸è€ƒè™‘æ–‡ä»¶ä¿®æ”¹æ—¶é—´çš„å·®å¼‚ã€‚\n--suffixå‚æ•°æŒ‡å®šæ–‡ä»¶åå¤‡ä»½æ—¶ï¼Œå¯¹æ–‡ä»¶åæ·»åŠ çš„åç¼€ï¼Œé»˜è®¤æ˜¯~ã€‚\n-uã€--updateå‚æ•°è¡¨ç¤ºåŒæ­¥æ—¶è·³è¿‡ç›®æ ‡ç›®å½•ä¸­ä¿®æ”¹æ—¶é—´æ›´æ–°çš„æ–‡ä»¶ï¼Œå³ä¸åŒæ­¥è¿™äº›æœ‰æ›´æ–°çš„æ—¶é—´æˆ³çš„æ–‡ä»¶ã€‚\n-vå‚æ•°è¡¨ç¤ºè¾“å‡ºç»†èŠ‚ã€‚-vvè¡¨ç¤ºè¾“å‡ºæ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œ-vvvè¡¨ç¤ºè¾“å‡ºæœ€è¯¦ç»†çš„ä¿¡æ¯ã€‚\n--versionå‚æ•°è¿”å› rsync çš„ç‰ˆæœ¬ã€‚\n-zå‚æ•°æŒ‡å®šåŒæ­¥æ—¶å‹ç¼©æ•°æ®ã€‚\nå‚è€ƒé“¾æ¥ How To Use Rsync to Sync Local and Remote Directories on a VPS, Justin Ellingwood Mirror Your Web Site With rsync, Falko Timme Examples on how to use Rsync, Egidio Docile How to create incremental backups using rsync on Linux, Egidio Docile ","description":"","tags":["linux","tools","command-line-tool"],"title":"rysncä½¿ç”¨æŒ‡å—","uri":"/blog/posts/Tool/rsync-use-guide/"},{"categories":["Python"],"content":"\nç¿»è¯‘ï¼šA deep dive into the official Docker image for Python\nDockerçš„å®˜æ–¹Pythoné•œåƒéå¸¸æµè¡Œï¼Œå®é™…ä¸Šï¼Œæˆ‘å»ºè®®å°†å…¶å˜ä½“ä¹‹ä¸€ä½œä¸ºåŸºç¡€é•œåƒã€‚ä½†æ˜¯è®¸å¤šäººä¸å¤ªäº†è§£å®ƒçš„ä½œç”¨ï¼Œè¿™å¯èƒ½å¯¼è‡´æ··ä¹±å’Œç ´è£‚ã€‚\nå› æ­¤ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ä»‹ç»å®ƒçš„æ„é€ æ–¹å¼ï¼Œä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Œå¦‚ä½•æ­£ç¡®ä½¿ç”¨å®ƒä»¥åŠå®ƒçš„å±€é™æ€§ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘å°†é€šè¯»æˆªè‡³2020å¹´8æœˆ19æ—¥çš„python:3.8-slim-busterå˜ä½“ï¼Œå¹¶åœ¨è¿›è¡Œè¿‡ç¨‹ä¸­å¯¹å…¶è¿›è¡Œè§£é‡Šã€‚\né˜…è¯» Dockerfile åŸºç¡€é•œåƒ æˆ‘ä»¬ä»åŸºç¡€é•œåƒå¼€å§‹ï¼š\n1 FROM debian:buster-slim ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸºç¡€é•œåƒæ˜¯Debian GNU / Linux 10ï¼Œè¿™æ˜¯Debianå‘è¡Œç‰ˆçš„å½“å‰ç¨³å®šå‘è¡Œç‰ˆï¼Œä¹Ÿç§°ä¸ºBusterã€‚\nDebian çš„æ‰€æœ‰å‘è¡Œç‰ˆå‡ä»¥ Toy Story ä¸­çš„è§’è‰²å‘½åã€‚å¦‚æœæ‚¨æƒ³çŸ¥é“ï¼ŒBusteræ˜¯Andyçš„çˆ±çŠ¬ã€‚\nå› æ­¤ï¼Œé¦–å…ˆï¼Œè¿™æ˜¯ä¸€ä¸ªLinuxå‘è¡Œç‰ˆï¼Œå¯ç¡®ä¿é•¿æœŸç¨³å®šï¼ŒåŒæ—¶æä¾›é”™è¯¯ä¿®å¤ã€‚è¯¥slimå˜ä½“å®‰è£…çš„è½¯ä»¶åŒ…è¾ƒå°‘ï¼Œå› æ­¤æ²¡æœ‰æä¾›ç¼–è¯‘å™¨ã€‚\nç¯å¢ƒå˜é‡ æ¥ä¸‹æ¥è®¾ç½®ç¯å¢ƒå˜é‡ã€‚é¦–å…ˆç¡®ä¿/usr/local/binåœ¨ $PATH ä¸­ï¼š\n1 2 # ensure local python is preferred over distribution python ENV PATH /usr/local/bin:$PATH åŸºæœ¬ä¸Šï¼ŒPython é•œåƒæ˜¯å°† Python å®‰è£…åˆ°/usr/localä¸­ï¼Œå› æ­¤å¯ä»¥ç¡®ä¿æ‰€å®‰è£…çš„ Python å¯æ‰§è¡Œæ–‡ä»¶æ˜¯é»˜è®¤ä½¿ç”¨çš„ã€‚\næ¥ä¸‹æ¥ï¼Œè®¾ç½®åŒºåŸŸè®¾ç½®ï¼š\n1 2 3 # http://bugs.python.org/issue19846 # \u003e At the moment, setting \"LANG=C\" on a Linux system *fundamentally breaks Python 3*, and that's not OK. ENV LANG C.UTF-8 æ®æˆ‘æ‰€çŸ¥ï¼Œå³ä½¿ä¸è¿™æ ·åšï¼Œç°ä»£Python 3ä»å°†é»˜è®¤ä¸ºUTF-8ï¼Œå› æ­¤æˆ‘ä¸ç¡®å®šç›®å‰æ˜¯å¦æœ‰å¿…è¦ã€‚\nè¿˜æœ‰ä¸€ä¸ªç¯å¢ƒå˜é‡å¯ä»¥å‘Šè¯‰æ‚¨å½“å‰çš„Pythonç‰ˆæœ¬ï¼š\n1 ENV PYTHON_VERSION 3.8.5 è¿˜æœ‰ä¸€ä¸ªå¸¦æœ‰GPGå¯†é’¥çš„ç¯å¢ƒå˜é‡ï¼Œç”¨äºåœ¨ä¸‹è½½Pythonæ—¶éªŒè¯å…¶æºä»£ç ã€‚\nè¿è¡Œæ—¶ä¾èµ– è¿è¡Œ Python éœ€è¦ä¸€äº›å…¶ä»–è½¯ä»¶åŒ…ï¼š\n1 2 3 4 RUN apt-get update \u0026\u0026 apt-get install -y --no-install-recommends \\ ca-certificates \\ netbase \\ \u0026\u0026 rm -rf /var/lib/apt/lists/* ca-certificatesæ˜¯æ ‡å‡†è¯ä¹¦é¢å‘æœºæ„çš„è¯ä¹¦åˆ—è¡¨ï¼Œä¸æ‚¨çš„æµè§ˆå™¨ç”¨æ¥éªŒè¯https://URLs çš„è¯ä¹¦ç›¸å½“ã€‚è¿™ä½¿Pythonï¼Œwgetå’Œå…¶ä»–å·¥å…·å¯ä»¥éªŒè¯æœåŠ¡å™¨æä¾›çš„è¯ä¹¦ã€‚\nnetbaseå®‰è£…äº†ä¸€äº›æ–‡ä»¶åˆ°/etcã€‚è¿™äº›æ–‡ä»¶åœ¨å°†æŸäº›åç§°æ˜ å°„åˆ°ç›¸åº”çš„ç«¯å£æˆ–åè®®æ—¶æ‰€éœ€ã€‚ä¾‹å¦‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ/etc/serviceså°†æœåŠ¡åç§°æ˜ å°„httpsåˆ°ç›¸åº”çš„ç«¯å£å·443/tcpã€‚\nå®‰è£…Python æ¥ä¸‹æ¥ï¼Œå®‰è£…ç¼–è¯‘å™¨å·¥å…·é“¾ï¼Œä¸‹è½½Pythonæºä»£ç ï¼Œç¼–è¯‘Pythonï¼Œç„¶åå¸è½½ä¸éœ€è¦çš„Debianè½¯ä»¶åŒ…ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 RUN set -ex \\ \\ \u0026\u0026 savedAptMark=\"$(apt-mark showmanual)\" \\ \u0026\u0026 apt-get update \u0026\u0026 apt-get install -y --no-install-recommends \\ dpkg-dev \\ gcc \\ libbluetooth-dev \\ libbz2-dev \\ libc6-dev \\ libexpat1-dev \\ libffi-dev \\ libgdbm-dev \\ liblzma-dev \\ libncursesw5-dev \\ libreadline-dev \\ libsqlite3-dev \\ libssl-dev \\ make \\ tk-dev \\ uuid-dev \\ wget \\ xz-utils \\ zlib1g-dev \\ # as of Stretch, \"gpg\" is no longer included by default $(command -v gpg \u003e /dev/null || echo 'gnupg dirmngr') \\ \\ \u0026\u0026 wget -O python.tar.xz \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz\" \\ \u0026\u0026 wget -O python.tar.xz.asc \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz.asc\" \\ \u0026\u0026 export GNUPGHOME=\"$(mktemp -d)\" \\ \u0026\u0026 gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$GPG_KEY\" \\ \u0026\u0026 gpg --batch --verify python.tar.xz.asc python.tar.xz \\ \u0026\u0026 { command -v gpgconf \u003e /dev/null \u0026\u0026 gpgconf --kill all || :; } \\ \u0026\u0026 rm -rf \"$GNUPGHOME\" python.tar.xz.asc \\ \u0026\u0026 mkdir -p /usr/src/python \\ \u0026\u0026 tar -xJC /usr/src/python --strip-components=1 -f python.tar.xz \\ \u0026\u0026 rm python.tar.xz \\ \\ \u0026\u0026 cd /usr/src/python \\ \u0026\u0026 gnuArch=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" \\ \u0026\u0026 ./configure \\ --build=\"$gnuArch\" \\ --enable-loadable-sqlite-extensions \\ --enable-optimizations \\ --enable-option-checking=fatal \\ --enable-shared \\ --with-system-expat \\ --with-system-ffi \\ --without-ensurepip \\ \u0026\u0026 make -j \"$(nproc)\" \\ LDFLAGS=\"-Wl,--strip-all\" \\ \u0026\u0026 make install \\ \u0026\u0026 rm -rf /usr/src/python \\ \\ \u0026\u0026 find /usr/local -depth \\ \\( \\ \\( -type d -a \\( -name test -o -name tests -o -name idle_test \\) \\) \\ -o \\( -type f -a \\( -name '*.pyc' -o -name '*.pyo' -o -name '*.a' \\) \\) \\ -o \\( -type f -a -name 'wininst-*.exe' \\) \\ \\) -exec rm -rf '{}' + \\ \\ \u0026\u0026 ldconfig \\ \\ \u0026\u0026 apt-mark auto '.*' \u003e /dev/null \\ \u0026\u0026 apt-mark manual $savedAptMark \\ \u0026\u0026 find /usr/local -type f -executable -not \\( -name '*tkinter*' \\) -exec ldd '{}' ';' \\ | awk '/=\u003e/ { print $(NF-1) }' \\ | sort -u \\ | xargs -r dpkg-query --search \\ | cut -d: -f1 \\ | sort -u \\ | xargs -r apt-mark manual \\ \u0026\u0026 apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false \\ \u0026\u0026 rm -rf /var/lib/apt/lists/* \\ \\ \u0026\u0026 python3 --version é‡Œé¢æœ‰å¾ˆå¤šä¸œè¥¿ï¼Œä½†æ˜¯åŸºæœ¬ç»“æœæ˜¯ï¼š\nPythonå·²å®‰è£…åˆ°ä¸­/usr/localã€‚ æ‰€æœ‰.pycæ–‡ä»¶è¢«åˆ é™¤ã€‚ gccä¸€æ—¦ä¸å†éœ€è¦ç¼–è¯‘Pythonæ‰€éœ€çš„ç¨‹åºåŒ…ç­‰ï¼Œä¾¿å°†å…¶åˆ é™¤ã€‚ ç”±äºæ‰€æœ‰è¿™äº›æ“ä½œå‡åœ¨å•ä¸ªRUNå‘½ä»¤ä¸­å‘ç”Ÿï¼Œå› æ­¤é•œåƒæœ€ç»ˆä¸ä¼šå°†ç¼–è¯‘å™¨å­˜å‚¨åœ¨å…¶ä»»ä½•å±‚ä¸­ï¼Œä»è€Œä½¿é•œåƒå˜å¾—æ›´å°ã€‚\næ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°çš„ä¸€ä»¶äº‹æ˜¯Pythonéœ€è¦libbluetooth-devè¿›è¡Œç¼–è¯‘ã€‚è¿™ä»¤äººæƒŠè®¶ï¼Œæ‰€ä»¥æˆ‘è¿½æ ¹ç©¶åº•ï¼Œå¾ˆæ˜æ˜¾ï¼ŒPythonå¯ä»¥åˆ›å»ºè“ç‰™å¥—æ¥å­—ï¼Œä½†å‰ææ˜¯å¿…é¡»åœ¨å®‰è£…äº†æ­¤è½¯ä»¶åŒ…çš„æƒ…å†µä¸‹è¿›è¡Œç¼–è¯‘çš„ã€‚\nè®¾ç½®åˆ«å æ¥ä¸‹æ¥ï¼Œ/usr/local/bin/python3è·å–ä¸€ä¸ªåˆ«å/usr/local/bin/pythonï¼Œä¸¤ç§æ–¹å¼éƒ½å¯è°ƒç”¨åˆ°ï¼š\n1 2 3 4 5 6 # make some useful symlinks that are expected to exist RUN cd /usr/local/bin \\ \u0026\u0026 ln -s idle3 idle \\ \u0026\u0026 ln -s pydoc3 pydoc \\ \u0026\u0026 ln -s python3 python \\ \u0026\u0026 ln -s python3-config python-config å®‰è£… pip è¯¥pipåŒ…ä¸‹è½½å·¥å…·éƒ½æœ‰å…¶è‡ªå·±çš„å‘å¸ƒæ—¶é—´è¡¨ï¼Œä¸Pythonçš„ä¸åŒã€‚ä¾‹å¦‚ï¼Œè¿™Dockerfileå°†å®‰è£…2020å¹´7æœˆå‘å¸ƒçš„Python3.8.5ã€‚ pip20.2.2å·²äº8æœˆå‘å¸ƒï¼Œä½†è¦Dockerfileç¡®ä¿åŒ…å«è¾ƒæ–°çš„ç‰ˆæœ¬pipï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 # if this is called \"PIP_VERSION\", pip explodes with \"ValueError: invalid truth value '\u003cVERSION\u003e'\" ENV PYTHON_PIP_VERSION 20.2.2 # https://github.com/pypa/get-pip ENV PYTHON_GET_PIP_URL https://github.com/pypa/get-pip/raw/5578af97f8b2b466f4cdbebe18a3ba2d48ad1434/get-pip.py ENV PYTHON_GET_PIP_SHA256 d4d62a0850fe0c2e6325b2cc20d818c580563de5a2038f917e3cb0e25280b4d1 RUN set -ex; \\ \\ savedAptMark=\"$(apt-mark showmanual)\"; \\ apt-get update; \\ apt-get install -y --no-install-recommends wget; \\ \\ wget -O get-pip.py \"$PYTHON_GET_PIP_URL\"; \\ echo \"$PYTHON_GET_PIP_SHA256 *get-pip.py\" | sha256sum --check --strict -; \\ \\ apt-mark auto '.*' \u003e /dev/null; \\ [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark; \\ apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \\ rm -rf /var/lib/apt/lists/*; \\ \\ python get-pip.py \\ --disable-pip-version-check \\ --no-cache-dir \\ \"pip==$PYTHON_PIP_VERSION\" \\ ; \\ pip --version; \\ \\ find /usr/local -depth \\ \\( \\ \\( -type d -a \\( -name test -o -name tests -o -name idle_test \\) \\) \\ -o \\ \\( -type f -a \\( -name '*.pyc' -o -name '*.pyo' \\) \\) \\ \\) -exec rm -rf '{}' +; \\ rm -f get-pip.py åŒæ ·ï¼Œæ‰€æœ‰.pycæ–‡ä»¶å‡è¢«åˆ é™¤ã€‚\nEntrypoint æœ€åï¼ŒDockerfileå…·ä½“è¯´æ˜ Entrypointï¼š\n1 CMD [\"python3\"] ä½¿ç”¨CMDä¸åŠ  ENTRYPOINTï¼Œpythoné»˜è®¤æƒ…å†µä¸‹ä¼šåœ¨è¿è¡Œé•œåƒæ—¶è¿›å…¥ REPLï¼š\n1 2 3 4 5 $ docker run -it python:3.8-slim-buster Python 3.8.5 (default, Aug 4 2020, 16:24:08) [GCC 8.3.0] on linux Type \"help\", \"copyright\", \"credits\" or \"license\" for more information. \u003e\u003e\u003e ä½†æ˜¯ï¼Œæ‚¨è¿˜å¯ä»¥æ ¹æ®éœ€è¦æŒ‡å®šå…¶ä»–å¯æ‰§è¡Œæ–‡ä»¶ï¼š\n1 2 $ docker run -it python:3.8-slim-buster bash root@280c9b73e8f9:/# æˆ‘ä»¬å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ å¯¹slim-busterå˜ä½“ï¼Œè¿™é‡Œæœ‰ä¸€äº›è¦ç‚¹ã€‚\nè¯¥pythonå®˜æ–¹é•œåƒå¦‚ä½•åŒ…å«çš„Python å°½ç®¡è¿™ä¸€ç‚¹ä¼¼ä¹å¾ˆæ˜æ˜¾ï¼Œä½†å€¼å¾—æ³¨æ„çš„æ˜¯å®ƒæ˜¯å¦‚ä½•åŒ…å«çš„ï¼šå®ƒæ˜¯è‡ªå®šä¹‰å®‰è£…Pythonåˆ°/usr/localã€‚\nå¸¸è§é”™è¯¯æ˜¯é€šè¿‡ä½¿ç”¨Debiançš„Pythonç‰ˆæœ¬å†æ¬¡å®‰è£…Pythonï¼š\n1 2 3 4 FROM python:3.8-slim-buster # THIS IS NOT NECESSARY: RUN apt-get update \u0026\u0026 apt-get install python3-dev è¿™ä¼šåœ¨/usrä¸­è€Œä¸æ˜¯åœ¨/usr/localä¸­å®‰è£…é¢å¤–çš„Pythonï¼Œå¹¶ä¸”é€šå¸¸ä¼šæ˜¯å…¶ä»–ç‰ˆæœ¬çš„Pythonã€‚æ‚¨å¯ä¸å¸Œæœ›åŒä¸€é•œåƒä¸­æœ‰ä¸¤ä¸ªä¸åŒç‰ˆæœ¬çš„Pythonã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™åªä¼šå¯¼è‡´æ··ä¹±ã€‚\nå¦‚æœæ‚¨ç¡®å®è¦ä½¿ç”¨Debianç‰ˆæœ¬çš„Pythonï¼Œè¯·debian:buster-slimæ”¹ä¸ºä½¿ç”¨åŸºæœ¬é•œåƒã€‚\npythonå®˜æ–¹é•œåƒåŒ…æ‹¬äº†æœ€æ–°çš„pip ä¾‹å¦‚ï¼ŒPython 3.5çš„æœ€æ–°ç‰ˆæœ¬æ˜¯åœ¨2019å¹´11æœˆï¼Œä½†æ˜¯python:3.5-slim-busteråŒ…å«çš„Dockeré•œåƒæ˜¯pipä»2020å¹´8æœˆå¼€å§‹çš„ã€‚ï¼ˆé€šå¸¸ï¼‰è¿™æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥è·å¾—æœ€æ–°çš„é”™è¯¯ä¿®å¤ï¼Œæ€§èƒ½æ”¹è¿›ä»¥åŠå¯¹è¾ƒæ–°ç‰ˆæœ¬çš„æ”¯æŒã€‚\npythonå®˜æ–¹é•œåƒåˆ é™¤æ‰€æœ‰.pycæ–‡ä»¶ å¦‚æœè¦ç¨å¾®åŠ å¿«å¯åŠ¨é€Ÿåº¦ï¼Œåˆ™å¯èƒ½å¸Œæœ›.pycä½¿ç”¨compileallå°†æ ‡å‡†åº“æºä»£ç ç¼–è¯‘åˆ°è‡ªå·±çš„é•œåƒä¸­ã€‚\npythonå®˜æ–¹é•œåƒä¸å®‰è£…Debianå®‰å…¨æ›´æ–° å°½ç®¡ç»å¸¸ä¼šé‡æ–°ç”Ÿæˆdebian:buster-slimå’Œpythoné•œåƒï¼Œä½†æ˜¯åœ¨æŸäº›çª—å£ä¸­å·²å‘å¸ƒäº†æ–°çš„Debianå®‰å…¨ä¿®å¤ç¨‹åºï¼Œä½†æ˜¯å°šæœªé‡æ–°ç”Ÿæˆé•œåƒã€‚æ‚¨åº”è¯¥å°†å®‰å…¨æ›´æ–°å®‰è£…åˆ°åŸºç¡€Linuxå‘è¡Œç‰ˆã€‚\n","description":"","tags":["python","docker"],"title":"æ·±å…¥äº†è§£Pythonçš„å®˜æ–¹Dockeré•œåƒ","uri":"/blog/posts/Python/official-docker-python-image/"},{"categories":null,"content":"\nJenkins å¤©ç„¶ç¨‹åºå’Œæ•°æ®åˆ†ç¦»çš„å±æ€§ï¼Œä½¿å¾—å®ƒèƒ½å¤Ÿå®¹æ˜“çš„è¿ç§»ä¸å‡çº§ã€‚\næœ¬æ–‡è®°å½•æƒ³æŠŠ Jenkins Service è¿ç§»åˆ° docker å®¹å™¨å†…ã€‚\nå¤‡ä»½ é€šè¿‡è„šæœ¬æ‰“åŒ… æœ€ç®€å•çš„æ–¹å¼æ˜¯å°† Jenkins çš„å·¥ä½œç›®å½•æ‰“åŒ…ã€‚ä¸€èˆ¬ä¸º /var/jenkins_homeï¼Œæˆ–è€… /var/lib/jenkinsã€‚å¦‚æœä½ çš„æ•°æ®é‡ç›¸å½“å°ï¼Œè¯·ç›´æ¥ç”¨ tar æ‰“åŒ…ã€‚å†ç›´æ¥è¿ç§»åˆ°éœ€è¦é‡æ–°éƒ¨ç½²çš„ Jenkins å·¥ä½œç›®å½•å³å¯ã€‚\næœ¬æ–‡ä¸­å®¿ä¸»æœºçš„ Jenkins åœ¨ /var/lib/jenkins ç›®å½•\nç„¶è€Œç”±äºå½“å‰çš„ jenkins_homeé‡Œé¢å­˜æ”¾äº†ä¸€äº›ä¸´æ—¶æ–‡ä»¶ï¼Œä»¥åŠ jobs, workspace ç›®å½•æ•°æ®é‡å·²ç»ç›¸å½“å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“åŒ…çš„æ—¶å€™éœ€è¦æ’é™¤ä¸€äº›æ–‡ä»¶ã€‚\nbackup.sh\n1 2 3 4 5 6 7 8 #!/bin/bash current_date=`date \"+%Y%m%d%H%M\"` jenkins_backup_path='/home/jks-master/jenkins/backups/backup_'$current_date'.tar' jenkins_home='/var/lib/jenkins' #echo $jenkins_backup_path tar -zcvf $jenkins_backup_path --exclude-from=exclude.txt $jenkins_home exclude.txt\n1 2 3 4 5 6 7 8 9 10 /var/lib/jenkins/jobs /var/lib/jenkins/workspace /var/lib/jenkins/backups /var/lib/jenkins/inbox /var/lib/jenkins/Anaconda3 /var/lib/jenkins/anaconda3 /var/lib/jenkins/caches /var/lib/jenkins/.cache /var/lib/jenkins/Pipeline_* é€šè¿‡æ’ä»¶å¤‡ä»½ ç›®å‰ Jenkins ä¸­æ¯”è¾ƒæˆç†Ÿçš„æ’ä»¶æ˜¯ ThinBackupã€‚é‡Œé¢æä¾›äº†ç›¸å¯¹ä¸°å¯Œçš„é…ç½®é¡¹\nå¾—åˆ°çš„å‹ç¼©æ–‡ä»¶ä¸ºä¸‹ä¸€æ­¥è¿ç§»ä½œå‡†å¤‡ã€‚\nè¿ç§» é€‰æ‹©ä½¿ç”¨çš„ docker é•œåƒæ˜¯ jenkins/jenkins:ltsã€‚\nå‡å®šå°†å¤‡ä»½æ–‡ä»¶è§£å‹åˆ°/var/jenkins_homeç›®å½•ï¼Œè‹¥ä¹‹å‰æ‰“åŒ…æ–‡ä»¶åŒ…å«äº† jobs/, workspace/æ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆåªéœ€å°†æ–‡ä»¶è§£å‹å‡ºæ¥å†æŒ‚è½½åˆ° docker å®¹å™¨å†…å³å¯ã€‚\nç”±äºæ–‡ä¸­çš„å®éªŒç¯å¢ƒæ²¡æœ‰å°†ä»¥ä¸Šä¸¤ä¸ªç›®å½•æ‰“åŒ…è¿›æ¥ï¼Œæ‰€ä»¥åœ¨å¯åŠ¨å®¹å™¨æ—¶ä¼šæŒ‚è½½å¤šä¸ªç›®å½•ã€‚\nå¦‚æœ Jenkins éœ€è¦è‡ªå®šä¹‰ä¸€äº›å·¥å…·ä¾èµ–ï¼Œç¯å¢ƒé…ç½®ï¼Œå¯ä»¥å°†è¿™äº›å†™å…¥ Dockerfile ï¼Œä½¿ç”¨ docker build ç”Ÿæˆæ–°é•œåƒã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 FROM jenkins/jenkins:lts USER root ENV TOOL_CHAIN_PATH=/opt/toolchain COPY gcc-linaro-5.4.1-2017.05-x86_64_arm-linux-gnueabihf.tar.xz /tmp/ COPY gcc-arm-none-eabi-5_2-2015q4-20151219-linux.tar.bz2 /tmp/ COPY jcli-linux-amd64.tar.gz /tmp/ RUN mkdir ${TOOL_CHAIN_PATH} \\ \u0026\u0026 tar -Jxvf /tmp/gcc-linaro-5.4.1-2017.05-x86_64_arm-linux-gnueabihf.tar.xz -C ${TOOL_CHAIN_PATH} \\ \u0026\u0026 tar -jxvf /tmp/gcc-arm-none-eabi-5_2-2015q4-20151219-linux.tar.bz2 -C ${TOOL_CHAIN_PATH} \\ \u0026\u0026 tar -zxvf /tmp/jcli-linux-amd64.tar.gz -C /tmp \\ \u0026\u0026 cp /tmp/jcli /usr/local/bin \\ \u0026\u0026 cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \u0026\u0026 echo Asia/Shanghai \u003e /etc/timezone \\ \u0026\u0026 sed -i 's/deb.debian.org/mirrors.ustc.edu.cn/g' /etc/apt/sources.list \\ \u0026\u0026 apt update \u0026\u0026 apt install --no-install-recommends -y zlib1g-dev libmagickwand-dev \\ lib32z1 lib32ncurses5 lib32stdc++6 squashfs-tools mtd-utils texinfo autopoint bison flex \\ liblz4-tool u-boot-tools \\ curl fakeroot wget vim htop python3 python3-pip python3-setuptools tree git autoconf automake make gcc \\ \u0026\u0026 pip3 install --upgrade pip \\ \u0026\u0026 rm -rf /tmp/* USER jenkins COPY åçš„æ–‡ä»¶éœ€å’Œ dockerfile æ”¾ç½®åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œdocker build . -t jenkins:\u003cYOUR TAG\u003e\nç£ç›˜RAIDï¼ˆå¯é€‰ï¼‰ ç”±äºæˆ‘ä»¬æ˜¯é€šè¿‡ mount ä¸»æœºçš„ç›®å½•åˆ°å®¹å™¨ä¸­ jenkins_homeï¼Œä¸ºäº†ä¿è¯æ•°æ®å¯é æ€§ï¼ŒæŠŠæ•°æ®æ‰€åœ¨çš„ç£ç›˜ç»„äº† RAID1 ã€‚\nå®‰è£… mdadm 1 apt install mdamd mdadm å‚æ•°\n-Cv åˆ›å»ºé˜µåˆ—\n-l -n -x é˜µåˆ—çº§åˆ« å‡ ä¸ªç¡¬ç›˜ç»„raid å‡ ä¸ªçƒ­å¤‡ç›˜\n-D æŸ¥çœ‹ä¿¡æ¯\n-D -s å†™å…¥é…ç½®æ–‡ä»¶\n-f -r -a æ¨¡æ‹ŸæŸå æ‹”é™¤ç¡¬ç›˜ æ’å›ç¡¬ç›˜\n-G -n å°†æ–°å¢çš„çƒ­å¤‡ç›˜åŠ å…¥é˜µåˆ—\n-S åœæ­¢raid\nåˆ›å»ºç£ç›˜é˜µåˆ— 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # åˆ›å»ºé˜µåˆ— mdadm -Cv /dev/md5 -l5 -n3 -x1 /dev/sd[bcde] # -C åˆ›å»ºå†—ä½™ # væ˜¾ç¤ºè¿‡ç¨‹ # -l raidçº§åˆ« # n raidç¡¬ç›˜æ•° # xçƒ­å¤‡ç›˜æ•°é‡ # æŸ¥çœ‹åŒæ­¥è¿›åº¦ madam -D /dev/md5 # å¦ä¸€ç§æŸ¥çœ‹æ–¹æ³• *cat /proc/mdstat # åˆ›å»ºæ–‡ä»¶ç³»ç»Ÿ mkfs.ext4 /dev/md5 mdadm -D -s \u003e/etc/mdadm.conf ç”Ÿæˆé…ç½®æ–‡ä»¶å¹¶åœ¨æœ«å°¾åŠ auto=yes (*ä¸ç”Ÿæˆé…ç½®æ–‡ä»¶ å¼€æœºraidæŸå) mdadm /dev/md5 -f /dev/sdb æ¨¡æ‹ŸsdbæŸå -fæŸå mdadm /dev/md5 -r /dev/sdb æ‹”å‡ºæ¨¡æ‹ŸæŸåçš„sdb mdadm /dev/md5 -a /dev/sdb æ’å›æ¨¡æ‹ŸæŸåçš„sdb mdadm -G /dev/md5 -n4 raidæ‹‰ä¼¸ æŠŠçƒ­å¤‡ç›˜sdbä¹ŸåŠ å…¥ç£ç›˜é˜µåˆ— resize2fs /dev/md5 åœ¨çº¿åŠ¨æ€æ ¼å¼åŒ– ä½¿æ–°åŠ å…¥çš„sdbå®¹é‡ä¹Ÿè¢«æŒ‚åœ¨ä¸Š æ­£ç¡®å®Œæˆåˆ›å»ºå 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT loop0 7:0 0 276K 1 loop /snap/gnome-characters/539 loop1 7:1 0 276K 1 loop /snap/gnome-characters/550 loop2 7:2 0 2.2M 1 loop /snap/gnome-system-monitor/148 loop3 7:3 0 62.1M 1 loop /snap/gtk-common-themes/1506 loop4 7:4 0 55M 1 loop /snap/core18/1880 loop5 7:5 0 2.2M 1 loop /snap/gnome-system-monitor/145 loop6 7:6 0 956K 1 loop /snap/gnome-logs/93 loop7 7:7 0 54.8M 1 loop /snap/gtk-common-themes/1502 loop8 7:8 0 161.4M 1 loop /snap/gnome-3-28-1804/128 loop9 7:9 0 2.4M 1 loop /snap/gnome-calculator/730 loop10 7:10 0 956K 1 loop /snap/gnome-logs/100 loop11 7:11 0 140.7M 1 loop /snap/gnome-3-26-1604/100 loop12 7:12 0 55.3M 1 loop /snap/core18/1885 loop13 7:13 0 2.4M 1 loop /snap/gnome-calculator/748 loop14 7:14 0 160.2M 1 loop /snap/gnome-3-28-1804/116 loop15 7:15 0 255.6M 1 loop /snap/gnome-3-34-1804/36 loop16 7:16 0 96.6M 1 loop /snap/core/9804 loop17 7:17 0 97M 1 loop /snap/core/9665 loop18 7:18 0 140.7M 1 loop /snap/gnome-3-26-1604/98 loop19 7:19 0 255.6M 1 loop /snap/gnome-3-34-1804/33 sda 8:0 0 238.5G 0 disk â”œâ”€sda1 8:1 0 512M 0 part /boot/efi â””â”€sda2 8:2 0 238G 0 part / sdb 8:16 0 7.3T 0 disk â””â”€md127 9:127 0 7.3T 0 raid1 /mnt/hdd sdc 8:32 0 7.3T 0 disk â””â”€md127 9:127 0 7.3T 0 raid1 /mnt/hdd æ­£ç¡®åˆ é™¤è½¯raidæ–¹æ³• 1 2 3 4 5 6 7 1 umount /md5 å…ˆå¸è½½é˜µåˆ— 2 mdadm -S /dev/md5 åœæ­¢raidè¿è¡Œ (*å¤§S stop) 3 mdadm --misc --zero-superblock /dev/sd[bcdef] åˆ é™¤ç£ç›˜ 4 åˆ é™¤é…ç½®æ–‡ä»¶ (*å¦‚æœfstabæˆ–rc.localé…ç½®äº†è‡ªåŠ¨æŒ‚è½½éƒ½è¦åˆ é™¤) æ€»ç»“ åˆ›å»ºå®Œraidè¦ç­‰åŒæ­¥åˆ°100%åå†æ ¼å¼åŒ–\nraidæ‹‰ä¼¸åè¦æŠŠæ‹‰ä¼¸çš„éƒ¨åˆ†resize2fsæ ¼å¼åŒ–\nåˆ é™¤æ—¶ åœæ­¢æŒ‚è½½ åœæ­¢raid åˆ é™¤ç¡¬ç›˜ åˆ é…ç½®æ–‡ä»¶\næ¶‰åŠç›®å½•\n/etc/mdadm.conf è¦æ‰‹åŠ¨ç”Ÿæˆè¿™ä¸ªé…ç½®æ–‡ä»¶ é‡Œé¢å†…å®¹æœ«å°¾åŠ ä¸Šauto=yes å¦åˆ™å¼€æœºä¼šraidæŸå\n/proc/mdstat é€šè¿‡æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶å¯ä»¥ç›‘æ§raidå·¥ä½œçŠ¶æ€ å‡ ä¸ªUä»£è¡¨å‡ ä¸ªç›˜åœ¨å·¥ä½œ\nå¯åŠ¨ start_docker_jenkins.sh\n1 2 3 4 5 6 7 8 9 10 #!/bin/bash docker run -d \\ -u 1000:1000 \\ -v /var/jenkins_home:/var/jenkins_home \\ -v /var/lib/jenkins/jobs:/var/jenkins_home/jobs \\ -v /var/lib/jenkins/workspace:/var/jenkins_home/workspace \\ -p 8080:8080 \\ -p 50000:50000 \\ jenkins/jenkins:\u003cTAG\u003e 50000 ç«¯å£ç”¨æ¥ä½œä¸º slave é€šä¿¡ï¼Œåœ¨ å¼‚å¸¸æƒ…å†µ ç¬¬äºŒç§æåˆ°\nå¯åŠ¨åï¼Œè·å–åˆ°å®¹å™¨çš„ idï¼Œä½¿ç”¨ docker logs [ID] æŸ¥çœ‹æ˜¯å¦æœ‰é”™è¯¯ã€‚\nå¼‚å¸¸æƒ…å†µ jenkins.model.InvalidBuildsDir: ${ITEM_ROOTDIR}/builds does not exist and probably cannot be created\nè¿™ä¸ªé”™è¯¯çš„åŸå› æ˜¯æƒé™é—®é¢˜ã€‚éœ€è¦æ£€æŸ¥å¯åŠ¨ docker çš„ç”¨æˆ·æ‰€æŒ‚è½½çš„ç›®å½•æ˜¯å¦æœ‰æƒé™è¯»å†™ã€‚å¦‚æœæ²¡æœ‰çš„è¯å¯æ›´æ”¹ç›®å½•çš„æŒæœ‰è€…ï¼š\nchown -R [USER] [DIR] å…³äº dockerå®¹å™¨çš„æƒé™é—®é¢˜å¯ä»¥è§å‚è€ƒä¸€èŠ‚å‰ä¸¤ç¯‡æ–‡ç« \nWindows Node æ— æ³•ä¸ Master é€šä¿¡\nåœ¨ Manage Jenkins -\u003e Configure Global Security -\u003e Agents ä¸­é…ç½®\nå‚è€ƒ dockeræŒ‚è½½volumeçš„ç”¨æˆ·æƒé™é—®é¢˜,ç†è§£dockerå®¹å™¨çš„uid\nç†è§£ docker å®¹å™¨ä¸­çš„ uid å’Œ gid\n","description":"","tags":["jenkins"],"title":"è¿ç§» Jenkins åˆ° Docker","uri":"/blog/posts/migrate-jenkins-on-docker/"},{"categories":null,"content":"\nJenkins æ˜¯å¼ºå¤§çš„è‡ªåŠ¨åŒ–å·¥å…·ã€‚\næœ¬æ–‡ä»‹ç»å¦‚æœé€šè¿‡ jcliï¼ˆJenkins Clientï¼‰æ¥ç®¡ç† Jenkins ç«™ç‚¹\nç¯å¢ƒ å¯åŠ¨ Jenkins Service å®‰è£… Linux ä¸‹çš„ç”¨æˆ·ï¼Œå¯é€šè¿‡ä¸€ä¸‹å‘½ä»¤å®‰è£… jcli\n1 2 3 4 curl -L https://github.com/jenkins-zh/jenkins-cli/releases/latest/download/jcli-linux-amd64.tar.gz|tar xzv # å°† jcli åæ·»åŠ è¿›ç¯å¢ƒå˜é‡ echo export PATH=~:$PATH \u003e\u003e ~/.bashrc \u0026\u0026 source ~/.bashrc ##ä½¿ç”¨\nåœ¨ä½¿ç”¨ jcli å·¥å…·ä¹‹å‰ï¼Œéœ€è¦å…ˆç”Ÿæˆä¸€ä»½é…ç½®æ–‡ä»¶ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 jcli config gen -i=false \u003e ~/.jenkins-cli.yaml cat .jenkins-cli.yaml jenkins_servers: - name: yourServer url: http://localhost:8080/jenkins username: admin token: admin proxy: \"\" proxyAuth: \"\" insecureSkipVerify: true description: \"\" preHooks: [] postHooks: [] pluginSuites: [] mirrors: - name: default url: http://mirrors.jenkins.io/ - name: tsinghua url: https://mirrors.tuna.tsinghua.edu.cn/jenkins/ - name: huawei url: https://mirrors.huaweicloud.com/jenkins/ - name: tencent url: https://mirrors.cloud.tencent.com/jenkins/ å¯ä»¥ç™»å½•åˆ° jenkins é¡µé¢ä¸Šå» User -\u003e Configure -\u003e API Token ç”Ÿæˆä¸€ä¸ª token å¡«å…¥åˆ°ä¸Šé¢å¯¹åº”å­—æ®µã€‚\njcli -h\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 Jenkins CLI written by golang which could help you with your multiple Jenkins, We'd love to hear your feedback at https://github.com/jenkins-zh/jenkins-cli/issues Usage: jcli [command] Available Commands: casc Configuration as Code center Manage your update center completion Generate shell completion scripts computer Manage the computers of your Jenkins config Manage the config of jcli credential Manage the credentials of your Jenkins crumb Print crumbIssuer of Jenkins cwp Custom Jenkins WAR packager for Jenkins doc Generate document for all jcl commands help Help about any command job Manage the job of your Jenkins open Open your Jenkins with a browser plugin Manage the plugins of Jenkins queue Manage the queue of your Jenkins restart Restart your Jenkins runner The wrapper of jenkinsfile runner shell Create a sub shell so that changes to a specific Jenkins remain local to the shell. shutdown Puts Jenkins into the quiet mode, wait for existing builds to be completed, and then shut down Jenkins user Print the user of your Jenkins version Print the version of Jenkins CLI Flags: --config-load If load a default config file (default true) --configFile string An alternative config file --debug Print the output into debug.html --doctor Run the diagnose for current command -h, --help help for jcli --insecureSkipVerify If skip insecure skip verify (default true) -j, --jenkins string Select a Jenkins server for this time --logger-level string Logger level which could be: debug, info, warn, error (default \"warn\") --proxy string The proxy of connection to Jenkins --proxy-auth string The auth of proxy of connection to Jenkins --proxy-disable Disable proxy setting --token string The token of Jenkins --url string The URL of Jenkins --username string The username of Jenkins Use \"jcli [command] --help\" for more information about a command. å¯ä»¥çœ‹å‡º jcli é‡Œé¢æ¶µç›–äº†è®¸å¤šå­å‘½ä»¤ï¼Œä¸ºäº†æ–¹ä¾¿æŸ¥è¯¢ï¼Œjcli æä¾›äº†ç”Ÿæˆå‘½ä»¤æ–‡æ¡£çš„åŠŸèƒ½\njcli doc [PATH]\nåœ¨å¯¼å‡ºç›®å½•ä¸‹ï¼š\né‡Œé¢çš„å†…å®¹ä¸ºï¼š\nå¸¸ç”¨å‘½ä»¤ ç”±äºå‘½ä»¤ç¹å¤šï¼Œè¿™é‡Œåˆ—å‡ºä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„å‘½ä»¤ï¼Œæ›´å¤šçš„åŠŸèƒ½è¯·å‚é˜…ä¸Šé¢ç”Ÿæˆçš„æ–‡æ¡£ã€‚\nCenter jcli center download\t- Download jenkins.war jcli center identity\t- Print the identity of current Jenkins jcli center mirror\t- Set the update center to a mirror address jcli center start\t- Start Jenkins server from a cache directory jcli center upgrade\t- Upgrade your Jenkins jcli center watch\t- Watch your update center status Config jcli config add\t- Add a Jenkins config item jcli config clean\t- Clean up some unavailable config items jcli config edit\t- Edit a Jenkins config jcli config generate\t- Generate a sample config file for you jcli config list\t- List all Jenkins config items jcli config plugin\t- Manage plugins for jcli jcli config plugin\t- Manage plugins for jcli jcli config remove\t- Remove a Jenkins config jcli config select\t- Select one config as current Jenkins Credential jcli credential create\t- Create a credential from Jenkins jcli credential delete\t- Delete a credential from Jenkins jcli credential list\t- List all credentials of Jenkins Job jcli job artifact\t- Print the artifact list of target job jcli job build\t- Build the job of your Jenkins jcli job create\t- Create a job in your Jenkins jcli job delete\t- Delete a job in your Jenkins jcli job disable\t- Disable a job in your Jenkins jcli job edit\t- Edit the job of your Jenkins jcli job enable\t- Enable a job in your Jenkins jcli job history\t- Print the history of job in your Jenkins jcli job input\t- Input a job in your Jenkins jcli job log\t- Print the job's log of your Jenkins jcli job param\t- Get parameters of the job of your Jenkins jcli job search\t- Print the job of your Jenkins jcli job stop\t- Stop a job build in your Jenkins jcli job type\t- Print the types of job which in your Jenkins Plugin jcli plugin build\t- Build the Jenkins plugin project jcli plugin check\t- Check update center server jcli plugin create\t- Create a plugin project from the archetypes jcli plugin download\t- Download the plugins jcli plugin install\t- Install the plugins jcli plugin list\t- Print all the plugins which are installed jcli plugin open\t- Open update center server in browser jcli plugin release\t- Release current plugin project jcli plugin search\t- Print the plugins of your Jenkins jcli plugin trend\t- Show the trend of the plugin jcli plugin uninstall\t- Uninstall the plugins jcli plugin upgrade\t- Upgrade the specific plugin jcli plugin upload\t- Upload a plugin to your Jenkins User jcli user create\t- Create a user for your Jenkins jcli user delete\t- Delete a user for your Jenkins jcli user edit\t- Edit the user of your Jenkins jcli user token\t- Token the user of your Jenkins Jenkins jcli restart - Restart your Jenkins jcli shutdown - Puts Jenkins into the quiet mode, wait for existing builds to be completed, and then shut down Jenkins jcli runner - The wrapper of jenkinsfile runner Get more about jenkinsfile runner from https://github.com/jenkinsci/jenkinsfile-runner jcli shell - Create a sub shell so that changes to a specific Jenkins remain local to the shell. å‚è€ƒ Jenkins CLI Tutorial\nJenkins CLI æ–‡æ¡£\n","description":"","tags":["jenkins"],"title":"é€šè¿‡ jcli ç®¡ç† Jenkins","uri":"/blog/posts/manage-jenkins-by-using-jcli/"},{"categories":["Algorithm"],"content":"çº¿æ€§è¡¨ç›¸å…³ #Array\nLeetCode-p1 Two Sum Description:\nGiven an array of integers, return indices of the two numbers such that they add up to a specific target.\nYou may assume that each input would have exactly one solution, and you may not use the same element twice.\nAnalysis:\nBrute-force HashMap Implements:\nCpp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 // Brute-force Solution class Solution { public: vector\u003cint\u003e twoSum(vector\u003cint\u003e\u0026 nums, int target) { vector\u003cint\u003e res; for(int i = 0; i \u003c nums.size(); ++i) { for(int j = i + 1; j \u003c nums.size(); ++j) { if(nums[j] == target - nums[i]) { res.push_back(i); res.push_back(j); return res; } } } return res; } }; Java 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 // Brute-force Solution class Solution { public int[] twoSum(int[] nums, int target) { for(int i = 0; i \u003c nums.length; i++){ for(int j = i + 1; j \u003c nums.length; j++){ if(nums[j] == target - nums[i]) return new int[]{i,j}; } } throw new IllegalArgumentException(\"No solution\"); } } // HashMap Solution class Solution { public int[] twoSum(int[] nums, int target) { int[] res = new int[2]; Map\u003cInteger, Integer\u003e map = new HashMap\u003cInteger, Integer\u003e(); for (int i = 0; i \u003c nums.length; ++i) { if (map.containsKey(target - nums[i])) { res[0] = i; res[1] = map.get(target - nums[i]); } map.put(nums[i], i); } return res; } } Related Problem\n3Sum\n4Sum\nTwo Sum II - Input array is sorted\nTwo Sum III - Data structure design\nSubarray Sum Equals K\nTwo Sum IV - Input is a BST\nLeetCode-P4 Median of Two Sorted Arrays Description:\nThere are two sorted arrays nums1 and nums2 of size m and n respectively.\nFind the median of the two sorted arrays. The overall run time complexity should be O(log (m+n)).\nYou may assume nums1 and nums2 cannot be both empty.\nAnalysis:\nMerge Sort Solution find K-th position Implements:\nJava 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 class Solution { public double findMedianSortedArrays(int[] nums1, int[] nums2) { int[] sorted = mergeSort(nums1, nums2); if (sorted.length % 2 == 1) { return sorted[sorted.length/2] / 1.0; } else { return (sorted[(sorted.length-1)/2] + sorted[sorted.length/2]) / 2.0; } } public int[] mergeSort(int[] nums1, int[] nums2) { int m = nums1.length, n = nums2.length; int total = m + n; int[] res = new int[total]; int i = 0, j = 0, k = 0; while (i \u003c m \u0026\u0026 j \u003c n) { res[k++] = (nums1[i] \u003c nums2[j]) ? nums1[i++] : nums2[j++]; } for (; i \u003c m; ++i) { res[k++] = nums1[i]; } for (; j \u003c n; ++j) { res[k++] = nums2[j]; } return res; } } LeetCode-P11 Container With Most Water Description:\nGiven n non-negative integers a1, a2, ..., an , where each represents a point at coordinate (i, ai). n vertical lines are drawn such that the two endpoints of line i is at (i, ai) and (i, 0). Find two lines, which together with x-axis forms a container, such that the container contains the most water.\nNote: You may not slant the container and n is at least 2.\nAnalysis:\nTwo Pointers Implements:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 class Solution { public int maxArea(int[] height) { int n = height.length; int left = 0, right = n - 1, maxArea = 0; while (left \u003c right) { int w = right - left; int h = Math.min(height[left], height[right]); maxArea = Math.max(maxArea, w * h); // é«˜åº¦è¾ƒå°çš„ä¸€ä¾§å†³å®šmaxArea if (height[left] \u003e= height[right]) { right--; } else { left++; } } return maxArea; } } class Solution { public int maxArea(int[] height) { int maxArea = 0; for(int left = 0, right = height.length - 1; left \u003c right; ){ int h = (height[left] \u003c height[right]) ? height[left++] : height[right--]; maxArea = Math.max(maxArea, (right-left+1) * h); } return maxArea; } } LeetCode-P15 3Sum Description:\nGiven an array nums of n integers, are there elements a, b, c in nums such that a + b + c = 0? Find all unique triplets in the array which gives the sum of zero.\nNote:\nThe solution set must not contain duplicate triplets.\nAnalysis:\nTwo Pointer Implements:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 public List\u003cList\u003cInteger\u003e\u003e threeSum(int[] num) { Arrays.sort(num); List\u003cList\u003cInteger\u003e\u003e res = new LinkedList\u003c\u003e(); for (int i = 0; i \u003c num.length-2; i++) { if (i == 0 || (i \u003e 0 \u0026\u0026 num[i] != num[i-1])) { int lo = i+1, hi = num.length-1, sum = 0 - num[i]; while (lo \u003c hi) { if (num[lo] + num[hi] == sum) { res.add(Arrays.asList(num[i], num[lo], num[hi])); do lo++; while (lo \u003c hi \u0026\u0026 num[lo] == num[lo-1]); do hi--; while (lo \u003c hi \u0026\u0026 num[hi] == num[hi+1]); } else if (num[lo] + num[hi] \u003c sum) lo++; else hi--; } } } return res; } Related Problem:\nLeetCode-P16 3Sum Closest LeetCode-P16 3Sum Closest Description:\nGiven an array nums of n integers and an integer target, find three integers in nums such that the sum is closest to target. Return the sum of the three integers. You may assume that each input would have exactly one solution.\nAnalyse:\nBrute-Force Two Pointers Implements:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 // Brute-Force class Solution { public int threeSumClosest(int[] nums, int target) { int min = Integer.MAX_VALUE, n = nums.length; int res = 0; for (int i = 0; i \u003c n - 2; ++i) { for (int j = i + 1; j \u003c n - 1; ++j) { for (int k = j + 1; k \u003c n; ++k) { int sum = nums[i] + nums[j] + nums[k]; if (Math.abs(target - sum) \u003c min) { min = Math.abs(target - sum); res = sum; } } } } return res; } } // Two-Pointers class Solution { public int threeSumClosest(int[] nums, int target) { Arrays.sort(nums); int res = nums[0] + nums[1] + nums[nums.length - 1]; for (int i = 0; i \u003c nums.length - 2; ++i) { if (i == 0 || (i \u003e 0 \u0026\u0026 nums[i] != nums[i-1])) { int lo = i + 1, hi = nums.length - 1; while (lo \u003c hi) { int sum = nums[i] + nums[lo] + nums[hi]; if (sum \u003c target) do lo++; while (lo \u003c hi \u0026\u0026 nums[lo] == nums[lo-1]); else if (sum \u003e target) do hi--; while (lo \u003c hi \u0026\u0026 nums[hi] == nums[hi+1]); else return sum; res = (Math.abs(target-sum) \u003c Math.abs(target-res)) ? sum : res; } } } return res; } } Related Problem:\nLeetCode-P15 3Sum ###LeetCode-P18 4Sum\nDescription:\nGiven an array nums of n integers and an integer target, are there elements a, b, c, and d in nums such that a + b + c + d = target? Find all unique quadruplets in the array which gives the sum of target.\nNote:\nThe solution set must not contain duplicate quadruplets.\nAnalysis:\nTwo Pointers Implements:\nRelated Problems:\nLeetCode-P26 Remove Duplicates from Sorted Array Description:\nGiven a sorted array, remove the duplicates in place such that each element appear only once and return the new length. Do not allocate extra space for another array, you must do this in place with constant memory. For example, Given input array A = [1,1,2], Your function should return length = 2, and A is now [1,2].\nAnalysis:\nNone\nImplements:\n1 2 3 4 5 6 7 8 9 10 11 12 13 // Time complexity: O(n) , Space complexity: O(1) class Solution { public: int removeDuplicates(vector\u003cint\u003e\u0026 nums) { if (nums.empty()) return 0; int index = 0; for (int i = 1; i \u003c nums.size(); i++) { if (nums[index] != nums[i]) nums[++index] = nums[i]; } return index + 1; } }; Related Problems\nå•é“¾è¡¨ ","description":"","tags":["algorithm","linear-list","array"],"title":"LeetCode çº¿æ€§è¡¨ç›¸å…³é¢˜ç›®ä¸è§£å†³","uri":"/blog/posts/Algorithm/leetcode-linear-table-related-problems-and-solutions/"},{"categories":["Java"],"content":"ã€ŠJavaæ ¸å¿ƒæŠ€æœ¯ã€‹å·ä¸€ ï¼šChap14 å¹¶å‘ è§£é‡Šï¼šå¤šä»»åŠ¡(Multitasking)ï¼Œå¤šçº¿ç¨‹(Multithreaded)\nå¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹åŒºåˆ«ï¼Ÿ\nçº¿ç¨‹æ‰§è¡Œä¸€ä¸ªä»»åŠ¡çš„è¿‡ç¨‹ï¼Ÿ\nå¦‚ä½•å®šä¹‰ä¸€ä¸ªçº¿ç¨‹ï¼Ÿ\nè­¦å‘Šï¼š\nå¦‚ä½•ä¸­æ–­çº¿ç¨‹ï¼Ÿ\nçº¿ç¨‹æœ‰å“ªäº›çŠ¶æ€ï¼Ÿ\nçº¿ç¨‹æœ‰å“ªäº›å±æ€§ï¼Ÿ\nä¸ºä»€ä¹ˆå­˜åœ¨çº¿ç¨‹åŒæ­¥ï¼Ÿ\nå› ä¸ºå­˜åœ¨ç«äº‰æ¡ä»¶(race condition)ã€‚ç«äº‰æ¡ä»¶æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçº¿ç¨‹éœ€è¦å…±äº«å¯¹åŒä¸€æ•°æ®çš„å­˜å–æ‰€å¯¼è‡´çš„è®¹è¯¯ã€‚ä¹‹æ‰€ä»¥ä¼šå‡ºç°æ˜¯å› ä¸ºæ‰§è¡Œå­˜å–åŠ¨ä½œå¹¶ä¸æ˜¯åŸå­æ“ä½œ(åŠ¨ä½œåœ¨æ‰§è¡Œä¸­è¢«ä¸­æ–­)ã€‚\nå¦‚ä½•åŒæ­¥å­˜å–ï¼Ÿ\næ·»åŠ é”å¯¹è±¡ã€‚\n","description":"","tags":["java"],"title":"ã€ŠJavaæ ¸å¿ƒæŠ€æœ¯ã€‹å·ä¸€ ï¼šChap14 å¹¶å‘","uri":"/blog/posts/Java/corejava--chap14-concurrency/"},{"categories":["Linux"],"content":"APUE: File and Directory æ–‡ä»¶ç±»å‹ æ™®é€šæ–‡ä»¶ï¼ˆregular file) ç›®å½•æ–‡ä»¶ å—ç‰¹æ®Šæ–‡ä»¶ å­—ç¬¦ç‰¹æ®Šæ–‡ä»¶ FIFO Socket ç¬¦å·é“¾æ¥ ç”¨æˆ· IDã€ç»„ ID ä¸€èˆ¬uidï¼Œgid è·å–è‡ªç™»å½•é¡¹ï¼Œå¹¶åœ¨ç™»å½•ä¼šè¯æœŸé—´ä¸ä¼šæ”¹å˜ã€‚ä½†è¶…çº§ç”¨æˆ·è¿›ç¨‹å¯ä»¥æ”¹å˜å®ƒä»¬ æœ‰æ•ˆç”¨æˆ· IDï¼Œæœ‰æ•ˆç»„ IDä»¥åŠé™„å±ç»„ ID å†³å®šäº†æ–‡ä»¶è®¿é—®æƒé™ æ¯ä¸ªæ–‡ä»¶æœ‰ä¸€ä¸ªæ‰€æœ‰è€…å’Œç»„æ‰€æœ‰è€… æ–‡ä»¶è®¿é—®æƒé™ æ¯ä¸ªæ–‡ä»¶æœ‰ 9 ä¸ªè®¿é—®æƒé™ä½ // table è¿›ç¨‹æ‰“å¼€ã€åˆ›å»ºæˆ–åˆ é™¤æ–‡ä»¶æ—¶ï¼Œå†…æ ¸ä¼šè¿›è¡Œæ–‡ä»¶è®¿é—®æƒé™æµ‹è¯•ã€‚ // æµ‹è¯•æµç¨‹ æ–°æ–‡ä»¶å’Œç›®å½•æ‰€æœ‰æƒ æ–°æ–‡ä»¶çš„ç”¨æˆ· ID è®¾ç½®ä¸ºæœ‰æ•ˆç”¨æˆ·ID æ–°æ–‡ä»¶ç»„ ID å¯ä»¥æ˜¯è¿›ç¨‹çš„æœ‰æ•ˆç»„ IDï¼Œæˆ–è€…æ‰€åœ¨ç›®å½•çš„ç»„ ID æ–‡ä»¶é•¿åº¦ stat ç»“æ„æˆå‘˜ st_size è¡¨ç¤ºä»¥å­—èŠ‚ä¸ºå•ä½çš„æ–‡ä»¶çš„é•¿åº¦ï¼Œåªå¯¹æ™®é€šæ–‡ä»¶ã€ç›®å½•æ–‡ä»¶å’Œç¬¦å·é“¾æ¥æœ‰æ„ä¹‰ æ–‡ä»¶ç©ºæ´ï¼Ÿ æ–‡ä»¶æˆªæ–­ åœ¨æ–‡ä»¶å°¾ç«¯æˆªå»ä¸€éƒ¨åˆ†æ•°æ®ç¼©çŸ­æ–‡ä»¶ æ–‡ä»¶ç³»ç»Ÿ å¾…å®š ç¬¦å·é“¾æ¥ ç¡¬é“¾æ¥é€šå¸¸è¦æ±‚é“¾æ¥å’Œæ–‡ä»¶ä½äºåŒä¸€æ–‡ä»¶ç³»ç»Ÿ åªæœ‰è¶…çº§ç”¨æˆ·æ‰èƒ½åˆ›å»ºåªæƒ³ç›®å½•çš„ç¡¬é“¾æ¥ è®¾å¤‡ç‰¹æ®Šæ–‡ä»¶ æ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿæ‰€åœ¨çš„å­˜å‚¨è®¾å¤‡éƒ½ç”±å…¶ä¸»ã€æ¬¡è®¾å¤‡å·è¡¨ç¤ºã€‚ ä¸»è®¾å¤‡å¥½æ ‡è¯†è®¾å¤‡é©±åŠ¨ç¨‹åº æ¬¡è®¾å¤‡å·æ ‡è¯†ç‰¹å®šå­è®¾å¤‡ ç³»ç»Ÿä¸­ä¸æ¯ä¸ªæ–‡ä»¶åå…³è”çš„ st_dev å€¼æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„è®¾å¤‡å· åªæœ‰å­—ç¬¦ç‰¹æ®Šæ–‡ä»¶å’Œå—ç‰¹æ®Šæ–‡ä»¶æ‰æœ‰ st_rdev å€¼ï¼Œæ­¤å€¼åŒ…å«ä¹¦ç±è®¾å¤‡çš„è®¾å¤‡å· ","description":"","tags":["apue"],"title":"ã€ŠAPUEã€‹æ–‡ä»¶ä¸ç›®å½•","uri":"/blog/posts/Linux/apue-file-and-directory/"},{"categories":["Linux"],"content":"APUE: STANDARD IO æµå’Œ FILE å¯¹è±¡ æ ‡å‡† I/O åº“æ“ä½œå›´ç»•æµï¼ˆStream ï¼‰è¿›è¡Œã€‚ æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ ç¼“å†² STDIO æä¾›ç¼“å†²çš„ç›®çš„æ˜¯å°½å¯èƒ½å‡å°‘ read å’Œ write è°ƒç”¨æ¬¡æ•°ï¼Œå¯¹æ¯ä¸ª IO æµè‡ªåŠ¨è¿›è¡Œç¼“å†²ç®¡ç†ã€‚\næä¾›ä»¥ä¸‹ç±»å‹çš„ç¼“å†²ï¼š\nå…¨ç¼“å†²ï¼šå¡«æ»¡ç¼“å†²åŒºåå†è¿›è¡Œ IO æ“ä½œ è¡Œç¼“å†²ï¼šè¾“å…¥å’Œè¾“å‡ºä¸­é‡åˆ°æ¢è¡Œç¬¦æ‰§è¡Œ IO æ“ä½œ æ— ç¼“å†²ï¼šç«‹å³æ‰§è¡Œ ISO C è¦æ±‚ç¼“å†²ç‰¹å¾ï¼š\nå½“ä¸”ä»…å½“æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºä¸æŒ‡å‘äº¤äº’å¼è®¾å¤‡æ—¶ï¼Œæ‰æ˜¯å…¨ç¼“å†²çš„ï¼ˆæŒ‡å‘ç»ˆç«¯è®¾å¤‡çš„æºœèˆªç¼“å†²ï¼Œå¦åˆ™ä¸ºå…¨ç¼“å†²ï¼‰\næ ‡å‡†é”™è¯¯ä¸€å®šä¸æ˜¯å…¨ç¼“å†²ï¼ˆå¾ˆå¤šç³»ç»Ÿé»˜è®¤ä½¿ç”¨ä¸å¸¦ç¼“å†²çš„æ ‡å‡†é”™è¯¯ï¼‰\næµçš„æ“ä½œ æ‰“å¼€æµ ç›¸å…³å‡½æ•°\nè¯»å†™æµ ","description":"","tags":["apue","io"],"title":"ã€ŠAPUEã€‹æ ‡å‡†è¾“å…¥è¾“å‡º","uri":"/blog/posts/Linux/apue-stdio/"},{"categories":["Linux"],"content":"é…ç½®å®Œå…¨å‘½ä»¤è¡Œç¯å¢ƒæŒ‡å— è·å–å¸®åŠ©ä¿¡æ¯ man man ascii man unicode|utf-8|latin1 help ##æ–‡ä»¶ä¸ç›®å½•\nbatï¼šæ›´å¥½çš„ cat clocï¼šè®¡ç®—ä»£ç è¡Œæ•°ï¼Œæ¯” wc æ›´å¼ºå¤§ file: æ–‡ä»¶ç±»å‹æŸ¥çœ‹ findï¼šå¼ºå¤§çš„æŸ¥æ‰¾å·¥å…· head/tailï¼šæŸ¥çœ‹æ–‡ä»¶é¦–éƒ¨/å°¾éƒ¨ï¼ŒæŸ¥çœ‹/etc ä¸‹çš„é…ç½®æ–‡ä»¶çš„åˆ©å™¨ locateï¼šæ–‡ä»¶æŸ¥æ‰¾ï¼ŒåŸºäºå†…ç½®æ•°æ®åº“ lessï¼šæ›´å¼ºå¤§çš„ more lsdï¼šæ›´å¥½çœ‹çš„ ls rangerï¼šç»ˆç«¯å¯è§†åŒ–æ–‡ä»¶ç®¡ç† rename/reprenï¼šæ‰¹é‡é‡å‘½åæ–‡ä»¶ rsyncï¼šé€šè¿‡ ssh æˆ–æœ¬åœ°æ–‡ä»¶ç³»ç»ŸåŒæ­¥æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ zï¼šå¿«é€Ÿè·³è½¬ç›®å½•å·¥å…·ï¼Œå¯æ›¿ä»£ autojump ç®¡é“ä¸æ­£åˆ™ |, \u003e, \u003c, \u003e\u003e, \u003c\u003c\nack\nawk\ngrep/egrep\nsed\nsort\nuniq\nç³»ç»Ÿä¿¡æ¯ dmesgï¼šå¼•å¯¼åŠç³»ç»Ÿé”™è¯¯ä¿¡æ¯ sysctlï¼š åœ¨å†…æ ¸è¿è¡Œæ—¶åŠ¨æ€åœ°æŸ¥çœ‹å’Œä¿®æ”¹å†…æ ¸çš„è¿è¡Œå‚æ•° hdparmï¼šSATA/ATA ç£ç›˜æ›´æ”¹åŠæ€§èƒ½åˆ†æ lsblkï¼šåˆ—å‡ºå—è®¾å¤‡ä¿¡æ¯ï¼šä»¥æ ‘å½¢å±•ç¤ºä½ çš„ç£ç›˜ä»¥åŠç£ç›˜åˆ†åŒºä¿¡æ¯ lshwï¼Œlscpuï¼Œlspciï¼Œlsusb å’Œ dmidecodeï¼šæŸ¥çœ‹ç¡¬ä»¶ä¿¡æ¯ï¼ŒåŒ…æ‹¬ CPUã€BIOSã€RAIDã€æ˜¾å¡ã€USBè®¾å¤‡ç­‰ lsmod å’Œ modinfoï¼šåˆ—å‡ºå†…æ ¸æ¨¡å—ï¼Œå¹¶æ˜¾ç¤ºå…¶ç»†èŠ‚ iostatï¼šç¡¬ç›˜ä½¿ç”¨çŠ¶æ€ mpstatï¼š CPU ä½¿ç”¨çŠ¶æ€ vmstatï¼š å†…å­˜ä½¿ç”¨çŠ¶æ€ lsofï¼šåˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶çš„å·¥å…·ä»¥åŠæŸ¥çœ‹ç«¯å£ä¿¡æ¯ dstatï¼šç³»ç»ŸçŠ¶æ€æŸ¥çœ‹ glancesï¼šé«˜å±‚æ¬¡çš„å¤šå­ç³»ç»Ÿæ€»è§ˆ htopï¼štop çš„åŠ å¼ºç‰ˆ ä»»åŠ¡ç®¡ç† nohup disown cron ç½‘ç»œç®¡ç† ip/ifconfig dig netstat ssï¼šå¥—æ¥å­—æ•°æ® host å’Œ digï¼šDNS æŸ¥æ‰¾ lsof -i: mtrï¼šæ›´å¥½çš„ç½‘ç»œè°ƒè¯•è·Ÿè¸ªå·¥å…· wireshark å’Œ tsharkï¼šæŠ“åŒ…å’Œç½‘ç»œè°ƒè¯•å·¥å…· ngrepï¼šç½‘ç»œå±‚çš„ grep ç‰ˆæœ¬æ§åˆ¶ git å†·é—¨ä½†æœ‰ç”¨ exprï¼šè®¡ç®—è¡¨è¾¾å¼æˆ–æ­£åˆ™åŒ¹é… m4ï¼šç®€å•çš„å®å¤„ç†å™¨ yesï¼šå¤šæ¬¡æ‰“å°å­—ç¬¦ä¸² calï¼šæ¼‚äº®çš„æ—¥å† envï¼šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼ˆè„šæœ¬æ–‡ä»¶ä¸­å¾ˆæœ‰ç”¨ï¼‰ printenvï¼šæ‰“å°ç¯å¢ƒå˜é‡ï¼ˆè°ƒè¯•æ—¶æˆ–åœ¨å†™è„šæœ¬æ–‡ä»¶æ—¶å¾ˆæœ‰ç”¨ï¼‰ lookï¼šæŸ¥æ‰¾ä»¥ç‰¹å®šå­—ç¬¦ä¸²å¼€å¤´çš„å•è¯æˆ–è¡Œ cutï¼Œpaste å’Œ joinï¼šæ•°æ®ä¿®æ”¹ fmtï¼šæ ¼å¼åŒ–æ–‡æœ¬æ®µè½ prï¼šå°†æ–‡æœ¬æ ¼å¼åŒ–æˆé¡µï¼åˆ—å½¢å¼ foldï¼šåŒ…è£¹æ–‡æœ¬ä¸­çš„å‡ è¡Œ columnï¼šå°†æ–‡æœ¬æ ¼å¼åŒ–æˆå¤šä¸ªå¯¹é½ã€å®šå®½çš„åˆ—æˆ–è¡¨æ ¼ expand å’Œ unexpandï¼šåˆ¶è¡¨ç¬¦ä¸ç©ºæ ¼ä¹‹é—´è½¬æ¢ nlï¼šæ·»åŠ è¡Œå· seqï¼šæ‰“å°æ•°å­— bcï¼šè®¡ç®—å™¨ factorï¼šåˆ†è§£å› æ•° gpgï¼šåŠ å¯†å¹¶ç­¾åæ–‡ä»¶ toeï¼šterminfo å…¥å£åˆ—è¡¨ ncï¼šç½‘ç»œè°ƒè¯•åŠæ•°æ®ä¼ è¾“ socatï¼šå¥—æ¥å­—ä»£ç†ï¼Œä¸ netcat ç±»ä¼¼ slurmï¼šç½‘ç»œæµé‡å¯è§†åŒ– ddï¼šæ–‡ä»¶æˆ–è®¾å¤‡é—´ä¼ è¾“æ•°æ® fileï¼šç¡®å®šæ–‡ä»¶ç±»å‹ treeï¼šä»¥æ ‘çš„å½¢å¼æ˜¾ç¤ºè·¯å¾„å’Œæ–‡ä»¶ï¼Œç±»ä¼¼äºé€’å½’çš„ ls statï¼šæ–‡ä»¶ä¿¡æ¯ timeï¼šæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶è®¡ç®—æ‰§è¡Œæ—¶é—´ timeoutï¼šåœ¨æŒ‡å®šæ—¶é•¿èŒƒå›´å†…æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶åœ¨è§„å®šæ—¶é—´ç»“æŸååœæ­¢è¿›ç¨‹ lockfileï¼šä½¿æ–‡ä»¶åªèƒ½é€šè¿‡ rm -f ç§»é™¤ logrotateï¼š åˆ‡æ¢ã€å‹ç¼©ä»¥åŠå‘é€æ—¥å¿—æ–‡ä»¶ watchï¼šé‡å¤è¿è¡ŒåŒä¸€ä¸ªå‘½ä»¤ï¼Œå±•ç¤ºç»“æœå¹¶ï¼æˆ–é«˜äº®æœ‰æ›´æ”¹çš„éƒ¨åˆ† when-changedï¼šå½“æ£€æµ‹åˆ°æ–‡ä»¶æ›´æ”¹æ—¶æ‰§è¡ŒæŒ‡å®šå‘½ä»¤ã€‚å‚é˜… inotifywait å’Œ entrã€‚ tacï¼šåå‘è¾“å‡ºæ–‡ä»¶ shufï¼šæ–‡ä»¶ä¸­éšæœºé€‰å–å‡ è¡Œ commï¼šä¸€è¡Œä¸€è¡Œçš„æ¯”è¾ƒæ’åºè¿‡çš„æ–‡ä»¶ stringsï¼šä»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŠ½å–æ–‡æœ¬ trï¼šè½¬æ¢å­—æ¯ iconv æˆ– uconvï¼šæ–‡æœ¬ç¼–ç è½¬æ¢ split å’Œ csplitï¼šåˆ†å‰²æ–‡ä»¶ spongeï¼šåœ¨å†™å…¥å‰è¯»å–æ‰€æœ‰è¾“å…¥ï¼Œåœ¨è¯»å–æ–‡ä»¶åå†å‘åŒä¸€æ–‡ä»¶å†™å…¥æ—¶æ¯”è¾ƒæœ‰ç”¨ï¼Œä¾‹å¦‚ grep -v something some-file | sponge some-file unitsï¼šå°†ä¸€ç§è®¡é‡å•ä½è½¬æ¢ä¸ºå¦ä¸€ç§ç­‰æ•ˆçš„è®¡é‡å•ä½ï¼ˆå‚é˜… /usr/share/units/definitions.unitsï¼‰ apgï¼šéšæœºç”Ÿæˆå¯†ç  xzï¼šé«˜æ¯”ä¾‹çš„æ–‡ä»¶å‹ç¼© lddï¼šåŠ¨æ€åº“ä¿¡æ¯ nmï¼šæå– obj æ–‡ä»¶ä¸­çš„ç¬¦å· ab æˆ– wrkï¼šweb æœåŠ¡å™¨æ€§èƒ½åˆ†æ straceï¼šè°ƒè¯•ç³»ç»Ÿè°ƒç”¨ csshï¼šå¯è§†åŒ–çš„å¹¶å‘ shell lastï¼šç™»å…¥è®°å½• wï¼šæŸ¥çœ‹å¤„äºç™»å½•çŠ¶æ€çš„ç”¨æˆ· idï¼šç”¨æˆ·/ç»„ ID ä¿¡æ¯ sarï¼šç³»ç»Ÿå†å²æ•°æ® iftop æˆ– nethogsï¼šå¥—æ¥å­—åŠè¿›ç¨‹çš„ç½‘ç»œåˆ©ç”¨æƒ…å†µ fortuneï¼Œddate å’Œ slï¼šé¢ï¼Œè¿™ä¸»è¦å–å†³äºä½ æ˜¯å¦è®¤ä¸ºè’¸æ±½ç«è½¦å’Œè«åå…¶å¦™çš„åäººåè¨€æ˜¯å¦â€œæœ‰ç”¨â€ ","description":"","tags":["cmdline-tool","terminal"],"title":"é…ç½®å®Œå…¨å‘½ä»¤è¡Œç¯å¢ƒæŒ‡å—","uri":"/blog/posts/Linux/summary-of-command-line-tools-under-linuxlinux/"},{"categories":["Web"],"content":"Django é¡¹ç›®çš„å®¹å™¨åŒ–å®è·µ Python web çš„éƒ¨ç½²ç¯å¢ƒï¼Œå¾€å¾€éœ€è¦å¤šç§æœåŠ¡é…åˆæ­å»ºï¼Œè¿™ç§éå¸¸é€‚åˆä½¿ç”¨ Docker æ¥è¿›è¡Œéƒ¨ç½²ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªåˆ©ç”¨ Dockerfile å’Œ docker-compose æ‰€éƒ¨ç½²çš„ Django é¡¹ç›®\né¡¹ç›®ç»“æ„ ","description":"","tags":["django","docker"],"title":"Django é¡¹ç›®çš„å®¹å™¨åŒ–å®è·µ","uri":"/blog/posts/Web/django-project-containerization-practice/"},{"categories":null,"content":"Jenkins Testlink Plugin æºç ç¬”è®° éœ€æ±‚ Testlink çš„ testcase å¯ä»¥é€šè¿‡ Jenkins å»æ‰§è¡Œï¼Œå½“ Jenkins job æ‰§è¡Œå®Œä¹‹åï¼Œå¯ä»¥å°†æ‰§è¡Œç»“æœä¿å­˜åˆ° Testlink ä¸­ã€‚\njenkins ä¸­ testlink plugin ä»…ä»…å¯ä»¥åœ¨ freestyle é¡¹ç›®ç±»å‹ä¸­ä½¿ç”¨ï¼Œä½†ç›®å‰å¤§å¤šæ•°çš„ job å·²ç»è½¬ç§»åˆ° pipeline ç±»å‹ï¼Œæ‰€ä»¥ testlink plugin æ”¯æŒ pipeline æ˜¯ä¸€ä¸ªè‡ªç„¶çš„éœ€è¦ã€‚\næ€è·¯ é¦–å…ˆæŸ¥åˆ°å®˜æ–¹ Testlink-plugin çš„ repo https://github.com/jenkinsci/testlink-plugin\npull åˆ°æœ¬åœ°æŸ¥çœ‹ä¸€ä¸‹é¡¹ç›®ç»“æ„\n1 2 3 4 5 6 7 8 9 â”œâ”€â”€ pom.xml â”œâ”€â”€ src\tâ”‚Â â”œâ”€â”€ main â”‚Â â”‚Â â”œâ”€â”€ java â”‚Â â”‚Â â”œâ”€â”€ resources â”‚Â â”‚Â â””â”€â”€ webapp â”‚Â â””â”€â”€ test â”‚Â â”œâ”€â”€ java â”‚Â â””â”€â”€ resources å…¶ä¸­ä¸»è¦ä»£ç å­˜æ”¾åœ¨ src/main/hudson/plugins/testlink ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 â”œâ”€â”€ AbstractTestLinkBuilder.java â”œâ”€â”€ AbstractTestLinkProjectAction.java â”œâ”€â”€ GraphHelper.java â”œâ”€â”€ Report.java â”œâ”€â”€ TestLinkBuildAction.java â”œâ”€â”€ TestLinkBuilder.java â”œâ”€â”€ TestLinkBuilderDescriptor.java â”œâ”€â”€ TestLinkInstallation.java â”œâ”€â”€ TestLinkJunitWrapper.java â”œâ”€â”€ TestLinkProjectAction.java â”œâ”€â”€ TestLinkResult.java â”œâ”€â”€ TestLinkSite.java â”œâ”€â”€ result â”‚Â â”œâ”€â”€ AbstractJUnitResultSeeker.java â”‚Â â”œâ”€â”€ AbstractTAPFileNameResultSeeker.java â”‚Â â”œâ”€â”€ AbstractTestNGResultSeeker.java â”‚Â â”œâ”€â”€ JUnitCaseClassNameResultSeeker.java â”‚Â â”œâ”€â”€ JUnitCaseNameResultSeeker.java â”‚Â â”œâ”€â”€ JUnitMethodNameResultSeeker.java â”‚Â â”œâ”€â”€ JUnitSuiteNameResultSeeker.java â”‚Â â”œâ”€â”€ ResultSeeker.java â”‚Â â”œâ”€â”€ ResultSeekerDescriptor.java â”‚Â â”œâ”€â”€ ResultSeekerException.java â”‚Â â”œâ”€â”€ TAPFileNameMultiTestPointsResultSeeker.java â”‚Â â”œâ”€â”€ TAPFileNameResultSeeker.java â”‚Â â”œâ”€â”€ TestCaseWrapper.java â”‚Â â”œâ”€â”€ TestNGClassNameResultSeeker.java â”‚Â â”œâ”€â”€ TestNGMethodNameDataProviderNameResultSeeker.java â”‚Â â”œâ”€â”€ TestNGMethodNameResultSeeker.java â”‚Â â””â”€â”€ TestNGSuiteNameResultSeeker.java â””â”€â”€ util â”œâ”€â”€ ExecutionOrderComparator.java â””â”€â”€ TestLinkHelper.java ç°åœ¨å¯ä»¥æ¥å¯¹ä»£ç è¿›è¡Œåˆ†æäº†ï¼Œé¦–å…ˆæˆ‘ä»¬å¯»æ‰¾åˆ°è°ƒç”¨çš„å…¥å£ TestlinkBuilder.java\nå®šä½åˆ° perfrom() å‡½æ•°\n1 2 3 public boolean perform(AbstractBuild\u003c?, ?\u003e build, Launcher launcher, BuildListener listener) throws InterruptedException, IOException { // function body\t} å¯ä»¥çœ‹åˆ°å…¥å‚åˆ—è¡¨ï¼š\nAbstractBuild\u003c?, ?\u003e build\nLauncher\nBuildListener æ¥ä¸‹æ¥çœ‹å‡½æ•°ä½“å†…å®¹ï¼š\n1 2 3 4 5 6 7 // TestLink installation listener.getLogger().println(Messages.TestLinkBuilder_PreparingTLAPI()); final TestLinkInstallation installation = DESCRIPTOR .getInstallationByTestLinkName(this.testLinkName); if (installation == null) { throw new AbortException(Messages.TestLinkBuilder_InvalidTLAPI()); } TestlinkInstallation ä¿å­˜ configuration é‡Œé¢å¯¹ Testlink çš„é…ç½®ä¿¡æ¯:\nåŒ…æ‹¬ name, url, devKey, testlinkJavaAPIPr\toperties\næ¥ä¸‹æ¥æ˜¯åˆå§‹åŒ–å…¶ä»–çš„ä¸œè¥¿\n1 2 3 4 5 6 7 8 9 10 TestLinkHelper.setTestLinkJavaAPIProperties(installation.getTestLinkJavaAPIProperties(), listener); final TestLinkSite testLinkSite; final TestCaseWrapper[] automatedTestCases; final String testLinkUrl = installation.getUrl(); final String testLinkDevKey = installation.getDevKey(); TestPlan testPlan; listener.getLogger().println(Messages.TestLinkBuilder_UsedTLURL(testLinkUrl)); ... testLinkSite = this.getTestLinkSite(testLinkUrl, testLinkDevKey, testProjectName, testPlanName, platformName, buildName, buildCustomFields, buildNotes); TestlinkSite æˆå‘˜é‡Œæœ‰ TestlinkAPI, å¯ä»¥é€šè¿‡ä¼ å…¥ configuration é‡Œé¢æ‰€è®¾ç½®çš„å‚æ•°å¯¹ Testlink è¿›è¡Œæ“ä½œã€‚\n1 2 3 4 5 6 7 8 9 10 final String[] testCaseCustomFieldsNames = TestLinkHelper.createArrayOfCustomFieldsNames(build.getBuildVariableResolver(), build.getEnvironment(listener), this.getCustomFields()); // Array of automated test cases TestCase[] testCases = testLinkSite.getAutomatedTestCases(testCaseCustomFieldsNames); // Retrieve custom fields in test plan final String[] testPlanCustomFieldsNames = TestLinkHelper.createArrayOfCustomFieldsNames(build.getBuildVariableResolver(), build.getEnvironment(listener), this.getTestPlanCustomFields()); testPlan = testLinkSite.getTestPlanWithCustomFields(testPlanCustomFieldsNames); // Transforms test cases into test case wrappers automatedTestCases = this.transform(testCases); è·å– CustomFields ï¼Œ é€šè¿‡TestlinkSite æ‹¿åˆ°å¯¹åº”çš„ (List)Testcaseï¼Œè½¬æ¢ä¸º(List)TestlinkWrapper , é’ˆå¯¹å…¶è¿›è¡Œäº†ä¸€å±‚å°è£…ï¼Œå…·ä½“ç»†èŠ‚çœ‹ result/TestcaseWrapper.java.\n1 2 3 4 5 6 for(TestCaseWrapper tcw : automatedTestCases) { testLinkSite.getReport().addTestCase(tcw); if(LOGGER.isLoggable(Level.FINE)) { LOGGER.log(Level.FINE, \"TestLink automated test case ID [\" + tcw.getId() + \"], name [\" +tcw.getName()+ \"]\"); } } TestSiteä¸­æœ‰æˆå‘˜ Reportï¼Œç”¨æ¥å­˜å‚¨åŸºæœ¬çš„ Testcaseï¼Œä»¥åŠ TestStatus è¿™äº›ä¿¡æ¯\n1 2 3 4 5 6 if(getResultSeekers() != null) { for (ResultSeeker resultSeeker : getResultSeekers()) { LOGGER.log(Level.INFO, \"Seeking test results. Using: \" + resultSeeker.getDescriptor().getDisplayName()); resultSeeker.seek(automatedTestCases, build, build.getWorkspace(), launcher, listener, testLinkSite); } } ResultSeeker é€šè¿‡æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹å¾—åˆ°çš„ *report.xml æ–‡ä»¶è§£æå¾—åˆ°ç›¸åº” Testcase çš„æ‰§è¡Œç»“æœã€‚\n1 2 3 4 5 6 final Report report = testLinkSite.getReport(); report.tally(); ... final TestLinkResult result = new TestLinkResult(report); final TestLinkBuildAction buildAction = new TestLinkBuildAction(result); build.addAction(buildAction); æœ€åä¸€æ­¥ï¼Œç”Ÿæˆ TestlinkReportï¼Œè¿™é‡Œçš„å¯¹åº”çš„æ˜¯ Jenkins æ˜¾ç¤ºçš„reportï¼Œè€Œä¸æ˜¯ TestlinkAPI çš„ reportã€‚\næ‰§è¡Œé€»è¾‘ç»“æŸã€‚\nåè®° åœ¨å®Œæˆè¿™ç¯‡æ–‡ç« ä¹‹å‰ï¼Œæˆ‘å¯¹äºèƒ½å¦æ¸…æ™°çš„è¡¨è¾¾å‡ºæˆ‘çš„åˆ†ææœ‰å¾ˆå¤§çš„æ€€ç–‘ã€‚æˆ‘ä¹‹å‰ä¹Ÿæ›¾é˜…è¯»è¿‡æºç ï¼Œæ˜¯å…³äºæ•°æ®ç»“æ„çš„ã€‚é’ˆå¯¹å¤§çš„ï¼Œäº’ç›¸æœ‰ä¾èµ–çš„ï¼Œä»¥ä¸€å®šä»£ç è§„æ¨¡çš„ï¼Œæˆ‘ä¸æ›¾åˆ†æè¿‡ã€‚\nåœ¨é˜…è¯»æºç çš„æ—¶å€™ï¼Œè·å¾—äº†ä»¥ä¸‹å‡ ä¸ªå°çš„çŸ¥è¯†ç‚¹\nä»å…¥å£åˆ°å„ä¸ªæ¨¡å—çš„è°ƒç”¨ï¼Œæ˜¯é˜…è¯»æºç çš„è„‰ç»œ ä¸è¦ä¸€å¼€å§‹çº ç»“äºç»†èŠ‚ã€‚å¤§è‡´äº†è§£å„ä¸ªåŠŸèƒ½æ¨¡å—çš„ä½œç”¨å°±è¡Œ è‰¯å¥½çš„æŠ½è±¡èƒ½åŠ›æ˜¯å…³é”®æŠ€èƒ½ ","description":"","tags":null,"title":"Jenkins Testlink Plugin æºç ç¬”è®°","uri":"/blog/posts/jenkins-testlink-plugin-source-notes/"},{"categories":null,"content":"Jenkins æœåŠ¡æ— æ³•å¯åŠ¨æ’é”™æŒ‡åŒ— é—®é¢˜å®šä½ start service:\nservice jenkins start then check service status:\nservice jenkins status for detail log info:\njournalctl -xe -u jenkins.service\nå¸¸è§åŸå›  ç«¯å£äº‰ç”¨\nå¦‚æœ jenkins æœåŠ¡ç«¯å£åœ¨ 8080ï¼Œå¯ä»¥æŸ¥çœ‹ 8080 ç«¯å£æ˜¯å¦è¢«å…¶ä»–æœåŠ¡æ‰€å ç”¨\nsudo lsof -i:8080\nå‡è®¾æ˜¯è¢«ä¸€ä¸ªå« http-alt çš„æœåŠ¡å ç”¨äº†ï¼Œæ¥ä¸‹æ¥æŠŠ 8080 ç«¯å£çš„æœåŠ¡ kill æ‰\nsudo htop\nè¿™é‡ŒåŠ  sudo æ˜¯ä¸ºäº†ä¸º htop é‡Œé¢ kill èµ‹äºˆ root æƒé™\n/http-alt æŸ¥æ‰¾åˆ°æœåŠ¡ï¼Œå¯èƒ½æœ‰å¤šè¡Œï¼Œæ‘ä¸‹ F5 sort ä¸‹ï¼Œæ‰¾åˆ°çˆ¶è¿›ç¨‹\nå†æ‘ä¸‹ F9 å‘é€ kill ä¿¡å·\næœ€åæ‘ä¸‹ 9\nç›¸å½“äºæ‰§è¡Œ kill PID -9\nHave fun\n","description":"","tags":null,"title":"Jenkins æœåŠ¡æ— æ³•å¯åŠ¨æ’é”™æŒ‡åŒ—","uri":"/blog/posts/jenkins-service-cannot-be-started/"},{"categories":null,"content":"k8s ç¯å¢ƒæ­å»º Intro å…³äºç»„ç»‡ä¸»é¢˜ï¼Œæ´»åŠ¨ç›¸å…³ä»‹ç»\nå‰æœŸå‡†å¤‡ ç¡¬ä»¶è¦æ±‚\nmasterèŠ‚ç‚¹ å†…å­˜2æ ¸3G(æœ€å°2G) nodeèŠ‚ç‚¹ å†…å­˜2æ ¸2G å…¶ä¸­å¯ä»¥\næ­å»ºè¿‡ç¨‹ é…ç½® etc/host\n1 2 3 172.19.0.21 debian-21 172.19.0.22 debian-22 172.19.0.23 debian-23 é…ç½® ssh\napt install openssh-server vim /etc/ssh/sshd_config PermitRootLogin yes\nå¼€å¯ ipv4 çš„ forwardæœºåˆ¶\n1 2 3 vim /etc/sysctl.conf net.ipv4.ip_forward=1 sysctl --system å…³é—­ swap\nswapoff -a\nå®‰è£… runtime ï¼ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦å®‰è£…ï¼‰\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 apt install \\ apt-transport-https \\ ca-certificates \\ curl \\ gnupg-agent \\ software-properties-common curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - add-apt-repository \\ \"deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/debian \\ $(lsb_release -cs) \\ stable\" apt update apt install docker-ce docker-ce-cli containerd.io é…ç½® docker\nä¿®æ”¹dockeré…ç½®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 vim /etc/docker/daemon.json { \"registry-mirrors\": [ \"https://dockerhub.azk8s.cn\", \"https://reg-mirror.qiniu.com\" ], \"exec-opts\": [\"native.cgroupdriver=systemd\"], \"log-driver\": \"json-file\", \"log-opts\": { \"max-size\": \"100m\" }, \"insecure-registries\": [\"0.0.0.0/0\"], \"storage-driver\": \"overlay2\" } Kubernates ç»„ä»¶\nMaster ç»„ä»¶\nProtocol Direction Port Range Purpose Used By TCP InBound 6443* Kubernetes API server All TCP InBound 2379-2380 etcd server client API kube-apiserver, etcd TCP InBound 10250 Kubelet API Self, Control plane TCP InBound 10251 kube-scheduler Self TCP InBound 10252 kube-controller-manager Self Nodes ç»„ä»¶\nProtocol Direction Port Range Purpose Used By TCP InBound 10250 Kubelet API Self, Control plane TCP InBound 30000-32767 NodePort Services All å®‰è£… kebulet kubeadm kubectl ï¼ˆmasterã€nodeèŠ‚ç‚¹éƒ½éœ€è¦å®‰è£…ï¼‰\n1 2 3 4 5 6 7 8 apt-get update \u0026\u0026 apt-get install -y apt-transport-https curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - cat \u003c\u003cEOF \u003e/etc/apt/sources.list.d/kubernetes.list deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main EOF apt-get update apt-get install -y kubelet kubeadm kubectl åœ¨ master èŠ‚ç‚¹\n1 kubeadm init --apiserver-advertise-address 172.19.0.21 --pod-network-cidr 10.10.0.0/16 --service-cidr 10.11.0.0/16 --kubernetes-version=v1.15.3 --dry-run k8sä¸­è¦æ³¨æ„ä¸€ä¸‹å‡ ä¸ªç½‘ç»œ:\næœºå™¨çš„ç½‘ç»œ podçš„ç½‘ç»œ é›†ç¾¤çš„ç½‘ç»œ ","description":"","tags":null,"title":"k8s ç¯å¢ƒæ­å»º","uri":"/blog/posts/k8s-environment-construction/"},{"categories":null,"content":"å…³äº Jenkins ä¸ Python Unittest é›†æˆçš„å®è·µ é—®é¢˜åœºæ™¯ unittest åœ¨ python ä¸­å¾—åˆ°äº†å¾ˆå¥½çš„æ”¯æŒï¼Œ Jenkins ä½œä¸ºè‡ªåŠ¨åŒ–å·¥å…·ï¼Œå¯ä»¥æ ¹æ® DSL å†™å‡ºçš„ job è‡ªåŠ¨è¿›è¡Œè°ƒåº¦ä¸æ‰§è¡Œã€‚\nè¿™é‡Œå°†æŠŠä¸¤è€…ç»“åˆèµ·æ¥ï¼Œè‡ªåŠ¨æ‰§è¡Œå•å…ƒæµ‹è¯•ã€‚\nç¯å¢ƒæ­å»º install jenkins by docker make jenkins node have python python lib: xmlrunnser jenkins plugins æ„å»ºè¿‡ç¨‹ Pipeline\nPython TestCasae\næµ‹è¯•ç»“æœä¸æŠ¥å‘Š ","description":"","tags":["jenkins","unittest","python"],"title":"å…³äº Jenkins ä¸ Python Unittest é›†æˆçš„å®è·µ","uri":"/blog/posts/practice-on-the-integration-of-jenkins-and-python-unittest/"},{"categories":["Python"],"content":"\nABC(Abstract Base Class) æŠ½è±¡åŸºç±»ã€‚\nè¦äº†è§£ä¸ºä»€ä¹ˆ Python è¦è®¾è®¡è¿™ä¸ªï¼Œéœ€è¦å…ˆäº†è§£åˆ°å‡ ä¸ªæ¦‚å¿µã€‚\né¸­å­ç±»å‹ æ¥å£åè®® ç»§æ‰¿ ä¸ collections.abc ç›¸å…³çš„æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š\nabc.py\n_collections_abc.py\nå…¶ä¸­ abc.py å®šä¹‰äº† ABCMeta å’Œ ABC ç±»ï¼Œå’Œä¸€äº›è£…é¥°å™¨ï¼š\nå‡½æ•°è£…é¥°å™¨ï¼šabstractmethod\nè£…é¥°å™¨ç±»ï¼šabstractclassmethodï¼Œabstractstaticmethodï¼Œabstractproperty\nABCMeta ç±»æ˜¯å…ƒç±»ï¼Œç”¨æ¥æè¿°å’Œç”Ÿæˆ ABC ç±»ã€‚\nä»£ç ä¸é•¿ï¼Œå»é™¤ debug çš„ä¸€äº›æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 class ABCMeta(type): \"\"\"Metaclass for defining Abstract Base Classes (ABCs). å®šä¹‰ ABC çš„å…ƒç±» ç”¨æ­¤å…ƒç±»åˆ›å»º ABCï¼ŒæŠ½è±¡åŸºç±»èƒ½è¢«ç›´æ¥ç”¨ä½œå­ç±»ï¼Œè¡Œä¸ºåƒ mix-inã€‚ä»¥åŠå¯ä»¥ Use this metaclass to create an ABC. An ABC can be subclassed directly, and then acts as a mix-in class. You can also register unrelated concrete classes (even built-in classes) and unrelated ABCs as 'virtual subclasses' -- these and their descendants will be considered subclasses of the registering ABC by the built-in issubclass() function, but the registering ABC won't show up in their MRO (Method Resolution Order) nor will method implementations defined by the registering ABC be callable (not even via super()). \"\"\" def __new__(mcls, name, bases, namespace, **kwargs): cls = super().__new__(mcls, name, bases, namespace, **kwargs) _abc_init(cls) return cls def register(cls, subclass): \"\"\"Register a virtual subclass of an ABC. Returns the subclass, to allow usage as a class decorator. \"\"\" return _abc_register(cls, subclass) def __instancecheck__(cls, instance): \"\"\"Override for isinstance(instance, cls).\"\"\" return _abc_instancecheck(cls, instance) def __subclasscheck__(cls, subclass): \"\"\"Override for issubclass(subclass, cls).\"\"\" return _abc_subclasscheck(cls, subclass) class ABC(metaclass=ABCMeta): \"\"\"Helper class that provides a standard way to create an ABC using inheritance. \"\"\" __slots__ = () ABCMeta ç”Ÿæˆ ABC ç±»æ˜¯é€šè¿‡ _abc_init(cls)ï¼Œåœ¨åˆ›å»ºå®ä¾‹çš„è¿‡ç¨‹ä¸­ï¼Œæ”¹å˜äº†ç”Ÿæˆç±»çš„å±æ€§ã€‚\nABCMeata é‡å†™äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œå¯ä»¥è¢«æ³¨å†Œä¸ºè™šæ‹Ÿå­ç±»ï¼Œè¿™å°±æ˜¯æŠ½è±¡åŸºç±»çš„å…¨éƒ¨ä½œç”¨ã€‚\n","description":"","tags":null,"title":"é˜…è¯» Python æºç ï¼šcollections.abc","uri":"/blog/posts/Python/pythonpython-source-code-collectionsabc/"},{"categories":["Python"],"content":"ç”¨ Python å®ç° LAN æ‰«æå·¥å…· æ ‘è“æ´¾æ²¡è£… GUIï¼Œæ’ä¸Šç½‘çº¿åæ‰¾ä¸åˆ° IP\nå½“ç„¶æœ‰å¾ˆå¤šç§æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªåœºæ™¯\narp -a å¯ä»¥æŸ¥çœ‹æ‰€åœ¨å±€åŸŸç½‘é‡Œæ‰€æœ‰çš„è®¾å¤‡ IP ä¸ MAC nmap å¦‚æœåœ¨ Mac æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ APPStore ä¸‹è½½ LANScan\nè¿™é‡Œå†™ä¸€ä¸ªç®€å•çš„ python è„šæœ¬æ¥è¾¾åˆ°ç›¸ä¼¼çš„æ•ˆæœã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 #!/usr/bin/env python3 # -*- coding: UTF-8 -*- \"\"\" æ‰«æç½‘å…³æ‰€åœ¨å­ç½‘ Host ä¿¡æ¯ \"\"\" import os import sys import netifaces import nmap from collections import namedtuple from prettytable import PrettyTable def switch_root(): \"\"\" æå‡åˆ°rootæƒé™ \"\"\" if os.geteuid(): args = [sys.executable] + sys.argv # ä¸‹é¢ä¸¤ç§å†™æ³•ï¼Œä¸€ç§ä½¿ç”¨suï¼Œä¸€ç§ä½¿ç”¨sudoï¼Œéƒ½å¯ä»¥ # os.execlp('su', 'su', '-c', ' '.join(args)) os.execlp('sudo', 'sudo', *args) # ä»æ­¤å¤„å¼€å§‹æ˜¯æ­£å¸¸çš„ç¨‹åºé€»è¾‘ print('Running at root privilege.') def get_gateway(): \"\"\" è·å–é»˜è®¤ç½‘å…³ \"\"\" return netifaces.gateways()['default'][netifaces.AF_INET][0] def lan_scan(gateway): nm = nmap.PortScanner() infos = [] lan_net = gateway + '/24' scan_rst = nm.scan(lan_net, arguments='-sn') scanstats = scan_rst['nmap']['scanstats'] for host in sorted(nm.all_hosts(), key=lambda x: int(x.split('.')[-1])): addr = scan_rst['scan'][host]['addresses']['ipv4'] mac = scan_rst['scan'][host]['addresses'].get('mac', 'None') hostname = scan_rst['scan'][host]['hostnames'][0]['name'] vendor = scan_rst['scan'][host]['vendor'].get(mac, 'None') info = [addr, mac, hostname, vendor] infos.append(info) return infos def print_table(ips_info): table = PrettyTable(['index', 'addr', 'mac', 'hostname', 'vendor']) table.board = True for i, info in enumerate(ips_info): table.add_row([i] + info) print(table) def main(): switch_root() print_table(lan_scan(get_gateway())) if __name__ == \"__main__\": main() å¦‚æœæƒ³è¦ç”Ÿæˆæ¶µç›–æ›´å¤šä¿¡æ¯çš„è¡¨æ ¼ï¼Œéœ€è¦è°ƒæ•´ nm.scan() é‡Œçš„ arguments å‚æ•°å†…å®¹ã€‚\n","description":"","tags":["network"],"title":"ç”¨ Python å®ç° LAN æ‰«æå·¥å…·","uri":"/blog/posts/Python/use-python-to-implement-lan-scanning-tool/"},{"categories":["Python"],"content":"æœ¬æ¬¡ share ä»‹ç»å¦‚ä½•å†™å‡ºæ›´ pythonic çš„ python ä»£ç ã€‚\nä»ä¸¤ä¸ªæ–¹é¢åˆ‡å…¥:\nç¬¬ä¸€ä¸ªæ–¹é¢æ˜¯ä»‹ç» python çš„ä»£ç é£æ ¼è§„èŒƒï¼Œä»¥ç›®å‰å®è·µä¸­äº‹å®è§„èŒƒ pep8 ä¸ºæ ‡å‡†ã€‚\nç¬¬äºŒä¸ªæ–¹é¢æ˜¯ä»‹ç» python çš„ä¸€äº›è¯­è¨€ç‰¹æ€§ï¼Œå¦‚ä½•åˆ©ç”¨è¿™äº›ç‰¹å†™ç¼–å†™æ›´ä¼˜é›…çš„ python ä»£ç \n[toc]\n1. PEP 8: Style Guide for Python Code ä»¥ä¸‹æ‰€æœ‰å†…å®¹åŒ…å«åœ¨å®˜æ–¹ PEP(Python Enhancement Proposals) é“¾æ¥ä¸º [pep8][https://www.python.org/dev/peps/pep-0008/]\nç®€è¦ç‰ˆæœ¬\nä»£ç ç¼–æ’\nç¼©è¿›ã€‚4ä¸ªç©ºæ ¼çš„ç¼©è¿›ï¼ˆç¼–è¾‘å™¨éƒ½å¯ä»¥å®Œæˆæ­¤åŠŸèƒ½ï¼‰ï¼Œä¸ä½¿ç”¨Tapï¼Œæ›´ä¸èƒ½æ··åˆä½¿ç”¨Tapå’Œç©ºæ ¼\né’ˆå¯¹ä¸åŒç¼–è¾‘å™¨å…¼å®¹æ€§ï¼Œå¯¹ tab å¯èƒ½æœ‰ä¸åŒçš„æ ‡å‡†ï¼Œå¯¼è‡´æ ·å¼ä¸ç»Ÿä¸€ã€‚\næ¯è¡Œæœ€å¤§é•¿åº¦79ï¼Œæ¢è¡Œå¯ä»¥ä½¿ç”¨åæ–œæ ï¼Œæœ€å¥½ä½¿ç”¨åœ†æ‹¬å·ã€‚æ¢è¡Œç‚¹è¦åœ¨æ“ä½œç¬¦çš„åè¾¹æ•²å›è½¦ã€‚\næ—©æœŸ unix ä¸»æœºç»ˆç«¯åªèƒ½æ˜¾ç¤º 80 ä¸ªå­—ç¬¦ã€‚\né€šè¿‡é™åˆ¶æ‰€éœ€çš„ç¼–è¾‘å™¨çª—å£å®½åº¦ï¼Œå¯ä»¥å¹¶æ’æ‰“å¼€å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨åœ¨ç›¸é‚»åˆ—ä¸­æ˜¾ç¤ºä¸¤ä¸ªç‰ˆæœ¬çš„ä»£ç æŸ¥çœ‹å·¥å…·æ—¶ï¼Œæ•ˆæœå¾ˆå¥½ã€‚\nç±»å’Œtop-levelå‡½æ•°å®šä¹‰ä¹‹é—´ç©ºä¸¤è¡Œï¼›\nç±»ä¸­çš„æ–¹æ³•å®šä¹‰ä¹‹é—´ç©ºä¸€è¡Œï¼›\nå‡½æ•°å†…é€»è¾‘æ— å…³æ®µè½ä¹‹é—´ç©ºä¸€è¡Œï¼›\nå…¶ä»–åœ°æ–¹å°½é‡ä¸è¦å†ç©ºè¡Œã€‚\næ–‡æ¡£ç¼–æ’\næ¨¡å—å†…å®¹çš„é¡ºåºï¼š\næ¨¡å—è¯´æ˜å’Œdocstring\nimport\nglobals\u0026constants\nå…¶ä»–å®šä¹‰ã€‚\nå…¶ä¸­importéƒ¨åˆ†ï¼ŒåˆæŒ‰æ ‡å‡†ã€ä¸‰æ–¹å’Œè‡ªå·±ç¼–å†™é¡ºåºä¾æ¬¡æ’æ”¾ï¼Œä¹‹é—´ç©ºä¸€è¡Œã€‚\nä¸è¦åœ¨ä¸€å¥importä¸­å¤šä¸ªåº“ï¼Œæ¯”å¦‚import os, sysä¸æ¨èã€‚ å¦‚æœé‡‡ç”¨from XX import XXå¼•ç”¨åº“ï¼Œå¯ä»¥çœç•¥â€˜module.â€™ï¼Œéƒ½æ˜¯å¯èƒ½å‡ºç°å‘½åå†²çªï¼Œè¿™æ—¶å°±è¦é‡‡ç”¨import XXã€‚\nå¦‚æœæœ‰å‘½åå†²çªã€‚å¯ä»¥ä½¿ç”¨ from X import Y as Z\nç©ºæ ¼çš„ä½¿ç”¨ æ€»ä½“åŸåˆ™ï¼Œé¿å…ä¸å¿…è¦çš„ç©ºæ ¼ã€‚\nå„ç§å³æ‹¬å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚ é€—å·ã€å†’å·ã€åˆ†å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚ å‡½æ•°çš„å·¦æ‹¬å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚å¦‚Func(1)ã€‚ åºåˆ—çš„å·¦æ‹¬å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚å¦‚list[2]ã€‚ æ“ä½œç¬¦å·¦å³å„åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œä¸è¦ä¸ºäº†å¯¹é½å¢åŠ ç©ºæ ¼ã€‚ å‡½æ•°é»˜è®¤å‚æ•°ä½¿ç”¨çš„èµ‹å€¼ç¬¦å·¦å³çœç•¥ç©ºæ ¼ã€‚ ä¸è¦å°†å¤šå¥è¯­å¥å†™åœ¨åŒä¸€è¡Œï¼Œå°½ç®¡ä½¿ç”¨â€˜ï¼›â€™å…è®¸ã€‚ if/for/whileè¯­å¥ä¸­ï¼Œå³ä½¿æ‰§è¡Œè¯­å¥åªæœ‰ä¸€å¥ï¼Œä¹Ÿå¿…é¡»å¦èµ·ä¸€è¡Œã€‚ å‘½åè§„èŒƒ æ€»ä½“åŸåˆ™ï¼Œæ–°ç¼–ä»£ç å¿…é¡»æŒ‰ä¸‹é¢å‘½åé£æ ¼è¿›è¡Œï¼Œç°æœ‰åº“çš„ç¼–ç å°½é‡ä¿æŒé£æ ¼ã€‚\nå°½é‡å•ç‹¬ä½¿ç”¨å°å†™å­—æ¯â€˜lâ€™ï¼Œå¤§å†™å­—æ¯â€˜Oâ€™ç­‰å®¹æ˜“æ··æ·†çš„å­—æ¯ã€‚ æ¨¡å—å‘½åå°½é‡çŸ­å°ï¼Œä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ åŒ…å‘½åå°½é‡çŸ­å°ï¼Œä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œä¸å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ ç±»çš„å‘½åä½¿ç”¨CapWordsçš„æ–¹å¼ï¼Œæ¨¡å—å†…éƒ¨ä½¿ç”¨çš„ç±»é‡‡ç”¨_CapWordsçš„æ–¹å¼ã€‚_ å¼‚å¸¸å‘½åä½¿ç”¨CapWords+Erroråç¼€çš„æ–¹å¼ã€‚ å…¨å±€å˜é‡å°½é‡åªåœ¨æ¨¡å—å†…æœ‰æ•ˆï¼Œç±»ä¼¼Cè¯­è¨€ä¸­çš„staticã€‚å®ç°æ–¹æ³•æœ‰ä¸¤ç§ï¼Œä¸€æ˜¯__all__æœºåˆ¶;äºŒæ˜¯å‰ç¼€ä¸€ä¸ªä¸‹åˆ’çº¿ å‡½æ•°å‘½åä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ å¸¸é‡å‘½åä½¿ç”¨å…¨éƒ¨å¤§å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ ç±»çš„å±æ€§ï¼ˆæ–¹æ³•å’Œå˜é‡ï¼‰å‘½åä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ ç±»çš„å±æ€§æœ‰3ç§ä½œç”¨åŸŸpublicã€non-publicå’Œsubclass APIï¼Œå¯ä»¥ç†è§£æˆC++ä¸­çš„publicã€privateã€protectedï¼Œnon-publicå±æ€§å‰ï¼Œå‰ç¼€ä¸€æ¡ä¸‹åˆ’çº¿ã€‚ ç±»çš„å±æ€§è‹¥ä¸å…³é”®å­—åå­—å†²çªï¼Œåç¼€ä¸€ä¸‹åˆ’çº¿ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ç¼©ç•¥ç­‰å…¶ä»–æ–¹å¼ã€‚ ä¸ºé¿å…ä¸å­ç±»å±æ€§å‘½åå†²çªï¼Œåœ¨ç±»çš„ä¸€äº›å±æ€§å‰ï¼Œå‰ç¼€ä¸¤æ¡ä¸‹åˆ’çº¿ã€‚æ¯”å¦‚ï¼šç±»Fooä¸­å£°æ˜__a,è®¿é—®æ—¶ï¼Œåªèƒ½é€šè¿‡Foo._Foo__aï¼Œé¿å…æ­§ä¹‰ã€‚å¦‚æœå­ç±»ä¹Ÿå«Fooï¼Œé‚£å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚ ç±»çš„æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯selfï¼Œè€Œé™æ€æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯clsã€‚ æ³¨é‡Š æ€»ä½“åŸåˆ™ï¼Œé”™è¯¯çš„æ³¨é‡Šä¸å¦‚æ²¡æœ‰æ³¨é‡Šã€‚æ‰€ä»¥å½“ä¸€æ®µä»£ç å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯è¦ä¿®æ”¹æ³¨é‡Šï¼ æ³¨é‡Šå¿…é¡»ä½¿ç”¨è‹±æ–‡ï¼Œæœ€å¥½æ˜¯å®Œæ•´çš„å¥å­ï¼Œé¦–å­—æ¯å¤§å†™ï¼Œå¥åè¦æœ‰ç»“æŸç¬¦ï¼Œç»“æŸç¬¦åè·Ÿä¸¤ä¸ªç©ºæ ¼ï¼Œå¼€å§‹ä¸‹ä¸€å¥ã€‚å¦‚æœæ˜¯çŸ­è¯­ï¼Œå¯ä»¥çœç•¥ç»“æŸç¬¦ã€‚\nå—æ³¨é‡Šï¼Œåœ¨ä¸€æ®µä»£ç å‰å¢åŠ çš„æ³¨é‡Šã€‚åœ¨â€˜#â€™ååŠ ä¸€ç©ºæ ¼ã€‚æ®µè½ä¹‹é—´ä»¥åªæœ‰â€˜#â€™çš„è¡Œé—´éš”ã€‚æ¯”å¦‚ï¼š # Description : Module config. # # Input : None # # Output : None è¡Œæ³¨é‡Šï¼Œåœ¨ä¸€å¥ä»£ç ååŠ æ³¨é‡Šã€‚æ¯”å¦‚ï¼šx = x + 1 # Increment x ä½†æ˜¯è¿™ç§æ–¹å¼å°½é‡å°‘ä½¿ç”¨ã€‚å¯ä»¥åœ¨ Magic Number æ—¶ä½¿ç”¨ã€‚ é¿å…æ— è°“çš„æ³¨é‡Šã€‚ æ–‡æ¡£æè¿° 1 ä¸ºæ‰€æœ‰çš„å…±æœ‰æ¨¡å—ã€å‡½æ•°ã€ç±»ã€æ–¹æ³•å†™docstringsï¼›éå…±æœ‰çš„æ²¡æœ‰å¿…è¦ï¼Œä½†æ˜¯å¯ä»¥å†™æ³¨é‡Šï¼ˆåœ¨defçš„ä¸‹ä¸€è¡Œï¼‰ã€‚ 2 å¦‚æœdocstringè¦æ¢è¡Œï¼Œå‚è€ƒå¦‚ä¸‹ä¾‹å­,è¯¦è§PEP 257\n1 2 3 4 5 \"\"\"Return a foobang Optional plotz says to frobnicate the bizbaz first. \"\"\" ç¼–ç å»ºè®®\nç¼–ç ä¸­è€ƒè™‘åˆ°å…¶ä»–pythonå®ç°çš„æ•ˆç‡ç­‰é—®é¢˜ï¼Œæ¯”å¦‚è¿ç®—ç¬¦â€˜+â€™åœ¨CPythonï¼ˆPythonï¼‰ä¸­æ•ˆç‡å¾ˆé«˜ï¼Œéƒ½æ˜¯Jythonä¸­å´éå¸¸ä½ï¼Œæ‰€ä»¥åº”è¯¥é‡‡ç”¨.join()çš„æ–¹å¼ã€‚ 2 å°½å¯èƒ½ä½¿ç”¨i\ns is notå–ä»£==ï¼Œæ¯”å¦‚if x is not None è¦ä¼˜äºif xã€‚ 3 ä½¿ç”¨åŸºäºç±»çš„å¼‚å¸¸ï¼Œæ¯ä¸ªæ¨¡å—æˆ–åŒ…éƒ½æœ‰è‡ªå·±çš„å¼‚å¸¸ç±»ï¼Œæ­¤å¼‚å¸¸ç±»ç»§æ‰¿è‡ªExceptionã€‚ 4 å¼‚å¸¸ä¸­ä¸è¦ä½¿ç”¨è£¸éœ²çš„exceptï¼Œexceptåè·Ÿå…·ä½“çš„exceptionsã€‚ 5 å¼‚å¸¸ä¸­tryçš„ä»£ç å°½å¯èƒ½å°‘ã€‚æ¯”å¦‚ï¼š\ntry: value = collection[key] except KeyError: return key_not_found(key) else: return handle_value(value) è¦ä¼˜äº try: # Too broad! return handle_value(collection[key]) except KeyError: # Will also catch KeyError raised by handle_value() return key_not_found(key) ä½¿ç”¨startswith() and endswith()ä»£æ›¿åˆ‡ç‰‡è¿›è¡Œåºåˆ—å‰ç¼€æˆ–åç¼€çš„æ£€æŸ¥ã€‚æ¯”å¦‚\nYes: if foo.startswith(â€˜barâ€™):ä¼˜äº No: if foo[:3] == â€˜barâ€™: - ä½¿ç”¨isinstance()æ¯”è¾ƒå¯¹è±¡çš„ç±»å‹ã€‚æ¯”å¦‚ Yes: if isinstance(obj, int): ä¼˜äº No: if type(obj) is type(1): åˆ¤æ–­åºåˆ—ç©ºæˆ–ä¸ç©ºï¼Œæœ‰å¦‚ä¸‹è§„åˆ™\nYes: if not seq: if seq: ä¼˜äº No: if len(seq) if not len(seq) å­—ç¬¦ä¸²ä¸è¦ä»¥ç©ºæ ¼æ”¶å°¾ã€‚\näºŒè¿›åˆ¶æ•°æ®åˆ¤æ–­ä½¿ç”¨ if boolvalueçš„æ–¹å¼ã€‚\n2.Effictive python åœ¨ç¬¬ä¸€éƒ¨åˆ†ä»‹ç»äº† Python Codestyle æ¥å—åº¦æœ€å¹¿æ³›çš„ pep8 åï¼Œè¦æƒ³èƒ½å¤Ÿå†™å‡º pythonic çš„ä»£ç ä»ç„¶æ˜¯ä¸å¤Ÿçš„ã€‚Python è¯­è¨€æœ‰ç€ä¸°å¯Œçš„è¯­æ³•ç‰¹æ€§ï¼Œèƒ½è®© Python ä»£ç ååˆ†ä¼˜é›…ã€‚\næ¥ä¸‹æ¥ä»‹ç»çš„è¿™éƒ¨åˆ†çš„å†…å®¹æ¥æºäº ã€Œ Effective Python ã€ã€‚\næœ¬æ¬¡åªä¼šä»‹ç»ä¸€éƒ¨åˆ†æœ‰ç”¨çš„ç‰¹æ€§ï¼Œç»“åˆå®é™…çš„ä¾‹å­æ¥å®Œæˆã€‚\nå†…ç½®åºåˆ—ç±»å‹æ¦‚è§ˆ å®¹å™¨åºåˆ—\nlistã€tuple å’Œ collections.deque è¿™äº›åºåˆ—èƒ½å­˜æ”¾ä¸åŒç±»å‹çš„æ•°æ®ã€‚ æ‰å¹³åºåˆ—\nstrã€bytesã€bytearrayã€memoryview å’Œ array.arrayï¼Œè¿™ç±»åºåˆ—åªèƒ½å®¹çº³ä¸€ç§ç±»å‹ã€‚ å®¹å™¨åºåˆ—å­˜æ”¾çš„æ˜¯å®ƒä»¬æ‰€åŒ…å«çš„ä»»æ„ç±»å‹çš„å¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œæ‰å¹³åºåˆ—é‡Œå­˜æ”¾çš„æ˜¯å€¼è€Œä¸æ˜¯å¼•ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œæ‰å¹³åºåˆ—å…¶å®æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ã€‚ç”±æ­¤å¯è§æ‰å¹³åºåˆ—å…¶å®æ›´åŠ ç´§å‡‘ï¼Œä½†æ˜¯å®ƒé‡Œé¢åªèƒ½å­˜æ”¾è¯¸å¦‚å­—ç¬¦ã€å­—èŠ‚å’Œæ•°å€¼è¿™ç§åŸºç¡€ç±»å‹ã€‚\nåºåˆ—ç±»å‹è¿˜èƒ½æŒ‰ç…§èƒ½å¦è¢«ä¿®æ”¹æ¥åˆ†ç±»ã€‚\nå¯å˜åºåˆ—\nlistã€bytearrayã€array.arrayã€collections.deque å’Œ memoryviewã€‚ ä¸å¯å˜åºåˆ—\ntupleã€str å’Œ bytes åˆ—è¡¨æ¨å¯¼å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼ åˆ—è¡¨æ¨å¯¼å’Œå¯è¯»æ€§ åˆ—è¡¨æ¨å¯¼æ˜¯æ„å»ºåˆ—è¡¨(list)çš„å¿«æ·æ–¹å¼ï¼Œç”Ÿæˆå™¨è¡¨è¾¾å¼ç”¨æ¥ç©¿ä»¶å…¶ä»–ä»»ä½•ç±»å‹çš„åºåˆ—ã€‚\n1 2 3 4 5 6 7 8 9 10 # æ¯”è¾ƒä¸¤æ®µä»£ç  symbols = 'abcde' codes = [] for symbol in symbols: codes.append(ord(symbol)) print(codes) codes = [ord(symbol) for symbol in symbols] print(codes) åˆ—è¡¨æ¨å¯¼èƒ½å¤Ÿæå‡å¯è¯»æ€§ã€‚ åªç”¨åˆ—è¡¨æ¨å¯¼æ¥åˆ›å»ºæ–°çš„åˆ—è¡¨ï¼Œå¹¶å°½é‡ä¿æŒç®€çŸ­ï¼ˆä¸è¦è¶…è¿‡ä¸€è¡Œï¼‰\nåˆ—è¡¨æ¨å¯¼åŒ filter å’Œ map çš„æ¯”è¾ƒ 1 2 3 4 5 6 7 symbols = 'abcde' beyond_ascii = [ord(s) for s in symbols if ord(s) \u003e 100] print(beyond_ascii) beyond_ascii = list(filter(lambda c: c \u003e 100, map(ord, symbols))) print(beyond_ascii) [101] [101] ç¬›å¡å°”ç§¯ 1 2 3 4 5 6 7 8 9 10 11 colors = ['black', 'white'] sizes = ['S', 'M', 'L'] tshirts = [(color, size) for color in colors for size in sizes] print(tshirts) tshirts = [(color, size) for size in sizes for color in colors] print(tshirts) # æ³¨æ„é¡ºåºæ˜¯ä¾ç…§ for-loop åµŒå¥—å…³ç³» [('black', 'S'), ('black', 'M'), ('black', 'L'), ('white', 'S'), ('white', 'M'), ('white', 'L')] [('black', 'S'), ('white', 'S'), ('black', 'M'), ('white', 'M'), ('black', 'L'), ('white', 'L')] ç”Ÿæˆå™¨è¡¨è¾¾å¼ åˆ—è¡¨æ¨å¯¼ä¸ç”Ÿæˆå™¨è¡¨è¾¾å¼çš„åŒºåˆ«ï¼š\nç”Ÿæˆå™¨è¡¨è¾¾å¼éµå®ˆå®ç°äº†è¿­ä»£å™¨æ¥å£ï¼Œå¯ä»¥é€ä¸ªåœ°äº§å‡ºå…ƒç´ ã€‚ åˆ—è¡¨æ¨å¯¼æ˜¯å…ˆå»ºç«‹ä¸€ä¸ªå®Œæ•´çš„åˆ—è¡¨ï¼Œå†å°†è¿™ä¸ªåˆ—è¡¨ä¼ é€’åˆ°æ„é€ å‡½æ•°é‡Œã€‚ è¯­æ³•ä¸Šè¿‘ä¼¼ï¼Œæ–¹æ‹¬å·æ¢æˆåœ†æ‹¬å· 1 2 3 4 5 # symbols = 'abcde' print(tuple(ord(symbol) for symbol in symbols)) import array print(array.array('I', (ord(symbol) for symbol in symbols))) å¦‚æœç”Ÿæˆå™¨è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­çš„å”¯ä¸€å‚æ•°ï¼Œåˆ™ä¸éœ€è¦é¢å¤–æ‹¬å· ç”Ÿæˆå™¨ä¼šåœ¨ for-loop è¿è¡Œæ—¶æ‰ç”Ÿæˆä¸€ä¸ªç»„åˆã€‚é€ä¸ªäº§å‡ºå…ƒç´  1 2 3 4 5 colors = ['black', 'white'] sizes = ['S', 'M', 'L'] for tshirt in ('%s %s' %(c, s) for c in colors for s in sizes): print(tshirt) black S black M black L white S white M white L å…ƒç¥–ä¸ä»…ä»…æ˜¯ä¸å¯å˜çš„åˆ—è¡¨ å…ƒç¥–ä¸è®°å½• å…ƒç¥–æ˜¯å¯¹æ•°æ®çš„è®°å½• å…ƒç¥–çš„ä½ç½®ä¿¡æ¯ä¸ºæ•°æ®èµ‹äºˆäº†æ„ä¹‰ã€‚å¯¹å…ƒç¥–å†…å…ƒç´ æ’åºï¼Œä½ç½®ä¿¡æ¯å°†ä¸¢å¤± 1 2 3 4 5 6 7 8 9 10 11 12 13 # LA å›½é™…æœºåœºç»çº¬åº¦ lax_coordinates = (33.9425, -118.408056) # åŸå¸‚ï¼Œå¹´ä»½ï¼Œäººå£ï¼ˆå•ä½ï¼šç™¾ä¸‡ï¼‰ï¼Œäººå£å˜åŒ–ï¼ˆå•ä½ï¼šç™¾åˆ†æ¯”ï¼‰ï¼Œé¢ç§¯ city, year, pop, chg, area = ('Tokyo', 2003, 32450, 0.66, 8014) # country_code, passport number traveler_ids = [('USA', '31195855'), ('BBA', 'CE342567'), ('ESP', 'XDA205856')] for passport in sorted(traveler_ids): print('%s%s' % passport) # æ‹†åŒ…ï¼ˆunpackingï¼‰ for country, _ in traveler_ids: print(country) BBACE342567 ESPXDA205856 USA31195855 USA BBA ESP å…ƒç¥–æ‹†åŒ… å¹³è¡Œèµ‹å€¼ 1 2 3 4 5 lax_coordinates = (33.9425, -118.408056) # å…ƒç¥–æ‹†åŒ… latitude, longtitude = lax_coordinates print(latitude) print(longtitude) 33.9425 -118.408056 äº¤æ¢å˜é‡å€¼ï¼Œä¸ä½¿ç”¨ä¸­é—´å˜é‡ 1 2 3 4 5 a = 3 b = 4 b, a = a, b print(a) print(b) 4 3 * è¿ç®—ç¬¦ï¼ŒæŠŠä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡æ‹†å¼€ä½œä¸ºå‡½æ•°å‚æ•° 1 2 3 4 5 6 7 8 divmod(20, 8) t = (20, 8) divmod(*t) quotient, remainder = divmod(*t) print(quotient) print(remainder) 2 4 å‡½æ•°ç”¨å…ƒç¥–å½¢å¼è¿”å›å¤šä¸ªå€¼ _ ç”¨ä½œå ä½ç¬¦ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†ä¸éœ€è¦çš„æ•°æ®\n1 2 3 4 import os _, filename = os.path.split('/home/xiao/.ssh/id_rsa.pub') print(filename) id_rsa.pub ç”¨* å¤„ç†çœä¸‹çš„å…ƒç´  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 a, b, *rest = range(5) print(a, b, rest) a, b, *rest = range(3) print(a, b, rest) a, b, *rest = range(2) print(a, b, rest) # * å‰ç¼€åªèƒ½ç”¨åœ¨ä¸€ä¸ªå˜é‡å‰ï¼Œè¯¥å˜é‡å¯å‡ºç°åœ¨èµ‹å€¼è¡¨è¾¾å¼ä¸­ä»»æ„ä½ç½® a, *body, c, d = range(5) print(a, body, c, d) *head, b, c, d = range(5) print(head, b, c, d) 0 1 [2, 3, 4] 0 1 [2] 0 1 [] 0 [1, 2] 3 4 [0, 1] 2 3 4 åµŒå¥—å…ƒç¥–æ‹†åŒ… 1 2 3 4 5 6 7 8 9 10 11 12 13 metro_areas = [ ('Tokyo', 'JP', 36.933, (35.689722, 139.691667)), # \u003c1\u003e ('Delhi NCR', 'IN', 21.935, (28.613889, 77.208889)), ('Mexico City', 'MX', 20.142, (19.433333, -99.133333)), ('New York-Newark', 'US', 20.104, (40.808611, -74.020386)), ('Sao Paulo', 'BR', 19.649, (-23.547778, -46.635833)), ] print('{:15} | {:^9} | {:^9}'.format('', 'lat.', 'long.')) fmt = '{:15} | {:9.4f} | {:9.4f}' for name, cc, pop, (latitude, longitude) in metro_areas: # \u003c2\u003e if longitude \u003c= 0: # \u003c3\u003e print(fmt.format(name, latitude, longitude)) | lat. | long. Mexico City | 19.4333 | -99.1333 New York-Newark | 40.8086 | -74.0204 Sao Paulo | -23.5478 | -46.6358 å°†å…ƒç¥–ä½œä¸ºè®°å½•ä»ç¼ºå°‘ä¸€ä¸ªåŠŸèƒ½ï¼šå­—æ®µå‘½å\nå…·åå…ƒç¥–(numedtuple) collections.namedtuple æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œç”¨æ¥æ„å»ºå¸¦å­—æ®µåçš„å…ƒç¥–å’Œä¸€ä¸ªæœ‰åå­—çš„\nnamedtuple æ„å»ºçš„ç±»çš„å®ä¾‹æ‰€æ¶ˆè€—çš„å†…å­˜å’Œå…ƒç¥–æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºå­—æ®µåéƒ½å­˜åœ¨å¯¹åº”çš„ç±»é‡Œã€‚ å®ä¾‹å’Œæ™®é€šçš„å¯¹è±¡å®ä¾‹å°ä¸€ç‚¹ï¼Œå› ä¸º Python ä¸ä¼šç”¨ __dict__ å­˜æ”¾å®ä¾‹çš„å±æ€§\n1 2 3 4 5 6 7 8 from collections import namedtuple # éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œç±»åå’Œç±»å„ä¸ªå­—æ®µçš„åå­— City = namedtuple('City', 'name country population coordinates') tokyo = City('Tokyo', 'JP', 36.933, (35.689722, 129.691667)) print(tokyo) print(tokyo.population) print(tokyo.coordinates) City(name='Tokyo', country='JP', population=36.933, coordinates=(35.689722, 129.691667)) 36.933 (35.689722, 129.691667) namedtuple é™¤äº†ä»æ™®é€šå…ƒç¥–ç»§æ‰¿çš„å±æ€§å¤–ï¼Œè¿˜æœ‰ä¸€äº›ä¸“æœ‰å±æ€§ã€‚ å¸¸ç”¨çš„æœ‰ï¼š\n_fields ç±»å±æ€§ _make(iterable) ç±»æ–¹æ³• _asdict() å®ä¾‹æ–¹æ³• 1 2 3 4 5 6 7 8 print(City._fields) LatLong = namedtuple('LatLong', 'lat long') delhi_data = ('Delhi NCR', 'IN', 21.935, LatLong(28.613889, 77.208889)) delhi = City._make(delhi_data) print(delhi._asdict()) for key, value in delhi._asdict().items(): print(key + ':', value) ('name', 'country', 'population', 'coordinates') OrderedDict([('name', 'Delhi NCR'), ('country', 'IN'), ('population', 21.935), ('coordinates', LatLong(lat=28.613889, long=77.208889))]) name: Delhi NCR country: IN population: 21.935 coordinates: LatLong(lat=28.613889, long=77.208889) åˆ‡ç‰‡ åœ¨ Python é‡Œ, åˆ—è¡¨ï¼ˆlistï¼‰ï¼Œå…ƒç¥–ï¼ˆtupleï¼‰å’Œå­—ç¬¦ä¸²ï¼ˆstrï¼‰è¿™ç±»åºåˆ—ç±»å‹éƒ½æ”¯æŒåˆ‡ç‰‡æ“ä½œ\nä¸ºä»€ä¹ˆåˆ‡ç‰‡çš„åŒºé—´ä¼šå¿½ç•¥æœ€åä¸€ä¸ªå…ƒç´  Python ä»¥0 ä½œä¸ºèµ·å§‹ä¸‹æ ‡ å½“åªæœ‰åä¸€ä¸ªä½ç½®ä¿¡æ¯æ—¶ï¼Œå¯ä»¥å¿«é€Ÿå¯¼å‡ºåˆ‡ç‰‡å’ŒåŒºé—´çš„å…ƒç´ æ•°é‡ å½“èµ·æ­¢ä½ç½®ä¿¡æ¯è¯¾ä»¶æ˜¯ï¼Œå¯ä»¥å¿«é€Ÿè®¡ç®—å‡ºåˆ‡ç‰‡å’ŒåŒºé—´çš„é•¿åº¦ ï¼ˆstop - startï¼‰ å¯åˆ©ç”¨ä»»æ„ä¸€ä¸ªä¸‹æ ‡æŠŠåºåˆ—åˆ†å‰²æˆä¸é‡å çš„ä¸¤éƒ¨åˆ†ã€‚my_list[:x] my_list[x:] 1 2 3 ### å¯¹å¯¹è±¡è¿›è¡Œåˆ‡ç‰‡ - å¯ä»¥é€šè¿‡ s[ağŸ…±ï¸c] çš„å½¢å¼å¯¹ s åœ¨ a å’Œ b åŒºé—´ä»¥ c ä¸ºé—´éš”å–å€¼ 1 2 3 4 s = 'bicycle' print(s[::3]) print(s[::-1]) print(s[::-2]) bye elcycib eccb å¤šç»´åˆ‡ç‰‡å’Œçœç•¥ [] è¿ç®—ç¬¦å¯ä»¥ä½¿ç”¨ä»¥é€—å·åˆ†å¼€çš„å¤šä¸ªç´¢å¼•æˆ–åˆ‡ç‰‡ã€‚\nå¦‚ a[i, j]ï¼Œa[m:n, k:1]å¾—åˆ°äºŒç»´åˆ‡ç‰‡\nè¦æ­£ç¡®å¤„ç†[] è¿ç®—ç¬¦ï¼Œå¯¹è±¡çš„ç‰¹æ®Šæ–¹æ³• __getitem__ï¼Œ__setitem__ éœ€è¦ä»¥å…ƒç¥–çš„å½¢å¼æ¥æ¥å— a[i, j]çš„ç´¢å¼•ã€‚\nç»™åˆ‡ç‰‡èµ‹å€¼ åˆ‡ç‰‡æ”¾åœ¨èµ‹å€¼è¯­å¥å·¦è¾¹ï¼Œæˆ–ä½œä¸º del æ“ä½œå¯¹è±¡ï¼Œå¯ä»¥å¯¹åºåˆ—è¿›è¡Œå«æ¥ã€åˆ‡é™¤æˆ–å°±åœ°ä¿®æ”¹\n1 2 3 4 5 6 7 8 9 10 11 12 13 l = list(range(10)) print(l) l[2:5] = [20, 30] print(l) del l[5:7] print(l) l[3::2] = [11, 22] print(l) # l[2:5] = 100 WRONG [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] [0, 1, 20, 30, 5, 6, 7, 8, 9] [0, 1, 20, 30, 5, 8, 9] [0, 1, 20, 11, 5, 22, 9] å¯¹åºåˆ—ä½¿ç”¨ + å’Œ * + å’Œ * ä¸ä¿®æ”¹åŸæœ‰çš„æ“ä½œå¯¹è±¡ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªæ–°çš„åºåˆ— 1 2 3 4 l = [1, 2, 3] print(l * 5) print(5 * 'abcd') [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3] abcdabcdabcdabcdabcd å»ºç«‹ç”±åˆ—è¡¨ç»„æˆçš„åˆ—è¡¨ a * nï¼Œå¦‚æœåœ¨åºåˆ— a ä¸­å­˜åœ¨å¯¹å…¶ä»–å¯å˜å˜é‡çš„å¼•ç”¨çš„è¯ï¼Œå¾—åˆ°çš„åºåˆ—ä¸­åŒ…å«çš„æ˜¯ n ä¸ªå¯¹æŒ‡å‘åŒä¸€åœ°å€çš„å¼•ç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 board = [['_'] * 3 for i in range(3)] # æ¢ä¸€ç§å½¢å¼ # board = [] # for i in range(3): # row = ['_'] * 3 # board.append(row) print(board) board[1][2] = 'X' print(board) # weird_board = [['_'] * 3] * 3 # æ¢ä¸€ç§å½¢å¼ weird_board = [] row = ['_'] * 3 for i in range(3): weird_board.append(row) weird_board[1][2] = 'O' # ä¼šå‘ç° 3 ä¸ªæŒ‡å‘åŒä¸€åˆ—è¡¨çš„å¼•ç”¨ print(weird_board) [['_', '_', '_'], ['_', '_', '_'], ['_', '_', '_']] [['_', '_', '_'], ['_', '_', 'X'], ['_', '_', '_']] [['_', '_', 'O'], ['_', '_', 'O'], ['_', '_', 'O']] åºåˆ—çš„å¢é‡èµ‹å€¼ +=ã€*= += èƒŒåçš„ç‰¹æ®Šæ–¹æ³•æ˜¯ __iadd__ æ–¹æ³•ï¼Œæ²¡æœ‰åˆ™é€€ä¸€æ­¥è°ƒç”¨ __add__ åŒç† *= çš„ç‰¹æ®Šæ–¹æ³•æ˜¯ __imul__ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 l = [1, 2, 3] print(id(l)) l *= 2 print(l) # åˆ—è¡¨ID æ— æ”¹å˜ print(id(l)) t = (1, 2, 3) print(id(t)) t *= 2 print(t) # æ–°å…ƒç¥–è¢«åˆ›å»º print(id(t)) 4534358344 [1, 2, 3, 1, 2, 3] 4534358344 4536971408 (1, 2, 3, 1, 2, 3) 4546754024 list.sortæ–¹æ³•å’Œå†…ç½®å‡½æ•°sorted list.sort ä¼šå°±åœ°æ’åºåˆ—è¡¨ï¼Œæ–¹æ³•è¿”å›å€¼ä¸º None sorted ä¼šæ–°å»ºä¸€ä¸ªåˆ—è¡¨ä½œä¸ºè¿”å›å€¼ ä¸¤ä¸ªæ–¹æ³•éƒ½æœ‰ reverse å’Œ key ä½œä¸ºå¯é€‰çš„å…³é”®å­—å‚æ•° reserve ä¸º True æ—¶ï¼Œé™åºè¾“å‡ºã€‚é»˜è®¤ä¸º false key åªæœ‰ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå°†è¢«ç”¨åœ¨åºåˆ—çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œå…¶ç»“æœä½œä¸ºæ’åºç®—æ³•ä¾èµ–çš„å¯¹æ¯”å…³é”®å­— ç”¨bisectç®¡ç†å·²æ’åºçš„åºåˆ— bisect æ¨¡å—æœ‰ä¸¤ä¸ªä¸»è¦å‡½æ•°ï¼š\nbisect insort éƒ½åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ³•æ¥åœ¨æœ‰åºåºåˆ—ä¸­æŸ¥æ‰¾æˆ–æ’å…¥äººå…ƒç´  ç”¨ bisect æ¥æœç´¢ bisect(haystack, needle) é»˜è®¤ä¸ºå‡åºï¼Œhaystack éœ€è¦ä¿æŒæœ‰åºã€‚ ä½¿ç”¨æ–¹æ³•ï¼š bisect(index, needle) æŸ¥æ‰¾ä½ç½® indexï¼Œå†ä½¿ç”¨ haystack.insert(index, needle) æ’å…¥æ–°å€¼\nä¹Ÿå¯ä»¥ç”¨ insort æ¥ä¸€æ­¥åˆ°ä½ï¼Œä¸”åè€…é€Ÿåº¦æ›´å¿«\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # BEGIN BISECT_DEMO import bisect import sys HAYSTACK = [1, 4, 5, 6, 8, 12, 15, 20, 21, 23, 23, 26, 29, 30] NEEDLES = [0, 1, 2, 5, 8, 10, 22, 23, 29, 30, 31] ROW_FMT = '{0:2d} @ {1:2d} {2}{0:\u003c2d}' def demo(bisect_fn): for needle in reversed(NEEDLES): position = bisect_fn(HAYSTACK, needle) # \u003c1\u003e offset = position * ' |' # \u003c2\u003e print(ROW_FMT.format(needle, position, offset)) # \u003c3\u003e if __name__ == '__main__': if sys.argv[-1] == 'left': # \u003c4\u003e bisect_fn = bisect.bisect_left else: bisect_fn = bisect.bisect print('DEMO:', bisect_fn.__name__) # \u003c5\u003e print('haystack -\u003e', ' '.join('%2d' % n for n in HAYSTACK)) demo(bisect_fn) # END BISECT_DEMO DEMO: bisect_right haystack -\u003e 1 4 5 6 8 12 15 20 21 23 23 26 29 30 31 @ 14 | | | | | | | | | | | | | |31 30 @ 14 | | | | | | | | | | | | | |30 29 @ 13 | | | | | | | | | | | | |29 23 @ 11 | | | | | | | | | | |23 22 @ 9 | | | | | | | | |22 10 @ 5 | | | | |10 8 @ 5 | | | | |8 5 @ 3 | | |5 2 @ 1 |2 1 @ 1 |1 0 @ 0 0 Array è™½ç„¶åˆ—è¡¨æ—¢çµæ´»åˆç®€å•ï¼Œä½†é¢å¯¹å„ç±»éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰æ›´å¥½çš„é€‰æ‹©ã€‚æ¯”å¦‚ï¼Œè¦å­˜æ”¾ 1000 ä¸‡ä¸ªæµ®ç‚¹æ•°çš„è¯ï¼Œæ•°ç»„ï¼ˆarrayï¼‰çš„æ•ˆç‡è¦é«˜å¾—å¤šï¼Œå› ä¸ºæ•°ç»„åœ¨èƒŒåå­˜çš„å¹¶ä¸æ˜¯ float å¯¹è±¡ï¼Œè€Œæ˜¯æ•°å­—çš„æœºå™¨ç¿»è¯‘ï¼Œä¹Ÿå°±æ˜¯å­—èŠ‚è¡¨è¿°ã€‚è¿™ä¸€ç‚¹å°±è·Ÿ C è¯­è¨€ä¸­çš„æ•°ç»„ä¸€æ ·ã€‚å†æ¯”å¦‚è¯´ï¼Œå¦‚æœéœ€è¦é¢‘ç¹å¯¹åºåˆ—åšå…ˆè¿›å…ˆå‡ºçš„æ“ä½œï¼Œdequeï¼ˆåŒç«¯é˜Ÿåˆ—ï¼‰çš„é€Ÿåº¦åº”è¯¥ä¼šæ›´å¿«ã€‚\narray.tofile å’Œ fromfile å¯ä»¥å°†æ•°ç»„ä»¥äºŒè¿›åˆ¶æ ¼å¼å†™å…¥æ–‡ä»¶ï¼Œé€Ÿåº¦è¦æ¯”å†™å…¥æ–‡æœ¬æ–‡ä»¶å¿«å¾ˆå¤šï¼Œæ–‡ä»¶çš„ä½“ç§¯ä¹Ÿå°ã€‚\nå¦å¤–ä¸€ä¸ªå¿«é€Ÿåºåˆ—åŒ–æ•°å­—ç±»å‹çš„æ–¹æ³•æ˜¯ä½¿ç”¨ pickleï¼ˆhttps://docs.python.org/3/library/pickle.htmlï¼‰æ¨¡å—ã€‚pickle.dump å¤„ç†æµ®ç‚¹æ•°ç»„çš„é€Ÿåº¦å‡ ä¹è·Ÿarray.tofile ä¸€æ ·å¿«ã€‚ä¸è¿‡å‰è€…å¯ä»¥å¤„ç†å‡ ä¹æ‰€æœ‰çš„å†…ç½®æ•°å­—ç±»å‹ï¼ŒåŒ…å«å¤æ•°ã€åµŒå¥—é›†åˆï¼Œç”šè‡³ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»ã€‚å‰ææ˜¯è¿™äº›ç±»æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«å¤æ‚çš„å®ç°ã€‚\narray å…·æœ‰ type code æ¥è¡¨ç¤ºæ•°ç»„ç±»å‹ï¼šå…·ä½“å¯è§ array æ–‡æ¡£.\nmemoryview memoryview.cast çš„æ¦‚å¿µè·Ÿæ•°ç»„æ¨¡å—ç±»ä¼¼ï¼Œèƒ½ç”¨ä¸åŒçš„æ–¹å¼è¯»å†™åŒä¸€å—å†…å­˜æ•°æ®ï¼Œè€Œä¸”å†…å®¹å­—èŠ‚ä¸ä¼šéšæ„ç§»åŠ¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import array arr = array.array('h', [1, 2, 3]) memv_arr = memoryview(arr) # æŠŠ signed short çš„å†…å­˜ä½¿ç”¨ char æ¥å‘ˆç° memv_char = memv_arr.cast('B') print('Short', memv_arr.tolist()) print('Char', memv_char.tolist()) memv_char[1] = 2 # æ›´æ”¹ array ç¬¬ä¸€ä¸ªæ•°çš„é«˜ä½å­—èŠ‚ # 0x1000000001 print(memv_arr.tolist(), arr) print('-' * 10) bytestr = b'123' # bytes æ˜¯ä¸å…è®¸æ›´æ”¹çš„ try: bytestr[1] = '3' except TypeError as e: print(repr(e)) memv_byte = memoryview(bytestr) print('Memv_byte', memv_byte.tolist()) # åŒæ ·è¿™å—å†…å­˜ä¹Ÿæ˜¯åªè¯»çš„ try: memv_byte[1] = 1 except TypeError as e: print(repr(e)) Deque collections.deque æ˜¯æ¯” list æ•ˆç‡æ›´é«˜ï¼Œä¸”çº¿ç¨‹å®‰å…¨çš„åŒå‘é˜Ÿåˆ—å®ç°ã€‚\né™¤äº† collections ä»¥å¤–ï¼Œä»¥ä¸‹ Python æ ‡å‡†åº“ä¹Ÿæœ‰å¯¹é˜Ÿåˆ—çš„å®ç°ï¼š\nqueue.Queue (å¯ç”¨äºçº¿ç¨‹é—´é€šä¿¡) multiprocessing.Queue (å¯ç”¨äºè¿›ç¨‹é—´é€šä¿¡) asyncio.Queue heapq ","description":"","tags":["python","codestyle"],"title":"å¦‚ä½•è®©ä½ çš„ä»£ç æ›´ Pythonic","uri":"/blog/posts/Python/make-your-code-more-pythonic/"},{"categories":["Python"],"content":"ä½¿ç”¨ Unittest ç»„ç»‡ TestCase çš„å·¥ç¨‹ç»“æ„ å•æ–‡ä»¶çš„ TestCase å¾ˆå®¹æ˜“è¢«æ‰§è¡Œï¼Œåªéœ€ç”¨æ‰§è¡Œå‘½ä»¤ python test_xxx.pyã€‚\néšç€ TestCase çš„å¢å¤šï¼Œæˆ‘ä»¬å¯èƒ½é¢å¯¹è¿™æ ·çš„æƒ…å†µï¼š\næ‰§è¡Œå¤šä¸ª TestCase ä½œä¸ºä¸€ç»„è¢«æ‰§è¡Œ æŒ‡å®šæŸä¸€äº› TestCase æ‰§è¡Œ æ­¤æ—¶æˆ‘ä»¬éœ€è¦æŠŠ TestCase æŒ‰ç…§ä¸€å®šå±‚æ¬¡ç»“æ„ç»„ç»‡ã€‚\nç¯å¢ƒ Python 3+ TestLoader åœ¨ import unittest æ—¶ï¼Œä¼šè‡ªåŠ¨å¯¼å…¥ TestLoader ç±»ï¼Œåœ¨ç±»ä¸­å°è£…äº† 5 ä¸­ç»„ç»‡ TestCase çš„æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 class TestLoader(object): \"\"\" è¯¥ç±»è´Ÿè´£æ ¹æ®å„ç§æ ‡å‡†åŠ è½½æµ‹è¯•å¹¶å°†å®ƒä»¬åŒ…è£…åœ¨TestSuiteä¸­ \"\"\" def loadTestsFromTestCase(self, testCaseClass): \"\"\" è¿”å›testCaseClassä¸­åŒ…å«çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹çš„å¥—ä»¶ \"\"\" def loadTestsFromModule(self, module, *args, pattern=None, **kws): \"\"\" è¿”å›ç»™å®šæ¨¡å—ä¸­åŒ…å«çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹çš„å¥—ä»¶ \"\"\" def loadTestsFromName(self, name, module=None): \"\"\" è¿”å›ç»™å®šç”¨ä¾‹åçš„æµ‹è¯•ç”¨ä¾‹çš„å¥—ä»¶ \"\"\" def loadTestsFromNames(self, names, module=None): \"\"\" è¿”å›ç»™å®šçš„ä¸€ç»„ç”¨ä¾‹åçš„æµ‹è¯•ç”¨ä¾‹çš„å¥—ä»¶ \"\"\" def discover(self, start_dir, pattern='test*.py', top_level_dir=None): \"\"\" æŸ¥æ‰¾å¹¶è¿”å›æŒ‡å®šçš„èµ·å§‹ç›®å½•ä¸­çš„æ‰€æœ‰æµ‹è¯•æ¨¡å—ï¼Œé€’å½’åˆ°å­ç›®å½•ä¸­ä»¥æŸ¥æ‰¾å®ƒä»¬å¹¶è¿”å›åœ¨å…¶ ä¸­æ‰¾åˆ°çš„æ‰€æœ‰æµ‹è¯•ã€‚ä»…åŠ è½½ä¸æ¨¡å¼åŒ¹é…çš„æµ‹è¯•æ–‡ä»¶ã€‚ å¿…é¡»å¯ä»¥ä»é¡¹ç›®çš„é¡¶å±‚å¯¼å…¥æµ‹è¯•æ¨¡å—ã€‚å¦‚æœèµ·å§‹ç›®å½•ä¸æ˜¯é¡¶çº§ç›®å½•ï¼Œåˆ™å¿…é¡»å•ç‹¬æŒ‡å®šé¡¶çº§ç›®å½•ã€‚ \"\"\" defaultTestLoader = TestLoader() \"\"\" defaultTestLoaderæ˜¯TestLoader()çš„å®ä¾‹å¯¹è±¡ \"\"\" Unittest ç»„ç»‡ TestCase çš„æ–¹å¼ å·¥ç¨‹ç›®å½• 1 2 3 4 5 6 7 8 9 10 test â”œâ”€â”€ run_from_discover.py â”œâ”€â”€ run_from_test_case_class.py â”œâ”€â”€ run_from_test_case_moudle.py â”œâ”€â”€ run_from_test_case_name.py â”œâ”€â”€ run_from_test_case_names.py â””â”€â”€ test_case â”œâ”€â”€ __init__.py â”œâ”€â”€ test_add.py â””â”€â”€ test_sub.py test_case ç”¨æ¥æ”¾ç½® TestCase çš„å®ç° test_case éœ€è¦ç»„ç»‡ä¸ºåŒ…ï¼ˆåŒ…å« __init__.pyï¼‰ run_from_*.py ä¸ºæµ‹è¯•æ‰§è¡Œå…¥å£ 1. åŠ è½½æµ‹è¯•ç±»ä¸­çš„ç”¨ä¾‹ 1 loadTestsFromTestCase(self, testCaseClass) ä½¿ç”¨loadTestsFromTestCaseè¿™ä¸ªæ–¹æ³•ï¼Œéœ€ä¼ å…¥unittestæµ‹è¯•ç±»çš„ç±»å ä»¥é¡¹ç›®ä¸ºä¾‹å­ï¼Œä¼ å…¥ testCaseClass ï¼šAddCase run_from_test_case_class.py\n1 2 3 4 5 6 7 8 # encoding:utf8 import unittest from test_case.test_add import AddCase cases = unittest.TestLoader().loadTestsFromTestCase(AddCase) runner = unittest.TextTestRunner(verbosity=2) runner.run(cases) è¿è¡Œ\n1 2 3 4 5 python run_from_test_case_class.py test_add_1 (test_case.test_add.AddCase) åŠ æ³•å†’çƒŸæµ‹è¯• ... ok test_add_2 (test_case.test_add.AddCase) ... FAIL 2ã€åŠ è½½æ¨¡å—ä¸­çš„æµ‹è¯•ç”¨ä¾‹ 1 loadTestsFromModule(self, module, *args, pattern=None, **kws) ä½¿ç”¨loadTestsFromModuleè¿™ä¸ªæ–¹æ³•ï¼Œéœ€ä¼ å…¥è¢«æµ‹è¯•æ¨¡å— ä»¥é¡¹ç›®ä¸ºä¾‹å­ï¼Œä¼ å…¥å‚æ•° module ï¼štest_add run_from_test_case_moudle.py\n1 2 3 4 5 6 7 8 # encoding:utf8 import unittest from test_case import test_add cases = unittest.TestLoader().loadTestsFromModule(test_add) runner = unittest.TextTestRunner(verbosity=2) runner.run(cases) è¿è¡Œ run_from_test_case_moudle.py\n1 python run_from_test_case_moudle.py è¿è¡Œç»“æœ\n1 2 3 test_add_1 (test_case.test_add.AddCase) åŠ æ³•å†’çƒŸæµ‹è¯• ... ok test_add_2 (test_case.test_add.AddCase) ... FAIL 3ã€åŠ è½½æŒ‡å®šçš„å•ä¸ªæµ‹è¯•ç”¨ä¾‹ 1 loadTestsFromName(self, name, module=None) ä½¿ç”¨loadTestsFromNameè¿™ä¸ªæ–¹æ³•ï¼Œéœ€ä¼ å…¥æµ‹è¯•ç”¨ä¾‹çš„æ–¹æ³•å ä¼ å…¥æµ‹è¯•ç”¨ä¾‹çš„æ–¹æ³•åæ ¼å¼ï¼šmoudleName.testCaseClassName.testCaseName ä»¥é¡¹ç›®ä¸ºä¾‹å­ï¼Œæˆ‘æƒ³æµ‹è¯•test_add.py é‡Œé¢çš„ç”¨ä¾‹ test_add_1 æˆ‘éœ€è¦ä¼ å…¥çš„å‚æ•° nameï¼štest_add.AddCase.test_add_1 loadTestsFromNameè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ sys.path é‡Œé¢çš„è·¯å¾„å»å¯»æ‰¾æµ‹è¯•æ¨¡å—test_add.py,ç„¶åå†å¯»æ‰¾æµ‹è¯•ç±»AddCase æœ€åå†å¯»æ‰¾æµ‹è¯•ç”¨ä¾‹test_add_1 run_from_case_name.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # encoding:utf8 import unittest import os import sys # è·å– \"how_to_run_test_case\" çš„ç»å¯¹è·¯å¾„ dir_run_test_case = os.path.dirname(os.path.abspath(__file__)) # è·å– \"test_case\" çš„ç»å¯¹è·¯å¾„ dir_test_case = dir_run_test_case + '/test_case' # æŠŠ \"test_case\" çš„ç»å¯¹è·¯å¾„ åŠ å…¥ sys.path sys.path.insert(0,dir_test_case) case= unittest.TestLoader().loadTestsFromName('test_add.AddCase.test_add_1') runner = unittest.TextTestRunner(verbosity=2) runner.run(cases) è¿è¡Œ run_from_case_name.py\n1 python run_from_case_name.py è¿è¡Œç»“æœ\n1 2 test_add_1 (test_add.AddCase) åŠ æ³•å†’çƒŸæµ‹è¯• ... ok 4ã€åŠ è½½æŒ‡å®šçš„å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ 1 loadTestsFromNames(self, names, module=None) ä½¿ç”¨loadTestsFromNamesè¿™ä¸ªæ–¹æ³•,éœ€è¦ä¼ å…¥ä¸€ä¸ªæ•°ç»„ æ•°ç»„é‡Œé¢é‡Œé¢çš„å…ƒç´ å¿…é¡»æ˜¯å­—ç¬¦ä¸² æ•°ç»„å…ƒç´ å¯ä»¥æ˜¯æ¨¡å—ã€ç±»ã€æ–¹æ³• æ•°ç»„å…ƒç´  - ä¼ å…¥æ ¼å¼1ï¼šmoudleName æ•°ç»„å…ƒç´  - ä¼ å…¥æ ¼å¼2ï¼šmoudleName.testCaseClassName æ•°ç»„å…ƒç´  - ä¼ å…¥æ ¼å¼3ï¼šmoudleName.testCaseClassName.testCaseName ä»¥é¡¹ç›®ä¸ºä¾‹ï¼Œæˆ‘æƒ³æµ‹è¯•test_add.py é‡Œé¢çš„ç”¨ä¾‹ test_add_1 ï¼Œä»¥åŠtest_sub.py é‡Œé¢çš„ç”¨ä¾‹ test_sub_1 æˆ‘éœ€è¦ä¼ å…¥çš„å‚æ•° namesï¼š['test_sub.SubCase.test_sub_2','test_add.AddCase.test_add_1'] loadTestsFromNamesè¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ sys.path é‡Œé¢çš„è·¯å¾„å»å¯»æ‰¾åŒ¹é…çš„æµ‹è¯•ç”¨ä¾‹ æ‰§è¡Œç”¨ä¾‹æ˜¯æ ¹æ®æ•°ç»„å…ƒç´ çš„çš„é¡ºåºæ‰§è¡Œ run_from_case_names.py\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # encoding:utf8 import unittest import sys import os # è·å– \"how_to_run_test_case\" çš„ç»å¯¹è·¯å¾„ dir_run_test_case = os.path.dirname(os.path.abspath(__file__)) # è·å– \"test_case\" çš„ç»å¯¹è·¯å¾„ dir_test_case = dir_run_test_case + '/test_case' # æŠŠ \"test_case\" çš„ç»å¯¹è·¯å¾„ åŠ å…¥ sys.path sys.path.insert(0,dir_test_case) cases = ['test_sub.SubCase.test_sub_1','test_add.AddCase.test_add_1'] suite = unittest.TestLoader().loadTestsFromNames(cases) runner = unittest.TextTestRunner(verbosity=2) runner.run(suite) è¿è¡Œ run_from_case_names.py\n1 python run_from_case_names.py è¿è¡Œç»“æœ\n1 2 3 4 test_sub_1 (test_sub.SubCase) å‡æ³•å†’çƒŸæµ‹è¯• ... ok test_add_1 (test_add.AddCase) åŠ æ³•å†’çƒŸæµ‹è¯• ... ok 5ã€åŠ è½½æŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ 1 discover(self, start_dir, pattern='test*.py', top_level_dir=None) start_dir ï¼š æŸ¥æ‰¾ç”¨ä¾‹çš„èµ·å§‹ç›®å½• pattern='test*py' : æŸ¥æ‰¾æ¨¡å—åä¸ºtestå¼€å¤´çš„pythonæ–‡ä»¶ top_level_dir=None ï¼šæµ‹è¯•æ¨¡å—é¡¶çº§ç›®å½• run_from_discover.py\n1 2 3 4 5 6 7 8 9 10 11 # encoding:utf8 import unittest import os dir_how_to_run_test_case = os.path.dirname(os.path.abspath(__file__)) dir_test_case = dir_how_to_run_test_case + '/test_case' cases = unittest.defaultTestLoader.discover(dir_test_case) runner = unittest.TextTestRunner(verbosity=2) runner.run(cases) è¿è¡Œ run_from_discover.py\n1 python run_from_discover.py è¿è¡Œç»“æœ\n1 2 3 4 5 6 test_add_1 (test_add.AddCase) åŠ æ³•å†’çƒŸæµ‹è¯• ... ok test_add_2 (test_add.AddCase) ... FAIL test_sub_1 (test_sub.SubCase) å‡æ³•å†’çƒŸæµ‹è¯• ... ok test_sub_2 (test_sub.SubCase) ... FAIL ","description":"","tags":["unitest"],"title":"ä½¿ç”¨ Unittest ç»„ç»‡ TestCase çš„å·¥ç¨‹ç»“æ„","uri":"/blog/posts/Python/organize-the-project-structure-of-testcase-in-unittest/"},{"categories":null,"content":"ä½¿ç”¨ Bashä¸¥æ ¼æ¨¡å¼ åŸæ–‡é“¾æ¥ï¼šUse Bash Strict Mode (Unless You Love Debugging)\nç¿»è¯‘ï¼šYueChuan\nåœ¨ Unix/Linux ç¯å¢ƒå¾ˆéš¾é¿å…ä¸ Bash è„šæœ¬æ‰“äº¤é“ï¼Œä¸€ä»½é«˜è´¨é‡ï¼Œå¯é ä¸”å¯ç»´æŠ¤çš„ Bash è„šæœ¬åº”è¯¥æ€ä¹ˆå†™ï¼Ÿ\næœ¬æ–‡å°†æä¾›ä¸€äº›æŠ€å·§å¸®åŠ©ä½ è§£å†³è¿™äº›é—®é¢˜...\nè®©æˆ‘ä»¬å¼€é—¨è§å±±ï¼Œç›´æ¥ä¸Š PUNCHLINEã€‚\nå¦‚æœä½ çš„ Bash è„šæœ¬ä»¥è¿™æ®µä»£ç å¼€å§‹ï¼Œå®ƒä»¬å°†å˜å¾—æ›´åŠ å¥å£®ï¼Œå¯é å’Œå¯ç»´æŠ¤ï¼š\n1 2 3 #!/bin/bash set -euo pipefail IFS=$'\\n\\t' [toc]\næˆ‘å°†æ­¤ç§°ä¸ºéå®˜æ–¹çš„ bashä¸¥æ ¼æ¨¡å¼ ã€‚\nè¿™å¯¼è‡´ bash çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè®¸å¤šç§ç±»çš„ç»†å¾®é”™è¯¯æ— æ³•å‡ºç°ã€‚æ‚¨å°†èŠ±è´¹æ›´å°‘çš„æ—¶é—´è¿›è¡Œè°ƒè¯•ï¼Œå¹¶é¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å‡ºç°æ„æƒ³ä¸åˆ°çš„å¤æ‚æƒ…å†µã€‚\nè¿™é‡Œæœ‰ä¸€ä¸ªçŸ­æœŸçš„å¼Šç«¯ï¼šè¿™äº›è®¾ç½®ä½¿æŸäº›å¸¸è§çš„ bash ä¹ æƒ¯ç”¨æ³•æ›´éš¾ä½¿ç”¨ã€‚å¤§å¤šæ•°æƒ…å†µéƒ½æœ‰ç®€å•çš„è§£å†³æ–¹æ³•ï¼Œè¯¦ç»†è¯´æ˜å¦‚ä¸‹ï¼šè·³è‡³ Issuesï¼†Solutionsã€‚\nä½†é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™äº›æ™¦æ¶©éš¾æ‡‚çš„è¡Œçš„å®é™…ä¸Šåšäº†ä»€ä¹ˆã€‚\nset è¯­å¥ è¿™äº›è¡Œæ•…æ„å¯¼è‡´è„šæœ¬å¤±è´¥ã€‚ç­‰ç­‰ï¼Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿç›¸ä¿¡æˆ‘ï¼Œè¿™æ˜¯ä¸€ä»¶å¥½äº‹ã€‚ä½¿ç”¨è¿™äº›è®¾ç½®ï¼ŒæŸäº›å¸¸è§é”™è¯¯å°†å¯¼è‡´è„šæœ¬ ç«‹å³ æ˜ç¡®ä¸”æ˜¾ç„¶åœ°å¤±è´¥ã€‚å¦åˆ™ï¼Œæ‚¨å°†æ”¶è·åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çˆ†ç‚¸åæ‰å‘ç°çš„éšè—é”™è¯¯ã€‚\nset -euo pipefail çš„ç¼©å†™ï¼š\n1 2 3 set -e set -u set -o pipefail è®©æˆ‘ä»¬åˆ†åˆ«çœ‹ä¸€ä¸‹ã€‚\nset -e set -e å¦‚æœä»»ä½•å‘½ä»¤[1] çš„é€€å‡ºçŠ¶æ€ä¸ºéé›¶ï¼Œåˆ™è¯¥é€‰é¡¹æŒ‡ç¤º bash ç«‹å³é€€å‡ºã€‚\næ‚¨ä¸æƒ³ä¸ºå‘½ä»¤è¡Œshellè®¾ç½®å®ƒï¼Œä½†æ˜¯åœ¨è„šæœ¬ä¸­å®ƒå¾ˆæœ‰å¸®åŠ©ã€‚åœ¨æ‰€æœ‰å¹¿æ³›ä½¿ç”¨çš„é€šç”¨ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæœªå¤„ç†çš„è¿è¡Œæ—¶é”™è¯¯ï¼ˆæ— è®ºæ˜¯Javaä¸­å¼•å‘çš„å¼‚å¸¸ï¼Œè¿˜æ˜¯Cä¸­çš„åˆ†æ®µé”™è¯¯ï¼Œè¿˜æ˜¯Pythonä¸­çš„è¯­æ³•é”™è¯¯ï¼‰éƒ½ç«‹å³åœæ­¢ç¨‹åºçš„æ‰§è¡Œï¼›éšåçš„è¡Œä¸æ‰§è¡Œã€‚\né»˜è®¤æƒ…å†µä¸‹ï¼Œbashæ‰€åšçš„æ²¡æœ‰åšåˆ°è¿™ä¸€ç‚¹ã€‚å¦‚æœæ‚¨åœ¨å‘½ä»¤è¡Œä¸Šä½¿ç”¨bashï¼Œåˆ™æ­¤é»˜è®¤è¡Œä¸ºæ­£æ˜¯æ‚¨æƒ³è¦çš„-æ‚¨ä¸å¸Œæœ›è¾“å…¥é”™è¯¯å°†æ‚¨æ³¨é”€ï¼ä½†æ˜¯åœ¨è„šæœ¬ä¸­ï¼Œæ‚¨çœŸçš„æƒ³è¦ç›¸åã€‚å¦‚æœè„šæœ¬ä¸­çš„ä¸€è¡Œå¤±è´¥ï¼Œä½†æœ€åä¸€è¡ŒæˆåŠŸï¼Œåˆ™æ•´ä¸ªè„šæœ¬å…·æœ‰æˆåŠŸçš„é€€å‡ºä»£ç ã€‚è¿™æ ·å¾ˆå®¹æ˜“é”™è¿‡è¯¥é”™è¯¯ã€‚\nåŒæ ·ï¼Œåœ¨å°†bashç”¨ä½œå‘½ä»¤è¡Œshellå¹¶å°†å…¶åœ¨è„šæœ¬ä¸­ä½¿ç”¨æ—¶ï¼Œæ‚¨æƒ³è¦çš„ä¸è¿™é‡Œä¸ä¸€è‡´ã€‚åœ¨è„šæœ¬ä¸­å®¹å¿é”™è¯¯è¦å¥½å¾—å¤šï¼Œè¿™å°±æ˜¯set -eç»™æ‚¨å¸¦æ¥çš„å¥½å¤„ã€‚\nset -u set -u å½±å“å˜é‡ã€‚\nè®¾ç½®åï¼Œå¯¹æ‚¨ä¹‹å‰æœªå®šä¹‰çš„ä»»ä½•å˜é‡çš„å¼•ç”¨( $* å’Œ $@ é™¤å¤–) éƒ½ä¼šå‘ç”Ÿé”™è¯¯ï¼Œå¹¶å¯¼è‡´ç¨‹åºç«‹å³é€€å‡ºã€‚å‡ºäºå„ç§ç¼˜ç”±ï¼ŒPythonï¼ŒCï¼ŒJavaç­‰è¯­è¨€éƒ½å…·æœ‰ç›¸åŒçš„è¡Œä¸ºæ–¹å¼ã€‚å…¶ä¸­ä¹‹ä¸€å°±æ˜¯é”™åˆ«å­—æ²¡æœ‰æ„è¯†åˆ°å°±ä¸ä¼šåˆ›å»ºæ–°å˜é‡ã€‚ä¾‹å¦‚ï¼š\n1 2 3 4 #!/bin/bash firstName=\"Aaron\" fullName=\"$firstname Maxwell\" echo \"$fullName\" èŠ±ä¸€ç‚¹æ—¶é—´çœ‹çœ‹ã€‚çœ‹åˆ°é”™è¯¯äº†å—ï¼Ÿ\nç¬¬ä¸‰è¡Œçš„å³ä¾§æ˜¾ç¤ºâ€œ firstnameâ€ï¼ˆå…¨éƒ¨å°å†™ï¼‰ï¼Œè€Œä¸ç”¨é©¼å³°å¼çš„â€œ firstNameâ€ã€‚å¦‚æœæ²¡æœ‰-ué€‰é¡¹ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªæ— æç¤ºé”™è¯¯ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨-ué€‰é¡¹ï¼Œè„šæœ¬å°†ä»¥é€€å‡ºä»£ç 1é€€å‡ºè¯¥è¡Œï¼Œå¹¶å°†æ¶ˆæ¯â€œ firstnameï¼šunbound variableâ€è¾“å‡ºåˆ°stderrã€‚\nè¿™å°±æ˜¯æ‚¨æƒ³è¦çš„ï¼šè®©å®ƒæ˜ç¡®ä¸”ç«‹å³å¤±è´¥ï¼Œè€Œä¸æ˜¯åˆ›å»ºå¯èƒ½ä¸ºæ—¶å·²æ™šçš„ç»†å¾®é”™è¯¯ã€‚\nset -o pipefail æ­¤è®¾ç½®å¯é˜²æ­¢æ©ç›–ç®¡é“ä¸­çš„é”™è¯¯ã€‚å¦‚æœç®¡é“ä¸­çš„ä»»ä½•å‘½ä»¤å¤±è´¥ï¼Œåˆ™è¯¥è¿”å›ç å°†ç”¨ä½œæ•´ä¸ªç®¡é“çš„è¿”å›ç ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç®¡é“çš„è¿”å›ç æ˜¯æœ€åä¸€ä¸ªå‘½ä»¤çš„è¿”å›ç -å³ä½¿æˆåŠŸã€‚æƒ³è±¡ä¸€ä¸‹åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°åŒ¹é…è¡Œçš„æ’åºåˆ—è¡¨ï¼š\n1 2 3 4 % grep some-string /non/existent/file | sort grep: /non/existent/file: No such file or directory echo $? 0 %æ˜¯bashæç¤º\nåœ¨è¿™é‡Œï¼Œgrepçš„é€€å‡ºä»£ç ä¸º2ï¼Œå°†é”™è¯¯æ¶ˆæ¯å†™å…¥stderrï¼Œå°†ç©ºå­—ç¬¦ä¸²å†™å…¥stdoutã€‚ç„¶åï¼Œæ­¤ç©ºå­—ç¬¦ä¸²é€šè¿‡sortä¼ é€’ï¼Œè¯¥å­—ç¬¦ä¸²æ„‰å¿«åœ°æ¥å—å®ƒä½œä¸ºæœ‰æ•ˆè¾“å…¥ï¼Œå¹¶è¿”å›çŠ¶æ€ä»£ç 0ã€‚è¿™å¯¹äºå‘½ä»¤è¡Œå¾ˆå¥½ï¼Œä½†å¯¹shellè„šæœ¬åˆ™ä¸åˆ©ï¼šæ‚¨å‡ ä¹è‚¯å®šå¸Œæœ›è„šæœ¬ç«‹å³é€€å‡ºå…·æœ‰éé›¶çš„é€€å‡ºä»£ç ...å°±åƒè¿™æ ·ï¼š\n1 2 3 4 5 1. % set -o pipefail 2. % grep some-string /non/existent/file | sort 3. grep: /non/existent/file: No such file or directory 4. % echo $? 5. 2 è®¾ç½®IFS IFS(Internal Field Separator) è®¾ç½® Bash çš„åˆ†éš”ç¬¦ã€‚\nå½“è®¾ç½®ä¸ºå­—ç¬¦ä¸²æ—¶ï¼ŒBashä¼šè€ƒè™‘å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ä»¥åˆ†éš”å•è¯ã€‚è¿™å†³å®šäº†bashå¦‚ä½•éå†åºåˆ—ã€‚ä¾‹å¦‚ï¼Œæ­¤è„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 1. #!/bin/bash 2. IFS=$' ' 3. items=\"a b c\" 4. for x in $items; do 5. echo \"$x\" 6. done 7. 8. IFS=$'\\n' 9. for y in $items; do 10. echo \"$y\" 11. done ...å°†æ‰“å°å‡ºä»¥ä¸‹å†…å®¹ï¼š\n1 2 3 4 a b c a b c åœ¨ç¬¬ä¸€ä¸ªforå¾ªç¯ä¸­ï¼ŒIFSè®¾ç½®ä¸º$' 'ã€‚ï¼ˆ $'...'è¯­æ³•åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨åæ–œæ è½¬ä¹‰çš„å­—ç¬¦æ›¿æ¢ä¸ºç‰¹æ®Šå­—ç¬¦-ä¾‹å¦‚ï¼Œâ€œ \\ tâ€ä»£è¡¨åˆ¶è¡¨ç¬¦ï¼Œâ€œ \\ nâ€ä»£è¡¨æ¢è¡Œç¬¦ã€‚ï¼‰\nåœ¨forå¾ªç¯ä¸­ï¼Œxå’Œyè®¾ç½®ä¸ºbashè®¤ä¸ºæ˜¯â€œå•è¯â€çš„ä»»ä½•å€¼â€ä»¥åŸå§‹é¡ºåºæ˜¾ç¤ºã€‚å¯¹äºç¬¬ä¸€ä¸ªå¾ªç¯ï¼ŒIFSæ˜¯ä¸€ä¸ªç©ºæ ¼ï¼Œè¿™æ„å‘³ç€å•è¯ç”±ç©ºæ ¼å­—ç¬¦åˆ†éš”ã€‚å¯¹äºç¬¬äºŒä¸ªå¾ªç¯ï¼Œâ€œå•è¯â€ç”± æ¢è¡Œç¬¦åˆ†éš”ï¼Œè¿™æ„å‘³ç€bashå°†â€œ itemsâ€çš„æ•´ä¸ªå€¼è§†ä¸ºä¸€ä¸ªå•è¯ã€‚å¦‚æœIFSè¶…è¿‡ä¸€ä¸ªå­—ç¬¦ï¼Œåˆ™å°†å¯¹è¿™äº›å­—ç¬¦ä¸­çš„ä»»ä½•ä¸€ä¸ªè¿›è¡Œæ‹†åˆ†ã€‚\nçŸ¥é“äº†å—ï¼Ÿä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬å°†IFSè®¾ç½®ä¸ºç”±åˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ï¼Ÿå› ä¸ºåœ¨å¾ªç¯ä¸­è¿­ä»£æ—¶ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†æ›´å¥½çš„è¡Œä¸ºã€‚â€œæ›´å¥½â€çš„æ„æ€æ˜¯â€œå¼•èµ·æ„å¤–å’Œä»¤äººå›°æƒ‘çš„é”™è¯¯çš„å¯èƒ½æ€§è¦å°å¾—å¤šâ€ã€‚è¿™åœ¨ä½¿ç”¨bashæ•°ç»„æ—¶å¾ˆæ˜æ˜¾ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 1. #!/bin/bash 2. names=( 3. \"Aaron Maxwell\" 4. \"Wayne Gretzky\" 5. \"David Beckham\" 6. \"Anderson da Silva\" 7. ) 8. 9. echo \"With default IFS value...\" 10. for name in ${names[@]}; do 11. echo \"$name\" 12. done 13. 14. echo \"\" 15. echo \"With strict-mode IFS value...\" 16. IFS=$'\\n\\t' 17. for name in ${names[@]}; do 18. echo \"$name\" 19. done ï¼ˆæ˜¯çš„ï¼Œæˆ‘æŠŠæˆ‘çš„åå­—åˆ—åœ¨äº†ä¸èµ·çš„è¿åŠ¨å‘˜åå•ä¸Šã€‚æ”¾é£è‡ªæˆ‘~ï¼‰\nè¿™æ˜¯è¾“å‡ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 With default IFS value... Aaron Maxwell Wayne Gretzky David Beckham Anderson da Silva With strict-mode IFS value... Aaron Maxwell Wayne Gretzky David Beckham Anderson da Silva æˆ–è€…è€ƒè™‘ä¸€ä¸ªä»¥æ–‡ä»¶åä½œä¸ºå‘½ä»¤è¡Œå‚æ•°çš„è„šæœ¬ï¼š\n1 2 3 1. for arg in $@; do 2. echo \"doing something with file: $arg\" 3. done å¦‚æœæ‚¨å°†å…¶è°ƒç”¨ä¸ºmyscript.sh notes todo-list 'My Resume.doc'ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„IFSå€¼ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å°†è¢«è¯¯è§£æä¸ºä¸¤ä¸ªå•ç‹¬çš„æ–‡ä»¶-åä¸ºâ€œ Myâ€å’Œâ€œ Resume.docâ€ã€‚å®é™…ä¸Šï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ…å«ç©ºæ ¼çš„æ–‡ä»¶ï¼Œåä¸ºâ€œ My Resume.docâ€ã€‚\nå“ªç§è¡Œä¸ºæ›´æ™®éæœ‰ç”¨ï¼Ÿå½“ç„¶ï¼Œç¬¬äºŒä¸ª-æˆ‘ä»¬æœ‰èƒ½åŠ›ä¸åˆ†å‰²ç©ºæ ¼ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªé€šå¸¸åŒ…å«ç©ºæ ¼çš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œé€šå¸¸æˆ‘ä»¬å¸Œæœ›é€é¡¹è¿­ä»£å®ƒä»¬ï¼Œè€Œä¸æ˜¯å°†å•ä¸ªé¡¹æ‹†åˆ†ä¸ºå¤šä¸ªã€‚\nå°†IFSè®¾ç½®ä¸º$'\\n\\t'æ„å‘³ç€ä»…åœ¨æ¢è¡Œç¬¦å’Œåˆ¶è¡¨ç¬¦ä¸Šä¼šå‘ç”Ÿå•è¯æ‹†åˆ†ã€‚è¿™é€šå¸¸ä¼šäº§ç”Ÿæœ‰ç”¨çš„æ‹†åˆ†è¡Œä¸ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œbashå°†æ­¤è®¾ç½®ä¸º$' \\n\\t'-ç©ºæ ¼ï¼Œæ¢è¡Œç¬¦ï¼Œåˆ¶è¡¨ç¬¦-è¿™å¤ªæ€¥äº†ã€‚[2]\né—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ å¤šå¹´æ¥ï¼Œæˆ‘ä¸€ç›´åœ¨ä½¿ç”¨éå®˜æ–¹çš„bashä¸¥æ ¼æ¨¡å¼ã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œå®ƒæ€»æ˜¯ç«‹å³ä¸ºæˆ‘èŠ‚çœæ—¶é—´å’Œè°ƒè¯•éº»çƒ¦ã€‚ä½†æ˜¯èµ·åˆè¿™æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ï¼Œå› ä¸ºåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘çš„è®¸å¤šæƒ¯å¸¸ä¹ æƒ¯å’Œæˆè¯­éƒ½ä¸èµ·ä½œç”¨ã€‚æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†åˆ—å‡ºäº†æ‚¨å¯èƒ½é‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•å¿«é€Ÿè§£å†³è¿™äº›é—®é¢˜ã€‚\nï¼ˆå¦‚æœé‡åˆ°é—®é¢˜ï¼Œåœ¨è¿™é‡Œçœ‹ä¸åˆ°ï¼Œè¯·ç»™æˆ‘å‘ç”µå­é‚®ä»¶ï¼Œæˆ‘ä¼šå°½åŠ›æä¾›å¸®åŠ©ã€‚ï¼‰\né‡‡è´­ä¸åˆæ ¼çš„æ–‡ä»¶ ä½ç½®å‚æ•° æ•…æ„æœªå®šä¹‰çš„å˜é‡ æ‚¨æœŸæœ›å…·æœ‰éé›¶é€€å‡ºçŠ¶æ€çš„å‘½ä»¤ åŸºæœ¬æ¸…ç† çŸ­è·¯æ³¨æ„äº‹é¡¹ åé¦ˆ/å¦‚æœå¡ä½ é‡‡è´­ä¸åˆæ ¼çš„æ–‡ä»¶ æœ‰æ—¶ï¼Œæ‚¨çš„è„šæœ¬éœ€è¦è·å–æ— æ³•åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä½¿ç”¨çš„æ–‡ä»¶ã€‚ç„¶åæ€æ ·å‘¢ï¼Ÿ\n1 2 3 source some/bad/file.env ï¼ƒæ‚¨çš„ä¸¥æ ¼æ¨¡å¼è„šæœ¬ä¼šç«‹å³é€€å‡ºæ­¤å¤„ï¼Œ ï¼ƒå‡ºç°è‡´å‘½é”™è¯¯ã€‚ è§£å†³æ–¹æ¡ˆæ˜¯ï¼ˆaï¼‰æš‚æ—¶ç¦ç”¨ä¸¥æ ¼æ¨¡å¼çš„è¯¥æ–¹é¢ï¼›ï¼ˆbï¼‰å‡ºç¤ºæ–‡ä»¶ï¼›ç„¶åï¼ˆcï¼‰åœ¨ä¸‹ä¸€è¡Œé‡æ–°å¯ç”¨ã€‚\næ‚¨æœ€éœ€è¦çš„æ—¶é—´æ˜¯æ–‡æ¡£å¼•ç”¨æœªå®šä¹‰çš„å˜é‡ã€‚æš‚æ—¶å…è®¸ä»¥ä¸‹è¡Œä¸ºset +uï¼š\n1 2 3 1. set +u 2. source some/bad/file.env 3. set -u è¯·è®°ä½ï¼Œset +u ç¦ç”¨æ­¤å˜é‡ä¸¥æ ¼æ€§å¹¶å°†å…¶set -u å¯ç”¨ã€‚è¿™æœ‰ç‚¹è¿åç›´è§‰ï¼Œå› æ­¤åœ¨è¿™é‡Œè¦å°å¿ƒã€‚\næ‚¨è¿‡å»åœ¨Pythonè™šæ‹Ÿç¯å¢ƒä¸­éœ€è¦è¿™æ ·åšã€‚å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰Pythonï¼šæ‚¨å¯ä»¥è®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„éš”ç¦»ç¯å¢ƒ-ç§°ä¸ºvirtualenv-å­˜å‚¨åœ¨ä¸€ä¸ªåä¸ºâ€œ venvâ€çš„ç›®å½•ä¸­ã€‚æ‚¨é€šè¿‡åœ¨ä»¥ä¸‹ä½ç½®è·å–åä¸ºâ€œ bin / activateâ€çš„æ–‡ä»¶æ¥é€‰æ‹©ä½¿ç”¨æ­¤æ–‡ä»¶ï¼š\n1 2 3 4 5 6 7 ï¼ƒè¿™å°†æ›´æ–°PATHå¹¶å°†PYTHONPATHè®¾ç½®ä¸º ï¼ƒä½¿ç”¨é¢„é…ç½®çš„è™šæ‹Ÿç¯å¢ƒã€‚ source /path/to/venv/bin/activate ï¼ƒç°åœ¨æ‰€éœ€çš„Pythonç‰ˆæœ¬å°±åœ¨æ‚¨çš„è·¯å¾„ä¸­ï¼Œ ï¼ƒä¸æ‚¨éœ€è¦çš„ä¸€ç»„ç‰¹å®šåº“ã€‚ python my_program.py åœ¨ç°ä»£ç‰ˆæœ¬çš„Pythonä¸­ï¼Œè¿™åœ¨bashä¸¥æ ¼æ¨¡å¼ä¸‹éå¸¸æœ‰æ•ˆã€‚ä½†æ˜¯ï¼Œè¾ƒæ—§çš„è™šæ‹Ÿç¯å¢ƒï¼ˆè¿˜å¾ˆå¹´è½»ï¼Œæ‚¨å¯èƒ½ä»ç„¶ä¼šé‡åˆ°å®ƒä»¬ï¼‰æ— æ³•ä¸-ué€‰é¡¹ä¸€èµ·æ­£å¸¸ä½¿ç”¨ï¼š\n1 2 3 4 5 6 1. set -u 2. source /path/to/venv/bin/activate 3. _OLD_VIRTUAL_PYTHONHOME: unbound variable _OLD_VIRTUAL_PYTHONHOMEï¼šæœªç»‘å®šå˜é‡ ï¼ƒè¿™ä¼šä½¿æ‚¨çš„ä¸¥æ ¼æ¨¡å¼è„šæœ¬é€€å‡ºå¹¶å‡ºç°é”™è¯¯ã€‚ æ²¡é—®é¢˜ï¼Œæ‚¨åªéœ€ä½¿ç”¨ä¸Šé¢çš„æ¨¡å¼ï¼š\n1 2 3 1. set +u 2. source /path/to/venv/bin/activate 3. set -u ä»¥æˆ‘çš„ç»éªŒï¼ŒåŸå§‹æ–‡æ¡£å¾ˆå°‘éœ€è¦ -eæˆ–è¢«-o pipefailç¦ç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœé‡åˆ°è¿™ç§æƒ…å†µï¼Œæ‚¨å°†ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç†å®ƒã€‚\nä½ç½®å‚æ•° -uå¦‚æœè¿›è¡Œä»»ä½•æœªå®šä¹‰çš„å˜é‡å¼•ç”¨ï¼ˆ$*æˆ–é™¤å¤–ï¼‰ï¼Œåˆ™æ­¤è®¾ç½®å°†å¯¼è‡´è„šæœ¬ç«‹å³é€€å‡º $@ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨çš„è„šæœ¬é‡‡ç”¨ä½ç½®å‚æ•°- $1ï¼Œ$2ç­‰ç­‰-å¹¶ä¸”æ‚¨æƒ³è¦éªŒè¯æ˜¯å¦æä¾›äº†è¯¥æ€ä¹ˆåŠï¼Ÿè€ƒè™‘ä»¥ä¸‹è„šæœ¬ sayhello.shï¼š\nå¦‚æœæ‚¨è‡ªå·±è¿è¡Œâ€œ sayhello.shâ€ï¼Œåˆ™ä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š\nï¼…./sayhello.sh ./sayhello.shï¼šç¬¬3è¡Œï¼š$ 1ï¼šæœªç»‘å®šå˜é‡ æœ€æ— ç”¨çš„é”™è¯¯æ¶ˆæ¯ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨å‚æ•°é»˜è®¤å€¼ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯ï¼Œå¦‚æœåœ¨è¿è¡Œæ—¶å¼•ç”¨äº†ä¸€ä¸ªæœªå®šä¹‰çš„å˜é‡ï¼Œåˆ™bashå…·æœ‰ä½¿ç”¨â€œï¼š-â€è¿ç®—ç¬¦å£°æ˜é»˜è®¤å€¼çš„è¯­æ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 ï¼ƒå°šæœªè®¾ç½®å˜é‡ $fooï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ ï¼ƒä¸‹ä¸€è¡Œè§¦å‘é”™è¯¯ã€‚ bar=$foo # å¦‚æœæœªå®šä¹‰VARNAMEï¼Œåˆ™ï¼ƒ$ {VARNAMEï¼š-DEFAULT_VALUE}ç­‰äºDEFAULT_VALUEã€‚ ï¼ƒ å› æ­¤ï¼Œåœ¨è¿™é‡Œï¼Œ$ barè®¾ç½®ä¸ºâ€œ alphaâ€ï¼š bar=${foo:-alpha} ï¼ƒç°åœ¨æˆ‘ä»¬æ˜¾å¼è®¾ç½®fooï¼š foo =â€œbetaâ€ ï¼ƒ...ï¼Œé»˜è®¤å€¼å°†è¢«å¿½ç•¥ã€‚è¿™é‡Œ$ barè®¾ç½®ä¸ºâ€œ betaâ€ï¼š bar=${foo:-alpha} ï¼ƒè¦å°†é»˜è®¤å€¼è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè¯·ä½¿ç”¨$ {VARNAMEï¼š-} empty_string=${some_undefined_var:-} åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œéœ€è¦å°†å…¶ç”¨äºæ‰€æœ‰ä½ç½®å‚æ•°å¼•ç”¨ï¼š\n1 2 3 4 5 6 7 8 1. #!/bin/bash 2. set -u 3. name=${1:-} 4. if [[ -z \"$name\" ]]; then 5. echo \"usage: $0 NAME\" 6. exit 1 7. fi 8. echo \"Hello, $name\" æ•…æ„æœªå®šä¹‰çš„å˜é‡ åœ¨é»˜è®¤æ¨¡å¼ä¸‹ï¼Œå¯¹æœªå®šä¹‰å˜é‡çš„å¼•ç”¨å°†å¾—å‡ºä¸€ä¸ªç©ºå­—ç¬¦ä¸²-æœ‰æ—¶ä¼šä¾èµ–æ­¤è¡Œä¸ºã€‚åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªé€‰æ‹©ï¼Œå¹¶ä¸”æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è§£å†³å®ƒã€‚æˆ‘è®¤ä¸ºæœ€å¥½çš„æ–¹æ³•æ˜¯åœ¨è„šæœ¬çš„ä»»ä½•ä½ç½®å¯¹å…¶è¿›è¡Œå¼•ç”¨ä¹‹å‰ï¼Œå°†å˜é‡æ˜ç¡®è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼š\n1 2 3 4 5 6 someVar = â€œâ€ ï¼ƒ... ï¼ƒå¯èƒ½è®¾ç½®æˆ–æœªè®¾ç½®someVarçš„ä»£ç è¡Œ ï¼ƒ... if [[ -z \"$someVar\" ]]; then ï¼ƒ... ä¸€ç§æ›¿ä»£æ–¹æ³•æ˜¯ä½¿ç”¨${someVar:-}è¯­æ³•ä½œä¸ºé»˜è®¤å€¼ï¼Œå¦‚Positional Parametersä¸‹æ‰€è¿°ã€‚é‚£é‡Œçš„é—®é¢˜æ˜¯ï¼Œæœ‰å¯èƒ½å¿˜è®°è€Œåªæ˜¯è¯´ $someVarï¼Œè€Œä¸”è¾“å…¥æ›´å¤šã€‚åªéœ€åœ¨è„šæœ¬é¡¶éƒ¨æ˜¾å¼è®¾ç½®é»˜è®¤å€¼å³å¯ã€‚é‚£å°±æ²¡æœ‰åŠæ³•å’¬ä½ äº†ã€‚\næ‚¨æœŸæœ›å…·æœ‰éé›¶é€€å‡ºçŠ¶æ€çš„å‘½ä»¤ å½“æ‚¨æƒ³è¿è¡Œå°†å¤±è´¥çš„å‘½ä»¤ï¼Œæˆ–è€…æ‚¨çŸ¥é“å°†æ‹¥æœ‰éé›¶é€€å‡ºä»£ç æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ‚¨ä¸å¸Œæœ›å®ƒåœæ­¢è„šæœ¬ï¼Œå› ä¸ºè¿™å®é™…ä¸Šæ˜¯æ­£ç¡®çš„è¡Œä¸ºã€‚\nè¿™é‡Œæœ‰ä¸¤ä¸ªé€‰æ‹©ã€‚é€šå¸¸ï¼Œæ‚¨æœ€æƒ³ä½¿ç”¨çš„æœ€ç®€å•çš„æ–¹æ³•æ˜¯|| trueåœ¨å‘½ä»¤åé™„åŠ â€œ â€ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 ï¼ƒâ€œ grep -câ€æŠ¥å‘ŠåŒ¹é…çš„è¡Œæ•°ã€‚å¦‚æœæ•°å­—æ˜¯0ï¼Œ ï¼ƒç„¶ågrepçš„é€€å‡ºçŠ¶æ€ä¸º1ï¼Œä½†æˆ‘ä»¬ä¸åœ¨ä¹-æˆ‘ä»¬åªæƒ³ ï¼ƒçŸ¥é“åŒ¹é…æ•°ç›®ï¼Œå³ä½¿è¯¥æ•°ç›®ä¸ºé›¶ã€‚ ï¼ƒåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä¸‹ä¸€è¡Œå› é”™è¯¯è€Œä¸­æ­¢ï¼š count=$(grep -c some-string some-file) ï¼ƒä½†æ˜¯è¿™ä¸€è¡Œä¸ºè¡¨ç°å¾—æ›´å¥½ï¼š 1. count=$(grep -c some-string some-file || true) 2. 3. echo \"count: $count\" å¸ƒå°”è¿ç®—ç¬¦çš„è¿™ç§çŸ­è·¯ä½¿å†…éƒ¨è¡¨è¾¾å¼ $( ... )å§‹ç»ˆå¯ä»¥æˆåŠŸæ±‚å€¼ã€‚\næ‚¨å¯èƒ½ä¼šå‘ç°è¿™ç§æŠ€å·§å‡ ä¹æ€»æ˜¯å¯ä»¥è§£å†³æ‚¨çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³çŸ¥é“å‘½ä»¤çš„è¿”å›å€¼ï¼Œå³ä½¿è¯¥è¿”å›å€¼éé›¶æ€ä¹ˆåŠï¼Ÿç„¶åï¼Œæ‚¨å¯ä»¥æš‚æ—¶ç¦ç”¨ç«‹å³é€€å‡ºé€‰é¡¹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 ï¼ƒæˆ‘ä»¬ä»¥set -eå¼€å§‹æ­¤è„šæœ¬ã€‚ç„¶å... 1. set +e 2. count=$(grep -c some-string some-file) 3. retval=$? 4. set -e ï¼ƒå½“ä¸€è¡Œæˆ–å¤šè¡ŒåŒ¹é…æ—¶ï¼Œgrepçš„è¿”å›ç ä¸º0ï¼› ï¼ƒ1ï¼Œå¦‚æœæ²¡æœ‰è¡ŒåŒ¹é…ï¼›å’Œ2é”™è¯¯ã€‚è¿™ä¸ªå›¾æ¡ˆ ï¼ƒè®©æˆ‘ä»¬åŒºåˆ†å®ƒä»¬ã€‚ 1. echo \"return value: $retval\" 2. echo \"count: $count\" åŸºæœ¬æ¸…ç† å‡è®¾æ‚¨çš„è„šæœ¬ç»“æ„å¦‚ä¸‹ï¼š\nç­¹é›†ä¸€äº›æ˜‚è´µçš„èµ„æº ç”¨å®ƒåšç‚¹ä»€ä¹ˆ é‡Šæ”¾è¯¥èµ„æºï¼Œä½¿å…¶ä¸ä¼šæŒç»­è¿è¡Œå¹¶äº§ç”Ÿå·¨é¢è´¦å• å¯¹äºâ€œæ˜‚è´µçš„èµ„æºâ€ï¼Œè¿™å¯èƒ½åƒEC2å®ä¾‹é‚£æ ·èŠ±è´¹æ‚¨çš„å®é™…é’±ã€‚æˆ–è€…ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€äº›æ›´å°-å°±åƒä¸€ä¸ªä¸´æ—¶ç›®å½•-è¦åˆ›å»ºè„šæœ¬æ¥ä½¿ç”¨ï¼Œé‚£ä¹ˆä¸€å®šè¦åˆ é™¤ä¸€æ—¦å®Œæˆï¼ˆæ‰€ä»¥å®ƒä¸ä¼šæ³„éœ²å­˜å‚¨ç­‰ï¼‰çš„set -eé€‰é¡¹ï¼Œå®ƒé”™è¯¯å¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„è„šæœ¬åœ¨æ‰§è¡Œæ¸…ç†ä¹‹å‰é€€å‡ºï¼Œè¿™æ˜¯ä¸å¯æ¥å—çš„ã€‚\nè§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨bashå‡ºå£é™·é˜±ã€‚é“¾æ¥çš„æ–‡ç« è¯¦ç»†è§£é‡Šäº†è¿™ä¸€é‡è¦æ¨¡å¼ï¼Œæˆ‘å¼ºçƒˆå»ºè®®æ‚¨ç²¾é€šæ­¤æŠ€æœ¯-åœ¨å·¥å…·ç®±ä¸­ä½¿ç”¨å®ƒä¼šæ˜¾ç€æé«˜è„šæœ¬çš„å¥å£®æ€§å’Œå¯é æ€§ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæ‚¨å°†å®šä¹‰ä¸€ä¸ªbashå‡½æ•°æ¥æ‰§è¡Œæ¸…ç†æˆ–é‡Šæ”¾èµ„æºï¼Œç„¶åæ³¨å†Œè¦åœ¨é€€å‡ºæ—¶è‡ªåŠ¨è°ƒç”¨çš„å‡½æ•°ã€‚è¿™æ˜¯ä½¿ç”¨å®ƒæ¥ç¨³å¥æ¸…é™¤æš‚å­˜ç›®å½•çš„æ–¹æ³•ï¼š\n1 2 3 4 5 6 7 8 9 1. scratch=$(mktemp -d -t tmp.XXXXXXXXXX) 2. function finish { 3. rm -rf \"$scratch\" 4. } 5. trap finish EXIT 6. 7. # Now your script can write files in the directory \"$scratch\". 8. # It will automatically be deleted on exit, whether that's due 9. # to an error, or normal completion. çŸ­è·¯æ³¨æ„äº‹é¡¹ ä¸¥æ ¼æ¨¡å¼çš„å…¨éƒ¨ç›®çš„æ˜¯å°†è®¸å¤šéšè—çš„ï¼Œé—´æ­‡çš„æˆ–å¾®å¦™çš„é”™è¯¯è½¬æ¢ä¸ºç›´æ¥çš„ï¼Œæ˜¾è€Œæ˜“è§çš„é”™è¯¯ã€‚ä½†æ˜¯ï¼Œä¸¥æ ¼æ¨¡å¼ä¼šå¼•èµ·ä¸€äº›ç‰¹æ®Šçš„çŸ­è·¯é—®é¢˜ã€‚â€œçŸ­è·¯â€æ˜¯æŒ‡ç”¨\u0026\u0026æˆ–||- å°†å¤šä¸ªå‘½ä»¤é“¾æ¥åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚ï¼š\n1 2 1. # Prints a message only if $somefile exists. 2. [[ -f \"$somefile\" ]] \u0026\u0026 echo \"Found file: $somefile\" å½“è¿ç»­é“¾æ¥ä¸‰ä¸ªæˆ–æ›´å¤šå‘½ä»¤æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°ç¬¬ä¸€ä¸ªçŸ­è·¯é—®é¢˜ï¼š\n1 2 3 1. first_task \u0026\u0026 second_task \u0026\u0026 third_task 2. # And more lines of code following: 3. next_task æ½œåœ¨çš„é—®é¢˜ï¼šå¦‚æœsecond_taskå¤±è´¥ï¼Œ third_taskå°†æ— æ³•è¿è¡Œï¼Œå¹¶ä¸”next_taskåœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæ‰§è¡Œå°†ç»§ç»­åˆ°ä¸‹ä¸€è¡Œä»£ç - ã€‚è¿™å¯èƒ½æ­£æ˜¯æ‚¨æƒ³è¦çš„è¡Œä¸ºã€‚æˆ–è€…ï¼Œæ‚¨å¯èƒ½æ‰“ç®—å¦‚æœsecond_taskå¤±è´¥ï¼Œåˆ™è„šæœ¬åº”ç«‹å³ä»¥é”™è¯¯ä»£ç é€€å‡ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½çš„é€‰æ‹©æ˜¯ä½¿ç”¨ä¸€ä¸ªå—-å³èŠ±æ‹¬å·ï¼š\n1 2 3 4 5 1. first_task \u0026\u0026 { 2. second_task 3. third_task 4. } 5. next_task å› ä¸ºæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨è¯¥-eé€‰é¡¹ï¼Œæ‰€ä»¥å¦‚æœ second_taskå¤±è´¥ï¼Œè„šæœ¬å°†ç«‹å³é€€å‡ºã€‚\nç¬¬äºŒä¸ªé—®é¢˜ç¡®å®å­˜åœ¨ã€‚ä½¿ç”¨ä»¥ä¸‹å¸¸è§ç”¨æ³•æ—¶ï¼Œå®ƒå¯èƒ½ä¼šæ½œè¡Œï¼š\n1 2 1. # COND \u0026\u0026 COMMAND 2. [[ -f \"$somefile\" ]] \u0026\u0026 echo \"Found file: $somefile\" äººä»¬å†™ä½œæ—¶COND \u0026\u0026 COMMANDï¼Œé€šå¸¸çš„æ„æ€æ˜¯â€œå¦‚æœCONDæˆåŠŸï¼ˆæˆ–å¸ƒå°”å€¼ä¸ºtrueï¼‰ï¼Œåˆ™æ‰§è¡ŒCOMMANDã€‚æ— è®ºå¦‚ä½•ï¼Œè¯·ç»§ç»­æ‰§è¡Œè„šæœ¬çš„ä¸‹ä¸€è¡Œã€‚â€ å¯¹äºå®Œæ•´çš„â€œ if / then / fiâ€å­å¥æ¥è¯´ï¼Œè¿™æ˜¯éå¸¸æ–¹ä¾¿çš„ç®€å†™ã€‚ä½†æ˜¯ï¼Œå½“è¿™æ ·çš„æ„é€ æ˜¯æ–‡ä»¶çš„æœ€åä¸€è¡Œæ—¶ï¼Œä¸¥æ ¼æ¨¡å¼å¯ä»¥ä¸ºè„šæœ¬æä¾›ä»¤äººæƒŠè®¶çš„é€€å‡ºä»£ç ï¼š\n1. % cat short-circuit-last-line.sh 2. #!/bin/bash 3. set -euo pipefail 4. # omitting some lines of code... 5. 6. # Prints a message only if $somefile exists. 7. # Note structure: COND \u0026\u0026 COMMAND 8. [[ -f \"$somefile\" ]] \u0026\u0026 echo \"Found file: $somefile\" 9. 10. % ./short-circuit-last-line.sh 11. % echo $? 12. 1 å½“è„šæœ¬åˆ°è¾¾æœ€åä¸€è¡Œæ—¶ï¼Œ$somefileå®é™…ä¸Š å¹¶ä¸å­˜åœ¨ã€‚å› æ­¤CONDè¯„ä¼°ä¸ºå‡ï¼Œå¹¶ä¸”COMMANDæ²¡æœ‰æ‰§è¡Œ-è¿™åº”è¯¥å‘ç”Ÿã€‚ä½†æ˜¯è¯¥è„šæœ¬ä»¥éé›¶çš„é€€å‡ºä»£ç é€€å‡ºï¼Œè¿™æ˜¯ä¸€ä¸ªé”™è¯¯ï¼šè¯¥è„šæœ¬å®é™…ä¸Šå·²æ­£ç¡®æ‰§è¡Œï¼Œå› æ­¤å®ƒå®é™…ä¸Šåº”è¯¥ä»¥0é€€å‡ºã€‚å®é™…ä¸Šï¼Œå¦‚æœæœ€åä¸€è¡Œä»£ç æ˜¯å…¶ä»–å†…å®¹ï¼Œé‚£æ­£æ˜¯æˆ‘ä»¬æ‰€å¾—åˆ°çš„ï¼š\n1. % cat short-circuit-before-last-line.sh 2. #!/bin/bash 3. set -euo pipefail 4. # omitting some lines of code... 5. 6. # Prints a message only if $somefile exists. 7. # Structure: COND \u0026\u0026 COMMAND 8. # (When we run this, $somefile will again not exist, 9. # so COMMAND will not run.) 10. [[ -f \"$somefile\" ]] \u0026\u0026 echo \"Found file: $somefile\" 11. 12. echo \"Done.\" 13. 14. % ./short-circuit-before-last-line.sh 15. Done. 16. % echo $? 17. 0 è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿäº‹å®è¯æ˜ï¼Œè¯¥-eé€‰é¡¹åœ¨è¿™æ ·çš„çŸ­è·¯è¡¨è¾¾å¼ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ä¾‹å¤–ï¼šå¦‚æœCOND è®¡ç®—ç»“æœä¸ºfalseï¼ŒCOMMANDå°†ä¸ä¼šè¿è¡Œï¼Œå¹¶ä¸”æ‰§è¡Œæµç¨‹å°†è¿›è¡Œåˆ°ä¸‹ä¸€è¡Œã€‚ä½†æ˜¯ï¼Œæ•´è¡Œçš„ç»“æœ-æ•´ä¸ªçŸ­è·¯è¡¨è¾¾å¼-å°†ä¸ºéé›¶ï¼Œå› ä¸ºCONDæ˜¯ã€‚ä½œä¸ºè„šæœ¬çš„æœ€åä¸€è¡Œï¼Œå®ƒæˆä¸ºç¨‹åºçš„é€€å‡ºä»£ç ã€‚\nè¿™æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›é‡åˆ°çš„é”™è¯¯ï¼Œå› ä¸ºå®ƒå¯èƒ½æ˜¯å¾®å¦™çš„ï¼Œä¸æ˜æ˜¾çš„å¹¶ä¸”éš¾ä»¥å¤åˆ¶ã€‚è€Œä¸”å®ƒä¸»è¦å¾ˆéš¾å¤„ç†ï¼Œå› ä¸ºä»…å½“å®ƒæ˜¯æ–‡ä»¶çš„æœ€åä¸€ä¸ªå‘½ä»¤æ—¶æ‰ä¼šæ˜¾ç¤ºã€‚åœ¨ä»»ä½•å…¶ä»–è¡Œä¸Šï¼Œå®ƒçš„è¡Œä¸ºéƒ½å¾ˆå¥½ï¼Œä¸ä¼šé€ æˆä»»ä½•é—®é¢˜ã€‚åœ¨æ­£å¸¸çš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¾ˆå®¹æ˜“å¿˜è®°è¿™ä¸€ç‚¹ï¼Œå¹¶ä½¿å…¶ä»è£‚ç¼ä¸­æºœèµ°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä»å¤´åˆ é™¤çœ‹èµ·æ¥æ— å®³çš„echoè¯­å¥ï¼Œä½¿çŸ­è·¯çº¿ç°åœ¨æœ€åï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ\nåœ¨ä¸Šé¢çš„ç‰¹å®šç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®Œæ•´çš„â€œ ifâ€å­å¥ä¸­æ‰©å±•è¡¨è¾¾å¼ã€‚è¿™æ˜¯å®Œç¾çš„è¡Œä¸ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 1. # Prints a message only if $somefile exists. 2. if [[ -f \"$somefile\" ]]; then 3. echo \"Found file: $somefile\" 4. fi 5. 6. # If COND is a command or program, it works the same. This: 7. first_task \u0026\u0026 second_task 8. 9. # ... becomes this: 10. if first_task; then 11. second_task 12. fi æœ€ç»ˆçš„å®Œæ•´è§£å†³æ–¹æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿæ‚¨å¯ä»¥å†³å®šä¿¡ä»»è‡ªå·±å’Œæ‚¨çš„é˜Ÿå‹ï¼Œä»¥å§‹ç»ˆè®°ä½è¿™ä¸€ç‰¹æ®Šæƒ…å†µã€‚æ‰€æœ‰äººéƒ½å¯ä»¥éšæ„ä½¿ç”¨çŸ­è·¯åŠŸèƒ½ï¼Œä½†æ˜¯å¯¹äºå®é™…éƒ¨ç½²çš„ä»»ä½•å†…å®¹ï¼Œéƒ½ä¸å…è®¸çŸ­è·¯è¡¨è¾¾å¼ä½äºè„šæœ¬çš„æœ€åä¸€è¡Œã€‚å¯¹äºæ‚¨å’Œæ‚¨çš„å›¢é˜Ÿæ¥è¯´ï¼Œè¿™å¯èƒ½100ï¼…å¯é åœ°èµ·ä½œç”¨ï¼Œä½†æˆ‘è®¤ä¸ºå¯¹äºæˆ‘è‡ªå·±å’Œè®¸å¤šå…¶ä»–å¼€å‘äººå‘˜è€Œè¨€å¹¶éå¦‚æ­¤ã€‚å½“ç„¶ï¼ŒæŸç§ç±»å‹çš„linteræˆ–commité’©å­å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚\nä¹Ÿè®¸æ›´å®‰å…¨çš„é€‰æ‹©æ˜¯å†³å®šæ ¹æœ¬ä¸ä½¿ç”¨çŸ­è·¯ï¼Œè€Œå§‹ç»ˆä½¿ç”¨å®Œæ•´çš„ifè¯­å¥ã€‚ä½†æ˜¯ï¼Œè¿™å¯èƒ½å¹¶ä¸å¸å¼•äººï¼šçŸ­è·¯å¾ˆæ–¹ä¾¿ï¼Œäººä»¬å‡ºäºæŸç§åŸå› å–œæ¬¢è¿™æ ·åšã€‚ç›®å‰ï¼Œæˆ‘ä»åœ¨å¯»æ‰¾æ›´ä»¤äººæ»¡æ„çš„è§£å†³æ–¹æ¡ˆã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•å»ºè®®ï¼Œè¯·ä¸æˆ‘è”ç³»ã€‚\nåé¦ˆ/å¦‚æœå¡ä½ å¦‚æœæ‚¨æœ‰ä»»ä½•åé¦ˆæˆ–æ”¹è¿›å»ºè®®ï¼Œæˆ‘å¾ˆæƒ³å¬å¬ã€‚é€šè¿‡ç”µå­é‚®ä»¶ä¸æˆ‘ï¼ˆAaron Maxwellï¼‰å–å¾—è”ç³»ï¼Œç½‘å€ä¸ºredsymbol dot netçš„æœ€å¤§å€¼ã€‚\nç›¸åï¼Œå¦‚æœæ‚¨å‘ç°ä¸¥æ ¼æ¨¡å¼ä¼šå¯¼è‡´ä¸Šè¿°é—®é¢˜ï¼ˆæˆ‘æ²¡æœ‰å‘Šè¯‰æ‚¨å¦‚ä½•è§£å†³ï¼‰ï¼Œæˆ‘ä¹Ÿæƒ³çŸ¥é“ã€‚ç»™æ‚¨å‘é€ç”µå­é‚®ä»¶æ—¶ï¼Œè¯·åœ¨ç”µå­é‚®ä»¶æ­£æ–‡ï¼ˆè€Œä¸æ˜¯é™„ä»¶ï¼‰ä¸­åŒ…å«ä¸€ä¸ªæœ€å°çš„ bashè„šæœ¬ï¼Œä»¥æ¼”ç¤ºè¯¥é—®é¢˜ã€‚è¿˜è¦éå¸¸æ¸…æ¥šåœ°è¯´æ˜æ‰€éœ€çš„è¾“å‡ºæˆ–æ•ˆæœï¼Œä»¥åŠæ‚¨å¾—åˆ°çš„é”™è¯¯æˆ–å¤±è´¥ã€‚å¦‚æœæ‚¨çš„è„šæœ¬ä¸æ˜¯æŸä¸ªæ ‡è¯†ç¬¦å¾ˆé’çš„å·¨å‹æ€ªå…½ï¼Œé‚£ä¹ˆæˆ‘å¾ˆæœ‰å¯èƒ½ä¼šå¾—åˆ°å“åº”ï¼Œè€Œæˆ‘å°†ä¸å¾—ä¸åœ¨æ•´ä¸ªä¸‹åˆè¿›è¡Œè§£æã€‚\nè„šæ³¨ [1]å…·ä½“æ¥è¯´ï¼Œå¦‚æœæœ‰ç®¡é“ï¼›æ‹¬å·ä¸­çš„ä»»ä½•å‘½ä»¤ï¼›æˆ–ä»¥å¤§æ‹¬å·å½¢å¼ä½œä¸ºå‘½ä»¤åˆ—è¡¨çš„ä¸€éƒ¨åˆ†æ‰§è¡Œçš„å‘½ä»¤ä»¥éé›¶é€€å‡ºçŠ¶æ€é€€å‡ºï¼Œè„šæœ¬ç«‹å³ä»¥ç›¸åŒçŠ¶æ€é€€å‡ºã€‚è¿™è¿˜æœ‰å…¶ä»–ä¸€äº›ç»†å¾®ä¹‹å¤„ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§å†…ç½®bashâ€œ setâ€çš„æ–‡æ¡£ã€‚ [2]å¦ä¸€ç§æ–¹æ³•ï¼šä¸æ›´æ”¹IFSï¼Œè€Œæ˜¯ä»å¾ªç¯å¼€å§‹for arg in \"$@\"-ç”¨åŒå¼•å·è¦†ç›–è¿­ä»£å˜é‡ã€‚è¿™å°†æ”¹å˜å¾ªç¯è¯­ä¹‰ä»¥äº§ç”Ÿæ›´å¥½çš„è¡Œä¸ºï¼Œç”šè‡³æ›´å¥½åœ°å¤„ç†ä¸€äº›è¾¹ç¼˜æƒ…å†µã€‚æœ€å¤§çš„é—®é¢˜æ˜¯å¯ç»´æŠ¤æ€§ã€‚å³ä½¿æ˜¯ç»éªŒä¸°å¯Œçš„å¼€å‘äººå‘˜ï¼Œä¹Ÿå¾ˆå®¹æ˜“å¿˜è®°åŠ åŒå¼•å·ã€‚å³ä½¿åŸå§‹ä½œè€…å·²ç»æˆåŠŸåœ°æ ¹æ·±è’‚å›ºäº†è¿™ä¸ªä¹ æƒ¯ï¼Œä½†æœŸæœ›æ‰€æœ‰æœªæ¥çš„ç»´æŠ¤è€…éƒ½ä¼šæ„šè ¢ã€‚ç®€è€Œè¨€ä¹‹ï¼Œä¾é å¼•å·å¾ˆå¯èƒ½ä¼šå¼•å…¥ç»†å¾®çš„å®šæ—¶ç‚¸å¼¹é”™è¯¯ã€‚è®¾ç½®IFSä½¿å…¶ä¸å¯èƒ½ã€‚ ","description":"","tags":["bash"],"title":"ä½¿ç”¨ Bash ä¸¥æ ¼æ¨¡å¼","uri":"/blog/posts/use-bash-strict-mode/"},{"categories":null,"content":" ä¹‹å‰ä»‹ç»è¿‡ Expect ä½œä¸ºå¤„ç†ç¨‹åºäº¤äº’å·¥å…·çš„ä½¿ç”¨ã€‚\nç»“åˆä¸²å£å‘½ä»¤ä»¥åŠ Expect è¯»å–è¾“å…¥è¾“å‡ºï¼Œé’ˆå¯¹ä¸€äº›å…·æœ‰å›ºå®šæµç¨‹è€Œä¸”èƒ½é€šè¿‡è¾“å‡ºåˆ¤æ–­å‘½ä»¤æ‰§è¡Œæƒ…å†µçš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¯ä»¥å®ç°åŸºäºä¸²å£çš„æµ‹è¯•è‡ªåŠ¨åŒ–ã€‚\né—®é¢˜ åœ¨ä½¿ç”¨ä¸²å£è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ‰‹åŠ¨è¾“å…¥æ‰§è¡Œå‘½ä»¤ï¼Œäº¤äº’æ€§è¾“å…¥ï¼Œä»¥åŠç­‰å¾…æ‰§è¡Œç»“æœã€‚åŸºæœ¬æ‰€æœ‰çš„ä¿¡æ¯éƒ½åœ¨ tty ä¸­ä¸²è¡Œçš„è¿›è¡Œæ˜¾ç¤ºã€‚ç—›ç‚¹æœ‰ä¸‹é¢å‡ ä¸ª\né‡å¤å‘½ä»¤æ‰‹åŠ¨è¾“å…¥æ‰§è¡Œ äº¤äº’æ€§è¾“å…¥ ç­‰å¾…æ‰§è¡Œä¿¡æ¯ï¼Œä¸èƒ½è‡ªåŠ¨ä¿å­˜åˆ°æ–‡ä»¶ ä¸²å£è°ƒè¯•ç¯å¢ƒæœ¬èº«edit ä¾¿åˆ©æ€§ åŸºäºä»¥ä¸Šçš„é—®é¢˜ï¼Œéœ€è¦å­˜åœ¨éœ€æ±‚ï¼š\nå¯ä»¥å°†æ‰§è¡Œå‘½ä»¤å­˜æ”¾è„šæœ¬ä¸­ï¼Œè€Œä¸”å¯ä»¥å»è°ƒç”¨æ‰§è¡Œ å¯å¤„ç†äº¤äº’æ€§è¾“å…¥ å¯¹äºæ‰§è¡Œå‘½ä»¤è¾“å‡ºå¯ä»¥ä¿å­˜åˆ° log æ–‡ä»¶ åŸºæœ¬æ–¹æ¡ˆ åŸºäº SecureCRT\nSecureCRT è„šæœ¬ï¼Œä½¿ç”¨ python è¯­è¨€\nä¼˜ç‚¹ï¼š\nGUI ç•Œé¢ï¼Œæ“ä½œç›´è§‚ python syntax è¯­æ³•ç‰¹æ€§æ”¯æŒå¼ºå¤§ ç¼ºç‚¹ï¼š\nSecureCRT è¿‡é‡ï¼Œæœ¬èº«å®‰è£…éº»çƒ¦ ä»ç„¶éœ€è¦åŸºæœ¬äº¤äº’ï¼ŒSecureCRT å†…è°ƒç”¨è„šæœ¬ ä¸ jenkins çš„é›†æˆ åŸºäº Terminal ç¯å¢ƒ\né¦–å…ˆè¦è§£å†³çš„æ˜¯ä¸²å£ç¯å¢ƒï¼Œè¿™é‡Œä½¿ç”¨ picocom å‘½ä»¤è¡Œå·¥å…·ï¼Œç±»ä¼¼çš„æœ‰ minicom ç­‰ã€‚\nå…¶æ¬¡ï¼Œé’ˆå¯¹éœ€è¦äº¤äº’è¡Œè¾“å…¥ï¼Œä½¿ç”¨ Expect å¤„ç†ï¼ŒExpect åŸºäº TCL (Tool control languageï¼‰\næœ€åï¼Œå¾—åˆ°çš„ .expect è„šæœ¬å¯ä»¥é€šè¿‡ Jenkins pipeline è¿›è¡Œè°ƒç”¨ã€‚\nä¼˜ç‚¹ï¼š\nè½»é‡åŒ–ï¼Œå¯é€šè¿‡å‘½ä»¤è¡Œå®‰è£… æ‰€æœ‰è¿‡ç¨‹éƒ½åœ¨ Terminal æ“ä½œ é›†æˆåˆ° Jenkinsï¼Œå®Œå…¨æ”¯æŒè‡ªåŠ¨åŒ–æµç¨‹ ç¼ºç‚¹ï¼š\npicocom åœ¨åŠŸèƒ½æ€§æ–¹é¢è¾ƒå¼± ##å®é™…è§£å†³\né’ˆå¯¹ä¸Šé¢ä¸¤ç§æ–¹æ¡ˆï¼Œå¦‚æœæ˜¯éé‡å¤æ€§è°ƒè¯•ï¼Œä½¿ç”¨å‰è€…ä¸Šæ‰‹æ›´å¿«ã€‚\nå¦‚æœæœ‰éœ€è¦å¤šæ¬¡é‡å¤æ€§ï¼Œæˆ–è€…è‡ªåŠ¨åŒ–æµ‹è¯•éœ€æ±‚ï¼Œé€‰æ‹©åè€…ã€‚\nä¸‹é¢ç»™å‡ºä½¿ç”¨ Expect çš„ä¸€ä¸ª demoï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 #!/usr/bin/expect # -d: debug mode # expect config set timeout 30 log_file test-expect.log # picocom config set baudrate \"115200\" set device \"/dev/ttyUSB0\" set prompt \"=\u003e\" # function define set interval 5 set iter_cnt 10 proc start_xvr_debug { prompt } { send \"xvr_client_dbus\\r\" expect $prompt } proc test_switch_channel_display { iter_cnt interval prompt } { for { set i 1 } { $i \u003c $iter_cnt } { incr i 1 } { send \"switch_channel_display -cam 0 -ch 0 -onoff 1\\r\" expect $prompt exec sleep $interval send \"switch_channel_display -cam 0 -ch 0 -onoff 0\\r\" expect $prompt exec sleep $interval send \"switch_channel_display -cam 0 -ch 1 -onoff 1\\r\" expect $prompt exec sleep $interval send \"switch_channel_display -cam 0 -ch 1 -onoff 0\\r\" expect $prompt exec sleep $interval } } proc test_start_stop_pipeline { iter_cnt interval prompt } { for { set i 1 } { $i \u003c $iter_cnt } { incr i 1 } { send \"stop_pipeline /dev/xvr_pipeline-0\\r\" expect $prompt exec sleep $interval send \"stop_pipeline /dev/xvr_pipeline-1\\r\" expect $prompt exec sleep $interval send \"start_pipeline /dev/xvr_pipeline-0\\r\" expect $prompt exec sleep $interval send \"start_pipeline /dev/xvr_pipeline-1\\r\" expect $prompt exec sleep $interval } } spawn picocom -b $baudrate $device expect \"Terminal ready\\r\" send \"\\r\" # send \"xvr_client_dbus\\r\" # expect $prompt start_xvr_debug $prompt test_switch_channel_display $iter_cnt $interval $prompt # test_start_stop_pipeline $iter_cnt $interval $prompt expect eof # interact wait åœ¨å…·ä½“ä½¿ç”¨ä¸­é‡åˆ°çš„æœ‰å‡ ä¸ªå°å‘:\né›†æˆåˆ° jenkins æ—¶ï¼Œjenkins ç”¨æˆ·æ— æ³•è·å¾— /dev/ttyUSB0 æƒé™ã€‚ sudo æ‰§è¡Œ Expect è„šæœ¬è¿›ç¨‹ kill è¯¦æƒ…è§å°¾æ³¨æ„å°èŠ‚ã€‚\nå‚è€ƒ SecureCRT-python-scripts SecureCRT Offical demo Expect manual Expect ä½¿ç”¨æ•™ç¨‹ Expect interact \u0026 expect eof æ³¨æ„ å…³äº jenkins ç”¨æˆ·æ— æ³•è·å– /dev/ttyUSB0 æƒé™\nåœ¨è¿™é‡Œæœ€å¥½ä¸è¦ç›´æ¥ä½¿ç”¨ sudo ï¼Œä½¿ç”¨ root æƒé™æ‰§è¡Œçš„åå¤„åœ¨äºï¼Œå½“ä½ æƒ³è¦ä¸­æ–­ expect è„šæœ¬æ—¶ï¼Œä¹Ÿå¿…é¡»ä½¿ç”¨ root æƒé™ã€‚å¹¶ä¸”åœ¨é›†æˆåˆ° Jenkins æ—¶ï¼Œjenkins ç”¨æˆ·èµ·äº† root æƒé™çš„è¿›ç¨‹ï¼Œåœ¨ä¸­æ–­ job çš„æ—¶å€™ã€‚expect ä»»ç„¶åœ¨ jenkins node ä¸Šç»§ç»­æ‰§è¡Œã€‚\nè§£å†³çš„æ–¹æ¡ˆæ˜¯å°† jenkins ç”¨æˆ·åŠ å…¥æ‹¥æœ‰ dev è®¾å¤‡æƒé™çš„ç”¨æˆ·ç»„ã€‚\n1 sudo usermod aG dialout jenkins sudo æ‰§è¡Œçš„ expect è¿›ç¨‹kill\nsudo killall -u USER expect ","description":"","tags":["automation","serial","expect"],"title":"å…³äºä¸²å£æµ‹è¯•è‡ªåŠ¨åŒ–çš„è§£å†³æ–¹æ¡ˆ","uri":"/blog/posts/solutions-for-serial-port-test-automation/"},{"categories":["Linux"],"content":"Linuxå¦‚ä½•æŸ¥æ‰¾å¤§æ–‡ä»¶æˆ–ç›®å½•æ€»ç»“ è½¬è½½è‡ª: https://www.cnblogs.com/kerrycode/p/4391859.html\nåœ¨Windowsç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ TreeSize å·¥å…·æŸ¥æ‰¾ä¸€äº›å¤§æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œéå¸¸çš„æ–¹ä¾¿é«˜æ•ˆ.\nåœ¨Linuxç³»ç»Ÿä¸­ï¼Œå¦‚ä½•å»æœç´¢ä¸€äº›æ¯”è¾ƒå¤§çš„æ–‡ä»¶å‘¢ï¼Ÿä¸‹é¢æˆ‘æ•´ç†äº†ä¸€ä¸‹åœ¨Linuxç³»ç»Ÿä¸­å¦‚ä½•æŸ¥æ‰¾å¤§æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„æ–¹æ³•ã€‚\nå¦‚ä½•æŸ¥æ‰¾å¤§æ–‡ä»¶ï¼Ÿ å…¶å®å¾ˆå¤šæ—¶å€™ï¼Œä½ éœ€è¦äº†è§£å½“å‰ç³»ç»Ÿä¸‹æœ‰å“ªäº›å¤§æ–‡ä»¶ï¼Œæ¯”å¦‚æ–‡ä»¶å¤§å°è¶…è¿‡100Mæˆ–1Gï¼ˆé˜€å€¼è§†å…·ä½“æƒ…å†µè€Œå®šï¼‰ã€‚é‚£ä¹ˆå¦‚ä½•æŠŠè¿™äº›å¤§æ–‡ä»¶æœç´¢å‡ºæ¥å‘¢ï¼Ÿä¾‹å¦‚æˆ‘è¦æœç´¢å½“å‰ç›®å½•ä¸‹ï¼Œè¶…è¿‡800Må¤§å°çš„æ–‡ä»¶\n1 find . -type f -size +800M å¦‚ä¸Šå‘½ä»¤æ‰€ç¤ºï¼Œæˆ‘ä»¬ä»…ä»…èƒ½çœ‹åˆ°è¶…è¿‡800Må¤§å°çš„æ–‡ä»¶çš„æ–‡ä»¶åç§°ï¼Œä½†æ˜¯å¯¹æ–‡ä»¶çš„ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œæ–‡ä»¶å¤§å°ã€æ–‡ä»¶å±æ€§ï¼‰ä¸€æ— æ‰€çŸ¥ï¼Œé‚£ä¹ˆèƒ½å¦æ›´è¯¦ç»†æ˜¾ç¤ºä¸€äº›æ–‡ä»¶å±æ€§æˆ–ä¿¡æ¯å‘¢ï¼Œå½“ç„¶å¯ä»¥ï¼Œå¦‚ä¸‹æ‰€ç¤º\n1 find . -typf f -size +800M | xargs ls -al å½“æˆ‘ä»¬åªéœ€è¦æŸ¥æ‰¾è¶…è¿‡800Må¤§å°æ–‡ä»¶ï¼Œå¹¶æ˜¾ç¤ºæŸ¥æ‰¾å‡ºæ¥æ–‡ä»¶çš„å…·ä½“å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤\n1 find . -typf f -size +800M | xargs du -h å¦‚æœä½ è¿˜éœ€è¦å¯¹æŸ¥æ‰¾ç»“æœæŒ‰ç…§æ–‡ä»¶å¤§å°åšä¸€ä¸ªæ’åºï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤\n1 find . -typf f -size +800M | xargs du -h | sort -nr # ä»å¤§åˆ°å°æ’åº æœ‰æ—¶å€™æ’åˆ—çš„é¡ºåºå¹¶ä¸å®Œå…¨æ˜¯æŒ‰å¤§å°ä¸€è‡´ï¼Œè¿™ä¸ªæ˜¯å› ä¸ºduå‘½ä»¤çš„å‚æ•°hæ‰€è‡´ï¼Œä½ å¯ä»¥ç»Ÿä¸€ä½¿ç”¨ä½¿ç”¨MBæ¥æ˜¾ç¤ºï¼Œè¿™æ ·å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚åˆ°è¿™é‡Œï¼Œè¿™ä¸ªåœ¨Linuxç³»ç»ŸæŸ¥æ‰¾å¤§æ–‡ä»¶çš„å‘½ä»¤å·²ç»éå¸¸å®Œç¾äº†ï¼Œå½“ç„¶å¦‚æœä½ è¿˜æœ‰å¾ˆå¤šçš„éœ€æ±‚ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨è¿™ä¸ªå‘½ä»¤ä¸Šåšä¿®æ”¹ã€è°ƒæ•´.\n2: å¦‚ä½•æŸ¥æ‰¾Linuxä¸‹çš„å¤§ç›®å½•\nè­¬å¦‚æœ‰æ—¶å€™ç£ç›˜ç©ºé—´å‘Šè­¦äº†ï¼Œè€Œä½ å¹³æ—¶åˆç–äºç®¡ç†ã€ç›‘æ§æ–‡ä»¶çš„å¢é•¿ï¼Œé‚£ä¹ˆæˆ‘éœ€è¦å¿«é€Ÿçš„äº†è§£å“ªäº›ç›®å½•å˜å¾—æ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å€ŸåŠ©duå‘½ä»¤æ¥å¸®æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n[root@getlnx01 u03]# du -h --max-depth=1\n16K ./lost+found\n33G ./flash_recovery_area\n37G ./oradata\n70G .\nå¦‚æœä½ æƒ³çŸ¥é“flash_recovery_areaç›®å½•ä¸‹é¢æœ‰å“ªäº›å¤§æ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆå¯ä»¥å°†å‚æ•°max-depth=2 ï¼Œå¦‚æœä½ æƒ³å¯¹æœç´¢å‡ºæ¥çš„ç»“æœè¿›è¡Œæ’åºï¼Œé‚£ä¹ˆå¯ä»¥å€ŸåŠ©äºsortå‘½ä»¤ã€‚å¦‚ä¸‹æ‰€ç¤º\n[root@getlnx01 u03]# du -h --max-depth=2 | sort -n\n3.5G ./flash_recovery_area/EPPS\n16K ./lost+found\n29G ./flash_recovery_area/backup\n33G ./flash_recovery_area\n37G ./oradata\n37G ./oradata/epps\n70G .\n[root@getlnx01 u03]# du -hm --max-depth=2 | sort -n\n1 ./lost+found\n3527 ./flash_recovery_area/EPPS\n29544 ./flash_recovery_area/backup\n33070 ./flash_recovery_area\n37705 ./oradata\n37705 ./oradata/epps\n70775 .\n[root@getlnx01 u03]# cd /\n[root@getlnx01 /]# du -hm --max-depth=2 | sort -n\næœ‰æ—¶å€™æœç´¢å‡ºæ¥çš„ç»“æœå¤ªå¤šäº†ï¼ˆè­¬å¦‚ï¼Œæˆ‘ä»æ ¹ç›®å½•å¼€å§‹æœç´¢ï¼‰ï¼Œä¸€ç›´åœ¨åˆ·å±ï¼Œå¦‚æœæˆ‘åªæƒ³æŸ¥å‡ºæœ€å¤§çš„12ä¸ªæ–‡ä»¶å¤¹ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿæ­¤æ—¶å°±è¦å€ŸåŠ©headå‘½ä»¤æ¥æ˜¾ç¤ºäº†\n[root@getlnx01 /]# du -hm --max-depth=2 | sort -nr | head -12\n407480 .\n167880 ./u04\n158685 ./u02/oradata\n158685 ./u02\n152118 ./u04/oradata\n70775 ./u03\n37705 ./u03/oradata\n33070 ./u03/flash_recovery_area\n5995 ./u01/app\n5995 ./u01\n3551 ./usr\n1558 ./usr/share\n[root@getlnx01 /]#\nå‚è€ƒèµ„æ–™ï¼š\nhttp://linuxandfriends.com/how-to-find-large-files-in-linux-using-command-line/\nhttp://www.docin.com/p-563963500.html\n","description":"","tags":["linux"],"title":"Linuxå¦‚ä½•æŸ¥æ‰¾å¤§æ–‡ä»¶æˆ–ç›®å½•æ€»ç»“","uri":"/blog/posts/Linux/how-to-find-files-under-linux/"},{"categories":["Python"],"content":"é€šè¿‡ pySerial è¿æ¥ä¸²å£ pySerial æ˜¯ä¸€ä¸ª Python æ¨¡å—ã€‚è¯¥æ¨¡å—å°è£…äº†å¯¹ä¸²è¡Œç«¯å£çš„è®¿é—®ã€‚\nå®ƒæä¾›äº†åœ¨Windowsï¼ŒOSXï¼ŒLinuxï¼ŒBSDï¼ˆå¯èƒ½æ˜¯ä»»ä½•POSIXå…¼å®¹ç³»ç»Ÿï¼‰å’ŒIronPythonä¸Šè¿è¡Œçš„Pythonçš„åç«¯ã€‚åä¸º â€œserialâ€ çš„æ¨¡å—ä¼šè‡ªåŠ¨é€‰æ‹©é€‚å½“çš„åç«¯ã€‚\nç®€è€Œè¨€ä¹‹ï¼ŒpySerial æä¾›äº†é€šè¿‡ Python ä»£ç è¿æ¥ä¸²å£è®¾å¤‡çš„åŠŸèƒ½ã€‚\n[toc]\nå®‰è£… 1 2 3 python -m pip install pyserial # or pip install pyserial åŸºæœ¬ä½¿ç”¨ æ‰“å¼€ä¸²å£è®¾å¤‡/dev/ttyUSB0ï¼Œé»˜è®¤æ³¢ç‰¹ç‡ 9600ï¼Œä¸è®¾ç½® Timeout\n1 2 3 4 5 \u003e\u003e\u003e import serial \u003e\u003e\u003e ser = serial.Serial('/dev/ttyUSB0') # open serial port \u003e\u003e\u003e print(ser.name) # check which port was really used \u003e\u003e\u003e ser.write(b'hello') # write a string \u003e\u003e\u003e ser.close() # close port æ‰“å¼€ä¸²å£è®¾å¤‡/dev/ttyS1, æ³¢ç‰¹ç‡ 19200ï¼Œè®¾ç½® Timeout ä¸º 1 ç§’\n1 2 3 4 \u003e\u003e\u003e with serial.Serial('/dev/ttyS1', 19200, timeout=1) as ser: ... x = ser.read() # read one byte ... s = ser.read(10) # read up to ten bytes (timeout) ... line = ser.readline() # read a '\\n' terminated line æ‰“å¼€ä¸²å£ COM3, æ³¢ç‰¹ç‡ 38400ï¼Œä¸è®¾ Timeout\n1 2 3 4 \u003e\u003e\u003e ser = serial.Serial('COM3', 38400, timeout=0, ... parity=serial.PARITY_EVEN, rtscts=1) \u003e\u003e\u003e s = ser.read(100) # read up to one hundred bytes ... # or as much is in the buffer åŠ¨æ€è®¾ç½®ä¸²å£å±æ€§\nå…ˆåˆ›å»º Serial å®ä¾‹ï¼Œå†è®¾ç½®å±æ€§ï¼Œé€šè¿‡ Serial.open() è¿æ¥ä¸²å£\n1 2 3 4 5 6 7 8 9 10 11 \u003e\u003e\u003e ser = serial.Serial() \u003e\u003e\u003e ser.baudrate = 19200 \u003e\u003e\u003e ser.port = 'COM1' \u003e\u003e\u003e ser Serial\u003cid=0xa81c10, open=False\u003e(port='COM1', baudrate=19200, bytesize=8, parity='N', stopbits=1, timeout=None, xonxoff=0, rtscts=0) \u003e\u003e\u003e ser.open() \u003e\u003e\u003e ser.is_open True \u003e\u003e\u003e ser.close() \u003e\u003e\u003e ser.is_open False æ”¯æŒ with è¯­æ³• context manager:\n1 2 3 4 5 with serial.Serial() as ser: ser.baudrate = 19200 ser.port = 'COM1' ser.open() ser.write(b'hello') å†…ç½®å·¥å…· pySerial åº“ä¸­å†…ç½®äº†ä¸¤ä¸ªå·¥å…·\nlist_ports miniterm list_ports list_ports èƒ½åˆ—å‡ºä¸²å£åˆ—è¡¨ï¼Œåœ¨ç»ˆç«¯ç¯å¢ƒä¸‹è¾“å…¥ python -m serial.tool.list_ports -h\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 usage: list_ports.py [-h] [-v] [-q] [-n N] [-s] [regexp] Serial port enumeration positional arguments: regexp only show ports that match this regex optional arguments: -h, --help show this help message and exit -v, --verbose show more messages -q, --quiet suppress all messages -n N only output the N-th entry -s, --include-links include entries that are symlinks to real devices # åˆ—å‡ºå¯ç”¨çš„ä¸²å£ç«¯å£ python -m serial.tools.list_ports -v /dev/ttyUSB0 desc: FT232R USB UART hwid: USB VID:PID=0403:6001 SER=A90807ZH LOCATION=1-10 /dev/ttyUSB1 desc: FT232R USB UART hwid: USB VID:PID=0403:6001 SER=AC01PSKO LOCATION=1-9 2 ports found åœ¨ Python ä»£ç é‡Œè°ƒç”¨ serial.tools.list_ports.comports()\n1 2 3 \u003e\u003e\u003e from serial.tools import list_ports \u003e\u003e\u003e list_ports.comports() [\u003cserial.tools.list_ports_linux.SysFS object at 0x7fc2c3ec5460\u003e, \u003cserial.tools.list_ports_linux.SysFS object at 0x7fc2d0aad880\u003e] miniterm miniterm æ˜¯å¯¹ pySerial è¿›è¡Œå°è£…çš„ä¸²å£ç»ˆç«¯ï¼Œè¾“å…¥ python -m serial.tools.miniterm -h:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 usage: miniterm.py [-h] [--parity {N,E,O,S,M}] [--rtscts] [--xonxoff] [--rts RTS] [--dtr DTR] [-e] [--encoding CODEC] [-f NAME] [--eol {CR,LF,CRLF}] [--raw] [--exit-char NUM] [--menu-char NUM] [-q] [--develop] [port] [baudrate] Miniterm - A simple terminal program for the serial port. positional arguments: port serial port name baudrate set baud rate, default: 9600 optional arguments: -h, --help show this help message and exit port settings: --parity {N,E,O,S,M} set parity, one of {N E O S M}, default: N --rtscts enable RTS/CTS flow control (default off) --xonxoff enable software flow control (default off) --rts RTS set initial RTS line state (possible values: 0, 1) --dtr DTR set initial DTR line state (possible values: 0, 1) --ask ask again for port when open fails data handling: -e, --echo enable local echo (default off) --encoding CODEC set the encoding for the serial port (e.g. hexlify, Latin1, UTF-8), default: UTF-8 -f NAME, --filter NAME add text transformation --eol {CR,LF,CRLF} end of line mode --raw Do no apply any encodings/transformations hotkeys: --exit-char NUM Unicode of special character that is used to exit the application, default: 29 --menu-char NUM Unicode code of special character that is used to control miniterm (menu), default: 20 diagnostics: -q, --quiet suppress non-error messages --develop show Python traceback on error ç”¨ miniterm.py è¿›å…¥ä¸²å£ç¯å¢ƒ\n1 2 3 4 5 6 miniterm.py /dev/ttyUSB1 115200 --- Miniterm on /dev/ttyUSB1 115200,8,N,1 --- --- Quit: Ctrl+] | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H --- / # æ¡ˆä¾‹ï¼šå‘ä¸²å£å†™å…¥ä»¥åŠè¯»å– 1 2 3 4 5 6 7 8 import serial device = serial.Serial('/dev/ttyUSB1', 115200) while True: str_in = input() device.write((str_in + '\\n').encode()) str_out = device.read_all().decode('utf-8') print(str_out) è¿™æ®µä»£ç ä»è¾“å…¥è¯»å–ï¼Œé€šè¿‡ä¸²å£å‘è®¾å¤‡å†™å…¥ï¼Œå†ä»ä¸²å£ä¸­è¯»å–è¿”å›çš„å€¼æ‰“å°å‡ºæ¥ã€‚\n","description":"","tags":["serial","python"],"title":"é€šè¿‡ pySerial è¿æ¥ä¸²å£","uri":"/blog/posts/Python/connect-serial-port-via-pyserial/"},{"categories":null,"content":"åŸºäº Pexpect åœ¨å¼€å‘æ¿æ‰§è¡Œ TestCase é—®é¢˜åœºæ™¯ åœ¨å¤§å¤šæ•°åµŒå…¥å¼å·¥ç¨‹ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡ä¸²å£æˆ–è€…ç½‘å£è¿æ¥å¼€å‘æ¿ï¼Œè¿›è¡Œæµ‹è¯•æˆ–è°ƒè¯•ã€‚\nå¸¦æœ‰å›ºå®šæ­¥éª¤ï¼Œä¸”å¯é€šè¿‡è¾“å‡ºåˆ¤æ–­æ‰§è¡Œç»“æœçš„ TestCaseï¼Œå¯ä»¥å°†å…¶è½¬ä¸ºè‡ªåŠ¨åŒ–æµ‹è¯•ã€‚\né€šè¿‡ ssh è¿æ¥å¼€å‘æ¿ï¼Œæµ‹è¯•ç”¨ä¾‹å¯ä»¥æ˜¯ Expect è„šæœ¬ï¼Œæˆ–è€…ä¸ºäº†æ–¹ä¾¿ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šï¼Œä½¿ç”¨ Python Unittest æ¡†æ¶ã€‚å¯ä»¥é€šè¿‡ Pexpect ï¼ˆExpect çš„ Python å®ç°ï¼‰æ¥è¾¾åˆ°ç›®æ ‡ã€‚\nç¯å¢ƒæ­å»º jenkins Python lib: pexpect å®ç° ","description":"","tags":["python","expect","jenkins"],"title":"åŸºäº Pexpect åœ¨å¼€å‘æ¿æ‰§è¡Œ TestCase","uri":"/blog/posts/execute-testcase-on-the-development-board-based-pexpect/"},{"categories":["Python","Fluent-Python"],"content":"\nå½“æˆ‘åœ¨è‡ªå·±çš„ç¨‹åºä¸­å‘ç°ç”¨åˆ°äº†æ¨¡å¼ï¼Œæˆ‘è§‰å¾—è¿™å°±è¡¨æ˜æŸä¸ªåœ°æ–¹å‡ºé”™äº†ã€‚ç¨‹åºçš„å½¢å¼åº”è¯¥ä»…ä»…åæ˜ å®ƒæ‰€è¦è§£å†³çš„é—®é¢˜ã€‚ä»£ç ä¸­å…¶ä»–ä»»ä½•å¤–åŠ çš„å½¢å¼éƒ½æ˜¯ä¸€ä¸ªä¿¡å·ï¼Œï¼ˆè‡³å°‘å¯¹æˆ‘æ¥è¯´ï¼‰è¡¨æ˜æˆ‘å¯¹é—®é¢˜çš„æŠ½è±¡è¿˜ä¸å¤Ÿæ·±â€”â€”è¿™é€šå¸¸æ„å‘³ç€è‡ªå·±æ­£åœ¨æ‰‹åŠ¨å®Œæˆäº‹æƒ…ï¼Œæœ¬åº”è¯¥é€šè¿‡å†™ä»£ç æ¥è®©å®çš„æ‰©å±•è‡ªåŠ¨å®ç°ã€‚\nâ€”â€”Paul Graham, Lisp é»‘å®¢å’Œé£é™©æŠ•èµ„äºº\nè¿­ä»£æ˜¯æ•°æ®å¤„ç†çš„åŸºçŸ³ã€‚æ‰«æå†…å­˜ä¸­æ”¾ä¸ä¸‹çš„æ•°æ®é›†æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æƒ°æ€§è·å–æ•°æ®é¡¹çš„æ–¹å¼ï¼Œå³æŒ‰éœ€ä¸€æ¬¡è·å–ä¸€ä¸ªæ•°æ®é¡¹ã€‚è¿™å°±æ˜¯è¿­ä»£å™¨æ¨¡å¼ï¼ˆIterator patternï¼‰ã€‚\næœ¬ç« è¯´æ˜ Python æ˜¯å¦‚ä½•å†…ç½®è¿­ä»£å™¨æ¨¡å¼ã€‚\nyield å…³é”®å­—ç”¨äºæ„å»ºç”Ÿæˆå™¨ï¼Œå…¶ä½œç”¨äºè¿­ä»£å™¨ä¸€æ ·\næ‰€æœ‰çš„ç”Ÿæˆå™¨éƒ½æ˜¯è¿­ä»£å™¨ã€‚å®ƒä»¬éƒ½å®ç°äº†è¿­ä»£å™¨æ¥å£ï¼ŒåŒºåˆ«äºè¿­ä»£å™¨ç”¨äºä»é›†åˆä¸­å–å‡ºå…ƒç´ ï¼Œç”Ÿæˆå™¨ç”¨æ¥ç”Ÿæˆå…ƒç´ ã€‚\nåœ¨ Python ä¸­ï¼Œæ‰€æœ‰é›†åˆéƒ½å¯ä»¥è¿­ä»£ï¼Œè¿­ä»£å™¨ç”¨äºæ”¯æŒ\nfor å¾ªç¯ æ„å»ºå’Œæ‹“å±•é›†åˆç±»å‹ é€è¡Œéå†æ–‡æœ¬æ–‡ä»¶ åˆ—è¡¨æ¨å¯¼ã€å­—å…¸æ¨å¯¼å’Œé›†åˆæ¨å¯¼ å…ƒç¥–æ‹†åŒ… è°ƒç”¨å‡½æ•°æ—¶ï¼Œ * æ‹†åŒ…å®å‚ æœ¬ç« è¦†ç›–è¯é¢˜ï¼š\nä½¿ç”¨ iter(...) å†…ç½®å‚æ•°å¤„ç†å¯è¿­ä»£å¯¹è±¡çš„æ–¹å¼ å¦‚ä½•ä½¿ç”¨ Python å®ç°è¿­ä»£å™¨æ¨¡å¼ ç”Ÿæˆå™¨å‡½æ•°çš„å·¥ä½œåŸç† ä½¿ç”¨ç”Ÿæˆå™¨ å‡½æ•°/è¡¨è¾¾å¼ ä»£æ›¿è¿­ä»£å™¨ ä½¿ç”¨æ ‡å‡†åº“ä¸­çš„é€šç”¨ç”Ÿæˆå™¨å‡½æ•° ä½¿ç”¨ yield from è¯­å¥åˆå¹¶ç”Ÿæˆå™¨ æ¡ˆä¾‹ï¼š æ•°æ®åº“è½¬æ¢å·¥å…·ä¸­ä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°å¤„ç†å¤§å‹æ•°æ®é›† ç”Ÿæˆå™¨å’Œåç¨‹çš„å·®å¼‚ å…ˆæ¥å†™ä¸€ä¸ªå¯è¿­ä»£çš„ Sentence ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 \"\"\" Sentence class v1 \"\"\" import re import reprlib RE_WORD = re.compile('\\w+') class Sentence: def __init__(self, text): self.text = text self.words = RE_WORD.findall(text) def __getitem__(self, index): return self.words[index] def __len__(self): return len(self.words) def __repr__(self): return 'Sentence(%s)' % reprlib.repr(self.text) s = Sentence('\"The time has come\", the Walrus said,') print(s) for word in s: print(word) print(list(s)) è¿­ä»£å™¨åè®® Python è§£é‡Šå™¨åœ¨è¿­ä»£ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ iter(x)ã€‚\nå†…ç½®çš„ iter å‡½æ•°ä¼šåšä»¥ä¸‹æ“ä½œï¼š\næ£€æŸ¥å¯¹è±¡æ˜¯å¦å®ç°äº† __iter__ æ–¹æ³•ï¼ˆabc.Iterableï¼‰ï¼Œè‹¥å®ç°ï¼Œä¸”è¿”å›çš„ç»“æœæ˜¯ä¸ªè¿­ä»£å™¨ï¼ˆabc.Iteratorï¼‰ï¼Œåˆ™è°ƒç”¨å®ƒï¼Œè·å–è¿­ä»£å™¨å¹¶è¿”å›ï¼› è‹¥æ²¡å®ç°ï¼Œä½†å®ç°äº† __getitem__ æ–¹æ³•ï¼ˆabc.Sequenceï¼‰ï¼Œè‹¥å®ç°åˆ™å°è¯•ä» 0 å¼€å§‹æŒ‰é¡ºåºè·å–å…ƒç´ å¹¶è¿”å›ï¼› ä»¥ä¸Šå°è¯•å¤±è´¥ï¼ŒæŠ›å‡º TypeErrorï¼Œè¡¨æ˜å¯¹è±¡ä¸å¯è¿­ä»£ã€‚ åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯è¿­ä»£ï¼Œæœ€å¥½çš„æ–¹æ³•ä¸æ˜¯ç”¨ isinstance æ¥åˆ¤æ–­ï¼Œè€Œåº”è¯¥ç›´æ¥å°è¯•è°ƒç”¨ iter å‡½æ•°ã€‚\næ³¨ï¼šå¯è¿­ä»£å¯¹è±¡å’Œè¿­ä»£å™¨ä¸ä¸€æ ·ã€‚ä»é¸­å­ç±»å‹çš„è§’åº¦çœ‹ï¼Œå¯è¿­ä»£å¯¹è±¡ Iterable è¦å®ç° __iter__ï¼Œè€Œè¿­ä»£å™¨ Iterator è¦å®ç° __next__. ä¸è¿‡ï¼Œè¿­ä»£å™¨ä¸Šä¹Ÿå®ç°äº† __iter__ï¼Œç”¨äºè¿”å›è‡ªèº«ã€‚\nè¿­ä»£å™¨çš„å…·ä½“å®ç° ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹ä¸€ä¹¦è®²è§£è¿­ä»£å™¨è®¾è®¡æ¨¡å¼æ—¶ï¼Œåœ¨â€œé€‚ç”¨æ€§â€ä¸€ èŠ‚ä¸­è¯´ï¼š è¿­ä»£å™¨æ¨¡å¼å¯ç”¨æ¥ï¼š\nè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡çš„å†…å®¹è€Œæ— éœ€æš´éœ²å®ƒçš„å†…éƒ¨è¡¨ç¤º\næ”¯æŒå¯¹èšåˆå¯¹è±¡çš„å¤šç§éå†\nä¸ºéå†ä¸åŒçš„èšåˆç»“æ„æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼ˆå³æ”¯æŒå¤šæ€è¿­ä»£ï¼‰\nä¸ºäº†â€œæ”¯æŒå¤šç§éå†â€ï¼Œå¿…é¡»èƒ½ä»åŒä¸€ä¸ªå¯è¿­ä»£çš„å®ä¾‹ä¸­è·å–å¤šä¸ªç‹¬ç«‹çš„è¿­ä»£å™¨ï¼Œè€Œä¸”å„ä¸ªè¿­ä»£å™¨è¦èƒ½ç»´æŠ¤è‡ªèº«çš„å†…éƒ¨çŠ¶æ€ï¼Œå› æ­¤è¿™ä¸€æ¨¡å¼æ­£ç¡®çš„å®ç°æ–¹å¼æ˜¯ï¼Œæ¯æ¬¡è°ƒç”¨ iter(my_iterable) éƒ½æ–°å»ºä¸€ä¸ªç‹¬ç«‹çš„è¿­ä»£å™¨ã€‚\nåºåˆ—å¯è¿­ä»£çš„åŸå› ï¼šiterå‡½æ•° è§£é‡Šå™¨éœ€è¦è¿­ä»£å¯¹è±¡ x æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ iter(x):\næ£€æŸ¥å¯¹è±¡æ˜¯å¦å®ç°äº† __iter__ æ–¹æ³•å¹¶è°ƒç”¨ï¼Œè·å–åˆ°è¿­ä»£å™¨\nå¦‚æœæ²¡æœ‰å®ç°__iter__, æ£€æŸ¥æ˜¯å¦æœ‰ __getitem__ å‡½æ•°ï¼Œå°è¯•æŒ‰é¡ºåºä¸‹æ ‡è·å–å…ƒç´ \nå¦‚æœä¸Šè¿°çŠ¶å†µéƒ½ä¸ç¬¦åˆï¼Œ æŠ›å‡º \"C object is not iterable\" å¼‚å¸¸\nè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªç¤ºä¾‹éœ€è¦å®šä¹‰ SentenceIterator ç±»ã€‚æ‰€ä»¥ï¼Œä¸åº”è¯¥æŠŠ Sentence æœ¬èº«ä½œä¸ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¦åˆ™æ¯æ¬¡è°ƒç”¨ iter(sentence) æ—¶è¿”å›çš„éƒ½æ˜¯è‡ªèº«ï¼Œå°±æ— æ³•è¿›è¡Œå¤šæ¬¡è¿­ä»£äº†ã€‚\nä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„ SentenceIterator å¯¹è±¡ç»§æ‰¿è‡ª abc.Iterator é€šè¿‡äº†è¿­ä»£å™¨æµ‹è¯•ã€‚è€Œä¸” Iterator æ›¿æˆ‘ä»¬å®ç°äº† __iter__ æ–¹æ³•ã€‚\nä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ä¸ç»§æ‰¿å®ƒï¼Œæˆ‘ä»¬å°±éœ€è¦åŒæ—¶å®ç° __next__ æŠ½è±¡æ–¹æ³•å’Œå®é™…è¿­ä»£ä¸­å¹¶ä¸ä¼šç”¨åˆ°çš„ __iter__ éæŠ½è±¡æ–¹æ³•ï¼Œæ‰èƒ½é€šè¿‡ Iterator æµ‹è¯•ã€‚\nå¯è¿­ä»£å¯¹è±¡ä¸è¿­ä»£å™¨çš„æ¯”è¾ƒ å¯è¿­ä»£å¯¹è±¡\nä½¿ç”¨ iter å†…ç½®å‡½æ•°å¯ä»¥è·å–è¿­ä»£å™¨çš„å¯¹è±¡ã€‚\nè¿­ä»£å™¨\nè¿­ä»£å™¨æ˜¯ä¸€ç§å¯¹è±¡ï¼šå®ç°äº† __next__ æ–¹æ³•ï¼Œè¿”å›åºåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶åœ¨æ— å…ƒç´ å¯è¿­ä»£æ—¶æŠ›å‡º StopIteration å¼‚å¸¸ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 \"\"\" Sentence class v2: åŠ ä¸Šä¸€ä¸ªè¿­ä»£å™¨ \"\"\" import re import reprlib RE_WORD = re.compile('\\w+') class Sentence: def __init__(self, text): self.text = text self.words = RE_WORD.findall(text) def __iter__(self): return SentenceIterator(self.words) def __repr__(self): return 'Sentence(%s)' % reprlib.repr(self.text) class SentenceIterator: def __init__(self, words): self.words = words self.index = 0 def __next__(self): try: word = self.words[self.index] except IndexError: raise StopIteration() self.index += 1 return word def __iter__(self): return self s = Sentence('\"The time has come\", the Walrus said,') print(s) for word in s: print(word) print(list(s)) ç”Ÿæˆå™¨å‡½æ•° ç”Ÿæˆå™¨å‡½æ•°çš„å·¥ä½œåŸç† åªè¦å‡½æ•°çš„å®šä¹‰ä½“ä¸­æœ‰ yield å…³é”®å­—ï¼Œè¯¥å‡½æ•°å°±æ˜¯ç”Ÿæˆå™¨å‡½æ•°ã€‚\nè°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ä¼šè¿”å›ç”Ÿæˆå™¨å¯¹è±¡ã€‚\nå¦‚æœæ‡’å¾—è‡ªå·±å†™ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¯ä»¥ç›´æ¥ç”¨ Python çš„ç”Ÿæˆå™¨å‡½æ•°æ¥åœ¨è°ƒç”¨ __iter__ æ—¶ç”Ÿæˆä¸€ä¸ªè¿­ä»£å™¨ã€‚\nåœ¨ Python ç¤¾åŒºä¸­ï¼Œå¤§å®¶å¹¶æ²¡æœ‰å¯¹â€œç”Ÿæˆå™¨â€å’Œâ€œè¿­ä»£å™¨â€ä¸¤ä¸ªæ¦‚å¿µåšå¤ªå¤šåŒºåˆ†ï¼Œå¾ˆå¤šäººæ˜¯æ··ç€ç”¨çš„ã€‚ä¸è¿‡æ— æ‰€è°“å•¦ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 \"\"\" Sentence class v3ï¼šç”Ÿæˆå™¨å‡½æ•° \"\"\" import re import reprlib RE_WORD = re.compile('\\w+') class Sentence: def __init__(self, text): self.text = text self.words = RE_WORD.findall(text) def __iter__(self): for word in self.words: yield word def __repr__(self): return 'Sentence(%s)' % reprlib.repr(self.text) s = Sentence('\"The time has come\", the Walrus said,') print(s) for word in s: print(word) print(list(s)) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \"\"\" Sentence class v4ï¼šæƒ°æ€§æ±‚å€¼ \"\"\" import re RE_WORD = re.compile('\\w+') class Sentence: def __init__(self, text): self.text = text def __iter__(self): for match in RE_WORD.finditer(self.text): yield match.group() s = Sentence('\"The time has come\", the Walrus said,') print(s) for word in s: print(word) print(list(s)) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 \"\"\" Sentence class v5: ç”Ÿæˆå™¨å‡½æ•° \"\"\" import re RE_WORD = re.compile('\\w+') class Sentence: def __init__(self, text): self.text = text def __iter__(self): return (match.group() for match in RE_WORD.finditer(self.text)) s = Sentence('\"The time has come\", the Walrus said,') print(s) for word in s: print(word) print(list(s)) ä½•æ—¶ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼ å¦‚æœç”Ÿæˆå™¨è¡¨è¾¾å¼è¦åˆ†å¤šè¡Œå†™ï¼Œå€¾å‘å®šä¹‰ç”Ÿæˆå™¨å‡½æ•°ã€‚ æ¡ˆä¾‹ï¼šä½¿ç”¨ itertoolsæ¨¡å—ç”Ÿæˆç­‰å·®æ•°åˆ— 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 # å®ç”¨æ¨¡å— import itertools # takewhile \u0026 dropwhile print(list(itertools.takewhile(lambda x: x \u003c 3, [1, 5, 2, 4, 3]))) print(list(itertools.dropwhile(lambda x: x \u003c 3, [1, 5, 2, 4, 3]))) # zip print(list(zip(range(5), range(3)))) print(list(itertools.zip_longest(range(5), range(3)))) # itertools.groupby animals = ['rat', 'bear', 'duck', 'bat', 'eagle', 'shark', 'dolphin', 'lion'] # groupby éœ€è¦å‡å®šè¾“å…¥çš„å¯è¿­ä»£å¯¹è±¡å·²ç»æŒ‰ç…§åˆ†ç»„æ ‡å‡†è¿›è¡Œæ’åºï¼ˆè‡³å°‘åŒç»„çš„å…ƒç´ è¦è¿åœ¨ä¸€èµ·ï¼‰ print('----') for length, animal in itertools.groupby(animals, len): print(length, list(animal)) print('----') animals.sort(key=len) for length, animal in itertools.groupby(animals, len): print(length, list(animal)) print('---') # tee g1, g2 = itertools.tee('abc', 2) print(list(zip(g1, g2))) 1 2 3 4 5 6 7 8 9 10 # ä½¿ç”¨ yield from è¯­å¥å¯ä»¥åœ¨ç”Ÿæˆå™¨å‡½æ•°ä¸­ç›´æ¥è¿­ä»£ä¸€ä¸ªè¿­ä»£å™¨ from itertools import chain def my_itertools_chain(*iterators): for iterator in iterators: yield from iterator chain1 = my_itertools_chain([1, 2], [3, 4, 5]) chain2 = chain([1, 2, 3], [4, 5]) print(list(chain1), list(chain2)) [1, 2, 3, 4, 5] [1, 2, 3, 4, 5] iter å‡½æ•°è¿˜æœ‰ä¸€ä¸ªé²œä¸ºäººçŸ¥çš„ç”¨æ³•ï¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œä½¿ç”¨å¸¸è§„çš„å‡½æ•°æˆ–ä»»ä½•å¯è°ƒç”¨çš„å¯¹è±¡åˆ›å»ºè¿­ä»£å™¨ã€‚è¿™æ ·ä½¿ç”¨æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯å¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºä¸æ–­è°ƒç”¨ï¼ˆæ²¡æœ‰å‚æ•°ï¼‰ï¼Œäº§å‡ºå„ä¸ªå€¼ï¼›ç¬¬äºŒä¸ªå€¼æ˜¯å“¨ç¬¦ï¼Œè¿™æ˜¯ä¸ªæ ‡è®°å€¼ï¼Œå½“å¯è°ƒç”¨çš„å¯¹è±¡è¿”å›è¿™ä¸ªå€¼æ—¶ï¼Œè§¦å‘è¿­ä»£å™¨æŠ›å‡º StopIteration å¼‚å¸¸ï¼Œè€Œä¸äº§å‡ºå“¨ç¬¦ã€‚\n1 2 3 4 5 6 7 8 # iter çš„ç¥å¥‡ç”¨æ³• # iter(callable, sentinel) import random def rand(): return random.randint(1, 6) # ä¸åœè°ƒç”¨ rand(), ç›´åˆ°äº§å‡ºä¸€ä¸ª 5 print(list(iter(rand, 5))) [2, 6, 6, 4, 1, 3, 4] æ ‡å‡†åº“ä¸­çš„ç”Ÿæˆå™¨å‡½æ•° è¿™é‡Œä½œè€…å°†å¸¸è§ç”Ÿæˆå™¨å‡½æ•°æŒ‰ç…§ä½œç”¨åˆ†ç±»å¦‚ä¸‹ï¼š\n// 625 é¡µ\nyield from å¦‚æœç”Ÿæˆå™¨å‡½æ•°éœ€è¦äº§å‡ºçš„æ˜¯å¦å¤–ä¸€ä¸ªç”Ÿæˆå™¨çš„å€¼ï¼Œä¼ ç»Ÿçš„æ–¹æ³•æ˜¯ç”¨åµŒå¥— for å¾ªç¯ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 def chain(*iterables): for it in iterables: for i in it: yield i s = 'ABC' t = tuple(range(3)) print(list(chain(s, t))) def chain(*iterables): for i in iterables: yield from i s = 'ABC' t = tuple(range(3)) print(list(chain(s, t))) ['A', 'B', 'C', 0, 1, 2] ['A', 'B', 'C', 0, 1, 2] å¯ä»¥çœ‹å‡º yield from æ›¿ä»£äº†å†…å±‚å¾ªç¯ï¼Œåé¢ä¼šè¯´æ˜ä¸ºä»€ä¹ˆ yield from ä¸åªæ˜¯è¯­æ³•ç³–ã€‚\n[PEP 380 -- Syntax for Delegating to a Subgenerator][https://www.python.org/dev/peps/pep-0380/]\nå¯è¿­ä»£çš„è§„çº¦å‡½æ•° è§„çº¦å‡½æ•°æ˜¯æŒ‡ï¼šå‡½æ•°éƒ½æ¥å—ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œç„¶åè¿”å›å•ä¸ªç»“æœ\n// 640 é¡µ\nä¸æ­¤ç›¸å¯¹ï¼Œæ¥å—ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡è¿”å›ä¸åŒçš„å€¼çš„å‡½æ•° sortedã€‚\næ·±å…¥åˆ†æ iter å‡½æ•° iter å‡½æ•°è¿˜æœ‰ä¸€ä¸ªé²œä¸ºäººçŸ¥çš„ç”¨æ³•ï¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œä½¿ç”¨å¸¸è§„çš„å‡½æ•°æˆ–ä»»ä½•å¯è°ƒç”¨å¯¹è±¡åˆ›å»ºè¿­ä»£å™¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯è°ƒç”¨å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯å“¨ç¬¦ã€‚å½“å¯è°ƒç”¨å¯¹è±¡è¿”å›å“¨ç¬¦æ—¶ï¼Œè§¦å‘ ~StopIteration~ å¼‚å¸¸ï¼Œä¸äº§å‡ºå“¨ç¬¦ã€‚\n1 2 3 4 5 6 7 8 9 from random import randint def d6(): return randint(1, 6) d6_iter = iter(d6, 1) for roll in d6_iter: print(roll) å†…ç½®å‡½æ•° iter æ–‡æ¡£\né‡Œé¢ä¸€ä¸ªå®ç”¨çš„ä¾‹å­\n1 2 3 4 # é€è¡Œè¯»å–æ–‡ä»¶ï¼Œç›´åˆ°é‡åˆ°ç©ºè¡Œæˆ–åˆ°è¾¾æ–‡ä»¶æœ«å°¾ with open('mydata.txt') as fp: for line in iter(fp.readline, '\\n'): process_line(line) æŠŠç”Ÿæˆå™¨å½“åšåç¨‹ (PEP 342 -- Coroutines via Enhanced Generators)[https://www.python.org/dev/peps/pep-0342/] ææ¡ˆä¸ºç”Ÿæˆå™¨å¯¹è±¡æ·»åŠ äº†é¢å¤–çš„æ–¹æ³•å’ŒåŠŸèƒ½\nå…¶ä¸­æœ€å€¼å¾—æ³¨æ„çš„æ˜¯ .send() æ–¹æ³•ã€‚å®ƒä½¿ç”Ÿæˆå™¨å‰è¿›é“ä¸‹ä¸€ä¸ª yield è¯­å¥ï¼Œè¿˜å…è®¸ä½¿ç”¨ç”Ÿæˆå™¨çš„å®¢æˆ·æŠŠæ•°æ®å‘ç»™è‡ªå·±ã€‚è€Œ .__next__() æ–¹æ³•åªå…è®¸å®¢æˆ·ä»ç”Ÿæˆå™¨ä¸­è·å–æ•°æ®ã€‚\nè¿™ä½¿å¾—ç”Ÿæˆå™¨å˜èº«æˆåç¨‹ã€‚è¿™é‡Œå…³äºç”Ÿæˆå™¨å’Œåç¨‹çš„ä¸€äº›æé†’ï¼š\nç”Ÿæˆå™¨ç”¨äºç”Ÿæˆä¾›è¿­ä»£çš„æ•°æ®\nåç¨‹æ˜¯æ•°æ®çš„æ¶ˆè´¹è€…\nä¸è¦æŠŠä¸¤ä¸ªæ¦‚å¿µæ··ä¸ºä¸€è°ˆ\nåç¨‹ä¸è¿­ä»£æ— å…³\nè™½ç„¶åç¨‹ä¸­ä¼šä½¿ç”¨ yield äº§å‡ºå€¼ï¼Œä½†è¿™ä¸è¿­ä»£æ— å…³\n","description":"","tags":["python"],"title":"ã€Šæµç•…çš„Pythonã€‹å¯è¿­ä»£çš„å¯¹è±¡ã€è¿­ä»£å™¨å’Œç”Ÿæˆå™¨","uri":"/blog/posts/Python/Fluent-Python/fluent-python-iterable-objects-iterators-and-generators/"},{"categories":["Python"],"content":" æ–‡ç« è½¬è½½è‡ªï¼š\nhttps://hanjianwei.com/2013/07/25/python-mro/\nä»€ä¹ˆæ˜¯MRO å¯¹äºæ”¯æŒç»§æ‰¿çš„ç¼–ç¨‹è¯­è¨€æ¥è¯´ï¼Œå…¶æ–¹æ³•ï¼ˆå±æ€§ï¼‰å¯èƒ½å®šä¹‰åœ¨å½“å‰ç±»ï¼Œä¹Ÿå¯èƒ½æ¥è‡ªäºåŸºç±»ï¼Œæ‰€ä»¥åœ¨æ–¹æ³•è°ƒç”¨æ—¶å°±éœ€è¦å¯¹å½“å‰ç±»å’ŒåŸºç±»è¿›è¡Œæœç´¢ä»¥ç¡®å®šæ–¹æ³•æ‰€åœ¨çš„ä½ç½®ã€‚\nè€Œæœç´¢çš„é¡ºåºå°±æ˜¯æ‰€è°“çš„ã€Œæ–¹æ³•è§£æé¡ºåºã€ï¼ˆMethod Resolution Orderï¼Œæˆ–MROï¼‰ã€‚å¯¹äºåªæ”¯æŒå•ç»§æ‰¿çš„è¯­è¨€æ¥è¯´ï¼ŒMRO ä¸€èˆ¬æ¯”è¾ƒç®€å•ï¼›è€Œå¯¹äº Python è¿™ç§æ”¯æŒå¤šç»§æ‰¿çš„è¯­è¨€æ¥è¯´ï¼ŒMRO å°±å¤æ‚å¾ˆå¤šã€‚\nå…ˆçœ‹ä¸€ä¸ªã€Œè±å½¢ç»§æ‰¿ã€çš„ä¾‹å­ï¼š\nå¦‚æœ x æ˜¯ D çš„ä¸€ä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆ x.show() åˆ°åº•ä¼šè°ƒç”¨å“ªä¸ª show æ–¹æ³•å‘¢ï¼Ÿ\nå¦‚æœæŒ‰ç…§ [D, B, A, C] çš„æœç´¢é¡ºåºï¼Œé‚£ä¹ˆ x.show() ä¼šè°ƒç”¨ A.show()ï¼›\nå¦‚æœæŒ‰ç…§ [D, B, C, A] çš„æœç´¢é¡ºåºï¼Œé‚£ä¹ˆ x.show() ä¼šè°ƒç”¨ C.show()ã€‚\nç”±æ­¤å¯è§ï¼ŒMRO æ˜¯æŠŠç±»çš„ç»§æ‰¿å…³ç³»çº¿æ€§åŒ–çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œè€Œçº¿æ€§åŒ–æ–¹å¼å†³å®šäº†ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å…·ä½“ä¼šè°ƒç”¨å“ªä¸ªæ–¹æ³•ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œé‚£ä»€ä¹ˆæ ·çš„ MRO æ‰æ˜¯æœ€åˆç†çš„ï¼ŸPython ä¸­åˆæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ\nPython è‡³å°‘æœ‰ä¸‰ç§ä¸åŒçš„ MROï¼š\nç»å…¸ç±»ï¼ˆclassic classï¼‰çš„æ·±åº¦éå†ã€‚ Python 2.2 çš„æ–°å¼ç±»ï¼ˆnew-style classï¼‰é¢„è®¡ç®—ã€‚ Python 2.3 çš„æ–°å¼ç±»çš„ C3 ç®—æ³•ã€‚å®ƒä¹Ÿæ˜¯ Python 3 å”¯ä¸€æ”¯æŒçš„æ–¹å¼ã€‚ ç»å…¸ç±»çš„ MRO Python æœ‰ä¸¤ç§ç±»ï¼šç»å…¸ç±»ï¼ˆclassic classï¼‰å’Œæ–°å¼ç±»ï¼ˆnew-style classï¼‰ã€‚ä¸¤è€…çš„ä¸åŒä¹‹å¤„åœ¨äºæ–°å¼ç±»ç»§æ‰¿è‡ª objectã€‚\nåœ¨ Python 2.1 ä»¥å‰ï¼Œç»å…¸ç±»æ˜¯å”¯ä¸€å¯ç”¨çš„å½¢å¼ï¼›Python 2.2 å¼•å…¥äº†æ–°å¼ç±»ï¼Œä½¿å¾—ç±»å’Œå†…ç½®ç±»å‹æ›´åŠ ç»Ÿä¸€ï¼›åœ¨ Python 3 ä¸­ï¼Œæ–°å¼ç±»æ˜¯å”¯ä¸€æ”¯æŒçš„ç±»ã€‚\nç»å…¸ç±»é‡‡ç”¨äº†ä¸€ç§å¾ˆç®€å•çš„ MRO æ–¹æ³•ï¼šä»å·¦è‡³å³çš„æ·±åº¦ä¼˜å…ˆéå†ã€‚ä»¥ä¸Šè¿°ã€Œè±å½¢ç»§æ‰¿ã€ä¸ºä¾‹ï¼Œå…¶æŸ¥æ‰¾é¡ºåºä¸º [D, B, A, C, A]ï¼Œå¦‚æœåªä¿ç•™é‡å¤ç±»çš„ç¬¬ä¸€ä¸ªåˆ™ç»“æœä¸º [D, B, A, C]ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ inspect.getmro æ¥è·å–ç±»çš„ MROï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \u003e\u003e\u003e import inspect \u003e\u003e\u003e class A: ... def show(self): ... print \"A.show()\" ... \u003e\u003e\u003e class B(A): pass \u003e\u003e\u003e class C(A): ... def show(self): ... print \"C.show()\" ... \u003e\u003e\u003e class D(B, C): pass \u003e\u003e\u003e inspect.getmro(D) (\u003cclass __main__.D at 0x105f0a6d0\u003e, \u003cclass __main__.B at 0x105f0a600\u003e, \u003cclass __main__.A at 0x105f0a668\u003e, \u003cclass __main__.C at 0x105f0a738\u003e) \u003e\u003e\u003e x = D() \u003e\u003e\u003e x.show() A.show() è¿™ç§æ·±åº¦ä¼˜å…ˆéå†å¯¹äºç®€å•çš„æƒ…å†µè¿˜èƒ½å¤„ç†çš„ä¸é”™ï¼Œä½†æ˜¯å¯¹äºä¸Šè¿°ã€Œè±å½¢ç»§æ‰¿ã€å…¶ç»“æœå´ä¸å°½å¦‚äººæ„ï¼šè™½ç„¶ C.show() æ˜¯ A.show() çš„æ›´å…·ä½“åŒ–ç‰ˆæœ¬ï¼ˆæ˜¾ç¤ºäº†æ›´å¤šçš„ä¿¡æ¯ï¼‰ï¼Œä½†æˆ‘ä»¬çš„ x.show() æ²¡æœ‰è°ƒç”¨å®ƒï¼Œè€Œæ˜¯è°ƒç”¨äº† A.show()ã€‚è¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çš„ç»“æœã€‚\nå¯¹äºæ–°å¼ç±»è€Œè¨€ï¼Œæ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿è‡ª objectï¼Œæ‰€ä»¥ã€Œè±å½¢ç»§æ‰¿ã€æ˜¯éå¸¸æ™®éçš„ç°è±¡ï¼Œå› æ­¤ä¸å¯èƒ½é‡‡ç”¨è¿™ç§ MRO æ–¹å¼ã€‚\nPython 2.2 çš„æ–°å¼ç±» MRO ä¸ºè§£å†³ç»å…¸ç±» MRO æ‰€å­˜åœ¨çš„é—®é¢˜ï¼ŒPython 2.2 é’ˆå¯¹æ–°å¼ç±»æå‡ºäº†ä¸€ç§æ–°çš„ MRO è®¡ç®—æ–¹å¼ï¼šåœ¨å®šä¹‰ç±»æ—¶å°±è®¡ç®—å‡ºè¯¥ç±»çš„ MRO å¹¶å°†å…¶ä½œä¸ºç±»çš„å±æ€§ã€‚å› æ­¤æ–°å¼ç±»å¯ä»¥ç›´æ¥é€šè¿‡ __mro__ å±æ€§è·å–ç±»çš„ MROã€‚\nPython 2.2 çš„æ–°å¼ç±» MRO è®¡ç®—æ–¹å¼å’Œç»å…¸ç±» MRO çš„è®¡ç®—æ–¹å¼éå¸¸ç›¸ä¼¼ï¼šå®ƒä»ç„¶é‡‡ç”¨ä»å·¦è‡³å³çš„æ·±åº¦ä¼˜å…ˆéå†ï¼Œä½†æ˜¯å¦‚æœéå†ä¸­å‡ºç°é‡å¤çš„ç±»ï¼Œåªä¿ç•™æœ€åä¸€ä¸ªã€‚é‡æ–°è€ƒè™‘ä¸Šé¢ã€Œè±å½¢ç»§æ‰¿ã€çš„ä¾‹å­ï¼Œç”±äºæ–°å¼ç±»ç»§æ‰¿è‡ª object å› æ­¤ç±»å›¾ç¨æœ‰æ”¹å˜ï¼š\næŒ‰ç…§æ·±åº¦éå†ï¼Œå…¶é¡ºåºä¸º [D, B, A, object, C, A, object]ï¼Œé‡å¤ç±»åªä¿ç•™æœ€åä¸€ä¸ªï¼Œå› æ­¤å˜ä¸º [D, B, C, A, object]ã€‚ä»£ç ä¸ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 \u003e\u003e\u003e class A(object): ... def show(self): ... print \"A.show()\" ... \u003e\u003e\u003e class B(A): pass \u003e\u003e\u003e class C(A): ... def show(self): ... print \"C.show()\" ... \u003e\u003e\u003e class D(B, C): pass \u003e\u003e\u003e D.__mro__ (\u003cclass '__main__.D'\u003e, \u003cclass '__main__.B'\u003e, \u003cclass '__main__.C'\u003e, \u003cclass '__main__.A'\u003e, \u003ctype 'object'\u003e) \u003e\u003e\u003e x = D() \u003e\u003e\u003e x.show() C.show() è¿™ç§ MRO æ–¹å¼å·²ç»èƒ½å¤Ÿè§£å†³ã€Œè±å½¢ç»§æ‰¿ã€é—®é¢˜ï¼Œå†è®©æˆ‘ä»¬çœ‹ä¸ªç¨å¾®å¤æ‚ç‚¹çš„ä¾‹å­ï¼š\n1 2 3 4 5 \u003e\u003e\u003e class X(object): pass \u003e\u003e\u003e class Y(object): pass \u003e\u003e\u003e class A(X, Y): pass \u003e\u003e\u003e class B(Y, X): pass \u003e\u003e\u003e class C(A, B): pass é¦–å…ˆè¿›è¡Œæ·±åº¦éå†ï¼Œç»“æœä¸º [C, A, X, object, Y, object, B, Y, object, X, object]ï¼›ç„¶åï¼Œåªä¿ç•™é‡å¤å…ƒç´ çš„æœ€åä¸€ä¸ªï¼Œç»“æœä¸º [C, A, B, Y, X, object]ã€‚Python 2.2 åœ¨å®ç°è¯¥æ–¹æ³•çš„æ—¶å€™è¿›è¡Œäº†è°ƒæ•´ï¼Œä½¿å…¶æ›´å°Šé‡åŸºç±»ä¸­ç±»å‡ºç°çš„é¡ºåºï¼Œå…¶å®é™…ç»“æœä¸º [C, A, B, X, Y, object]ã€‚\nè¿™æ ·çš„ç»“æœæ˜¯å¦åˆç†å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬çœ‹ä¸‹å„ä¸ªç±»ä¸­çš„æ–¹æ³•è§£æé¡ºåºï¼šå¯¹äº A æ¥è¯´ï¼Œå…¶æœç´¢é¡ºåºä¸º [A, X, Y, object]ï¼›å¯¹äº Bï¼Œå…¶æœç´¢é¡ºåºä¸º [B, Y, X, object]ï¼›å¯¹äº Cï¼Œå…¶æœç´¢é¡ºåºä¸º [C, A, B, X, Y, object]ã€‚æˆ‘ä»¬ä¼šå‘ç°ï¼ŒB å’Œ C ä¸­ Xã€Y çš„æœç´¢é¡ºåºæ˜¯ç›¸åçš„ï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ B è¢«ç»§æ‰¿æ—¶ï¼Œå®ƒæœ¬èº«çš„è¡Œä¸ºç«Ÿç„¶ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ï¼Œè¿™å¾ˆå®¹æ˜“å¯¼è‡´ä¸æ˜“å¯Ÿè§‰çš„é”™è¯¯ã€‚æ­¤å¤–ï¼Œå³ä½¿æŠŠ C æœç´¢é¡ºåºä¸­ X å’Œ Y äº’æ¢ä»ç„¶ä¸èƒ½è§£å†³é—®é¢˜ï¼Œè¿™æ—¶å€™å®ƒåˆä¼šå’Œ A ä¸­çš„æœç´¢é¡ºåºç›¸çŸ›ç›¾ã€‚\näº‹å®ä¸Šï¼Œä¸ä½†ä¸Šè¿°ç‰¹æ®Šæƒ…å†µä¼šå‡ºç°é—®é¢˜ï¼Œåœ¨å…¶å®ƒæƒ…å†µä¸‹ä¹Ÿå¯èƒ½å‡ºé—®é¢˜ã€‚å…¶åŸå› åœ¨äºï¼Œä¸Šè¿°ç»§æ‰¿å…³ç³»è¿åäº†çº¿æ€§åŒ–çš„ã€Œ å•è°ƒæ€§åŸåˆ™ ã€ã€‚Michele Simionatoå¯¹å•è°ƒæ€§çš„å®šä¹‰ä¸ºï¼š\nA MRO is monotonic when the following is true: if C1 precedes C2 in the linearization of C, then C1 precedes C2 in the linearization of any subclass of C. Otherwise, the innocuous operation of deriving a new class could change the resolution order of methods, potentially introducing very subtle bugs.\nä¹Ÿå°±æ˜¯è¯´ï¼Œå­ç±»ä¸èƒ½æ”¹å˜åŸºç±»çš„æ–¹æ³•æœç´¢é¡ºåºã€‚åœ¨ Python 2.2 çš„ MRO ç®—æ³•ä¸­å¹¶ä¸èƒ½ä¿è¯è¿™ç§å•è°ƒæ€§ï¼Œå®ƒä¸ä¼šé˜»æ­¢ç¨‹åºå‘˜å†™å‡ºä¸Šè¿°å…·æœ‰äºŒä¹‰æ€§çš„ç»§æ‰¿å…³ç³»ï¼Œå› æ­¤å¾ˆå¯èƒ½æˆä¸ºé”™è¯¯çš„æ ¹æºã€‚\né™¤äº†å•è°ƒæ€§ä¹‹å¤–ï¼ŒPython 2.2 åŠ ç»å…¸ç±»çš„ MRO ä¹Ÿå¯èƒ½è¿åç»§æ‰¿çš„ã€Œ å±€éƒ¨ä¼˜å…ˆçº§ ã€ï¼Œå…·ä½“ä¾‹å­å¯ä»¥å‚è§å®˜æ–¹æ–‡æ¡£ã€‚é‡‡ç”¨ä¸€ç§æ›´å¥½çš„ MRO æ–¹å¼åŠ¿åœ¨å¿…è¡Œã€‚\nC3 MRO ä¸ºè§£å†³ Python 2.2 ä¸­ MRO æ‰€å­˜åœ¨çš„é—®é¢˜ï¼ŒPython 2.3ä»¥åé‡‡ç”¨äº† C3 æ–¹æ³•æ¥ç¡®å®šæ–¹æ³•è§£æé¡ºåºã€‚ä½ å¦‚æœåœ¨ Python 2.3 ä»¥åç‰ˆæœ¬é‡Œè¾“å…¥ä¸Šè¿°ä»£ç ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªå¼‚å¸¸ï¼Œç¦æ­¢åˆ›å»ºå…·æœ‰äºŒä¹‰æ€§çš„ç»§æ‰¿å…³ç³»ï¼š\n1 2 3 4 5 6 7 \u003e\u003e\u003e class C(A, B): pass Traceback (most recent call last): File \"\u003cipython-input-8-01bae83dc806\u003e\", line 1, in \u003cmodule\u003e class C(A, B): pass TypeError: Error when calling the metaclass bases Cannot create a consistent method resolution order (MRO) for bases X, Y æˆ‘ä»¬æŠŠç±» C çš„çº¿æ€§åŒ–ï¼ˆMROï¼‰è®°ä¸º L[C] = [C1, C2,â€¦,CN]ã€‚å…¶ä¸­ C1 ç§°ä¸º L[C] çš„å¤´ï¼Œå…¶ä½™å…ƒç´  [C2,â€¦,CN] ç§°ä¸ºå°¾ã€‚å¦‚æœä¸€ä¸ªç±» C ç»§æ‰¿è‡ªåŸºç±» B1ã€B2ã€â€¦â€¦ã€BNï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ ¹æ®ä»¥ä¸‹ä¸¤æ­¥è®¡ç®—å‡º L[C]ï¼š\nL[object] = [object] L[C(B1â€¦BN)] = [C] + merge(L[B1]â€¦L[BN], [B1]â€¦[BN]) è¿™é‡Œçš„å…³é”®åœ¨äº mergeï¼Œå…¶è¾“å…¥æ˜¯ä¸€ç»„åˆ—è¡¨ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ–¹å¼è¾“å‡ºä¸€ä¸ªåˆ—è¡¨ï¼š\næ£€æŸ¥ç¬¬ä¸€ä¸ªåˆ—è¡¨çš„å¤´å…ƒç´ ï¼ˆå¦‚ L[B1] çš„å¤´ï¼‰ï¼Œè®°ä½œ Hã€‚ è‹¥ H æœªå‡ºç°åœ¨å…¶å®ƒåˆ—è¡¨çš„å°¾éƒ¨ï¼Œåˆ™å°†å…¶è¾“å‡ºï¼Œå¹¶å°†å…¶ä»æ‰€æœ‰åˆ—è¡¨ä¸­åˆ é™¤ï¼Œç„¶åå›åˆ°æ­¥éª¤1ï¼›å¦åˆ™ï¼Œå–å‡ºä¸‹ä¸€ä¸ªåˆ—è¡¨çš„å¤´éƒ¨è®°ä½œ Hï¼Œç»§ç»­è¯¥æ­¥éª¤ã€‚ é‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç›´è‡³åˆ—è¡¨ä¸ºç©ºæˆ–è€…ä¸èƒ½å†æ‰¾å‡ºå¯ä»¥è¾“å‡ºçš„å…ƒç´ ã€‚å¦‚æœæ˜¯å‰ä¸€ç§æƒ…å†µï¼Œåˆ™ç®—æ³•ç»“æŸï¼›å¦‚æœæ˜¯åä¸€ç§æƒ…å†µï¼Œè¯´æ˜æ— æ³•æ„å»ºç»§æ‰¿å…³ç³»ï¼ŒPython ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ è¯¥æ–¹æ³•æœ‰ç‚¹ç±»ä¼¼äºå›¾çš„æ‹“æ‰‘æ’åºï¼Œä½†å®ƒåŒæ—¶è¿˜è€ƒè™‘äº†åŸºç±»çš„å‡ºç°é¡ºåºã€‚æˆ‘ä»¬ç”¨ C3 åˆ†æä¸€ä¸‹åˆšæ‰çš„ä¾‹å­ã€‚\nobjectï¼ŒXï¼ŒY çš„çº¿æ€§åŒ–ç»“æœæ¯”è¾ƒç®€å•ï¼š\n1 2 3 L[object] = [object] L[X] = [X, object] L[Y] = [Y, object] A çš„çº¿æ€§åŒ–è®¡ç®—å¦‚ä¸‹ï¼š\n1 2 3 4 5 L[A] = [A] + merge(L[X], L[Y], [X], [Y]) = [A] + merge([X, object], [Y, object], [X], [Y]) = [A, X] + merge([object], [Y, object], [Y]) = [A, X, Y] + merge([object], [object]) = [A, X, Y, object] æ³¨æ„ç¬¬3æ­¥ï¼Œmerge([object], [Y, object], [Y]) ä¸­é¦–å…ˆè¾“å‡ºçš„æ˜¯ Y è€Œä¸æ˜¯ objectã€‚è¿™æ˜¯å› ä¸º object è™½ç„¶æ˜¯ç¬¬ä¸€ä¸ªåˆ—è¡¨çš„å¤´ï¼Œä½†æ˜¯å®ƒå‡ºç°åœ¨äº†ç¬¬äºŒä¸ªåˆ—è¡¨çš„å°¾éƒ¨ã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šè·³è¿‡ç¬¬ä¸€ä¸ªåˆ—è¡¨ï¼Œå»æ£€æŸ¥ç¬¬äºŒä¸ªåˆ—è¡¨çš„å¤´éƒ¨ï¼Œä¹Ÿå°±æ˜¯ Yã€‚Y æ²¡æœ‰å‡ºç°åœ¨å…¶å®ƒåˆ—è¡¨çš„å°¾éƒ¨ï¼Œæ‰€ä»¥å°†å…¶è¾“å‡ºã€‚\nåŒç†ï¼ŒB çš„çº¿æ€§åŒ–ç»“æœä¸ºï¼š\n1 L[B] = [B, Y, X, object] æœ€åï¼Œæˆ‘ä»¬çœ‹çœ‹ C çš„çº¿æ€§åŒ–ç»“æœï¼š\n1 2 3 4 L[C] = [C] + merge(L[A], L[B], [A], [B]) = [C] + merge([A, X, Y, object], [B, Y, X, object], [A], [B]) = [C, A] + merge([X, Y, object], [B, Y, X, object], [B]) = [C, A, B] + merge([X, Y, object], [Y, X, object]) åˆ°äº†æœ€åä¸€æ­¥æˆ‘ä»¬æ²¡æœ‰åŠæ³•ç»§ç»­è®¡ç®—ä¸‹å» äº†ï¼šX è™½ç„¶æ˜¯ç¬¬ä¸€ä¸ªåˆ—è¡¨çš„å¤´ï¼Œä½†æ˜¯å®ƒå‡ºç°åœ¨äº†ç¬¬äºŒä¸ªåˆ—è¡¨çš„å°¾éƒ¨ï¼›Y è™½ç„¶æ˜¯ç¬¬äºŒä¸ªåˆ—è¡¨çš„å¤´ï¼Œä½†æ˜¯å®ƒå‡ºç°åœ¨äº†ç¬¬ä¸€ä¸ªåˆ—è¡¨çš„å°¾éƒ¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ— æ³•æ„å»ºä¸€ä¸ªæ²¡æœ‰äºŒä¹‰æ€§çš„ç»§æ‰¿å…³ç³»ï¼Œåªèƒ½æ‰‹å·¥å»è§£å†³ï¼ˆæ¯”å¦‚æ”¹å˜ B åŸºç±»ä¸­ Xã€Y çš„é¡ºåºï¼‰ã€‚\næˆ‘ä»¬å†çœ‹ä¸€ä¸ªæ²¡æœ‰å†²çªçš„ä¾‹å­ï¼š\nè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 L[object] = [object] L[D] = [D, object] L[E] = [E, object] L[F] = [F, object] L[B] = [B, D, E, object] L[C] = [C, D, F, object] L[A] = [A] + merge(L[B], L[C], [B], [C]) = [A] + merge([B, D, E, object], [C, D, F, object], [B], [C]) = [A, B] + merge([D, E, object], [C, D, F, object], [C]) = [A, B, C] + merge([D, E, object], [D, F, object]) = [A, B, C, D] + merge([E, object], [F, object]) = [A, B, C, D, E] + merge([object], [F, object]) = [A, B, C, D, E, F] + merge([object], [object]) = [A, B, C, D, E, F, object] å½“ç„¶ï¼Œå¯ä»¥ç”¨ä»£ç éªŒè¯ç±»çš„ MROï¼Œä¸Šé¢çš„ä¾‹å­å¯ä»¥å†™ä½œï¼š\n1 2 3 4 5 6 7 8 \u003e\u003e\u003e class D(object): pass \u003e\u003e\u003e class E(object): pass \u003e\u003e\u003e class F(object): pass \u003e\u003e\u003e class B(D, E): pass \u003e\u003e\u003e class C(D, F): pass \u003e\u003e\u003e class A(B, C): pass \u003e\u003e\u003e A.__mro__ (\u003cclass '__main__.A'\u003e, \u003cclass '__main__.B'\u003e, \u003cclass '__main__.C'\u003e, \u003cclass '__main__.D ","description":"","tags":["python"],"title":"Python ä¸­çš„æ–¹æ³•è§£æé¡ºåº(MRO)","uri":"/blog/posts/Python/method-resolution-order-mro-in-python/"},{"categories":["Linux"],"content":"ç”¨ Expect å¤„ç†å‘½ä»¤è¡Œç¨‹åºäº¤äº’ shell æŠŠç¨‹åºäº¤äº’çš„ç‰¹æ€§ç•™ç»™äº†ç”¨æˆ·ï¼Œè¿™æ„å‘³ç€æœ‰äº›ç¨‹åºï¼Œä¸èƒ½è„±ç¦»ç”¨æˆ·è¾“å…¥ã€‚æ¯”å¦‚ passwd å‘½ä»¤ã€‚\nexpect èƒ½å¤Ÿè°ƒç”¨å…¶ä»– unix ç¨‹åºï¼Œå¤„ç†äº¤äº’æ“ä½œã€‚\nExpect è„šæœ¬ç™»å½• SSH å…ˆçœ‹ä¸€ä¸ªé€šè¿‡ expect è„šæœ¬ SSH åˆ°è¿œç¨‹ä¸»æœºçš„ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #!/usr/bin/expect set host \"192.168.199.231\" set user \"xiao\" set password \"xiao\" spawn ssh '$user@$host' expect { \"*(yes/no)?\" { send \"yes\\r\" exp_continue } \"*password:\" { send \"$password\\r\" } timeout { puts \"timed out\",exit } } interact è¿™é‡Œæ³¨æ„åˆ°ä¸¤ä¸ªé‡è¦çš„å…³é”®å­—ï¼šspawnï¼Œexpect\nä¸‹é¢å¯¹ expect è¯­æ³•é‡Œçš„å…³é”®å­—ä½œä»‹ç»\nKeyword spawnï¼š è°ƒç”¨å…¶ä»– unix ç¨‹åºï¼Œç”Ÿæˆæ–°è¿›ç¨‹\nexpect: å¤„ç†å…¶ä»–ç¨‹åºçš„è¾“å‡ºï¼Œå¯¹äºåŒ¹é…åˆ°çš„è¾“å‡ºå¯ä»¥è§¦å‘æ“ä½œ\nset: å…¨å±€å˜é‡èµ‹å€¼\nsend: å‘é€å­—ç¬¦æŒ‡ä»¤ï¼Œæ”¯æŒç‰¹æ®Šå­—ç¬¦ \\r å›è½¦, \\x03 Ctrl+c ç­‰ç­‰\nputs: å‘é€å­—ç¬¦åˆ°æ ‡å‡†è¾“å‡º\ninteract: äº¤äº’æ§åˆ¶æƒåˆ‡æ¢åˆ°ç”¨æˆ·\nFlowControl for-loop 1 2 3 4 5 6 7 8 9 10 11 12 13 for {} {} {} { ... } // eg: for {set i 0} { i \u003c 10} {incr 1} { ... } // Endless loop for {} 1 {} { ... } while-loop 1 2 3 while { EXPRESSION } { ... } if-else 1 2 3 4 5 if { EXPRESSION } { ... } else { ... } Match-Operation 1 2 3 4 5 6 7 8 9 10 11 expect { PATTERN1 { DO_SOMETHING } PATTERN2 { DO_SOMETHING_ELSE } timeout { exit } } æ¥æ”¶å‚æ•°ä¼ å…¥ 1 2 3 4 5 # å‘½ä»¤è¡Œå‚æ•° # $argvï¼Œå‚æ•°æ•°ç»„ï¼Œä½¿ç”¨[lindex $argv n]è·å–ï¼Œ$argv 0ä¸ºè„šæœ¬åå­— # $argcï¼Œå‚æ•°ä¸ªæ•° set username [lindex $argv 1] # è·å–ç¬¬1ä¸ªå‚æ•° set passwd [lindex $argv 2] # è·å–ç¬¬2ä¸ªå‚æ•° Function 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 # params set timeout 5 set now [clock seconds] set date [clock format $now -format {%Y%m%d-%H%M}] log_file -noappend exp/log/xvr_autotest_$date.log # picocom config set baudrate \"1000000\" set device [lindex $argv 0]; proc test_reboot { interval } { send \"reboot\\r\" sleep $interval } proc test_some_function {} { } proc main {} { set interval 5 test_reboot $interval test_some_function } spawn picocom -b $baudrate -f x $device expect \"Terminal ready\" { send \"\\r\" } main ä»¥ä¸Šï¼Œé€šè¿‡ expect è°ƒç”¨äº† picocom (ä¸²å£å‘½ä»¤è¡Œå·¥å…·) è¿æ¥åˆ°ä¸²å£ï¼Œå»æ‰§è¡Œé‡å¯å‘½ä»¤ã€‚\nReference expectæ•™ç¨‹ä¸­æ–‡ç‰ˆ expectè¯´æ˜ [expectå‘½ä»¤][https://man.linuxde.net/expect1] ","description":"","tags":null,"title":"ç”¨ Expect å¤„ç†å‘½ä»¤è¡Œç¨‹åºäº¤äº’","uri":"/blog/posts/Linux/linuxuse-expect-to-handle-command-line-program-interaction/"},{"categories":["Python","Fluent-Python"],"content":"\næŠ½è±¡ç±»è¡¨ç¤ºæ¥å£ã€‚\nâ€”â€”Bjarne Stroustrup, C++ ä¹‹çˆ¶\næœ¬ç« è®¨è®ºçš„è¯é¢˜æ˜¯æ¥å£ï¼š\nä»é¸­å­ç±»å‹çš„ä»£è¡¨ç‰¹å¾åŠ¨æ€åè®®ï¼Œåˆ°ä½¿æ¥å£æ›´æ˜ç¡®ã€èƒ½éªŒè¯å®ç°æ˜¯å¦ç¬¦åˆè§„å®šçš„æŠ½è±¡åŸºç±»ï¼ˆAbstract Base Class, ABCï¼‰ã€‚\næ¥å£çš„å®šä¹‰ï¼šå¯¹è±¡å…¬å¼€æ–¹æ³•çš„å­é›†ï¼Œè®©å¯¹è±¡åœ¨ç³»ç»Ÿä¸­æ‰®æ¼”ç‰¹å®šçš„è§’è‰²ã€‚\nåè®®æ˜¯æ¥å£ï¼Œä½†ä¸æ˜¯æ­£å¼çš„ï¼ˆåªç”±æ–‡æ¡£å’Œçº¦å®šå®šä¹‰ï¼‰ï¼Œå› æ­¤åè®®ä¸èƒ½åƒæ­£å¼æ¥å£é‚£æ ·æ–½åŠ é™åˆ¶ã€‚\nå…è®¸ä¸€ä¸ªç±»ä¸Šåªå®ç°éƒ¨åˆ†æ¥å£ã€‚\næ¥å£ä¸åè®® ä»€ä¹ˆæ˜¯æ¥å£\nå¯¹è±¡å…¬å¼€æ–¹æ³•çš„å­é›†ï¼Œè®©å¯¹è±¡åœ¨ç³»ç»Ÿä¸­æ‰®æ¼”ç‰¹å®šçš„è§’è‰²ã€‚\né¸­å­ç±»å‹ä¸åŠ¨æ€åè®®\nå—ä¿æŠ¤çš„ç±»å‹ä¸ç§æœ‰ç±»å‹ä¸èƒ½åœ¨æ¥å£ä¸­\nå¯ä»¥æŠŠå…¬å¼€çš„æ•°æ®å±æ€§æ”¾åœ¨æ¥å£ä¸­\næ¡ˆä¾‹ï¼šé€šè¿‡å®ç° getitem æ–¹æ³•æ”¯æŒåºåˆ—æ“ä½œ 1 2 3 4 5 6 7 8 9 class Foo: def __getitem__(self, pos): return range(0, 30, 10)[pos] f = Foo() print(f[1]) for i in f: print(i) Foo å®ç°äº†åºåˆ—åè®®çš„ __getitem__ æ–¹æ³•ã€‚å› æ­¤å¯æ”¯æŒä¸‹æ ‡æ“ä½œã€‚\nFoo å®ä¾‹æ˜¯å¯è¿­ä»£çš„å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ in æ“ä½œç¬¦\næ¡ˆä¾‹ï¼šåœ¨è¿è¡Œæ—¶å®ç°åè®®â€”â€”çŒ´å­è¡¥ä¸ FrenchDeck ç±»è§å‰é¢ç« èŠ‚ã€‚\nFrenchDeck å®ä¾‹çš„è¡Œä¸ºåƒåºåˆ—ï¼Œé‚£ä¹ˆå…¶å®å¯ä»¥ç”¨ random çš„ shuffle æ–¹æ³•æ¥ä»£æ›¿åœ¨ç±»ä¸­å®ç°çš„æ–¹æ³•ã€‚\n1 2 3 4 5 6 from random import shuffle from frenchdeck import FrenchDeck deck = FrenchDeck() shuffle(deck) # TypeError: 'FrenchDeck' object does not support item assigment FrenchDeck å¯¹è±¡ä¸æ”¯æŒå…ƒç´ èµ‹å€¼ã€‚è¿™æ˜¯å› ä¸ºå®ƒåªå®ç°äº†ä¸å¯å˜çš„åºåˆ—åè®®ï¼Œå¯å˜çš„åºåˆ—è¿˜å¿…é¡»æä¾› __setitem__ æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 def set_card(deck, pos, card): deck._cards[pos] = card FrenchDeck.__setitem__ = set_card shuffle(deck) print(deck[:5]) print(deck[:5]) è¿™ç§æŠ€æœ¯å«åšçŒ´å­è¡¥ä¸ï¼šåœ¨è¿è¡Œæ˜¯ä¿®æ”¹ç±»æˆ–ç¨‹åºï¼Œè€Œä¸æ”¹åŠ¨æºç ã€‚ç¼ºé™·æ˜¯è¡¥ä¸ä»£ç ä¸è¦æ‰“è¡¥ä¸çš„ç¨‹åºè€¦åˆç´§å¯†ã€‚\næŠ½è±¡åŸºç±»ï¼ˆabcï¼‰ æŠ½è±¡åŸºç±»æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨æŠ½è±¡åŸºç±»æ¥æ£€æµ‹æŸä¸ªç±»æ˜¯å¦å®ç°äº†æŸç§åè®®ï¼Œè€Œè¿™ä¸ªç±»å¹¶ä¸éœ€è¦ç»§æ‰¿è‡ªè¿™ä¸ªæŠ½è±¡ç±»ã€‚\ncollections.abc å’Œ numbers æ¨¡å—ä¸­æä¾›äº†è®¸å¤šå¸¸ç”¨çš„æŠ½è±¡åŸºç±»ä»¥ç”¨äºè¿™ç§æ£€æµ‹ã€‚\næœ‰äº†è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬åœ¨è‡ªå·±å®ç°å‡½æ•°æ—¶ï¼Œå°±ä¸éœ€è¦éå¸¸å…³å¿ƒå¤–é¢ä¼ è¿›æ¥çš„å‚æ•°çš„å…·ä½“ç±»å‹ï¼ˆisinstance(param, list)ï¼‰ï¼Œåªéœ€è¦å…³æ³¨è¿™ä¸ªå‚æ•°æ˜¯å¦æ”¯æŒæˆ‘ä»¬éœ€è¦çš„åè®®ï¼ˆisinstance(param, abc.Sequenceï¼‰ä»¥ä¿éšœæ­£å¸¸ä½¿ç”¨å°±å¯ä»¥äº†ã€‚\nä½†æ˜¯æ³¨æ„ï¼šä» Python ç®€æ´æ€§è€ƒè™‘ï¼Œæœ€å¥½ä¸è¦è‡ªå·±åˆ›å»ºæ–°çš„æŠ½è±¡åŸºç±»ï¼Œè€Œåº”å°½é‡è€ƒè™‘ä½¿ç”¨ç°æœ‰çš„æŠ½è±¡åŸºç±»ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # æŠ½è±¡åŸºç±» from collections import abc class A: pass class B: def __len__(self): return 0 assert not isinstance(A(), abc.Sized) assert isinstance(B(), abc.Sized) assert abc.Sequence not in list.__bases__ # list å¹¶ä¸æ˜¯ Sequence çš„å­ç±» assert isinstance([], abc.Sequence) # ä½†æ˜¯ list å®ä¾‹æ”¯æŒåºåˆ—åè®® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # åœ¨æŠ½è±¡åŸºç±»ä¸Šè¿›è¡Œè‡ªå·±çš„å®ç° from collections import abc class FailedSized(abc.Sized): pass class NormalSized(abc.Sized): def __len__(self): return 0 n = NormalSized() print(len(n)) f = FailedSized() # åŸºç±»çš„æŠ½è±¡åè®®æœªå®ç°ï¼ŒPython ä¼šé˜»æ­¢å¯¹è±¡å®ä¾‹åŒ– æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼šæŠ½è±¡åŸºç±»ä¸Šçš„æ–¹æ³•å¹¶ä¸éƒ½æ˜¯æŠ½è±¡æ–¹æ³•ã€‚\næ¢å¥è¯è¯´ï¼Œæƒ³ç»§æ‰¿è‡ªæŠ½è±¡åŸºç±»ï¼Œåªéœ€è¦å®ç°å®ƒä¸Šé¢æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•å³å¯ï¼Œæœ‰äº›æ–¹æ³•çš„å®ç°æ˜¯å¯é€‰çš„ã€‚\næ¯”å¦‚ Sequence.__contains__ï¼ŒPython å¯¹æ­¤æœ‰è‡ªå·±çš„å®ç°ï¼ˆä½¿ç”¨ __iter__ éå†è‡ªèº«ï¼ŒæŸ¥æ‰¾æ˜¯å¦æœ‰ç›¸ç­‰çš„å…ƒç´ ï¼‰ã€‚ä½†å¦‚æœä½ åœ¨ Sequence ä¹‹ä¸Šå®ç°çš„åºåˆ—æ˜¯æœ‰åºçš„ï¼Œåˆ™å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥è¦†ç›– __contains__ æ–¹æ³•ï¼Œä»è€Œæé«˜æŸ¥æ‰¾æ•ˆç‡ã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨ __abstractmethods__ å±æ€§æ¥æŸ¥çœ‹æŸä¸ªæŠ½è±¡åŸºç±»ä¸Šçš„æŠ½è±¡æ–¹æ³•ã€‚è¿™ä¸ªæŠ½è±¡åŸºç±»çš„å­ç±»å¿…é¡»å®ç°è¿™äº›æ–¹æ³•ï¼Œæ‰å¯ä»¥è¢«æ­£å¸¸å®ä¾‹åŒ–ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # è‡ªå·±å®šä¹‰ä¸€ä¸ªæŠ½è±¡åŸºç±» import abc # ä½¿ç”¨å…ƒç±»çš„å®šä¹‰æ–¹å¼æ˜¯ class SomeABC(metaclass=abc.ABCMeta) class SomeABC(abc.ABC): @abc.abstractmethod def some_method(self): raise NotImplementedError class IllegalClass(SomeABC): pass class LegalClass(SomeABC): def some_method(self): print('Legal class OK') l = LegalClass() l.some_method() il = IllegalClass() # Raises è™šæ‹Ÿå­ç±» ä½¿ç”¨ register æ¥å£å¯ä»¥å°†æŸä¸ªç±»æ³¨å†Œä¸ºæŸä¸ª ABC çš„â€œè™šæ‹Ÿå­ç±»â€ã€‚æ”¯æŒ register ç›´æ¥è°ƒç”¨æ³¨å†Œï¼Œä»¥åŠä½¿ç”¨ @register è£…é¥°å™¨æ–¹å¼æ³¨å†Œï¼ˆå…¶å®è¿™ä¿©æ˜¯ä¸€å›äº‹ï¼‰ã€‚\næ³¨å†Œåï¼Œä½¿ç”¨ isinstance ä»¥åŠå®ä¾‹åŒ–æ—¶ï¼Œè§£é‡Šå™¨å°†ä¸ä¼šå¯¹è™šæ‹Ÿå­ç±»åšä»»ä½•æ–¹æ³•æ£€æŸ¥ã€‚\næ³¨æ„ï¼šè™šæ‹Ÿå­ç±»ä¸æ˜¯å­ç±»ï¼Œæ‰€ä»¥è™šæ‹Ÿå­ç±»ä¸ä¼šç»§æ‰¿æŠ½è±¡åŸºç±»çš„ä»»ä½•æ–¹æ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 # è™šæ‹Ÿå­ç±» import abc import traceback class SomeABC(abc.ABC): @abc.abstractmethod def some_method(self): raise NotImplementedError def another_method(self): print('Another') @classmethod def __subclasshook__(cls, subcls): \"\"\" åœ¨ register æˆ–è€…è¿›è¡Œ isinstance åˆ¤æ–­æ—¶è¿›è¡Œå­ç±»æ£€æµ‹ https://docs.python.org/3/library/abc.html#abc.ABCMeta.__subclasshook__ \"\"\" print('Subclass:', subcls) return True class IllegalClass: pass SomeABC.register(IllegalClass) # æ³¨å†Œ il = IllegalClass() assert isinstance(il, IllegalClass) assert SomeABC not in IllegalClass.__mro__ # isinstance ä¼šè¿”å› Trueï¼Œä½† IllegalClass å¹¶ä¸æ˜¯ SomeABC çš„å­ç±» try: il.some_method() # è™šæ‹Ÿå­ç±»ä¸æ˜¯å­ç±»ï¼Œä¸ä¼šä»æŠ½è±¡åŸºç±»ä¸Šç»§æ‰¿ä»»ä½•æ–¹æ³• except Exception as e: traceback.print_exc() try: il.another_method() except Exception as e: traceback.print_exc() ","description":"","tags":["python"],"title":"ã€Šæµç•…çš„Pythonã€‹æ¥å£ä¹‹ä»åè®®åˆ°æŠ½è±¡åŸºç±»","uri":"/blog/posts/Python/Fluent-Python/fluent-python-interface-from-protocol-to-abstract-base-class/"},{"categories":null,"content":"è‡ªå­¦è®¡ç®—æœºç§‘å­¦ æœ¬æ–‡æ¡£æ˜¯å¯¹TeachYourselfCSå†…å®¹çš„ä¸­æ–‡ç¿»è¯‘ï¼ŒåŸä½œè€…ä¸ºOzan Onayå’ŒMyles Byrneã€‚å¦‚éœ€äº†è§£ç¿»è¯‘ç›¸å…³ä¿¡æ¯æˆ–å¸®åŠ©æ”¹è¿›ç¿»è¯‘ï¼Œè¯·å‚è§æœ¬æ–‡æ¡£ç»“å°¾ã€‚\nThis document is a Chinese translation of TeachYourselfCS, which is written by Ozan Onay and Myles Byrne. For more information about this translation, please refer to the end of this document.\nå¦‚æœä½ æ˜¯ä¸€ä¸ªè‡ªå­¦æˆæ‰çš„å·¥ç¨‹å¸ˆï¼Œæˆ–è€…ä»ç¼–ç¨‹åŸ¹è®­ç­æ¯•ä¸šï¼Œé‚£ä¹ˆä½ å¾ˆæœ‰å¿…è¦å­¦ä¹ è®¡ç®—æœºç§‘å­¦ã€‚å¹¸è¿çš„æ˜¯ï¼Œä¸å¿…ä¸ºæ­¤èŠ±ä¸Šæ•°å¹´å…‰é˜´å’Œä¸è²è´¹ç”¨å»æ”»è¯»ä¸€ä¸ªå­¦ä½ï¼šä»…ä»…ä¾é è‡ªå·±ï¼Œä½ å°±å¯ä»¥è·å¾—ä¸–ç•Œä¸€æµæ°´å¹³çš„æ•™è‚²ğŸ’¸ã€‚\näº’è”ç½‘ä¸Šï¼Œåˆ°å¤„éƒ½æœ‰è®¸å¤šçš„å­¦ä¹ èµ„æºï¼Œç„¶è€Œç²¾åä¸ç³Ÿç²•å¹¶å­˜ã€‚ä½ æ‰€éœ€è¦çš„ï¼Œä¸æ˜¯ä¸€ä¸ªè¯¸å¦‚â€œ200+å…è´¹åœ¨çº¿è¯¾ç¨‹â€çš„æ¸…å•ï¼Œè€Œæ˜¯ä»¥ä¸‹é—®é¢˜çš„ç­”æ¡ˆï¼š\nä½ åº”å½“å­¦ä¹ å“ªäº›ç§‘ç›®ï¼Œä¸ºä»€ä¹ˆï¼Ÿ å¯¹äºè¿™äº›ç§‘ç›®ï¼Œæœ€å¥½çš„ä¹¦ç±æˆ–è€…è§†é¢‘è¯¾ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ åœ¨è¿™ä»½æŒ‡å¼•ä¸­ï¼Œæˆ‘ä»¬å°è¯•å¯¹è¿™äº›é—®é¢˜åšå‡ºç¡®å®šçš„å›ç­”ã€‚\nç®€è€Œè¨€ä¹‹ å¤§è‡´æŒ‰ç…§åˆ—å‡ºçš„é¡ºåºï¼Œå€ŸåŠ©æˆ‘ä»¬æ‰€å»ºè®®çš„æ•™ææˆ–è€…è§†é¢‘è¯¾ç¨‹ï¼ˆä½†æ˜¯æœ€å¥½äºŒè€…å…¼ç”¨ï¼‰ï¼Œå­¦ä¹ å¦‚ä¸‹çš„ä¹é—¨ç§‘ç›®ã€‚ç›®æ ‡æ˜¯å…ˆèŠ±100åˆ°200ä¸ªå°æ—¶å­¦ä¹ å®Œæ¯ä¸€ä¸ªç§‘ç›®ï¼Œç„¶ååœ¨ä½ èŒä¸šç”Ÿæ¶¯ä¸­ï¼Œä¸æ—¶æ¸©ä¹ å…¶ä¸­çš„ç²¾é«“ğŸš€ã€‚\nç§‘ç›® ä¸ºä½•è¦å­¦ï¼Ÿ æœ€ä½³ä¹¦ç± æœ€ä½³è§†é¢‘ ç¼–ç¨‹ ä¸è¦åšä¸€ä¸ªâ€œæ°¸è¿œæ²¡å½»åº•ææ‡‚â€è¯¸å¦‚é€’å½’ç­‰æ¦‚å¿µçš„ç¨‹åºå‘˜ã€‚ ã€Šè®¡ç®—æœºç¨‹åºçš„æ„é€ å’Œè§£é‡Šã€‹ Brian Harveyâ€™s Berkeley CS 61A è®¡ç®—æœºæ¶æ„ å¦‚æœä½ å¯¹äºè®¡ç®—æœºå¦‚ä½•å·¥ä½œæ²¡æœ‰å…·ä½“çš„æ¦‚å¿µï¼Œé‚£ä¹ˆä½ æ‰€åšå‡ºçš„æ‰€æœ‰é«˜çº§æŠ½è±¡éƒ½æ˜¯ç©ºä¸­æ¥¼é˜ã€‚ ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ Berkeley CS 61C ç®—æ³•ä¸æ•°æ®ç»“æ„ å¦‚æœä½ ä¸æ‡‚å¾—å¦‚ä½•ä½¿ç”¨æ ˆã€é˜Ÿåˆ—ã€æ ‘ã€å›¾ç­‰å¸¸è§æ•°æ®ç»“æ„ï¼Œé‡åˆ°æœ‰éš¾åº¦çš„é—®é¢˜æ—¶ï¼Œä½ å°†æŸæ‰‹æ— ç­–ã€‚ ã€Šç®—æ³•è®¾è®¡æ‰‹å†Œã€‹ Steven Skienaâ€™s lectures æ•°å­¦çŸ¥è¯† è®¡ç®—æœºç§‘å­¦åŸºæœ¬ä¸Šæ˜¯åº”ç”¨æ•°å­¦çš„ä¸€ä¸ªâ€œè·‘åçš„â€åˆ†æ”¯ï¼Œå› æ­¤å­¦ä¹ æ•°å­¦å°†ä¼šç»™ä½ å¸¦æ¥ç«äº‰ä¼˜åŠ¿ã€‚ ã€Šè®¡ç®—æœºç§‘å­¦ä¸­çš„æ•°å­¦ã€‹ Tom Leightonâ€™s MIT 6.042J æ“ä½œç³»ç»Ÿ ä½ æ‰€å†™çš„ä»£ç ï¼ŒåŸºæœ¬ä¸Šéƒ½ç”±æ“ä½œç³»ç»Ÿæ¥è¿è¡Œï¼Œå› æ­¤ä½ åº”å½“äº†è§£å…¶è¿ä½œçš„åŸç†ã€‚ ã€Šæ“ä½œç³»ç»Ÿå¯¼è®ºã€‹ Berkeley CS 162 è®¡ç®—æœºç½‘ç»œ äº’è”ç½‘å·²ç„¶åŠ¿ä¸å¯æŒ¡ï¼šç†è§£å·¥ä½œåŸç†æ‰èƒ½è§£é”å…¨éƒ¨æ½œåŠ›ã€‚ ã€Šè®¡ç®—æœºç½‘ç»œï¼šè‡ªé¡¶å‘ä¸‹æ–¹æ³•ã€‹ Stanford CS 144 æ•°æ®åº“ å¯¹äºå¤šæ•°é‡è¦ç¨‹åºï¼Œæ•°æ®æ˜¯å…¶æ ¸å¿ƒï¼Œç„¶è€Œå¾ˆå°‘äººç†è§£æ•°æ®åº“ç³»ç»Ÿçš„å·¥ä½œåŸç†ã€‚ ã€ŠReadings in Database Systemsã€‹ ï¼ˆæš‚æ— ä¸­è¯‘æœ¬ï¼‰ Joe Hellersteinâ€™s Berkeley CS 186 ç¼–ç¨‹è¯­è¨€ä¸ç¼–è¯‘å™¨ è‹¥ä½ æ‡‚å¾—ç¼–ç¨‹è¯­è¨€å’Œç¼–è¯‘å™¨å¦‚ä½•å·¥ä½œï¼Œä½ å°±èƒ½å†™å‡ºæ›´å¥½çš„ä»£ç ï¼Œæ›´è½»æ¾åœ°å­¦ä¹ æ–°çš„ç¼–ç¨‹è¯­è¨€ã€‚ ã€ŠCrafting Interpretersã€‹ Alex Aikenâ€™s course on Lagunita åˆ†å¸ƒå¼ç³»ç»Ÿ å¦‚ä»Šï¼Œå¤šæ•° ç³»ç»Ÿéƒ½æ˜¯åˆ†å¸ƒå¼çš„ã€‚ ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹ MIT 6.824 è¿˜æ˜¯å¤ªå¤šï¼Ÿ å¦‚æœèŠ±å‡ å¹´æ—¶é—´è‡ªå­¦ 9 é—¨ç§‘ç›®è®©äººæœ›è€Œå´æ­¥ï¼Œæˆ‘ä»¬å»ºè®®ä½ åªä¸“æ³¨äºä¸¤æœ¬ä¹¦ï¼šã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ å’Œ ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹ã€‚æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼ŒæŠ•å…¥åˆ°è¿™ä¸¤æœ¬ä¹¦çš„æ—¶é—´å¯ä»¥è·å¾—æé«˜çš„å›æŠ¥ç‡ï¼Œç‰¹åˆ«é€‚åˆä»äº‹ç½‘ç»œåº”ç”¨å¼€å‘çš„è‡ªå­¦å·¥ç¨‹å¸ˆã€‚è¿™ä¸¤æœ¬ä¹¦ä¹Ÿå¯ä»¥ä½œä¸ºä¸Šé¢è¡¨æ ¼ä¸­å…¶ä»–ç§‘ç›®çš„çº²é¢†ã€‚\nä¸ºä»€ä¹ˆè¦å­¦ä¹ è®¡ç®—æœºç§‘å­¦ï¼Ÿ è½¯ä»¶å·¥ç¨‹å¸ˆåˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§å……åˆ†ç†è§£äº†è®¡ç®—æœºç§‘å­¦ï¼Œä»è€Œæœ‰èƒ½åŠ›åº”å¯¹å……æ»¡æŒ‘æˆ˜çš„åˆ›é€ æ€§å·¥ä½œï¼›å¦ä¸€ç§ä»…ä»…å‡­ç€å¯¹ä¸€äº›é«˜çº§å·¥å…·çš„ç†Ÿæ‚‰è€Œå‹‰å¼ºåº”ä»˜ã€‚\nè¿™ä¸¤ç§äººéƒ½è‡ªç§°è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œéƒ½èƒ½åœ¨èŒä¸šç”Ÿæ¶¯æ—©æœŸæŒ£åˆ°å·®ä¸å¤šçš„å·¥èµ„ã€‚ç„¶è€Œï¼Œéšç€æ—¶é—´æµé€ï¼Œç¬¬ä¸€ç§å·¥ç¨‹å¸ˆä¸æ–­æˆé•¿ï¼Œæ‰€åšçš„äº‹æƒ…å°†ä¼šè¶Šæ¥è¶Šæœ‰æ„ä¹‰ä¸”æ›´ä¸ºé«˜è–ªï¼Œä¸è®ºæ˜¯æœ‰ä»·å€¼çš„å•†ä¸šå·¥ä½œã€çªç ´æ€§çš„å¼€æºé¡¹ç›®ã€æŠ€æœ¯ä¸Šçš„é¢†å¯¼åŠ›æˆ–è€…é«˜è´¨é‡çš„ä¸ªäººè´¡çŒ®ã€‚\nå…¨çƒçŸ­ä¿¡ç³»ç»Ÿæ¯æ—¥æ”¶å‘çº¦200äº¿æ¡ä¿¡æ¯ï¼Œè€Œä»…ä»…é 57åå·¥ç¨‹å¸ˆï¼Œç°åœ¨çš„ WhatsApp æ¯æ—¥æ”¶å‘420äº¿æ¡ã€‚\nâ€” Benedict Evans (@BenedictEvans) 2016å¹´2æœˆ2æ—¥\nç¬¬ä¸€ç§å·¥ç¨‹å¸ˆæ€»æ˜¯å¯»æ±‚æ·±å…¥å­¦ä¹ è®¡ç®—æœºç§‘å­¦çš„æ–¹æ³•ï¼Œæˆ–æ˜¯é€šè¿‡ä¼ ç»Ÿçš„æ–¹æ³•å­¦ä¹ ï¼Œæˆ–æ˜¯åœ¨èŒä¸šç”Ÿæ¶¯ä¸­æ°¸æ— æ­¢æ¯åœ°å­¦ä¹ ï¼›ç¬¬äºŒç§å·¥ç¨‹å¸ˆ é€šå¸¸æµ®äºè¡¨é¢ï¼Œåªå­¦ä¹ æŸäº›ç‰¹å®šçš„å·¥å…·å’ŒæŠ€æœ¯ï¼Œè€Œä¸ç ”ç©¶å…¶åº•å±‚çš„åŸºæœ¬åŸç†ï¼Œä»…ä»…åœ¨æŠ€æœ¯æ½®æµçš„é£å‘æ”¹å˜æ—¶å­¦ä¹ æ–°çš„æŠ€èƒ½ã€‚\nå¦‚ä»Šï¼Œæ¶Œå…¥è®¡ç®—æœºè¡Œä¸šçš„äººæ•°æ¿€å¢ï¼Œç„¶è€Œè®¡ç®—æœºä¸“ä¸šçš„æ¯•ä¸šç”Ÿæ•°é‡åŸºæœ¬ä¸Šæœªæ›¾æ”¹å˜ã€‚ç¬¬äºŒç§å·¥ç¨‹å¸ˆçš„ä¾›è¿‡äºæ±‚æ­£åœ¨å¼€å§‹å‡å°‘ä»–ä»¬çš„å·¥ä½œæœºä¼šï¼Œä½¿ä»–ä»¬æ— æ³•æ¶‰è¶³è¡Œä¸šå†…æ›´åŠ æœ‰æ„ä¹‰çš„å·¥ä½œã€‚å¯¹ä½ è€Œè¨€ï¼Œä¸è®ºæ­£åœ¨åŠªåŠ›æˆä¸ºç¬¬ä¸€ç§å·¥ç¨‹å¸ˆï¼Œè¿˜æ˜¯åªæƒ³è®©è‡ªå·±çš„èŒä¸šç”Ÿæ¶¯æ›´åŠ å®‰å…¨ï¼Œå­¦ä¹ è®¡ç®—æœºç§‘å­¦æ˜¯å”¯ä¸€å¯é çš„é€”å¾„ã€‚\n23333 ç„¶è€Œä»–ä»¬... pic.twitter.com/XVNYlXAHar\nâ€” Jenna Bilotta (@jenna) 2017å¹´3æœˆ4æ—¥\nåˆ†ç§‘ç›®æŒ‡å¼• ç¼–ç¨‹ å¤§å¤šæ•°è®¡ç®—æœºä¸“ä¸šæœ¬ç§‘æ•™å­¦ä»¥ç¨‹åºè®¾è®¡â€œå¯¼è®ºâ€ä½œä¸ºå¼€å§‹ã€‚è¿™ç±»è¯¾ç¨‹çš„æœ€ä½³ç‰ˆæœ¬ä¸ä»…èƒ½æ»¡è¶³åˆå­¦è€…çš„éœ€è¦ï¼Œè¿˜é€‚ç”¨äºé‚£äº›åœ¨åˆå­¦ç¼–ç¨‹é˜¶æ®µé—æ¼äº†æŸäº›æœ‰ç›Šçš„æ¦‚å¿µå’Œç¨‹åºè®¾è®¡æ¨¡å¼çš„äººã€‚\nå¯¹äºè¿™éƒ¨åˆ†å†…å®¹ï¼Œæˆ‘ä»¬çš„æ ‡å‡†æ¨èæ˜¯è¿™éƒ¨ç»å…¸è‘—ä½œï¼šã€Šè®¡ç®—æœºç¨‹åºçš„æ„é€ å’Œè§£é‡Šã€‹ã€‚åœ¨ç½‘ç»œä¸Šï¼Œè¿™æœ¬ä¹¦æ—¢å¯ä¾›å…è´¹é˜…è¯»ï¼ˆè‹±æ–‡ç‰ˆï¼‰ï¼Œä¹Ÿä½œä¸ºMITçš„å…è´¹è§†é¢‘è¯¾ç¨‹ã€‚ä¸è¿‡å°½ç®¡è¿™äº›è§†é¢‘è¯¾ç¨‹å¾ˆä¸é”™ï¼Œæˆ‘ä»¬å¯¹äºè§†é¢‘è¯¾ç¨‹çš„æ¨èå®é™…ä¸Šæ˜¯Brian Harvey å¼€è®¾çš„ SICP è¯¾ç¨‹ï¼ˆå³ Berkeley çš„ 61A è¯¾ç¨‹ï¼‰ã€‚æ¯”èµ·MITçš„è¯¾ç¨‹ï¼Œå®ƒæ›´åŠ å®Œå–„ï¼Œæ›´é€‚ç”¨äºåˆå­¦è€…ã€‚\næˆ‘ä»¬å»ºè®®è‡³å°‘å­¦å®ŒSICPçš„å‰ä¸‰ç« ï¼Œå¹¶å®Œæˆé…å¥—çš„ä¹ é¢˜ã€‚å¦‚æœéœ€è¦é¢å¤–çš„ç»ƒä¹ ï¼Œå¯ä»¥å»è§£å†³ä¸€äº›å°çš„ç¨‹åºè®¾è®¡é—®é¢˜ï¼Œæ¯”å¦‚exercismã€‚\nä¸­æ–‡ç¿»è¯‘æ–°å¢ï¼š\nå…³äºSICPå›½å†…è§†é¢‘è§‚çœ‹åœ°å€ MITçš„å…è´¹è§†é¢‘è¯¾ç¨‹ï¼ˆä¸­è‹±å­—å¹•ï¼‰ Brian Harvey å¼€è®¾çš„ SICP è¯¾ç¨‹ï¼ˆè‹±æ–‡å­—å¹•ï¼‰ Scheme å­¦ä¹ çš„ç›¸å…³èµ„æºå‚è§ï¼šhttps://github.com/DeathKing/Learning-SICP æ›´è¯¦ç»†çš„è¡¥å……è¯´æ˜ï¼š#3 è‡ªä» 2016 å¹´é¦–æ¬¡å‘å¸ƒè¿™ä»½æŒ‡å—ä»¥æ¥ï¼Œæœ€å¸¸è¢«é—®åˆ°çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬æ˜¯å¦æ¨èç”± John DeNero è®²æˆçš„æ›´æ–°çš„ CS 61A è¯¾ç¨‹ï¼Œä»¥åŠé…å¥—çš„ä¹¦ç± ã€ŠComposing Programsã€‹ï¼Œè¿™æœ¬ä¹¦â€œç»§æ‰¿è‡ª SICPâ€ ä½†ä½¿ç”¨ Python è®²è§£ã€‚æˆ‘ä»¬è®¤ä¸º DeNero çš„è¯¾ç¨‹ä¹Ÿå¾ˆä¸é”™ï¼Œæœ‰çš„å­¦ç”Ÿå¯èƒ½æ›´å–œæ¬¢ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å»ºè®®æŠŠ SICP, Scheme å’Œ Brian Harvey çš„è§†é¢‘è¯¾ç¨‹ä½œä¸ºé¦–é€‰ã€‚\nä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿå› ä¸º SICP æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå®ƒå¯ä»¥â€”â€”è‡³å°‘å¾ˆæœ‰å¯èƒ½â€”â€”æ”¹å˜ä½ å¯¹è®¡ç®—æœºå’Œç¼–ç¨‹çš„åŸºæœ¬è®¤è¯†ã€‚ä¸æ˜¯æ¯ä¸ªäººéƒ½æœ‰è¿™æ ·çš„ä½“éªŒã€‚æœ‰çš„äººè®¨åŒè¿™æœ¬ä¹¦ï¼Œæœ‰çš„äººçœ‹äº†å‰å‡ é¡µå°±æ”¾å¼ƒäº†ã€‚ä½†æ½œåœ¨çš„å›æŠ¥è®©å®ƒå€¼å¾—ä¸€è¯»ã€‚\nå¦‚æœä½ è§‰å¾—SICPè¿‡äºéš¾ï¼Œè¯•è¯• ã€ŠComposing Programsã€‹ã€‚å¦‚æœè¿˜æ˜¯ä¸åˆé€‚ï¼Œé‚£æˆ‘ä»¬æ¨è ã€Šç¨‹åºè®¾è®¡æ–¹æ³•ã€‹ï¼ˆä¸­æ–‡ç‰ˆï¼Œè‹±æ–‡ç‰ˆï¼‰ ï¼›å¦‚æœä½ è§‰å¾—SICPè¿‡äºç®€å•ï¼Œé‚£æˆ‘ä»¬æ¨è ã€ŠConcepts, Techniques, and Models of Computer Programmingã€‹ ã€‚å¦‚æœè¯»è¿™äº›ä¹¦è®©ä½ è§‰å¾—æ²¡æœ‰æ”¶è·ï¼Œä¹Ÿè¡Œä½ åº”è¯¥å…ˆå­¦ä¹ å…¶ä»–ç§‘ç›®ï¼Œä¸€ä¸¤å¹´åå†é‡æ–°å®¡è§†ç¼–ç¨‹çš„ç†å¿µã€‚\næ–°ç‰ˆåŸæ–‡åˆ é™¤äº†å¯¹ ã€ŠConcepts, Techniques, and Models of Computer Programmingã€‹ ä¸€ä¹¦çš„æ¨èï¼Œä½†è¿™æœ¬ä¹¦å¯¹å„ç§ç¼–ç¨‹æ¨¡å‹æœ‰æ·±å…¥çš„è§è§£ï¼Œå€¼å¾—ä¸€è¯»ã€‚æ‰€ä»¥è¯‘æ–‡ä¸­ä¾ç„¶ä¿ç•™ã€‚ â€” è¯‘è€…æ³¨\næœ€åï¼Œæœ‰ä¸€ç‚¹è¦è¯´æ˜çš„æ˜¯ï¼šæœ¬æŒ‡å—ä¸é€‚ç”¨äºå®Œå…¨ä¸æ‡‚ç¼–ç¨‹çš„æ–°æ‰‹ã€‚æˆ‘ä»¬å‡å®šä½ æ˜¯ä¸€ä¸ªæ²¡æœ‰è®¡ç®—æœºä¸“ä¸šèƒŒæ™¯çš„ç¨‹åºå‘˜ï¼Œå¸Œæœ›å¡«è¡¥ä¸€äº›çŸ¥è¯†ç©ºç™½ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬æŠŠâ€œç¼–ç¨‹â€ç« èŠ‚åŒ…æ‹¬è¿›æ¥åªæ˜¯æé†’ä½ è¿˜æœ‰æ›´å¤šçŸ¥è¯†éœ€è¦å­¦ä¹ ã€‚å¯¹äºé‚£äº›ä»æ¥æ²¡æœ‰å­¦è¿‡ç¼–ç¨‹ï¼Œä½†åˆæƒ³å­¦çš„äººæ¥è¯´ï¼Œè¿™ä»½æŒ‡å—æ›´åˆé€‚ã€‚\nè®¡ç®—æœºæ¶æ„ è®¡ç®—æœºæ¶æ„â€”â€”æœ‰æ—¶å€™åˆè¢«ç§°ä¸ºâ€œè®¡ç®—æœºç³»ç»Ÿâ€æˆ–è€…â€œè®¡ç®—æœºç»„æˆâ€â€”â€”æ˜¯äº†è§£è½¯ä»¶åº•å±‚çš„çš„é‡è¦è§†è§’ã€‚æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œè¿™æ˜¯è‡ªå­¦çš„è½¯ä»¶å·¥ç¨‹å¸ˆæœ€å®¹æ˜“å¿½è§†çš„é¢†åŸŸã€‚\næˆ‘ä»¬æœ€å–œæ¬¢çš„å…¥é—¨ä¹¦æ˜¯ ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ã€‚å…¸å‹çš„è®¡ç®—æœºä½“ç³»ç»“æ„å¯¼è®ºè¯¾ç¨‹ä¼šæ¶µç›–æœ¬ä¹¦çš„ 1 - 6 ç« ã€‚\næˆ‘ä»¬å–œçˆ±ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ï¼Œå› ä¸ºå®ƒçš„å®ç”¨æ€§ï¼Œå¹¶ä¸”ç«™åœ¨ç¨‹åºå‘˜çš„è§†è§’ã€‚è™½ç„¶è®¡ç®—æœºä½“ç³»ç»“æ„çš„å†…å®¹æ¯”æœ¬ä¹¦æ‰€æ¶‰åŠçš„å†…å®¹å¤šå¾—å¤šï¼Œä½†å¯¹äºé‚£äº›æƒ³äº†è§£è®¡ç®—æœºç³»ç»Ÿä»¥æ±‚ç¼–å†™æ›´å¿«ã€æ›´é«˜æ•ˆã€æ›´å¯é çš„è½¯ä»¶çš„äººæ¥è¯´ï¼Œè¿™æœ¬ä¹¦æ˜¯å¾ˆå¥½çš„èµ·ç‚¹ã€‚\nå¯¹äºé‚£äº›æ—¢æƒ³äº†è§£è¿™ä¸ªä¸»é¢˜åˆæƒ³å…¼é¡¾ç¡¬ä»¶å’Œè½¯ä»¶çš„çŸ¥è¯†çš„äººæ¥è¯´ï¼Œæˆ‘ä»¬æ¨è ã€Šè®¡ç®—æœºç³»ç»Ÿè¦ç´ ã€‹ï¼Œåˆåâ€œä»ä¸éé—¨åˆ°ä¿„ç½—æ–¯æ–¹å—â€ï¼ˆâ€œNand2Tetrisâ€ï¼‰ï¼Œè¿™æœ¬ä¹¦è§„æ¨¡å®å¤§ï¼Œè®©è¯»è€…å¯¹è®¡ç®—æœºå†…çš„æ‰€æœ‰éƒ¨åˆ†å¦‚ä½•ååŒå·¥ä½œæœ‰å®Œå…¨çš„è®¤è¯†ã€‚è¿™æœ¬ä¹¦çš„æ¯ä¸€ç« èŠ‚å¯¹åº”å¦‚ä½•æ„å»ºè®¡ç®—æœºæ•´ä½“ç³»ç»Ÿä¸­çš„ä¸€å°éƒ¨åˆ†ï¼Œä»ç”¨HDLï¼ˆç¡¬ä»¶æè¿°è¯­è¨€ï¼‰å†™åŸºæœ¬çš„é€»è¾‘é—¨ç”µè·¯å‡ºå‘ï¼Œé€”ç»CPUå’Œæ±‡ç¼–ï¼Œæœ€ç»ˆæŠµè¾¾è¯¸å¦‚ä¿„ç½—æ–¯æ–¹å—è¿™èˆ¬è§„æ¨¡çš„åº”ç”¨ç¨‹åºã€‚\næˆ‘ä»¬æ¨èæŠŠæ­¤ä¹¦çš„å‰å…­ç« è¯»å®Œï¼Œå¹¶å®Œæˆå¯¹åº”çš„é¡¹ç›®ç»ƒä¹ ã€‚è¿™ä¹ˆåšï¼Œä½ å°†æ›´åŠ æ·±å…¥åœ°ç†è§£ï¼Œè®¡ç®—æœºæ¶æ„å’Œè¿è¡Œå…¶ä¸Šçš„è½¯ä»¶ä¹‹é—´çš„å…³ç³»ã€‚\nè¿™æœ¬ä¹¦çš„å‰åŠéƒ¨åˆ†ï¼ˆåŒ…æ‹¬æ‰€æœ‰å¯¹åº”çš„é¡¹ç›®ï¼‰å‡å¯ä»Nand2Tetrisçš„ç½‘ç«™ä¸Šå…è´¹è·å¾—ã€‚åŒæ—¶ï¼Œåœ¨Courseraä¸Šï¼Œè¿™æ˜¯ä¸€é—¨è§†é¢‘è¯¾ç¨‹ã€‚\nä¸ºäº†è¿½æ±‚ç®€æ´å’Œç´§å‡‘ï¼Œè¿™æœ¬ä¹¦ç‰ºç‰²äº†å†…å®¹ä¸Šçš„æ·±åº¦ã€‚å°¤å…¶å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæµæ°´çº¿å’Œå­˜å‚¨å±‚æ¬¡ç»“æ„æ˜¯ç°ä»£è®¡ç®—æœºæ¶æ„ä¸­æå…¶é‡è¦çš„ä¸¤ä¸ªæ¦‚å¿µï¼Œç„¶è€Œè¿™æœ¬ä¹¦å¯¹æ­¤å‡ ä¹æ¯«æ— æ¶‰åŠã€‚\nå½“ä½ æŒæ¡äº†Nand2Tetrisçš„å†…å®¹åï¼Œæˆ‘ä»¬æ¨èè¦ä¹ˆå›åˆ°ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ï¼Œæˆ–è€…è€ƒè™‘Pattersonå’ŒHennessyäºŒäººæ‰€è‘—çš„ ã€Šè®¡ç®—æœºç»„æˆä¸è®¾è®¡ã€‹ï¼Œä¸€æœ¬ä¼˜ç§€çš„ç»å…¸è‘—ä½œã€‚è¿™æœ¬ä¹¦ä¸­çš„ä¸åŒç« èŠ‚é‡è¦ç¨‹åº¦ä¸ä¸€ï¼Œå› æ­¤æˆ‘ä»¬å»ºè®®æ ¹æ®Berkeleyçš„CS61Cè¯¾ç¨‹ â€œè®¡ç®—æœºæ¶æ„ä¸­çš„ä¼Ÿå¤§æ€æƒ³â€æ¥ç€é‡é˜…è¯»ä¸€äº›ç« èŠ‚ã€‚è¿™é—¨è¯¾çš„ç¬”è®°å’Œå®éªŒåœ¨ç½‘ç»œä¸Šå¯ä»¥å…è´¹è·å¾—ï¼Œå¹¶ä¸”åœ¨äº’è”ç½‘æ¡£æ¡ˆä¸­æœ‰è¿™é—¨è¯¾ç¨‹çš„è¿‡å¾€èµ„æ–™ã€‚\nç¡¬ä»¶æ˜¯å¹³å°ã€‚\nâ€” Mike Acton, Engine Director at Insomniac Games (è§‚çœ‹ä»–åœ¨CppConä¸Šçš„æ¼”è¯´)\nç®—æ³•ä¸æ•°æ®ç»“æ„ æ­£å¦‚å‡ åå¹´æ¥çš„å…±è¯†ï¼Œæˆ‘ä»¬è®¤ä¸ºï¼Œè®¡ç®—æœºç§‘å­¦æ•™è‚²æ‰€èµ‹äºˆäººä»¬çš„æœ€å¤§èƒ½é‡åœ¨äºå¯¹å¸¸è§ç®—æ³•å’Œæ•°æ®ç»“æ„çš„ç†Ÿæ‚‰ã€‚æ­¤å¤–ï¼Œè¿™ä¹Ÿå¯ä»¥è®­ç»ƒä¸€ä¸ªäººå¯¹äºå„ç§é—®é¢˜çš„è§£å†³èƒ½åŠ›ï¼Œæœ‰åŠ©äºå…¶ä»–é¢†åŸŸçš„å­¦ä¹ ã€‚\nå…³äºç®—æ³•ä¸æ•°æ®ç»“æ„ï¼Œæœ‰æˆç™¾ä¸Šåƒçš„ä¹¦å¯ä¾›ä½¿ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬çš„æœ€çˆ±æ˜¯Steven Skienaç¼–å†™çš„ ã€Šç®—æ³•è®¾è®¡æ‰‹å†Œã€‹ã€‚æ˜¾è€Œæ˜“è§ï¼Œä»–å¯¹æ­¤å……æ»¡çƒ­çˆ±ï¼Œè¿«ä¸åŠå¾…åœ°æƒ³è¦å¸®åŠ©å…¶ä»–äººç†è§£ã€‚åœ¨æˆ‘ä»¬çœ‹æ¥ï¼Œè¿™æœ¬ä¹¦ç»™äººä¸€ç§ç„•ç„¶ä¸€æ–°çš„ä½“éªŒï¼Œå®Œå…¨ä¸åŒäºé‚£äº›æ›´åŠ ç»å¸¸è¢«æ¨èçš„ä¹¦ï¼ˆæ¯”å¦‚Cormenï¼ŒLeisersonï¼ŒRivest å’Œ Steinï¼Œæˆ–è€… Sedgewickçš„ä¹¦ï¼Œåä¸¤è€…å……æ–¥ç€è¿‡å¤šçš„è¯æ˜ï¼Œä¸é€‚åˆä»¥ è§£å†³é—®é¢˜ ä¸ºå¯¼å‘çš„å­¦ä¹ ï¼‰ã€‚\nå¦‚æœä½ æ›´å–œæ¬¢è§†é¢‘è¯¾ç¨‹ï¼ŒSkienaæ…·æ…¨åœ°æä¾›äº†ä»–çš„è¯¾ç¨‹ã€‚æ­¤å¤–ï¼ŒTim Roughgardençš„è¯¾ç¨‹ä¹Ÿå¾ˆä¸é”™ï¼Œ åœ¨Stanfordçš„MOOCå¹³å°Lagunitaï¼Œæˆ–è€…Courseraä¸Šå‡å¯è·å¾—ã€‚Skienaå’ŒRoughgardençš„è¿™ä¸¤é—¨è¯¾ç¨‹æ²¡æœ‰ä¼˜åŠ£ä¹‹åˆ†ï¼Œé€‰æ‹©ä½•è€…å–å†³äºä¸ªäººå“å‘³ã€‚\nè‡³äºç»ƒä¹ ï¼Œæˆ‘ä»¬æ¨èå­¦ç”Ÿåœ¨Leetcodeä¸Šè§£å†³é—®é¢˜ã€‚Leetcodeä¸Šçš„é—®é¢˜å¾€å¾€æœ‰è¶£ä¸”å¸¦æœ‰è‰¯å¥½çš„è§£æ³•å’Œè®¨è®ºã€‚æ­¤å¤–ï¼Œåœ¨ç«äº‰æ—¥ç›Šæ¿€çƒˆçš„è½¯ä»¶è¡Œä¸šï¼Œè¿™äº›é—®é¢˜å¯ä»¥å¸®åŠ©ä½ è¯„ä¼°è‡ªå·±åº”å¯¹æŠ€æœ¯é¢è¯•ä¸­å¸¸è§é—®é¢˜çš„èƒ½åŠ›ã€‚æˆ‘ä»¬å»ºè®®è§£å†³å¤§çº¦100é“éšæœºæŒ‘é€‰çš„Leetcodeé—®é¢˜ï¼Œä½œä¸ºå­¦ä¹ çš„ä¸€éƒ¨åˆ†ã€‚\næœ€åï¼Œæˆ‘ä»¬å¼ºçƒˆæ¨è ã€Šæ€æ ·è§£é¢˜ã€‹ã€‚è¿™æœ¬ä¹¦æä¸ºä¼˜ç§€ä¸”ç‹¬ç‰¹ï¼ŒæŒ‡å¯¼äººä»¬è§£å†³å¹¿ä¹‰ä¸Šçš„é—®é¢˜ï¼Œå› è€Œä¸€å¦‚å…¶é€‚ç”¨äºæ•°å­¦ï¼Œå®ƒé€‚ç”¨äºè®¡ç®—æœºç§‘å­¦ã€‚\næˆ‘å¯ä»¥å¹¿æ³›æ¨èçš„æ–¹æ³•åªæœ‰ä¸€ä¸ªï¼š å†™ä¹‹å‰å…ˆæ€è€ƒã€‚\nâ€” Richard Hamming\næ•°å­¦çŸ¥è¯† ä»æŸä¸ªè§’åº¦è¯´ï¼Œè®¡ç®—æœºç§‘å­¦æ˜¯åº”ç”¨æ•°å­¦çš„ä¸€ä¸ªâ€œå‘è‚²è¿‡åº¦â€çš„åˆ†æ”¯ã€‚å°½ç®¡è®¸å¤šè½¯ä»¶å·¥ç¨‹å¸ˆè¯•å›¾â€”â€”å¹¶ä¸”åœ¨ä¸åŒç¨‹åº¦ä¸ŠæˆåŠŸåšåˆ°â€”â€”å¿½è§†è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬é¼“åŠ±ä½ ç”¨å­¦ä¹ æ¥æ‹¥æŠ±æ•°å­¦ã€‚å¦‚è‹¥æˆåŠŸï¼Œæ¯”èµ·é‚£äº›æ²¡æœ‰æŒæ¡æ•°å­¦çš„äººï¼Œä½ å°†è·å¾—å·¨å¤§çš„ç«äº‰ä¼˜åŠ¿ã€‚\nå¯¹äºè®¡ç®—æœºç§‘å­¦ï¼Œæ•°å­¦ä¸­æœ€ç›¸å…³çš„é¢†åŸŸæ˜¯â€œç¦»æ•£æ•°å­¦â€ï¼Œå…¶ä¸­çš„â€œç¦»æ•£â€ä¸â€œè¿ç»­â€ç›¸å¯¹ç«‹ï¼Œå¤§è‡´ä¸ŠæŒ‡çš„æ˜¯åº”ç”¨æ•°å­¦ä¸­é‚£äº›æœ‰è¶£çš„ä¸»é¢˜ï¼Œè€Œä¸æ˜¯å¾®ç§¯åˆ†ä¹‹ç±»çš„ã€‚ç”±äºå®šä¹‰æ¯”è¾ƒå«ç³Šï¼Œè¯•å›¾æŒæ¡ç¦»æ•£æ•°å­¦çš„å…¨éƒ¨å†…å®¹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚è¾ƒä¸ºç°å®çš„å­¦ä¹ ç›®æ ‡æ˜¯ï¼Œäº†è§£é€»è¾‘ã€æ’åˆ—ç»„åˆã€æ¦‚ç‡è®ºã€é›†åˆè®ºã€å›¾è®ºä»¥åŠå¯†ç å­¦ç›¸å…³çš„ä¸€äº›æ•°è®ºçŸ¥è¯†ã€‚è€ƒè™‘åˆ°çº¿æ€§ä»£æ•°åœ¨è®¡ç®—æœºå›¾å½¢å­¦å’Œæœºå™¨å­¦ä¹ ä¸­çš„é‡è¦æ€§ï¼Œè¯¥é¢†åŸŸåŒæ ·å€¼å¾—å­¦ä¹ ã€‚\nå­¦ä¹ ç¦»æ•£æ•°å­¦ï¼Œæˆ‘ä»¬å»ºè®®ä»LÃ¡szlÃ³ LovÃ¡szçš„è¯¾ç¨‹ç¬”è®°å¼€å§‹ã€‚LovÃ¡szæ•™æˆæˆåŠŸåœ°è®©è¿™äº›å†…å®¹æµ…æ˜¾æ˜“æ‡‚ä¸”ç¬¦åˆç›´è§‰ï¼Œå› æ­¤ï¼Œæ¯”èµ·æ­£å¼çš„æ•™æï¼Œè¿™æ›´é€‚åˆåˆå­¦è€…ã€‚\nå¯¹äºæ›´åŠ é«˜é˜¶çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æ¨è ã€Šè®¡ç®—æœºç§‘å­¦ä¸­çš„æ•°å­¦ã€‹ï¼ŒMITåŒåè¯¾ç¨‹çš„è¯¾ç¨‹ç¬”è®°ï¼Œç¯‡å¹…ä¸ä¹¦ç±ç›¸å½“ï¼ˆäº‹å®ä¸Šï¼Œç°å·²å‡ºç‰ˆï¼‰ã€‚è¿™é—¨è¯¾ç¨‹çš„è§†é¢‘åŒæ ·å¯å…è´¹è·å¾—ï¼Œæ˜¯æˆ‘ä»¬æ‰€æ¨èçš„å­¦ä¹ è§†é¢‘ã€‚\nå¯¹äºçº¿æ€§ä»£æ•°ï¼Œæˆ‘ä»¬å»ºè®®ä»Essence of linear algebraç³»åˆ—è§†é¢‘å¼€å§‹ï¼Œç„¶åå†å»å­¦ä¹ Gilbert Strangçš„ã€Šçº¿æ€§ä»£æ•°å¯¼è®ºã€‹å’Œè§†é¢‘è¯¾ç¨‹ã€‚\nå¦‚æœäººä»¬ä¸ç›¸ä¿¡æ•°å­¦æ˜¯ç®€å•çš„ï¼Œé‚£ä¹ˆåªèƒ½æ˜¯å› ä¸ºä»–ä»¬æ²¡æœ‰æ„è¯†åˆ°ç”Ÿæ´»æœ‰å¤šä¹ˆå¤æ‚ã€‚\nâ€” John von Neumann\næ“ä½œç³»ç»Ÿ ã€Šæ“ä½œç³»ç»Ÿæ¦‚å¿µã€‹ ï¼ˆâ€œæé¾™ä¹¦â€ï¼‰å’Œ ã€Šç°ä»£æ“ä½œç³»ç»Ÿã€‹ æ˜¯æ“ä½œç³»ç»Ÿé¢†åŸŸçš„ç»å…¸ä¹¦ç±ã€‚äºŒè€…éƒ½å› ä¸ºå†™ä½œé£æ ¼å’Œå¯¹å­¦ç”Ÿä¸å‹å¥½è€Œæ‹›è‡´äº†ä¸€äº›æ‰¹è¯„ã€‚\nã€Šæ“ä½œç³»ç»Ÿå¯¼è®ºã€‹ï¼ˆOperating Systems: Three Easy Piecesï¼‰ æ˜¯ä¸€ä¸ªä¸é”™çš„æ›¿ä»£å“ï¼Œå¹¶ä¸”å¯åœ¨ç½‘ä¸Šå…è´¹è·å¾—ï¼ˆè‹±æ–‡ç‰ˆï¼‰ã€‚æˆ‘ä»¬æ ¼å¤–å–œæ¬¢è¿™æœ¬ä¹¦çš„ç»“æ„ï¼Œå¹¶ä¸”è®¤ä¸ºè¿™æœ¬ä¹¦çš„ä¹ é¢˜å¾ˆå€¼å¾—ä¸€åšã€‚\nåœ¨è¯»å®Œã€Šæ“ä½œç³»ç»Ÿå¯¼è®ºã€‹åï¼Œæˆ‘ä»¬é¼“åŠ±ä½ æ¢ç´¢ç‰¹å®šæ“ä½œç³»ç»Ÿçš„è®¾è®¡ã€‚å¯ä»¥å€ŸåŠ©â€œ{OS name} Internalsâ€é£æ ¼çš„ä¹¦ç±ï¼Œæ¯”å¦‚ Lion's commentary on Unixï¼Œ The Design and Implementation of the FreeBSD Operating Systemï¼Œä»¥åŠ Mac OS X Internalsã€‚å¯¹äº Linux ï¼Œæˆ‘ä»¬æ¨è Robert Love çš„ ã€ŠLinuxå†…æ ¸è®¾è®¡ä¸å®ç°ã€‹ã€‚\nä¸ºäº†å·©å›ºå¯¹æ“ä½œç³»ç»Ÿçš„ç†è§£ï¼Œé˜…è¯»å°å‹ç³»ç»Ÿå†…æ ¸çš„ä»£ç å¹¶ä¸”ä¸ºå…¶å¢åŠ ç‰¹æ€§æ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œxv6ï¼Œç”±MITçš„ä¸€é—¨è¯¾ç¨‹æ‰€ç»´æŠ¤çš„ä»Unix V6åˆ°ANSI Cå’Œx86çš„ç§»æ¤ï¼Œå°±æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„é€‰æ‹©ã€‚ã€Šæ“ä½œç³»ç»Ÿå¯¼è®ºã€‹æœ‰ä¸€ä¸ªé™„å½•ï¼Œè®°è½½äº†ä¸€äº›å¯èƒ½çš„xv6å®éªŒé¡¹ç›®ï¼Œå…¶ä¸­å……æ»¡äº†å…³äºæ½œåœ¨é¡¹ç›®çš„å¾ˆæ£’æƒ³æ³•ã€‚\nè®¡ç®—æœºç½‘ç»œ é‰´äºæœ‰é‚£ä¹ˆå¤šå…³äºç½‘ç»œæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„è½¯ä»¶å·¥ç¨‹ï¼Œè®¡ç®—æœºç½‘ç»œæ˜¯è®¡ç®—æœºç§‘å­¦ä¸­ä»·å€¼æœ€ä¸ºâ€œç«‹ç«¿è§å½±â€çš„é¢†åŸŸä¹‹ä¸€ã€‚æˆ‘ä»¬çš„å­¦ç”Ÿï¼Œç³»ç»Ÿæ€§åœ°å­¦ä¹ äº†è®¡ç®—æœºç½‘ç»œï¼Œæœ€ç»ˆèƒ½å¤Ÿç†è§£é‚£äº›æ›¾å›°æ‰°ä»–ä»¬å¤šå¹´çš„æœ¯è¯­ã€æ¦‚å¿µå’Œåè®®ã€‚\nåœ¨è¿™ä¸€ä¸»é¢˜ä¸Šï¼Œæˆ‘ä»¬æœ€çˆ±çš„ä¹¦ç±æ˜¯ ã€Šè®¡ç®—æœºç½‘ç»œï¼šè‡ªé¡¶å‘ä¸‹æ–¹æ³•ã€‹ã€‚ä¹¦ä¸­çš„å°é¡¹ç›®å’Œä¹ é¢˜ç›¸å½“å€¼å¾—ç»ƒä¹ ï¼Œå°¤å…¶æ˜¯å…¶ä¸­çš„â€œWireshark labsâ€ï¼ˆè¿™éƒ¨åˆ†åœ¨ç½‘ä¸Šå¯ä»¥è·å¾—ï¼‰ã€‚\nå¦‚æœæ›´å–œæ¬¢è§†é¢‘è¯¾ç¨‹ï¼Œæˆ‘ä»¬æ¨èStanfordçš„Introduction to Computer Networkingï¼Œå¯åœ¨ä»–ä»¬çš„MOOCå¹³å°Lagunitaä¸Šå…è´¹è§‚çœ‹ã€‚\nå¯¹äºè®¡ç®—æœºç½‘ç»œçš„å­¦ä¹ ï¼Œåšé¡¹ç›®æ¯”å®Œæˆå°çš„ä¹ é¢˜æ›´æœ‰ç›Šã€‚ä¸€äº›å¯èƒ½çš„é¡¹ç›®æœ‰ï¼šHTTPæœåŠ¡å™¨ï¼ŒåŸºäºUDPçš„èŠå¤©APPï¼Œè¿·ä½ TCPæ ˆï¼Œä»£ç†ï¼Œè´Ÿè½½å‡è¡¡å™¨ï¼Œæˆ–è€…åˆ†å¸ƒå¼å“ˆå¸Œè¡¨ã€‚\nä½ æ— æ³•ç›¯ç€æ°´æ™¶çƒé¢„è§æœªæ¥ï¼Œæœªæ¥çš„äº’è”ç½‘ä½•å»ä½•ä»å–å†³äºç¤¾ä¼šã€‚\nâ€” Bob Kahn\næ•°æ®åº“ æ¯”èµ·å…¶ä»–ä¸»é¢˜ï¼Œè‡ªå­¦æ•°æ®åº“ç³»ç»Ÿéœ€è¦æ›´å¤šçš„ä»˜å‡ºã€‚è¿™æ˜¯ä¸€ä¸ªç›¸å¯¹å¹´è½»çš„ç ”ç©¶é¢†åŸŸï¼Œå¹¶ä¸”å‡ºäºå¾ˆå¼ºçš„å•†ä¸šåŠ¨æœºï¼Œç ”ç©¶è€…æŠŠæƒ³æ³•è—åœ¨ç´§é—­çš„é—¨åã€‚æ­¤å¤–ï¼Œè®¸å¤šåŸæœ¬æœ‰æ½œåŠ›å†™å‡ºä¼˜ç§€æ•™æçš„ä½œè€…åè€Œé€‰æ‹©äº†åŠ å…¥æˆ–åˆ›ç«‹å…¬å¸ã€‚\né‰´äºå¦‚ä¸Šæƒ…å†µï¼Œæˆ‘ä»¬é¼“åŠ±è‡ªå­¦è€…å¤§ä½“ä¸ŠæŠ›å¼ƒæ•™æï¼Œè€Œæ˜¯ä»2015å¹´æ˜¥å­£å­¦æœŸçš„CS 186è¯¾ç¨‹ï¼ˆJoe Hellersteinåœ¨Berkeleyçš„æ•°æ®åº“è¯¾ç¨‹ï¼‰å¼€å§‹ï¼Œç„¶åå‰å¾€é˜…è¯»è®ºæ–‡ã€‚\nå¯¹äºåˆå­¦è€…ï¼Œæœ‰ä¸€ç¯‡æ ¼å¤–å€¼å¾—æåŠçš„è®ºæ–‡ï¼šâ€œArchitecture of a Database Systemâ€ã€‚è¿™ç¯‡è®ºæ–‡æä¾›äº†ç‹¬ç‰¹çš„å¯¹å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRDBMSï¼‰å¦‚ä½•å·¥ä½œçš„é«˜å±‚æ¬¡è§‚ç‚¹ï¼Œæ˜¯åç»­å­¦ä¹ çš„å®ç”¨æ¢—æ¦‚ã€‚\nã€ŠReadings in Database Systemsã€‹ï¼Œæˆ–è€…ä»¥æ•°æ®åº“â€œçº¢ä¹¦â€æ›´ä¸ºäººçŸ¥ï¼Œæ˜¯ç”±Peter Bailisï¼ŒJoe Hellersteinå’ŒMichael Stonebrakerç¼–çº‚çš„è®ºæ–‡åˆé›†ã€‚å¯¹äºé‚£äº›æƒ³è¦åœ¨CS 186è¯¾ç¨‹çš„æ°´å¹³æ›´è¿›ä¸€æ­¥çš„å­¦ä¹ è€…ï¼Œâ€œçº¢ä¹¦â€åº”å½“æ˜¯ä¸‹ä¸€æ­¥ã€‚\nå¦‚æœä½ åšæŒä¸€å®šè¦ä¸€æœ¬å¯¼è®ºæ•™æï¼Œé‚£æˆ‘ä»¬æ¨èRamakrishnanå’ŒGehrkeæ‰€è‘—çš„ ã€Šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼šåŸç†ä¸è®¾è®¡ã€‹ã€‚å¦‚éœ€æ›´æ·±ä¸€æ­¥ï¼ŒJim Grayçš„ç»å…¸è‘—ä½œ ã€ŠTransaction Processing: Concepts and Techniquesã€‹ å€¼å¾—ä¸€è¯»ï¼Œä¸è¿‡æˆ‘ä»¬ä¸å»ºè®®æŠŠè¿™æœ¬ä¹¦å½“ä½œé¦–è¦èµ„æºã€‚\nå¦‚æœæ²¡æœ‰ç¼–å†™è¶³å¤Ÿæ•°é‡çš„ä»£ç ï¼Œå¾ˆéš¾å·©å›ºæ•°æ®åº“ç†è®ºã€‚CS 186è¯¾ç¨‹çš„å­¦ç”Ÿç»™Sparkæ·»åŠ ç‰¹æ€§ï¼Œå€’æ˜¯ä¸é”™çš„é¡¹ç›®ï¼Œä¸è¿‡æˆ‘ä»¬ä»…ä»…å»ºè®®ä»é›¶å®ç°ä¸€ä¸ªç®€å•çš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€‚è‡ªç„¶ï¼Œå®ƒå°†ä¸ä¼šæœ‰å¤ªå¤šçš„ç‰¹æ€§ï¼Œä½†æ˜¯å³ä¾¿åªå®ç°å…¸å‹çš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ¯ä¸ªæ–¹é¢æœ€åŸºç¡€çš„åŠŸèƒ½ï¼Œä¹Ÿæ˜¯ç›¸å½“æœ‰å¯å‘çš„ã€‚\næœ€åï¼Œæ•°æ®æ¨¡å‹å¾€å¾€æ˜¯æ•°æ®åº“ä¸­ä¸€ä¸ªè¢«å¿½è§†çš„ã€æ•™å­¦ä¸å……åˆ†çš„æ–¹é¢ã€‚å…³äºè¿™ä¸ªä¸»é¢˜ï¼Œæˆ‘ä»¬æ¨èçš„ä¹¦ç±æ˜¯ Data and Reality: A Timeless Perspective on Perceiving and Managing Information in Our Imprecise Worldã€‚\nç¼–ç¨‹è¯­è¨€ä¸ç¼–è¯‘å™¨ å¤šæ•°ç¨‹åºå‘˜å­¦ä¹ ç¼–ç¨‹è¯­è¨€çš„çŸ¥è¯†ï¼Œè€Œå¤šæ•°è®¡ç®—æœºç§‘å­¦å®¶å­¦ä¹ ç¼–ç¨‹è¯­è¨€ ç›¸å…³ çš„çŸ¥è¯†ã€‚è¿™ä½¿å¾—è®¡ç®—æœºç§‘å­¦å®¶æ¯”èµ·ç¨‹åºå‘˜æ‹¥æœ‰æ˜¾è‘—çš„ä¼˜åŠ¿ï¼Œå³ä¾¿åœ¨ç¼–ç¨‹é¢†åŸŸï¼å› ä¸ºä»–ä»¬çš„çŸ¥è¯†å¯ä»¥æ¨è€Œå¹¿ä¹‹ï¼šç›¸è¾ƒåªå­¦ä¹ è¿‡ç‰¹å®šç¼–ç¨‹è¯­è¨€çš„äººï¼Œä»–ä»¬å¯ä»¥æ›´æ·±å…¥æ›´å¿«é€Ÿåœ°ç†è§£æ–°çš„ç¼–ç¨‹è¯­è¨€ã€‚\næˆ‘ä»¬æ¨èçš„å…¥é—¨ä¹¦æ˜¯ Bob Nystrom æ‰€è‘—çš„ä¼˜ç§€çš„ Crafting Interpretersï¼Œå¯åœ¨ç½‘ä¸Šå…è´¹è·å–ã€‚è¿™æœ¬ä¹¦æ¡ç†æ¸…æ™°ï¼Œå¯Œæœ‰è¶£å‘³æ€§ï¼Œéå¸¸é€‚åˆé‚£äº›æƒ³è¦æ›´å¥½åœ°ç†è§£è¯­è¨€å’Œè¯­è¨€å·¥å…·çš„äººã€‚æˆ‘ä»¬å»ºè®®ä½ èŠ±æ—¶é—´è¯»å®Œæ•´æœ¬ä¹¦ï¼Œå¹¶å°è¯•ä»»ä½•ä¸€ä¸ªæ„Ÿå…´è¶£çš„â€œæŒ‘æˆ˜â€ã€‚\nå¦ä¸€æœ¬æ›´ä¸ºä¼ ç»Ÿçš„æ¨èä¹¦ç±æ˜¯ ã€Šç¼–è¯‘åŸç†ã€‹ï¼Œé€šå¸¸ç§°ä¸ºâ€œé¾™ä¹¦â€ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™æœ¬ä¹¦ä¸æ˜¯ä¸ºè‡ªå­¦è€…è€Œè®¾è®¡çš„ï¼Œè€Œæ˜¯ä¾›æ•™å¸ˆä»ä¸­æŒ‘é€‰ä¸€äº›ä¸»é¢˜ç”¨äº1-2å­¦æœŸçš„æ•™å­¦ã€‚\nå¦‚æœä½ é€‰æ‹©ä½¿ç”¨é¾™ä¹¦è¿›è¡Œè‡ªå­¦ï¼Œä½ éœ€è¦ä»ä¸­ç”„é€‰ä¸»é¢˜ï¼Œè€Œä¸”æœ€å¥½æ˜¯åœ¨å¯¼å¸ˆçš„å¸®åŠ©ä¸‹ã€‚æˆ‘ä»¬å»ºè®®ä¾æ®æŸä¸ªè§†é¢‘è¯¾ç¨‹æ¥è®¾å®šå­¦ä¹ çš„ç»“æ„ï¼Œç„¶åæŒ‰éœ€ä»é¾™ä¹¦ä¸­è·å–æ·±å…¥çš„å†…å®¹ã€‚æˆ‘ä»¬æ¨èçš„åœ¨çº¿è¯¾ç¨‹æ˜¯Alex Aikenåœ¨MOOCå¹³å° edX æ‰€å¼€è®¾çš„ã€‚\nä¸è¦åšä¸€ä¸ªåªå†™æ ·æ¿ä»£ç çš„ç¨‹åºå‘˜ã€‚ç›¸åï¼Œç»™ç”¨æˆ·å’Œå…¶ä»–ç¨‹åºå‘˜åˆ›é€ å·¥å…·ã€‚ä»çººç»‡å·¥ä¸šå’Œé’¢é“å·¥ä¸šä¸­å­¦ä¹ å†å²æ•™è®­ï¼šä½ æƒ³åˆ¶é€ æœºå™¨å’Œå·¥å…·ï¼Œè¿˜æ˜¯æ“ä½œè¿™äº›æœºå™¨ï¼Ÿ\nâ€” Ras Bodik åœ¨ä»–çš„ç¼–è¯‘å™¨è¯¾ç¨‹ä¼Šå§‹\nåˆ†å¸ƒå¼ç³»ç»Ÿ éšç€è®¡ç®—æœºåœ¨æ•°é‡ä¸Šçš„å¢åŠ ï¼Œè®¡ç®—æœºåŒæ ·å¼€å§‹ åˆ†æ•£ã€‚å°½ç®¡å•†ä¸šå…¬å¸è¿‡å»æ„¿æ„è´­ä¹°è¶Šæ¥è¶Šå¤§çš„å¤§å‹æœºï¼Œç°åœ¨çš„å…¸å‹æƒ…å†µæ˜¯ï¼Œç”šè‡³å¾ˆå°çš„åº”ç”¨ç¨‹åºéƒ½åŒæ—¶åœ¨å¤šå°æœºå™¨ä¸Šè¿è¡Œã€‚æ€è€ƒè¿™æ ·åšçš„åˆ©å¼Šæƒè¡¡ï¼Œå³æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç ”ç©¶æ‰€åœ¨ï¼Œä¹Ÿæ˜¯è¶Šæ¥è¶Šé‡è¦çš„ä¸€é¡¹æŠ€èƒ½ã€‚\næˆ‘ä»¬æ¨èçš„è‡ªå­¦å‚è€ƒä¹¦æ˜¯ Martin Kleppmann çš„ ã€Šæ•°æ®å¯†é›†å‹åº”ç”¨ç³»ç»Ÿè®¾è®¡ã€‹ã€‚ä¸ä¼ ç»Ÿçš„æ•™ç§‘ä¹¦ç›¸æ¯”ï¼Œå®ƒæ˜¯ä¸€æœ¬ä¸ºå®è·µè€…è®¾è®¡çš„å…·æœ‰å¾ˆé«˜çš„å¯è¯»æ€§çš„ä¹¦ï¼Œå¹¶ä¸”ä¿æŒäº†æ·±åº¦å’Œä¸¥è°¨æ€§ã€‚\nå¯¹äºé‚£äº›åçˆ±ä¼ ç»Ÿæ•™æï¼Œæˆ–è€…å¸Œæœ›å¯ä»¥ä»ç½‘ä¸Šå…è´¹è·å–çš„äººï¼Œæˆ‘ä»¬æ¨èçš„æ•™ææ˜¯Maarten van Steenå’ŒAndrew Tanenbaumæ‰€è‘—çš„ ã€Šåˆ†å¸ƒå¼ç³»ç»ŸåŸç†ä¸èŒƒå‹ã€‹ï¼ˆä¸­æ–‡ç¬¬äºŒç‰ˆï¼Œè‹±æ–‡ç¬¬ä¸‰ç‰ˆï¼‰ã€‚\nå¯¹äºå–œæ¬¢è§†é¢‘è¯¾ç¨‹çš„äººï¼ŒMITçš„6.824 æ˜¯ä¸€é—¨å¾ˆå¥½çš„åœ¨çº¿è§†é¢‘è¯¾ç¨‹ï¼Œç”± Robert Morris æ•™æˆçš„ç ”ç©¶ç”Ÿè¯¾ç¨‹ï¼Œåœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°è¯¾ç¨‹å®‰æ’ã€‚\nä¸ç®¡é€‰æ‹©æ€æ ·çš„æ•™ææˆ–è€…å…¶ä»–è¾…åŠ©èµ„æ–™ï¼Œå­¦ä¹ åˆ†å¸ƒå¼ç³»ç»Ÿå¿…ç„¶è¦æ±‚é˜…è¯»è®ºæ–‡ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¸é”™çš„è®ºæ–‡æ¸…å•ï¼Œè€Œä¸”æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ å‡ºå¸­ä½ å½“åœ°çš„Papers We Loveï¼ˆä»…é™ç¾å›½ï¼‰ã€‚\nå¸¸è§é—®é¢˜è§£ç­” è¿™ä»½æŒ‡å¼•çš„ç›®æ ‡å—ä¼—æ˜¯ï¼Ÿ æˆ‘ä»¬é¢å‘è‡ªå­¦çš„è½¯ä»¶å·¥ç¨‹å¸ˆã€åŸ¹è®­ç­å­¦ç”Ÿã€â€œæ—©ç†Ÿçš„â€é«˜ä¸­ç”Ÿæˆ–è€…æƒ³è¦é€šè¿‡è‡ªå­¦è¡¥å……æ­£å¼æ•™è‚²çš„å¤§å­¦ç”Ÿã€‚å…³äºä½•æ—¶å¼€å¯è¿™æ®µè‡ªå­¦æ—…ç¨‹ï¼Œå®Œå…¨å–å†³äºä¸ªäººï¼Œä¸è¿‡å¤šæ•°äººåœ¨æœ‰ä¸€å®šçš„èŒä¸šç»å†åæ·±å…¥å­¦ä¹ è®¡ç®—æœºç§‘å­¦ç†è®ºä¼šè·ç›ŠåŒªæµ…ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¦‚æœå­¦ç”Ÿåœ¨å·¥ä½œä¸­æ›¾ç»ä½¿ç”¨è¿‡æ•°æ®åº“ï¼Œä»–ä»¬ä¼š å–œçˆ± å­¦ä¹ æ•°æ®åº“ç³»ç»Ÿè¯¾ç¨‹ï¼›å¦‚æœå­¦ç”Ÿä»äº‹è¿‡ä¸€ä¸¤ä¸ªWebé¡¹ç›®ï¼Œä»–ä»¬ä¼š å–œçˆ± å­¦ä¹ è®¡ç®—æœºç½‘ç»œã€‚\näººå·¥æ™ºèƒ½/è®¡ç®—æœºå›¾å½¢å­¦/XXä¸»é¢˜æ€ä¹ˆæ ·ï¼Ÿ æˆ‘ä»¬è¯•å›¾æŠŠè®¡ç®—æœºç§‘å­¦ä¸»é¢˜æ¸…å•é™åˆ¶åˆ°é‚£äº›æˆ‘ä»¬è®¤ä¸º æ¯ä¸€ä¸ªè½¯ä»¶å·¥ç¨‹å¸ˆ éƒ½åº”è¯¥äº†è§£çš„å†…å®¹ï¼Œä¸é™äºä¸“ä¸šæˆ–è¡Œä¸šã€‚æ‹¥æœ‰äº†è¿™äº›åŸºç¡€ï¼Œä½ å°†èƒ½æ›´åŠ è½»æ¾åœ°æŒ‘é€‰æ•™ææˆ–è®ºæ–‡ï¼Œç„¶è€Œæ— éœ€æŒ‡å¼•åœ°å­¦ä¹ æ ¸å¿ƒæ¦‚å¿µã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»™å‡ºä¸€äº›å…¶ä»–å¸¸è§ä¸»é¢˜çš„è‡ªå­¦èµ·ç‚¹ï¼š\näººå·¥æ™ºèƒ½ï¼šé€šè¿‡è§‚çœ‹è§†é¢‘å¹¶å®ŒæˆPacmané¡¹ç›®æ¥å­¦ä¹ Berkeleyçš„AIè¯¾ç¨‹ã€‚è‡³äºæ•™æï¼Œä½¿ç”¨Russellå’ŒNorvigç¼–å†™çš„ ã€Šäººå·¥æ™ºèƒ½ï¼šä¸€ç§ç°ä»£æ–¹æ³•ã€‹ã€‚ æœºå™¨å­¦ä¹ ï¼šå­¦ä¹ å´æ©è¾¾åœ¨Courseraä¸Šçš„è¯¾ç¨‹ã€‚è€å¿ƒå­¦ä¹ ï¼Œå…ˆç¡®ä¿ç†è§£äº†åŸºç¡€æ¦‚å¿µå†å¥”å‘ç±»å¦‚æ·±åº¦å­¦ä¹ çš„è¯±äººæ–°ä¸»é¢˜ã€‚ è®¡ç®—æœºå›¾å½¢å­¦ï¼šå­¦ä¹ Berkeley CS 184è¯¾ç¨‹çš„ææ–™ï¼Œä½¿ç”¨ã€Šè®¡ç®—æœºå›¾å½¢å­¦ï¼šåŸç†åŠå®è·µã€‹ä½œä¸ºæ•™æã€‚ ä¸€å®šè¦ä¸¥æ ¼éµå®ˆæ¨èçš„å­¦ä¹ æ¬¡åºå—ï¼Ÿ äº‹å®ä¸Šï¼Œæ‰€æœ‰ä¸»é¢˜ä¹‹é—´éƒ½æœ‰ä¸€å®šç¨‹åº¦çš„é‡å ï¼Œå½¼æ­¤å¾ªç¯å¼•ç”¨ã€‚ä»¥ç¦»æ•£æ•°å­¦å’Œç®—æ³•çš„å…³ç³»ä¸ºä¾‹ï¼šå…ˆå­¦ä¹ æ•°å­¦å¯ä»¥å¸®åŠ©ä½ æ›´æ·±å…¥åœ°åˆ†æå’Œç†è§£ç®—æ³•ï¼Œç„¶è€Œå…ˆå­¦ä¹ ç®—æ³•å¯ä»¥ä¸ºå­¦ä¹ ç¦»æ•£æ•°å­¦æä¾›æ›´å¤§çš„åŠ¨åŠ›å’Œåº”ç”¨èƒŒæ™¯ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œä½ å°†åœ¨ä½ çš„èŒä¸šç”Ÿæ¶¯å¤šæ¬¡é‡æ¸©äºŒè€…ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬æ‰€æ¨èçš„æ¬¡åºä¸»è¦æ˜¯ä¸ºäº†å¸®åŠ©ä½  èµ·æ­¥â€¦â€¦å¦‚æœä½ å‡ºäºæŸç§å¼ºçƒˆçš„åŸå› è€Œå€¾å‘ä»¥ä¸åŒçš„é¡ºåºå­¦ä¹ ï¼Œé‚£ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå‹‡æ•¢å¼€å§‹å§ï¼ä¸è¿‡åœ¨æˆ‘ä»¬çœ‹æ¥ï¼Œæœ€é‡è¦çš„â€œå…ˆå†³æ¡ä»¶â€æ˜¯ï¼šå…ˆå­¦è®¡ç®—æœºæ¶æ„å†å­¦æ“ä½œç³»ç»Ÿæˆ–æ•°æ®åº“ï¼Œå…ˆå­¦è®¡ç®—æœºç½‘ç»œå’Œæ“ä½œç³»ç»Ÿå†å­¦åˆ†å¸ƒå¼ç³»ç»Ÿã€‚\nå’ŒOpen Source Societyã€freeCodeCamp curriculaç­‰æ¯”èµ·æ¥ï¼Œè¿™ä»½æŒ‡å¼•? OSSæŒ‡å¼•æ¶µç›–å¤ªå¤šä¸»é¢˜ï¼Œåœ¨è®¸å¤šä¸»é¢˜ä¸­æ¨èåŠ£è´¨èµ„æºï¼Œæ²¡æœ‰å°±ç‰¹å®šè¯¾ç¨‹å“ªäº›æ–¹é¢æœ‰ä»·å€¼æä¾›åŸå› æˆ–æŒ‡å¼•ã€‚æˆ‘ä»¬åŠªåŠ›å¯¹è¿™ä»½æŒ‡å¼•ä¸­çš„è¯¾ç¨‹åŠ ä»¥é™åˆ¶ï¼Œä»…ä»…åŒ…æ‹¬é‚£äº›ä½ ä½œä¸ºè½¯ä»¶å·¥ç¨‹å¸ˆ ç¡®å®éœ€è¦äº†è§£çš„ï¼Œä¸è®ºä½ çš„ä¸“ä¸šæ–¹å‘ï¼Œå¹¶ä¸”å¯¹æ¯é—¨è¯¾ç¨‹ä¸ºä½•å¿…è¦åšå‡ºäº†è§£é‡Šä»¥å¸®åŠ©ä½ ç†è§£ã€‚\nFreeCodeCampä¸»è¦å…³æ³¨ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯è®¡ç®—æœºç§‘å­¦ã€‚è‡³äºä½ ä¸ºä»€ä¹ˆè¦å­¦ä¹ è®¡ç®—æœºç§‘å­¦ï¼Œå‚è§ä¸Šæ–‡ã€‚å¦‚æœä½ æ˜¯ä¸ªæ–°æ‰‹ï¼Œæˆ‘ä»¬å»ºè®®å…ˆå­¦ freeCodeCamp çš„è¯¾ç¨‹ï¼Œä¸€ä¸¤å¹´åå†å›å½’æœ¬æŒ‡å—ã€‚\nXXç¼–ç¨‹è¯­è¨€æ€ä¹ˆæ ·? å­¦ä¹ ä¸€é—¨ç‰¹å®šçš„ç¼–ç¨‹è¯­è¨€å’Œå­¦ä¹ è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªé¢†åŸŸå®Œå…¨ä¸åœ¨ä¸€ä¸ªç»´åº¦â€”â€”ç›¸æ¯”ä¹‹ä¸‹ï¼Œå­¦ä¹ è¯­è¨€ å®¹æ˜“ ä¸” ç¼ºä¹ä»·å€¼ã€‚å¦‚æœä½ å·²ç»äº†è§£äº†ä¸€äº›è¯­è¨€ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®éµç…§æˆ‘ä»¬çš„æŒ‡å¼•ï¼Œç„¶ååœ¨å­¦ä¹ çš„ç©ºå½“ä¸­ä¹ å¾—è¯­è¨€ï¼Œæˆ–è€…æš‚ä¸”ä¸ç®¡ä»¥åå†è¯´ã€‚å¦‚æœä½ å·²ç»æŠŠç¼–ç¨‹å­¦å¾—ä¸é”™äº†ï¼ˆæ¯”å¦‚å­¦å®Œäº† ã€Šè®¡ç®—æœºç¨‹åºçš„æ„é€ å’Œè§£é‡Šã€‹ï¼‰ï¼Œå°¤å…¶æ˜¯å¦‚æœä½ å­¦ä¹ è¿‡ç¼–è¯‘å™¨ï¼Œé‚£ä¹ˆé¢å¯¹ä¸€é—¨æ–°çš„è¯­è¨€ï¼Œä½ åªéœ€è¦èŠ±ä¸€ä¸ªå‘¨æœ«ç¨å¤šçš„æ—¶é—´å³å¯åŸºæœ¬æŒæ¡ï¼Œä¹‹åä½ å¯ä»¥åœ¨å·¥ä½œä¸­å­¦ä¹ ç›¸å…³çš„ç±»åº“/å·¥å…·/ç”Ÿæ€ã€‚\nXXæµè¡ŒæŠ€æœ¯æ€ä¹ˆæ ·? æ²¡æœ‰ä»»ä½•ä¸€ç§æŠ€æœ¯çš„é‡è¦ç¨‹åº¦å¯ä»¥è¾¾åˆ°å­¦ä¹ å…¶ä½¿ç”¨è¶³ä»¥æˆä¸ºè®¡ç®—æœºç§‘å­¦æ•™å­¦çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ä¸è¿‡ï¼Œä½ å¯¹å­¦ä¹ é‚£é—¨æŠ€æœ¯å……æ»¡çƒ­æƒ…ï¼Œè¿™å¾ˆä¸é”™ã€‚è¯€çªæ˜¯å…ˆä»ç‰¹å®šçš„æŠ€æœ¯å›é€€åˆ°åŸºæœ¬çš„é¢†åŸŸæˆ–æ¦‚å¿µï¼Œåˆ¤æ–­è¿™é—¨æµè¡ŒæŠ€æœ¯åœ¨æŠ€æœ¯çš„å®è§‚å¤§å±€ä¸­ä½äºä½•å¤„ï¼Œç„¶åæ‰æ·±å…¥å­¦ä¹ è¿™é—¨æŠ€æœ¯ã€‚\nä¸ºä»€ä¹ˆä½ ä»¬è¿˜åœ¨æ¨èSICP? å…ˆå°è¯•è¯»ä¸€ä¸‹ï¼Œæœ‰äº›äººè§‰å¾— SICP è®©äººç¥é­‚é¢ å€’ï¼Œè¿™åœ¨å…¶ä»–ä¹¦å¾ˆå°‘è§ã€‚å¦‚æœä½ ä¸å–œæ¬¢ï¼Œä½ å¯ä»¥å°è¯•å…¶ä»–çš„ä¸œè¥¿ï¼Œä¹Ÿè®¸ä»¥åå†å›åˆ° SICPã€‚\nä¸ºä»€ä¹ˆä½ ä»¬è¿˜åœ¨æ¨èé¾™ä¹¦? é¾™ä¹¦ä¾æ—§æ˜¯å†…å®¹æœ€ä¸ºå®Œæ•´çš„ç¼–è¯‘å™¨å•æœ¬ä¹¦ç±ã€‚ç”±äºè¿‡åˆ†å¼ºè°ƒä¸€äº›å¦‚ä»Šä¸å¤Ÿæ—¶æ–°çš„ä¸»é¢˜çš„ç»†èŠ‚ï¼Œæ¯”å¦‚è§£æï¼Œè¿™æœ¬ä¹¦æ‹›è‡´äº†æ¶è¯„ã€‚ç„¶è€Œäº‹å®ä¸Šï¼Œè¿™æœ¬ä¹¦ä»æœªæ‰“ç®—ä¾›äººä¸€é¡µä¸€é¡µçš„å­¦ä¹ ï¼Œè€Œä»…ä»…æ˜¯ä¸ºäº†ç»™æ•™å¸ˆå‡†å¤‡ä¸€é—¨è¯¾ç¨‹æä¾›è¶³å¤Ÿçš„ææ–™ã€‚ç±»ä¼¼åœ°ï¼Œè‡ªå­¦è€…å¯ä»¥ä»ä¹¦ä¸­é‡èº«æŒ‰éœ€æŒ‘é€‰ä¸»é¢˜ï¼Œæˆ–è€…æœ€å¥½ä¾ç…§å…¬å¼€è¯¾æˆè¯¾æ•™å¸ˆåœ¨è¯¾ç¨‹å¤§çº²ä¸­çš„å»ºè®®ã€‚\nå¦‚ä½•ä¾¿å®œè·å–æ•™æ? æˆ‘ä»¬æ‰€å»ºè®®çš„è®¸å¤šæ•™æåœ¨ç½‘ä¸Šéƒ½å¯ä»¥å…è´¹è·å¾—ï¼Œè¿™å¤šäºäº†ä½œè€…ä»¬çš„æ…·æ…¨ã€‚å¯¹äºé‚£äº›ä¸å…è´¹çš„ä¹¦ç±ï¼Œæˆ‘ä»¬å»ºè®®è´­ä¹°æ—§ç‰ˆæœ¬çš„äºŒæ‰‹ä¹¦ç±ã€‚å¹¿è€Œè¨€ä¹‹ï¼Œå¦‚æœä¸€æœ¬æ•™ææœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œæ—§ç‰ˆæœ¬å¤§æ¦‚ç‡æ˜¯å®Œå…¨è¶³å¤Ÿä½¿ç”¨çš„ã€‚å³ä¾¿æ–°ç‰ˆæœ¬çš„ä»·æ ¼æ˜¯æ—§ç‰ˆæœ¬çš„10å€ï¼Œæ–°ç‰ˆæœ¬ä¹Ÿç»ä¸å¯èƒ½æ¯”æ—§ç‰ˆæœ¬å¥½10å€ï¼\nä¸­æ–‡ç¿»è¯‘æ–°å¢ï¼š äº‹å®ä¸Šï¼Œæ¯”èµ·ç¾å›½ï¼Œåœ¨å›½å†…è´­ä¹°æŠ€æœ¯ä¹¦ç±å¯ä»¥è¯´æ˜¯ç›¸å½“â€œå»‰ä»·â€äº†ã€‚å¦‚æœä»æ—§å¯»æ±‚æ›´åŠ ä¾¿å®œçš„è´­ä¹°æ¸ é“ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡V2EXä¸Šçš„è®¨è®ºå¸–å­ï¼Œå…¶ä¸­æåˆ°äº†ä¸€äº›ä¸é”™çš„è´­ä¹°æ¸ é“ã€‚\nè¿™ä»½æŒ‡å¼•æ˜¯è°å†™çš„? è¿™ä»½æŒ‡å¼•ç”±Bradfield School of Computer Scienceï¼ˆæ—§é‡‘å±±ï¼‰çš„ä¸¤ä½æ•™å‘˜ï¼šOzan Onayå’ŒMyles Byrneç¼–å†™ï¼Œå¹¶ç”± Oz äº 2020 å¹´æ›´æ–°ã€‚è¿™ä»½æŒ‡å¼•åŸºäºæˆ‘ä»¬å¯¹æ•°åƒåè‡ªå­¦æˆæ‰çš„å·¥ç¨‹å¸ˆå’ŒåŸ¹è®­ç­å­¦ç”Ÿæ•™æˆè®¡ç®—æœºç§‘å­¦åŸºç¡€çš„ç»éªŒã€‚æ„Ÿè°¢æˆ‘ä»¬æ‰€æœ‰å­¦ç”Ÿå¯¹è‡ªå­¦èµ„æºçš„æŒç»­åé¦ˆã€‚\nåªè¦æœ‰è¶³å¤Ÿçš„æ—¶é—´å’ŒåŠ¨åŠ›ï¼Œæˆ‘ä»¬éå¸¸æœ‰ä¿¡å¿ƒï¼Œä½ å¯ä»¥è‡ªå­¦å®Œä»¥ä¸Šæ‰€æœ‰è¯¾ç¨‹ã€‚å¦‚æœä½ å–œæ¬¢ä¸€ä¸ªé›†ä¸­å¼ã€ç»“æ„åŒ–ã€ç”±æ•™å¸ˆæŒ‡å¯¼çš„è¯¾ç¨‹ï¼Œä½ å¯èƒ½å¯¹æˆ‘ä»¬çš„è®¡ç®—æœºç§‘å­¦å¼ºåŒ–ç­æ„Ÿå…´è¶£ã€‚æˆ‘ä»¬ä¸å»ºè®®ä½ å»æ”»è¯»ç¡•å£«å­¦ä½ã€‚\nè¿™ä»½æŒ‡å¼•æ˜¯è°ç¿»è¯‘çš„ï¼Ÿ è¿™ä»½æŒ‡å¼•çš„ä¸­æ–‡ç¿»è¯‘æ˜¯ç¤¾åŒºå…±åŒè´¡çŒ®çš„æˆæœï¼Œæˆ‘ä»¬æ¬¢è¿ä»»ä½•åé¦ˆå’Œæ”¹è¿›ï¼\n","description":"","tags":["methodology"],"title":"è®¡ç®—æœºç§‘å­¦è‡ªå­¦æŒ‡å—","uri":"/blog/posts/computer-science-selfstudy-guide/"},{"categories":null,"content":"ä½¿ç”¨Graphvizåˆ›å»ºå›¾è¡¨ è½¬è½½è‡ªï¼šhttps://ncona.com/2020/06/create-diagrams-with-code-using-graphviz/\næ‚¨æ˜¯å¦æ›¾ä¸ºç»˜åˆ¶è¿‡æ¶æ„å›¾æ—¶é‡å¤çš„å•å‡»å’Œæ‹–åŠ¨è€Œæ„Ÿåˆ°ä¹å‘³ï¼Ÿ\næ‚¨æ˜¯å¦éœ€è¦å¯¹è¯¥å›¾è¿›è¡Œä¿®æ”¹å‘ç°æ”¹åŠ¨å´å¾ˆå¤æ‚ï¼Ÿ\nGraphviz æ˜¯ä¸€ä¸ªå¼€æºçš„å›¾å½¢å¯è§†åŒ–è½¯ä»¶ï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä»£ç æè¿°å›¾è¡¨ï¼Œå¹¶ä¸ºæˆ‘ä»¬è‡ªåŠ¨ç»˜åˆ¶ã€‚å¦‚æœå°†æ¥éœ€è¦ä¿®æ”¹è¯¥å›¾ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹æè¿°ä»£ç ï¼ŒèŠ‚ç‚¹å’Œè¾¹å°†è‡ªåŠ¨ä¸ºæˆ‘ä»¬é‡æ–°å®šä½ã€‚\nç»˜åˆ¶å›¾å½¢ åœ¨å¼€å§‹ç¼–å†™å›¾å½¢ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å­¦ä¹ å¦‚ä½•å°†ä»£ç è½¬æ¢ä¸ºå›¾åƒï¼Œä»¥ä¾¿å¯ä»¥æµ‹è¯•æ­£åœ¨åšçš„äº‹æƒ…ã€‚\nWebgraphviz.com å¯ç”¨äºä»æµè§ˆå™¨ç»˜åˆ¶å›¾å½¢ã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨ apt åœ¨ Ubuntu ä¸­å®‰è£…å‘½ä»¤è¡Œå·¥å…·ï¼š\n1 1 sudo apt install graphviz åœ¨ macOS ç¯å¢ƒ ä½¿ç”¨ brew å®‰è£…\n1 brew install graphviz\té™¤å…¶ä»–å¤–ï¼Œè¿™å°†å®‰è£… dot CLIï¼Œè¯¥CLIå¯ç”¨äºä»æ–‡æœ¬æ–‡ä»¶ç”Ÿæˆå›¾åƒï¼š\n1 1 dot -Tpng input.gv -o output.png åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°† png æŒ‡å®šä¸ºoutputï¼ˆ-Tpngï¼‰ï¼Œä½†æ˜¯æœ‰è®¸å¤šå¯ç”¨çš„é€‰é¡¹ã€‚å¦‚æˆ‘ä»¬æ‰€è§ï¼Œè¾“å…¥æ–‡ä»¶é€šå¸¸ä½¿ç”¨gvæ‰©å±•åã€‚\nDOT DOTæ˜¯ç”¨äºæè¿°è¦ç”±Graphvizè§£æçš„å›¾å½¢çš„æœ€å¸¸è§æ ¼å¼ã€‚\nåŸºæœ¬ ä¸€ä¸ªç®€å•çš„å›¾å½¢å…·æœ‰ä»¥ä¸‹å½¢å¼ï¼š\ngraph MyGraph { begin -- end } å¦‚æœè¦ä½¿ç”¨æœ‰å‘å›¾ï¼ˆå¸¦ç®­å¤´ï¼‰ï¼Œåˆ™éœ€è¦ä½¿ç”¨digraphï¼š\ndigraph MyGraph { begin -\u003e end } ç®­å¤´å¯ä»¥å•å‘æˆ–åŒå‘ï¼š\ndigraph MyGraph { a -\u003e b a -\u003e c [dir=both] } å½¢çŠ¶ å¦‚æœæˆ‘ä»¬ä¸å–œæ¬¢æ¤­åœ†å½¢ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–å½¢çŠ¶ï¼š\ndigraph MyGraph { a [shape=box] b [shape=polygon,sides=6] c [shape=triangle] d [shape=invtriangle] e [shape=polygon,sides=4,skew=.5] f [shape=polygon,sides=4,distortion=.5] g [shape=diamond] h [shape=Mdiamond] i [shape=Msquare] a -\u003e b a -\u003e c a -\u003e d a -\u003e e a -\u003e f a -\u003e g a -\u003e h a -\u003e i } å¯ä»¥åœ¨å…¶æ–‡æ¡£çš„â€œ èŠ‚ç‚¹å½¢çŠ¶â€éƒ¨åˆ†ä¸­æ‰¾åˆ°ä¸åŒçš„å—æ”¯æŒå½¢çŠ¶ã€‚\næˆ‘ä»¬è¿˜å¯ä»¥å‘èŠ‚ç‚¹æ·»åŠ ä¸€äº›é¢œè‰²å’Œæ ·å¼ï¼š\ndigraph MyGraph { a [style=filled,color=green] b [peripheries=4,color=blue] c [fontcolor=crimson] d [style=filled,fillcolor=dodgerblue,color=coral4,penwidth=3] e [style=dotted] f [style=dashed] g [style=diagonals] h [style=filled,color=\"#333399\"] i [style=filled,color=\"#ff000055\"] j [shape=box,style=striped,fillcolor=\"red:green:blue\"] k [style=wedged,fillcolor=\"green:white:red\"] a -\u003e b a -\u003e c a -\u003e d a -\u003e e b -\u003e f b -\u003e g b -\u003e h b -\u003e i d -\u003e j j -\u003e k } å¯ä»¥åœ¨ é¢œè‰²åç§°æ–‡æ¡£ ä¸­æ‰¾åˆ°ä¸åŒçš„ é¢œè‰²åç§°ã€‚\nç®­å¤´ ç®­å¤´çš„å°¾å·´å’Œå¤´éƒ¨ä¹Ÿå¯ä»¥ä¿®æ”¹ï¼š\ndigraph MyGraph { a -\u003e b [dir=both,arrowhead=open,arrowtail=inv] a -\u003e c [dir=both,arrowhead=dot,arrowtail=invdot] a -\u003e d [dir=both,arrowhead=odot,arrowtail=invodot] a -\u003e e [dir=both,arrowhead=tee,arrowtail=empty] a -\u003e f [dir=both,arrowhead=halfopen,arrowtail=crow] a -\u003e g [dir=both,arrowhead=diamond,arrowtail=box] } å¯ä»¥åœ¨ç®­å¤´å½¢çŠ¶æ–‡æ¡£ä¸­æ‰¾åˆ°ä¸åŒçš„ç®­å¤´ç±»å‹ã€‚\nä»¥åŠå‘ç®­å¤´çº¿æ·»åŠ æ ·å¼ï¼š\ndigraph MyGraph { a -\u003e b [color=\"black:red:blue\"] a -\u003e c [color=\"black:red;0.5:blue\"] a -\u003e d [dir=none,color=\"green:red:blue\"] a -\u003e e [dir=none,color=\"green:red;.3:blue\"] a -\u003e f [dir=none,color=\"orange\"] d -\u003e g [arrowsize=2.5] d -\u003e h [style=dashed] d -\u003e i [style=dotted] d -\u003e j [penwidth=5] } å¦‚æœæˆ‘ä»¬æ³¨æ„ä¸Šé¢çš„ä»£ç å’Œå›¾è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ä¸ºç®­å¤´æŒ‡å®šå¤šç§é¢œè‰²æ—¶ï¼Œå¦‚æœä¸æŒ‡å®šä»»ä½•æƒé‡ï¼Œæ¯ç§é¢œè‰²å°†åªæœ‰ä¸€è¡Œã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªå¸¦æœ‰å¤šç§é¢œè‰²çš„ç®­å¤´ï¼Œåˆ™è‡³å°‘ä¸€ç§é¢œè‰²å¿…é¡»æŒ‡å®šè¦è¦†ç›–çš„çº¿æ¡çš„é‡é‡ç™¾åˆ†æ¯”ï¼š\n1 a -\u003e e [dir=none,color=\"green:red;.3:blue\"] æ ‡ç­¾ æˆ‘ä»¬å¯ä»¥å‘èŠ‚ç‚¹æ·»åŠ æ ‡ç­¾ï¼š\ndigraph MyGraph { begin [label=\"This is the beginning\"] end [label=\"It ends here\"] begin -\u003e end } ä»¥åŠé¡¶ç‚¹ï¼š\ndigraph MyGraph { begin end begin -\u003e end [label=\"Beginning to end\"] } æˆ‘ä»¬å¯ä»¥è®¾ç½®æ ‡ç­¾æ ·å¼ï¼š\ndigraph MyGraph { begin [label=\"This is the beginning\",fontcolor=green,fontsize=10] end [label=\"It ends here\",fontcolor=red,fontsize=10] begin -\u003e end [label=\"Beginning to end\",fontcolor=gray,fontsize=16] } é›†ç¾¤ èšç±»ä¹Ÿç§°ä¸ºå­å›¾ã€‚é›†ç¾¤çš„åç§°å¿…é¡»ä»¥å¼€å¤´cluster_ï¼Œå¦åˆ™å°†ä¸ä¼šåŒ…å«åœ¨æ¡†ä¸­ã€‚\ndigraph MyGraph { subgraph cluster_a { b c -\u003e d } a -\u003e b d -\u003e e } é›†ç¾¤å¯ä»¥æ ¹æ®éœ€è¦åµŒå¥—ï¼š\ndigraph MyGraph { subgraph cluster_a { subgraph cluster_b { subgraph cluster_c { d } c -\u003e d } b -\u003e c } a -\u003e b d -\u003e e } HTML HTMLä½¿æˆ‘ä»¬å¯ä»¥åˆ›å»ºæ›´å¤æ‚çš„èŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹å¯ä»¥åˆ†ä¸ºå¤šä¸ªéƒ¨åˆ†ã€‚å¯ä»¥åœ¨å›¾ä¸­ç‹¬ç«‹åœ°å¼•ç”¨æ¯ä¸ªéƒ¨åˆ†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 digraph MyGraph { a [shape=plaintext,label=\u003c \u003ctable\u003e \u003ctr\u003e \u003ctd\u003eHello\u003c/td\u003e \u003ctd\u003eworld!\u003c/td\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd colspan=\"2\" port=\"a1\"\u003eare you ok?\u003c/td\u003e \u003c/tr\u003e \u003c/table\u003e \u003e] b [shape=plaintext,label=\u003c \u003ctable border=\"0\" cellborder=\"1\" cellspacing=\"0\"\u003e \u003ctr\u003e \u003ctd rowspan=\"3\"\u003eleft\u003c/td\u003e \u003ctd\u003etop\u003c/td\u003e \u003ctd rowspan=\"3\" port=\"b2\"\u003eright\u003c/td\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd port=\"b1\"\u003ecenter\u003c/td\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd\u003ebottom\u003c/td\u003e \u003c/tr\u003e \u003c/table\u003e \u003e] a:a1 -\u003e b:b1 a:a1 -\u003e b:b2 } åªæœ‰HTMLçš„ä¸€ä¸ªå­é›†å¯ç”¨äºåˆ›å»ºèŠ‚ç‚¹ï¼Œå¹¶ä¸”è§„åˆ™éå¸¸ä¸¥æ ¼ã€‚ä¸ºäº†ä½¿èŠ‚ç‚¹æ­£ç¡®æ˜¾ç¤ºï¼Œæˆ‘ä»¬éœ€è¦å°†è®¾ç½®shapeä¸ºplaintextã€‚\néœ€è¦æ³¨æ„çš„å¦ä¸€ä»¶äº‹æ˜¯portå±æ€§ï¼Œå®ƒä½¿æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†’å·ï¼ˆa:a1ï¼‰æ¥å¼•ç”¨è¯¥ç‰¹å®šå•å…ƒæ ¼ã€‚\næˆ‘ä»¬å¯ä»¥è®¾ç½®HTMLèŠ‚ç‚¹çš„æ ·å¼ï¼Œä½†åªèƒ½ä½¿ç”¨HTMLçš„å­é›†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 digraph MyGraph { a [shape=plaintext,label=\u003c \u003ctable\u003e \u003ctr\u003e \u003ctd color=\"#ff0000\" bgcolor=\"#008822\"\u003e\u003cfont color=\"#55ff00\"\u003eHello\u003c/font\u003e\u003c/td\u003e \u003ctd\u003eworld!\u003c/td\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd colspan=\"2\" color=\"#00ff00\" bgcolor=\"#ff0000\"\u003e \u003cfont color=\"#ffffff\"\u003eare you ok?\u003c/font\u003e \u003c/td\u003e \u003c/tr\u003e \u003c/table\u003e \u003e] } å›¾ç‰‡ æœ‰æ—¶æˆ‘ä»¬æƒ³ä¸ºèŠ‚ç‚¹ä½¿ç”¨æŒ‡å®šå›¾æ ‡ï¼Œè¿™å¯ä»¥é€šè¿‡imageå±æ€§æ¥å®Œæˆï¼š\ndigraph MyGraph { ec2 [shape=none,label=\"\",image=\"icons/ec2.png\"] igw [shape=none,label=\"\",image=\"icons/igw.png\"] rds [shape=none,label=\"\",image=\"icons/rds.png\"] vpc [shape=none,label=\"\",image=\"icons/vpc.png\"] subgraph cluster_vpc { label=\"VPC\" subgraph cluster_public_subnet { label=\"Public Subnet\" ec2 } subgraph cluster_private_subnet { label=\"Private Subnet\" ec2 -\u003e rds } vpc igw -\u003e ec2 } users -\u003e igw } Rank ç­‰çº§æ˜¯æœ€éš¾ç†è§£çš„äº‹æƒ…ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒä»¬ä¼šæ”¹å˜æ¸²æŸ“å¼•æ“çš„å·¥ä½œæ–¹å¼ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†ä»‹ç»ä¸€äº›æˆ‘è®¤ä¸ºæœ‰ç”¨çš„åŸºæœ¬çŸ¥è¯†ã€‚\nå›¾è¡¨é€šå¸¸ä¼šä»ä¸Šåˆ°ä¸‹å‘ˆç°ï¼š\ndigraph MyGraph { a -\u003e b b -\u003e c a -\u003e d a -\u003e c } ä½¿ç”¨rankdirå±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä»å·¦åˆ°å³æ¸²æŸ“å®ƒï¼š\ndigraph MyGraph { rankdir=LR a -\u003e b b -\u003e c a -\u003e d a -\u003e c } æ’åè¿˜å¯ä»¥ç”¨äºå¼ºåˆ¶ä¸€ä¸ªèŠ‚ç‚¹ä¸å¦ä¸€ä¸ªèŠ‚ç‚¹å¤„äºåŒä¸€çº§åˆ«ï¼š\ndigraph MyGraph { rankdir=LR a -\u003e b b -\u003e c a -\u003e d a -\u003e c {rank=same;c;b} } åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ç”¨äºrank=sameå°†node cä¸node å¯¹é½bã€‚\nè¯¥rankdirå±æ€§æ˜¯å…¨å±€å±æ€§ï¼Œå› æ­¤æ— æ³•åœ¨é›†ç¾¤å†…éƒ¨æ›´æ”¹ï¼Œä½†æ˜¯ä½¿ç”¨rankæˆ‘ä»¬å¯ä»¥æ¨¡æ‹ŸLRé›†ç¾¤å†…éƒ¨çš„æ–¹å‘ï¼š\ndigraph MyGraph { subgraph cluster_A { a1 -\u003e a2 a2 -\u003e a3 {rank=same;a1;a2;a3} } subgraph cluster_B { a3 -\u003e b1 b1 -\u003e b2 b2 -\u003e b3 {rank=same;b1;b2;b3} } begin -\u003e a1 } æˆ‘ä»¬å¯ä»¥ç»“åˆrankä½¿ç”¨constraint=falseä»¥åˆ›å»ºæ›´ç´§å‡‘çš„å›¾å½¢ï¼š\ndigraph MyGraph { subgraph cluster_A { a1 a2 a3 {rank=same;a1;a2;a3} } subgraph cluster_B { b1 b2 b3 {rank=same;b1;b2;b3} } begin -\u003e a1 a1 -\u003e a2 [constraint=false] a2 -\u003e a3 [constraint=false] a3 -\u003e b1 b1 -\u003e b2 b2 -\u003e b3 } ç­‰çº§è¿˜å¯ä»¥ç”¨äºæŒ‡å®šæ¯ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»ï¼š\ndigraph MyGraph { rankdir=LR ranksep=1 a -\u003e b b -\u003e c c -\u003e d } å…¶ç¼ºçœå€¼ranksepæ˜¯.5ã€‚\næ€»ç»“ åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ Graphviz åŸºäºå£°æ˜æ€§è¯­è¨€ç”Ÿæˆå›¾ã€‚è¿™ä½¿æˆ‘åœ¨å°†æ¥æ›´å®¹æ˜“ç»˜åˆ¶æ¶æ„å›¾å¹¶å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚\næˆ‘ä»‹ç»äº†æˆ‘è®¤ä¸ºå¯¹äºæ—¥å¸¸ä½¿ç”¨æœ€é‡è¦çš„åŠŸèƒ½ï¼Œä½†æ˜¯å¦ç‡åœ°è¯´ï¼Œå¾ˆå¤šåŠŸèƒ½æˆ‘ä»è¿˜ä¸äº†è§£ã€‚\n","description":"","tags":["graph","tool"],"title":"ä½¿ç”¨Graphvizåˆ›å»ºå›¾è¡¨","uri":"/blog/posts/%E4%BD%BF%E7%94%A8Graphviz%E5%88%9B%E5%BB%BA%E5%9B%BE%E8%A1%A8/"},{"categories":null,"content":"å¦‚ä½•é…ç½®ä½ çš„ VSCode è¿™ç¯‡ä¸»è¦åˆ†äº«ä¸‹ VSCode çš„ç”¨æ³•ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å…¶å¼ºå¤§çš„æ’ä»¶æ¥æå‡æ•ˆç‡ï¼Œæˆ‘åˆ—å‡ºäº†ä¸€äº›è‡ªå·±ç”¨åˆ°çš„æ¯”è¾ƒä½¿ç”¨çš„æ’ä»¶ã€‚\nåœ¨æ‹“å±•é‡Œé¢éƒ½èƒ½çœ‹åˆ°æ’ä»¶çš„ç›¸å…³æ–‡æ¡£ï¼Œä½¿ç”¨ä¸é…ç½®ã€‚\næ¬¢è¿å¤§å®¶è¡¥å…… :)\næœ¬åœ°åŒ– Chinese (Simplified) Language Pack for Visual Studio Code\né€‚ç”¨äº VS Code çš„ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰è¯­è¨€åŒ…\nå¼€å‘ Remote Development\nAn extension pack that lets you open any folder in a container, on a remote machine, or in WSL and take advantage of VS Code's full feature set.\nå¯åœ¨è¿œç¨‹ä¸»æœºä¸Šå¼€å‘æˆ–è€…åœ¨å®¹å™¨å†…å¼€å‘\nCode Runner\nRun C, C++, Java, JS, PHP, Python, Perl, Ruby, Go, Lua, Groovy, PowerShell, CMD, BASH, F#, C#, VBScript, TypeScript, CoffeeScript, Scala, Swift, Julia, Crystal, OCaml, R, AppleScript, Elixir, VB.NET, Clojure, Haxe, Obj-C, Rust, Racket, Scheme, AutoHotkey, AutoIt, Kotlin, Dart, Pascal, Haskell, Nim,\næ”¯æŒå„ç§è¯­è¨€è¿è¡Œï¼ŒåŠ¨æ€è¯­è¨€éœ€è¦é…ç½®ä¸‹ interpreterï¼Œé™æ€è¯­è¨€é…ç½® compiler\nç¼–ç¨‹è¯­è¨€ Python\nPython extension pack\né›†æˆäº†é’ˆå¯¹ Python æ™ºèƒ½æç¤ºï¼Œè¯­æ³•æ£€æŸ¥ï¼Œæ ¼å¼åŒ–ç­‰åŠŸèƒ½\nIntelliSense: Edit your code with auto-completion, code navigation, syntax checking and more Linting: Get additional code analysis with Pylint, Flake8 and more Code formatting: Format your code with black, autopep or yapf Debugging: Debug your Python scripts, web apps, remote or multi-threaded processes Testing: Run and debug tests through the Test Explorer with unittest, pytest or nose Jupyter Notebooks: Create and edit Jupyter Notebooks, add and run code cells, render plots, visualize variables through the variable explorer, visualize dataframes with the data viewer, and more Environments: Automatically activate and switch between virtualenv, venv, pipenv, conda and pyenv environments Refactoring: Restructure your Python code with variable extraction, method extraction and import sorting XML\nXML Language Support by Red Hat\nRedhat å‡ºå“ï¼Œå¿…å±ç²¾å“ã€‚\nSyntax error reporting General code completion Auto-close tags Automatic node indentation Symbol highlighting Document folding Document links Document symbols and outline Renaming support Document Formatting DTD validation DTD completion DTD formatting XSD validation XSD based hover XSD based code completion XSL support XML catalogs File associations Code actions Schema Caching YAML\nYAML Language Support by Red Hat, with built-in Kubernetes and Kedge syntax support\nRedhat å‡ºå“ï¼Œå¿…å±ç²¾å“ã€‚\nYAML validation: Detects whether the entire file is valid yaml Detects errors such as: Node is not found Node has an invalid key node type Node has an invalid type Node is not a valid child node Document Outlining (Ctrl + Shift + O): Provides the document outlining of all completed nodes in the file Auto completion (Ctrl + Space): Auto completes on all commands Scalar nodes autocomplete to schema's defaults if they exist Hover support: Hovering over a node shows description if provided by schema Formatter: Allows for formatting the current file Markdown All in One\nAll you need to write Markdown (keyboard shortcuts, table of contents, auto preview and more)\næä¾›äº†è¯­æ³•æç¤ºï¼Œæ”¯æŒ Latexï¼Œæ ¼å¼åŒ–æ”¯æŒï¼Œé¢„è§ˆç­‰ä¸€æ¡é¾™æœåŠ¡ã€‚\næ ¼å¼ Auto Rename Tag\nAuto rename paired HTML/XML tag\nAuto Complete Tag\nExtension Packs to add close tag and rename paired tag automatically for HTML/XML\nAuto Close Tag\nAutomatically add HTML/XML close tag, same as Visual Studio IDE or Sublime Text\nBracket Pair Colorizer\nA customizable extension for colorizing matching brackets\nBetter Comments\nImprove your code commenting by annotating with alert, informational, TODOs, and more!\nå¯è§†åŒ– Excel Viewer\nView Excel spreadsheets and CSV files within Visual Studio Code workspaces.\nDraw.io Integration\nThis extension integrates Draw.io into VS Code.\nCI/CD JenkinsFile Support\nExtension provides basic jenkinsfile support (highlighting, snippets and completion)\nJenkins Jack\nJack into your remote Jenkins to execute Pipeline scripts, provide Pipeline step auto-completions, pull Shared Library step documenation, run console groovy scripts across multiple nodes, and more! Honestly, not that much more.\n","description":"","tags":["vscode"],"title":"å¦‚ä½•é…ç½®ä½ çš„ VSCode","uri":"/blog/posts/how-to-configure-your-vscode/"},{"categories":["Python"],"content":" è½¬è½½æ¥æºï¼šhttps://linuxops.org/blog/python/prettytable.html\nä¸€ã€å‰è¨€ æœ€è¿‘åœ¨ç”¨pythonå†™ä¸€ä¸ªå°å·¥å…·ï¼Œè¿™ä¸ªå·¥å…·ä¸»è¦å°±æ˜¯ç”¨æ¥ç®¡ç†å„ç§èµ„æºçš„ä¿¡æ¯ï¼Œæ¯”å¦‚é˜¿é‡Œäº‘çš„ECSç­‰ä¿¡æ¯ï¼Œå› ä¸ºæˆ‘å·¥ä½œçš„ç”µè„‘ä½¿ç”¨çš„æ˜¯LINUXï¼Œæ‰€ä»¥å°±æƒ³ç€ç”¨pythonå†™ä¸€ä¸ªå‘½ä»¤è¡Œçš„ç®¡ç†å·¥å…·ï¼ŒåŸºæœ¬çš„åŠŸèƒ½å°±æ˜¯åŒæ­¥é˜¿é‡Œäº‘çš„èµ„æºçš„ä¿¡æ¯åˆ°æ•°æ®åº“ï¼Œç„¶åå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡ŒæŸ¥è¯¢ã€‚\nå› ä¸ºä¿¡æ¯æ˜¯å±•ç°åœ¨å‘½ä»¤è¡Œä¸­çš„ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œå‘½ä»¤è¡Œå±•ç°å¤æ‚çš„æ–‡æœ¬çœ‹èµ·æ¥ç€å®ç´¯äººï¼Œäºæ˜¯å°±æƒ³ç€èƒ½åƒè¡¨æ ¼é‚£æ ·å±•ç¤ºï¼Œé‚£çœ‹èµ·æ¥å°±èˆ’æœå¤šäº†ã€‚\nprettytableåº“å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªå·¥å…·ï¼Œprettytableå¯ä»¥æ‰“å°å‡ºç¾è§‚çš„è¡¨æ ¼ï¼Œå¹¶ä¸”å¯¹ä¸­æ–‡æ”¯æŒç›¸å½“å¥½ï¼ˆå¦‚æœæœ‰è¯•å›¾è‡ªå·±å®ç°æ‰“å°è¡¨æ ¼ï¼Œä½ å°±åº”è¯¥çŸ¥é“å¤„ç†ä¸­æ–‡æ˜¯å¤šä¹ˆçš„éº»çƒ¦ï¼‰\nè¯´æ˜ï¼šæœ¬æ–‡ä½¿ç”¨Markdownè¯­æ³•ç¼–å†™ï¼Œä¸ºäº†å±•ç¤ºæ–¹ä¾¿ï¼Œä»¥åŠå¤åˆ¶æ–¹ä¾¿ï¼Œæ‰€ä»¥æœ¬æ–‡ä¸­æ²¡æœ‰ä½¿ç”¨æˆªå›¾ï¼Œå› ä¸ºæ ¼å¼æ§åˆ¶çš„é—®é¢˜ï¼Œæ–‡ç« ä¸­çš„è¿è¡Œç»“æœä¼šå‡ºç°ä¸€äº›åˆ†å‰²çº¿çš„åç§»ï¼Œåœ¨ç»ˆç«¯ä¸­å‘ˆç°å¹¶æ­¤é—®é¢˜ï¼Œè¯·å„ä½æ‰‹åŠ¨å»æ“ä½œéªŒè¯ã€‚\näºŒã€å®‰è£… prettytableå¹¶épythonçš„å†…ç½®åº“ï¼Œé€šè¿‡ pip install prettytableå³å¯å®‰è£…ã€‚\nä¸‰ã€ä¸€ä¸ªå°ç¤ºä¾‹ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #!/usr/bin/python #**coding:utf-8** import sys from prettytable import PrettyTable reload(sys) sys.setdefaultencoding('utf8') table = PrettyTable(['ç¼–å·','äº‘ç¼–å·','åç§°','IPåœ°å€']) table.add_row(['1','server01','æœåŠ¡å™¨01','172.16.0.1']) table.add_row(['2','server02','æœåŠ¡å™¨02','172.16.0.2']) table.add_row(['3','server03','æœåŠ¡å™¨03','172.16.0.3']) table.add_row(['4','server04','æœåŠ¡å™¨04','172.16.0.4']) table.add_row(['5','server05','æœåŠ¡å™¨05','172.16.0.5']) table.add_row(['6','server06','æœåŠ¡å™¨06','172.16.0.6']) table.add_row(['7','server07','æœåŠ¡å™¨07','172.16.0.7']) table.add_row(['8','server08','æœåŠ¡å™¨08','172.16.0.8']) table.add_row(['9','server09','æœåŠ¡å™¨09','172.16.0.9']) print(table) ä»¥ä¸Šç¤ºä¾‹è¿è¡Œç»“æœå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 linuxops@deepin:~$ python p.py +------+----------+----------+------------+ | ç¼–å· | äº‘ç¼–å· | åç§° | IPåœ°å€ | +------+----------+----------+------------+ | 1 | server01 | æœåŠ¡å™¨01 | 172.16.0.1 | | 2 | server02 | æœåŠ¡å™¨02 | 172.16.0.2 | | 3 | server03 | æœåŠ¡å™¨03 | 172.16.0.3 | | 4 | server04 | æœåŠ¡å™¨04 | 172.16.0.4 | | 5 | server05 | æœåŠ¡å™¨05 | 172.16.0.5 | | 6 | server06 | æœåŠ¡å™¨06 | 172.16.0.6 | | 7 | server07 | æœåŠ¡å™¨07 | 172.16.0.7 | | 8 | server08 | æœåŠ¡å™¨08 | 172.16.0.8 | | 9 | server09 | æœåŠ¡å™¨09 | 172.16.0.9 | +------+----------+----------+------------+ åœ¨ä»¥ä¸Šçš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡formå¯¼å…¥äº†è¡¨æ ¼åº“ã€‚ tableå®ä¾‹åŒ–äº†ä¸€ä¸ªè¡¨æ ¼åº“ï¼Œå¹¶ä¸”æ·»åŠ äº†['ç¼–å·','äº‘ç¼–å·','åç§°','IPåœ°å€']ä¸ºè¡¨å¤´ï¼Œå¦‚æœæ²¡æœ‰æ·»åŠ è¡¨å¤´ï¼Œé‚£ä¹ˆä¼šä»¥é»˜è®¤çš„Field+ç¼–å·æ˜¾ç¤ºï¼Œä¾‹å¦‚ï¼š\n1 2 3 +---------+----------+----------+------------+ | Field 1 | Field 2 | Field 3 | Field 4 | +---------+----------+----------+------------+ æ‰€ä»¥ä¸ºæ›´ç›´è§‚çœ‹å‡ºæ¯ä¸€åˆ—çš„æ„ä¹‰ï¼Œè¿˜æ˜¯è¦æ·»åŠ è¡¨å¤´çš„ã€‚\nå››ã€æ·»åŠ æ•°æ® prettytableæä¾›äº†å¤šç§çš„æ·»åŠ æ•°æ®çš„æ–¹å¼ï¼Œæœ€å¸¸ç”¨çš„åº”è¯¥å°±æ˜¯æŒ‰è¡ŒæŒ‰åˆ—æ·»åŠ æ•°æ®äº†ã€‚\nAã€æŒ‰è¡Œæ·»åŠ æ•°æ® table.add_row åœ¨ä¸Šé¢ç®€å•çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°±æ˜¯æŒ‰è¡Œæ·»åŠ æ•°æ®çš„ã€‚\næ·»åŠ çš„æ•°æ®å¿…é¡»è¦æ˜¯åˆ—è¡¨çš„å½¢å¼ï¼Œè€Œä¸”æ•°æ®çš„åˆ—è¡¨é•¿åº¦è¦å’Œè¡¨å¤´çš„é•¿åº¦ä¸€æ ·ã€‚åœ¨å®é™…çš„ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥è¦å…³æ³¨åˆ°æ·»åŠ çš„æ•°æ®æ˜¯å¦å’Œè¡¨å¤´å¯¹åº”ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚\nBã€æŒ‰åˆ—æ·»åŠ æ•°æ® table.add_column() çœ‹ä¸‹é¢çš„ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 #!/usr/bin/python #**coding:utf-8** import sys from prettytable import PrettyTable reload(sys) sys.setdefaultencoding('utf8') table = PrettyTable() table.add_column('é¡¹ç›®', ['ç¼–å·','äº‘ç¼–å·','åç§°','IPåœ°å€']) table.add_column('å€¼', ['1','server01','æœåŠ¡å™¨01','172.16.0.1']) print(table) è¿è¡Œç»“æœå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 +-------+--------+------------+ | index | é¡¹ç›® | å€¼ | +-------+--------+------------+ | 1 | ç¼–å· | 1 | | 2 | äº‘ç¼–å· | server01 | | 3 | åç§° | æœåŠ¡å™¨01 | | 4 | IPåœ°å€ | 172.16.0.1 | +-------+--------+------------+ ä»¥ä¸Šç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡add_columnæ¥æŒ‰åˆ—æ·»åŠ æ•°æ®ï¼ŒæŒ‰åˆ—æ·»åŠ æ•°æ®ä¸éœ€è¦åœ¨å®ä¾‹åŒ–è¡¨æ ¼çš„æ—¶å€™åˆ¶å®šè¡¨å¤´ï¼Œå®ƒçš„è¡¨å¤´æ˜¯åœ¨æ·»åŠ åˆ—çš„æ—¶å€™æŒ‡å®šçš„ã€‚\ntable.add_column('é¡¹ç›®', ['ç¼–å·','äº‘ç¼–å·','åç§°','IPåœ°å€']) è¿™ä¸€è¡Œä»£ç ä¸ºä¾‹ï¼Œé¡¹ç›®æŒ‡å®šäº†è¿™ä¸ªåˆ—çš„è¡¨å¤´åä¸º\"é¡¹ç›®\"ï¼Œ['ç¼–å·','äº‘ç¼–å·','åç§°','IPåœ°å€']ä¸ºåˆ—çš„å€¼ï¼ŒåŒæ ·ä¸ºåˆ—è¡¨ã€‚\nCã€ä»csvæ–‡ä»¶æ·»åŠ æ•°æ® PrettyTableä¸ä»…æä¾›äº†æ‰‹åŠ¨æŒ‰è¡ŒæŒ‰åˆ—æ·»åŠ æ•°æ®ï¼Œä¹Ÿæ”¯æŒç›´æ¥ä»csvæ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 #!/usr/bin/python #**coding:utf-8** import sys from prettytable import PrettyTable from prettytable import from_csv reload(sys) sys.setdefaultencoding('utf8') table = PrettyTable() fp = open(\"res.csv\", \"r\") table = from_csv(fp) print(table) fp.close() å¦‚æœè¦è¯»å–cvsæ–‡ä»¶æ•°æ®ï¼Œå¿…é¡»è¦å…ˆå¯¼å…¥from_csvï¼Œå¦åˆ™æ— æ³•è¿è¡Œã€‚ä¸Šé¢çš„ç¤ºä¾‹è¿è¡Œç»“æœå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 +------+----------+----------+------------+ | ç¼–å· | äº‘ç¼–å· | åç§° | IPåœ°å€ | +------+----------+----------+------------+ | 1 | server01 | æœåŠ¡å™¨01 | 172.16.0.1 | | 2 | server02 | æœåŠ¡å™¨02 | 172.16.0.2 | | 3 | server03 | æœåŠ¡å™¨03 | 172.16.0.3 | | 4 | server04 | æœåŠ¡å™¨04 | 172.16.0.4 | | 5 | server05 | æœåŠ¡å™¨05 | 172.16.0.5 | | 6 | server06 | æœåŠ¡å™¨06 | 172.16.0.6 | | 7 | server07 | æœåŠ¡å™¨07 | 172.16.0.7 | | 8 | server08 | æœåŠ¡å™¨08 | 172.16.0.8 | | 9 | server09 | æœåŠ¡å™¨09 | 172.16.0.9 | +------+----------+----------+------------+ csvæ–‡ä»¶ä¸èƒ½é€šè¿‡xlsç›´æ¥é‡å‘½åå¾—åˆ°ï¼Œä¼šæŠ¥é”™ã€‚å¦‚æœæ˜¯xlsæ–‡ä»¶ï¼Œè¯·ç”¨å¦å­˜ä¸ºcsvè·å¾—csvæ–‡ä»¶\nDã€ä»sqlæŸ¥è¯¢å€¼æ·»åŠ  ä»æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¯ä»¥ç›´æ¥å¯¼å…¥åˆ°è¡¨æ ¼æ‰“å°ï¼Œä¸‹é¢çš„ä¾‹å­ä½¿ç”¨äº†sqlite3,å¦‚æœä½¿ç”¨çš„æ˜¯mysqlä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œåªè¦èƒ½æŸ¥è¯¢åˆ°æ•°æ®å°±èƒ½å¯¼å…¥åˆ°è¡¨æ ¼ä¸­\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 #!/usr/bin/python #**coding:utf-8** import sys from prettytable import PrettyTable from prettytable import from_db_cursor import sqlite3 reload(sys) sys.setdefaultencoding('utf8') conn = sqlite3.connect(\"/tmp/aliyun.db\") cur = conn.cursor() cur.execute(\"SELECT * FROM res\") table = from_db_cursor(cur) print(table) è¿è¡Œç»“æœå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 +------+----------+----------+------------+ | ç¼–å· | äº‘ç¼–å· | åç§° | IPåœ°å€ | +------+----------+----------+------------+ | 1 | server01 | æœåŠ¡å™¨01 | 172.16.0.1 | | 2 | server02 | æœåŠ¡å™¨02 | 172.16.0.2 | | 3 | server03 | æœåŠ¡å™¨03 | 172.16.0.3 | | 4 | server04 | æœåŠ¡å™¨04 | 172.16.0.4 | | 5 | server05 | æœåŠ¡å™¨05 | 172.16.0.5 | | 6 | server06 | æœåŠ¡å™¨06 | 172.16.0.6 | | 7 | server07 | æœåŠ¡å™¨07 | 172.16.0.7 | | 8 | server08 | æœåŠ¡å™¨08 | 172.16.0.8 | | 9 | server09 | æœåŠ¡å™¨09 | 172.16.0.9 | +------+----------+----------+------------+ Eã€ä»HTMLå¯¼å…¥æ•°æ® æ”¯æŒä»htmlçš„è¡¨æ ¼ä¸­å¯¼å…¥ï¼Œè¯·çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 #!/usr/bin/python #**coding:utf-8** import sys from prettytable import PrettyTable from prettytable import from_html reload(sys) sys.setdefaultencoding('utf8') html_string='''\u003ctable\u003e \u003ctr\u003e \u003cth\u003eç¼–å·\u003c/th\u003e \u003cth\u003eäº‘ç¼–å·\u003c/th\u003e \u003cth\u003eåç§°\u003c/th\u003e \u003cth\u003eIPåœ°å€\u003c/th\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd\u003e1\u003c/td\u003e \u003ctd\u003eserver01\u003c/td\u003e \u003ctd\u003eæœåŠ¡å™¨01\u003c/td\u003e \u003ctd\u003e172.16.0.1\u003c/td\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd\u003e2\u003c/td\u003e \u003ctd\u003eserver02\u003c/td\u003e \u003ctd\u003eæœåŠ¡å™¨02\u003c/td\u003e \u003ctd\u003e172.16.0.2\u003c/td\u003e \u003c/tr\u003e \u003c/table\u003e''' table = from_html(html_string) print(table[0]) è¿è¡Œç»“æœå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 +------+----------+----------+------------+ | ç¼–å· | äº‘ç¼–å· | åç§° | IPåœ°å€ | +------+----------+----------+------------+ | 1 | server01 | æœåŠ¡å™¨01 | 172.16.0.1 | | 2 | server02 | æœåŠ¡å™¨02 | 172.16.0.2 | +------+----------+----------+------------+ å¦‚ä¸Šç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¼å…¥htmlçš„è¡¨æ ¼ï¼Œä½†æ˜¯ä¸ä¸€æ ·çš„åœ°æ–¹æ˜¯printè¯­å¥ï¼Œä½¿ç”¨htmlè¡¨æ ¼å¯¼å…¥æ•°æ®çš„æ—¶å€™printçš„å¿…é¡»æ˜¯åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦åˆ™æœ‰å¯èƒ½ä¼šæŠ¥[\u003cprettytable.PrettyTable object at 0x7fa87feba590\u003e]è¿™æ ·çš„é”™è¯¯ã€‚\nè¿™æ˜¯å› ä¸ºtableå¹¶ä¸æ˜¯PrettyTableå¯¹è±¡ï¼Œè€Œæ˜¯åŒ…å«å•ä¸ªPrettyTableå¯¹è±¡çš„åˆ—è¡¨ï¼Œå®ƒé€šè¿‡è§£æhtmlè€Œæ¥ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥æ‰“å°tableï¼Œè€Œéœ€è¦æ‰“å°table[0]\näº”ã€è¡¨æ ¼è¾“å‡ºæ ¼å¼ æ­£å¦‚æ”¯æŒå¤šç§è¾“å…¥ä¸€æ ·ï¼Œè¡¨æ ¼çš„è¾“å‡ºä¹Ÿæ”¯æŒå¤šç§æ ¼å¼ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢ä¸­çš„ä¾‹å­ä¸­å·²ç»ä½¿ç”¨äº†printçš„æ–¹å¼è¾“å‡ºï¼Œè¿™æ˜¯ä¸€ç§å¸¸ç”¨çš„è¾“å‡ºæ–¹å¼ã€‚\nAã€print ç›´æ¥é€šè¿‡printæ‰“å°å‡ºè¡¨æ ¼ã€‚è¿™ç§æ–¹å¼æ‰“å°å‡ºçš„è¡¨æ ¼ä¼šå¸¦è¾¹æ¡†ã€‚\nBã€è¾“å‡ºHTMLæ ¼å¼çš„è¡¨æ ¼ print(table.get_html_string())å¯ä»¥æ‰“å°å‡ºhtmlæ ‡ç­¾çš„è¡¨æ ¼ã€‚\nåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨print(table.get_html_string())ä¼šæ‰“å°å‡ºå¦‚ä¸‹ç»“æœï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 \u003ctable\u003e \u003ctr\u003e \u003cth\u003eç¼–å·\u003c/th\u003e \u003cth\u003eäº‘ç¼–å·\u003c/th\u003e \u003cth\u003eåç§°\u003c/th\u003e \u003cth\u003eIPåœ°å€\u003c/th\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd\u003e1\u003c/td\u003e \u003ctd\u003eserver01\u003c/td\u003e \u003ctd\u003eæœåŠ¡å™¨01\u003c/td\u003e \u003ctd\u003e172.16.0.1\u003c/td\u003e \u003c/tr\u003e \u003ctr\u003e \u003ctd\u003e2\u003c/td\u003e \u003ctd\u003eserver02\u003c/td\u003e \u003ctd\u003eæœåŠ¡å™¨02\u003c/td\u003e \u003ctd\u003e172.16.0.2\u003c/td\u003e \u003c/tr\u003e \u003c/table\u003e å…­ã€é€‰æ‹©æ€§è¾“å‡º prettytableåœ¨åˆ›å»ºè¡¨æ ¼ä¹‹åï¼Œä½ ä¾ç„¶å¯ä»¥æœ‰é€‰æ‹©çš„è¾“å‡ºæŸäº›ç‰¹å®šçš„è¡Œ.\nAã€è¾“å‡ºæŒ‡å®šçš„åˆ— print table.get_string(fields=[\"ç¼–å·\", \"IPåœ°å€\"])å¯ä»¥è¾“å‡ºæŒ‡å®šçš„åˆ—\nBã€è¾“å‡ºå‰ä¸¤è¡Œ é€šè¿‡print(table.get_string(start = 0, end = 2))çš„å¯ä»¥æ‰“å°å‡ºæŒ‡å®šçš„åˆ—ï¼Œå½“ç„¶startå’Œendå‚æ•°è®©æˆ‘å¯ä»¥è‡ªç”±æ§åˆ¶æ˜¾ç¤ºåŒºé—´ã€‚å½“ç„¶åŒºé—´ä¸­åŒ…å«startä¸åŒ…å«endï¼Œæ˜¯ä¸æ˜¯å¾ˆç†Ÿæ‚‰è¿™æ ·çš„ç”¨æ³•ï¼Ÿ\næ ¹æ®è¾“å‡ºæŒ‡å®šè¡Œåˆ—çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶æŒ‡å®šè¡Œå’Œåˆ—æ¥è¾“å‡ºï¼Œè¿™é‡Œå°±ä¸è¯´æ˜äº†ã€‚\nCã€å°†è¡¨æ ¼åˆ‡ç‰‡ ä»ä¸Šé¢çš„è¾“å‡ºåŒºé—´ï¼Œæˆ‘ä»¬åšä¸€ä¸ªå¤§èƒ†çš„å‡è®¾ï¼Œæ—¢ç„¶åŒºé—´åŒ…å«startä¸åŒ…å«endè¿™ç§è§„åˆ™å’Œåˆ‡ç‰‡çš„ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä¸å¯é€šè¿‡åˆ‡ç‰‡æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„è¡¨æ ¼ç„¶åå°†å…¶æ‰“å°ã€‚\näº‹å®ä¸Šæ˜¯å¯ä»¥çš„ã€‚\n1 2 new_table = table[0:2] print(new_table) å¦‚ä¸Šä»£ç æ®µä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰“å°å‡º0åˆ°1è¡Œå…±2è¡Œçš„è¡¨æ ¼ï¼Œpythonçš„åˆ‡ç‰‡åŠŸèƒ½å¼‚å¸¸å¼ºå¤§ï¼Œé…åˆåˆ‡ç‰‡æˆ‘ä»¬å¯ä»¥è‡ªç”±çš„è¾“å…¥ä»»æ„çš„è¡Œã€‚\nDã€è¾“å‡ºæ’åº æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹è¾“å‡ºçš„è¡¨æ ¼è¿›è¡Œæ’åºï¼Œä½¿ç”¨print table.get_string(sortby=\"ç¼–å·\", reversesort=True)å°±å¯ä»¥å¯¹è¡¨æ ¼è¿›è¡Œæ’åºï¼Œå…¶ä¸­reversesortæŒ‡å®šäº†æ˜¯å¦å€’åºæ’åº,é»˜è®¤ä¸ºFalseï¼Œå³é»˜è®¤æ­£åºåˆ—æ’åºã€‚\nsortbyæŒ‡å®šäº†æ’åºçš„å­—æ®µã€‚\nä¸ƒã€è¡¨æ ¼çš„æ ·å¼ Aã€å†…ç½®æ ·å¼ é€šè¿‡set_style()å¯ä»¥è®¾ç½®è¡¨æ ¼æ ·å¼ï¼Œprettytableå†…ç½®äº†å¤šç§çš„æ ·å¼ä¸ªäººè§‰å¾—MSWORD_FRIENDLYï¼ŒPLAIN_COLUMNSï¼ŒDEFAULT è¿™ä¸‰ç§æ ·å¼çœ‹èµ·æ¥æ¯”è¾ƒæ¸…çˆ½ï¼Œåœ¨ç»ˆç«¯ä¸‹æ˜¾ç¤ºè¡¨æ ¼æœ¬æ¥çœ‹èµ·å°±å¾ˆç´¯ï¼Œå†åŠ ä¸Šä¸€ä¸‹èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿çœ‹èµ·æ¥å°±æ›´ç´¯ã€‚\né™¤äº†ä»¥ä¸Šæ¨èçš„ä¸‰ç§æ ·å¼ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ ·å¼ä¸å¾—ä¸è¯´ï¼Œé‚£å°±æ˜¯RANDOMï¼Œè¿™æ˜¯ä¸€ç§éšæœºçš„æ ·å¼ï¼Œæ¯ä¸€æ¬¡æ‰“å°éƒ½ä¼šåœ¨å†…ç½®çš„æ ·å¼ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªï¼Œæ¯”è¾ƒå¥½ç©ã€‚\nå…·ä½“å†…ç½®äº†å‡ ç§æ ·å¼ï¼Œè¯·å„ä½å‚è€ƒå®˜ç½‘å®Œæ•´è‡ªå·±å°è¯•è¾“å‡ºçœ‹çœ‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #!/usr/bin/python #**coding:utf-8** import sys from prettytable import PrettyTable from prettytable import MSWORD_FRIENDLY from prettytable import PLAIN_COLUMNS from prettytable import RANDOM from prettytable import DEFAULT reload(sys) sys.setdefaultencoding('utf8') table = PrettyTable(['ç¼–å·','äº‘ç¼–å·','åç§°','IPåœ°å€']) table.add_row(['1','server01','æœåŠ¡å™¨01','172.16.0.1']) table.add_row(['3','server03','æœåŠ¡å™¨03','172.16.0.3']) table.add_row(['2','server02','æœåŠ¡å™¨02','172.16.0.2']) table.add_row(['9','server09','æœåŠ¡å™¨09','172.16.0.9']) table.add_row(['4','server04','æœåŠ¡å™¨04','172.16.0.4']) table.add_row(['5','server05','æœåŠ¡å™¨05','172.16.0.5']) table.add_row(['6','server06','æœåŠ¡å™¨06','172.16.0.6']) table.add_row(['8','server08','æœåŠ¡å™¨08','172.16.0.8']) table.add_row(['7','server07','æœåŠ¡å™¨07','172.16.0.7']) table.set_style(DEFAULT) print(table) Bã€è‡ªå®šä¹‰æ ·å¼ é™¤äº†å†…ç½®çš„æ ·å¼ä»¥å¤–ï¼ŒPrettyTableä¹Ÿæä¾›äº†ç”¨æˆ·è‡ªå®šä¹‰ï¼Œä¾‹å¦‚å¯¹é½æ–¹å¼ï¼Œæ•°å­—è¾“å‡ºæ ¼å¼ï¼Œè¾¹æ¡†è¿æ¥ç¬¦ç­‰ç­‰\nCã€è®¾ç½®å¯¹é½æ–¹å¼ alignæä¾›äº†ç”¨æˆ·è®¾ç½®å¯¹é½çš„æ–¹å¼ï¼Œå€¼æœ‰lï¼Œrï¼Œcæ–¹ä¾¿ä»£è¡¨å·¦å¯¹é½ï¼Œå³å¯¹é½å’Œå±…ä¸­ å¦‚æœä¸è®¾ç½®ï¼Œé»˜è®¤å±…ä¸­å¯¹é½ã€‚\nDã€æ§åˆ¶è¾¹æ¡†æ ·å¼ åœ¨PrettyTableä¸­ï¼Œè¾¹æ¡†ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œæ¨ªè¾¹æ¡†ï¼Œç«–è¾¹æ¡†ï¼Œå’Œè¾¹æ¡†è¿æ¥ç¬¦ï¼ˆæ¨ªç«–äº¤å‰çš„é“¾æ¥ç¬¦å·ï¼‰\nå¦‚ä¸‹ç¤ºä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 #!/usr/bin/python #**coding:utf-8** import sys from prettytable import PrettyTable reload(sys) sys.setdefaultencoding('utf8') table = PrettyTable(['ç¼–å·','äº‘ç¼–å·','åç§°','IPåœ°å€']) table.add_row(['1','server01','æœåŠ¡å™¨01','172.16.0.1']) table.add_row(['3','server03','æœåŠ¡å™¨03','172.16.0.3']) table.add_row(['2','server02','æœåŠ¡å™¨02','172.16.0.2']) table.add_row(['9','server09','æœåŠ¡å™¨09','172.16.0.9']) table.add_row(['4','server04','æœåŠ¡å™¨04','172.16.0.4']) table.add_row(['5','server05','æœåŠ¡å™¨05','172.16.0.5']) table.add_row(['6','server06','æœåŠ¡å™¨06','172.16.0.6']) table.add_row(['8','server08','æœåŠ¡å™¨08','172.16.0.8']) table.add_row(['7','server07','æœåŠ¡å™¨07','172.16.0.7']) table.align[1] = 'l' table.border = True table.junction_char='$' table.horizontal_char = '+' table.vertical_char = '%' print(table) table.border`æ§åˆ¶æ˜¯å¦æ˜¾ç¤ºè¾¹æ¡†ï¼Œé»˜è®¤æ˜¯`True table.junction_charæ§åˆ¶è¾¹æ¡†è¿æ¥ç¬¦\ntable.horizontal_charæ§åˆ¶æ¨ªè¾¹æ¡†ç¬¦å·\ntable.vertical_charæ§åˆ¶ç«–è¾¹æ¡†ç¬¦å·\nä¸Šä¾‹è¿è¡Œå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 $++++++$++++++++++$++++++++++$++++++++++++$ % ç¼–å· % äº‘ç¼–å· % åç§° % IPåœ°å€ % $++++++$++++++++++$++++++++++$++++++++++++$ % 1 % server01 % æœåŠ¡å™¨01 % 172.16.0.1 % % 3 % server03 % æœåŠ¡å™¨03 % 172.16.0.3 % % 2 % server02 % æœåŠ¡å™¨02 % 172.16.0.2 % % 9 % server09 % æœåŠ¡å™¨09 % 172.16.0.9 % % 4 % server04 % æœåŠ¡å™¨04 % 172.16.0.4 % % 5 % server05 % æœåŠ¡å™¨05 % 172.16.0.5 % % 6 % server06 % æœåŠ¡å™¨06 % 172.16.0.6 % % 8 % server08 % æœåŠ¡å™¨08 % 172.16.0.8 % % 7 % server07 % æœåŠ¡å™¨07 % 172.16.0.7 % $++++++$++++++++++$++++++++++$++++++++++++$ ä»¥ä¸Šç®€å•ä»‹ç»äº†è¡¨æ ¼å¸¸ç”¨çš„ä¸€äº›æ ·å¼è®¾ç½®ï¼Œå…·ä½“çš„è¯·å‚è€ƒå®˜æ–¹ç½‘ç«™ã€‚\nhttps://github.com/jazzband/prettytable\nhttps://code.google.com/archive/p/prettytable/wikis/Tutorial.wiki\n","description":"","tags":["python","linux"],"title":"ç”¨ prettytable åœ¨ç»ˆç«¯è¾“å‡ºæ¼‚äº®çš„è¡¨æ ¼","uri":"/blog/posts/Python/use-prettytable-to-output-a-pretty-table-in-the-terminal/"},{"categories":["Python","Fluent-Python"],"content":"\næœ‰å¾ˆå¤šäººæŠ±æ€¨ï¼ŒæŠŠè¿™ä¸ªç‰¹æ€§å‘½åä¸ºâ€œè£…é¥°å™¨â€ä¸å¥½ã€‚ä¸»è¦åŸå› æ˜¯ï¼Œè¿™ä¸ªåç§°ä¸ GoF ä¹¦ä½¿ç”¨çš„ä¸ä¸€è‡´ã€‚è£…é¥°å™¨è¿™ä¸ªåç§°å¯èƒ½æ›´é€‚åˆåœ¨ç¼–è¯‘å™¨é¢†åŸŸä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¼šéå†å¹¶æ³¨è§£è¯­æ³•ä¹¦ã€‚ â€”â€œPEP 318 â€” Decorators for Functions and Methodsâ€\næœ¬ç« çš„æœ€ç»ˆç›®æ ‡æ˜¯è§£é‡Šæ¸…æ¥šå‡½æ•°è£…é¥°å™¨çš„å·¥ä½œåŸç†ï¼ŒåŒ…æ‹¬æœ€ç®€å•çš„æ³¨å†Œè£…é¥°å™¨å’Œè¾ƒå¤æ‚çš„å‚æ•°åŒ–è£…é¥°å™¨ã€‚\nè®¨è®ºå†…å®¹ï¼š\nPython å¦‚ä½•è®¡ç®—è£…é¥°å™¨è¯­æ³• Python å¦‚ä½•åˆ¤æ–­å˜é‡æ˜¯ä¸æ˜¯å±€éƒ¨çš„ é—­åŒ…å­˜åœ¨çš„åŸå› å’Œå·¥ä½œåŸç† nonlocal èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ å®ç°è¡Œä¸ºè‰¯å¥½çš„è£…é¥°å™¨ æ ‡å‡†åº“ä¸­æœ‰ç”¨çš„è£…é¥°å™¨ å®ç°ä¸€ä¸ªå‚æ•°åŒ–çš„è£…é¥°å™¨ è£…é¥°å™¨åŸºç¡€ è£…é¥°å™¨æ˜¯å¯è°ƒç”¨çš„å¯¹è±¡ï¼Œå…¶å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆè¢«è£…é¥°çš„å‡½æ•°ï¼‰ã€‚\nè£…é¥°å™¨å¯èƒ½ä¼šå¤„ç†è¢«è£…é¥°çš„å‡½æ•°ï¼Œç„¶åæŠŠå®ƒè¿”å›ï¼Œæˆ–è€…å°†å…¶æ›¿æ¢æˆå¦ä¸€ä¸ªå‡½æ•°æˆ–å¯è°ƒç”¨å¯¹è±¡ã€‚\nè£…é¥°å™¨ä¸¤å¤§ç‰¹æ€§ï¼š\nèƒ½æŠŠè¢«è£…é¥°çš„å‡½æ•°æ›¿æ¢æˆå…¶ä»–å‡½æ•° è£…é¥°å™¨åœ¨åŠ è½½æ¨¡å—æ—¶ç«‹å³æ‰§è¡Œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 # è£…é¥°å™¨é€šå¸¸ä¼šæŠŠå‡½æ•°æ›¿æ¢æˆå¦ä¸€ä¸ªå‡½æ•° def decorate(func): def wrapped(): print('Running wrapped()') return wrapped @decorate def target(): print('running target()') target() # ä»¥ä¸Šå†™æ³•ç­‰åŒäº def target(): print('running target()') target = decorate(target) target() # è¿™é‡ŒçœŸæ­£è°ƒç”¨çš„æ˜¯è£…é¥°å™¨è¿”å›çš„å‡½æ•° def deco(func): def inner(): print('running iner()') return inner @deco def target(): print('running target()') target() # target ç°åœ¨æ˜¯ inner çš„å¼•ç”¨ target Python ä½•æ—¶æ‰§è¡Œè£…é¥°å™¨ è£…é¥°å™¨åœ¨å¯¼å…¥æ—¶ï¼ˆæ¨¡å—åŠ è½½æ—¶ï¼‰ç«‹å³æ‰§è¡Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 # registration.py registry = [] def register(func): print('running register {}'.format(func)) registry.append(func) return func @register def f1(): print('running f1()') @register def f2(): print('running f2()') def f3(): print('running f3()') def main(): print('running main()') print('registry -\u003e', registry) f1() f2() f3() if __name__=='__main__': main() # python3 registration.py # output: # running register \u003cfunction f1 at 0x10b4194d0\u003e # running register \u003cfunction f2 at 0x10b419ef0\u003e # running main() # registry -\u003e [\u003cfunction f1 at 0x10b4194d0\u003e, \u003cfunction f2 at 0x10b419ef0\u003e] # running f1() # running f2() # running f3() # import registration # running register \u003cfunction f1 at 0x10d89e950\u003e # running register \u003cfunction f2 at 0x10d89e050\u003e é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œå¼ºè°ƒè£…é¥°å™¨å‡½æ•°åœ¨å¯¼å…¥æ¨¡å—å¼ç«‹å³æ‰§è¡Œï¼Œè€Œæ™®é€šå‡½æ•°åœ¨è¢«è°ƒç”¨æ—¶è¿è¡Œã€‚å¯¼å…¥æ—¶å’Œè¿è¡Œæ—¶çš„åŒºåˆ«ã€‚\nè£…é¥°å™¨å‡½æ•°é€šå¸¸ä¸è¢«è£…é¥°å‡½æ•°ä¸åœ¨åŒä¸€æ¨¡å—ã€‚ register è£…é¥°å™¨è¿”å›çš„å‡½æ•°æ²¡æœ‰å˜åŒ– ä¸Šé¢çš„è£…é¥°å™¨ä¼šåŸå°ä¸åŠ¨åœ°è¿”å›è¢«è£…é¥°çš„å‡½æ•°ï¼Œè€Œä¸ä¸€å®šä¼šå¯¹å‡½æ•°åšä¿®æ”¹ã€‚ è¿™ç§è£…é¥°å™¨å«æ³¨å†Œè£…é¥°å™¨ï¼Œé€šè¿‡ä½¿ç”¨å®ƒæ¥ä¸­å¿ƒåŒ–åœ°æ³¨å†Œå‡½æ•°ï¼Œä¾‹å¦‚æŠŠ URL æ¨¡å¼æ˜ å°„åˆ°ç”Ÿæˆ HTTP å“åº”çš„å‡½æ•°ä¸Šçš„æ³¨å†Œå¤„ã€‚\nä½¿ç”¨è£…é¥°å™¨ 1 2 3 4 5 6 7 8 9 10 promos = [] def promotion(promo_func): promos.append(promo_func) return promo_func @promotion def fidelity(order): \"\"\"ç§¯åˆ† \u003e= 1000 æä¾› 5% æŠ˜æ‰£\"\"\" return order.total() * .05 if order.customer.fidelity \u003e= 1000 else 0 å˜é‡ä½œç”¨åŸŸè§„åˆ™ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # æ¯”è¾ƒä¸¤ä¸ªä¾‹å­ b = 6 def f1(a): print(a) print(b) f1(3) def f2(a): print(a) print(b) b = 9 # b æ­¤æ—¶ä¸ºå±€éƒ¨å˜é‡ f2(3) Python å‡å®šåœ¨å‡½æ•°ä½“å†…éƒ¨çš„å˜é‡ä¸ºå±€éƒ¨å˜é‡ã€‚å¦‚æœæœªåœ¨å±€éƒ¨å˜é‡ä¸­æ‰¾åˆ°ï¼Œä¼šé€çº§å‘ä¸ŠæŸ¥æ‰¾å˜é‡ã€‚\nå¦‚æœæƒ³åœ¨å‡½æ•°ä¸­èµ‹å€¼æ—¶è®©è§£é‡Šå™¨æŠŠ b å½“åšå…¨å±€å˜é‡ï¼Œç”¨ global å…³é”®å­—\n1 2 3 4 5 6 def f3(a): global b print(a) print(b) b = 9 f3(3) é—­åŒ… é—­åŒ…å’ŒåŒ¿åå‡½æ•°å¸¸è¢«å¼„æ··ã€‚åªæœ‰æ¶‰åŠåˆ°åµŒå¥—å‡½æ•°æ—¶æ‰æœ‰é—­åŒ…é—®é¢˜ã€‚\né—­åŒ…æŒ‡å»¶ä¼¸äº†ä½œç”¨åŸŸçš„å‡½æ•°ï¼Œå…¶ä¸­åŒ…å«å‡½æ•°å®šä¹‰ä½“ä¸­çš„å¼•ç”¨ï¼Œä½†éå®šä¹‰ä½“ä¸­å®šä¹‰çš„éå…¨å±€å˜é‡ã€‚å’Œå‡½æ•°æ˜¯å¦åŒ¿åæ— å…³ã€‚å…³é”®æ˜¯èƒ½è®¿é—®å®šä¹‰ä½“ä¹‹å¤–å®šä¹‰çš„éå…¨å±€å˜é‡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 class Averager(): def __init__(self): self.series = [] def __call__(self, new_value): self.series.append(new_value) total = sum(self.series) return total/len(self.series) avg = Averager() avg(10) avg(11) avg(12) def make_averager(): series = [] # è‡ªç”±å˜é‡ def averager(new_value): series.append(new_value) total = sum(series) return total/len(series) return averager avg = make_averager() avg(10) avg(11) avg(12) avg.__code__.co_varnames avg.__code__.co_freevars avg.__closure__ avg.__closure__[0].cell_contents åœ¨ averager å‡½æ•°ä¸­ï¼Œseries æ˜¯è‡ªç”±å˜é‡ï¼ŒæŒ‡æœªåœ¨æœ¬åœ°ä½œç”¨åŸŸç»‘å®šçš„å˜é‡ã€‚\né€šè¿‡ __code__.co_freevars __closure__ æŸ¥çœ‹è‡ªç”±å˜é‡å’Œé—­åŒ…\né—­åŒ…æ˜¯ä¸€ç§å‡½æ•°ï¼Œä¿ç•™å®šä¹‰å‡½æ•°æ—¶å­˜åœ¨çš„è‡ªç”±å˜é‡çš„ç»‘å®šã€‚è°ƒç”¨å‡½æ•°æ—¶ï¼Œè™½ç„¶å®šä¹‰ä½œç”¨åŸŸä¸å¯ç”¨äº†ï¼Œä½†ä»èƒ½ä½¿ç”¨é‚£äº›ç»‘å®š\nåªæœ‰åµŒå¥—åœ¨å…¶ä»–å‡½æ•°ä¸­çš„å‡½æ•°æ‰å¯èƒ½éœ€è¦å¤„ç†ä¸åœ¨å…¨å±€ä½œç”¨åŸŸçš„å¤–éƒ¨å˜é‡\nnonlocal å£°æ˜ ä¸‹é¢ä¸€ä¸ªä¾‹å­æœ‰ç¼ºé™·ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 def make_averager(): count = 0 total = 0 def averager(new_value): count += 1 total += new_value return total / count return averager avg = make_averager() avg(10) æ³¨æ„ countï¼Œ total çš„èµ‹å€¼è¯­å¥ä½¿å®ƒä»¬æˆä¸ºå±€éƒ¨å˜é‡ï¼Œåœ¨èµ‹å€¼æ˜¯ä¼šéšå¼åˆ›å»ºå±€éƒ¨å˜é‡ï¼Œè¿™æ ·å®ƒä»¬å°±ä¸æ˜¯è‡ªç”±å˜é‡äº†ï¼Œå› æ­¤ä¸ä¼šä¿å­˜åœ¨é—­åŒ…ä¸­ã€‚\nä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒPython3 å¼•å…¥äº† nonlocal å£°æ˜ï¼Œä½œç”¨æ˜¯å§å˜é‡æ ‡è®°ä¸ºè‡ªç”±å˜é‡ï¼Œå³ä½¿åœ¨å‡½æ•°ä¸­ä¸ºå˜é‡æ–°å€¼äº†ï¼Œä¹Ÿä¼šå˜æˆè‡ªç”±å˜é‡ã€‚åœ¨é—­åŒ…ä¸­çš„ç»‘å®šä¹Ÿä¼šæ›´æ–°\nå¯¹äºæ²¡æœ‰ nonlocal çš„ Python2 PEP3104\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 def make_averager(): count = 0 total = 0 def averager(new_value): nonlocal count, total count += 1 total += new_value return total / count return averager avg = make_averager() avg(10) å®ç°ä¸€ä¸ªç®€å•çš„è£…é¥°å™¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import time def clock(func): def clocked(*args): t0 = time.perf_counter() result = func(*args) elapsed = time.perf_counter() - t0 name = func.__name__ arg_str = ', '.join(repr(arg) for arg in args) print('[%0.8fs] %s(%s) -\u003e % r' %(elapsed, name, arg_str, result)) return result return clocked @clock def snooze(seconds): time.sleep(seconds) @clock def factorial(n): return 1 if n \u003c 2 else n * factorial(n-1) if __name__=='__main__': print('*' * 40, 'Calling snooze(.123)') snooze(.123) print('*' * 40, 'Calling factorial(6)') print('6! =', factorial(6)) è£…é¥°å™¨çš„å…¸å‹è¡Œä¸ºï¼šæŠŠè¢«è£…é¥°çš„å‡½æ•°æ›¿æ¢æˆæ–°å‡½æ•°ï¼ŒäºŒè€…æ¥å—ç›¸åŒçš„å‚æ•°ï¼Œè€Œä¸”(é€šå¸¸)è¿”å›è¢«è£…è£…é¥°å‡½æ•°æœ¬è¯¥è¿”å›çš„å€¼ï¼ŒåŒæ—¶åšä¸€äº›é¢å¤–æ“ä½œ\n1 factorial.__name__ ä¸Šè¿°å®ç°çš„ clock è£…é¥°å™¨æœ‰å‡ ä¸ªç¼ºç‚¹ï¼šä¸æ”¯æŒå…³é”®å­—å‚æ•°ï¼Œè€Œä¸”é®ç›–äº†è¢«è£…é¥°å‡½æ•°çš„ __name__, __doc__ å±æ€§\nfunctools.wraps è£…é¥°å™¨æŠŠç›¸å…³å±æ€§ä» func å¤åˆ¶åˆ° clocked ä¸­ï¼Œè¿˜èƒ½æ­£ç¡®å¤„ç†å…³é”®å­—å‡½æ•°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import time import functools def clock(func): @functools.wraps(func) def clocked(*args, **kwargs): t0 = time.perf_counter() result = func(*args, **kwargs) elapsed = time.perf_counter() - t0 name = func.__name__ arg_lst = [] if args: arg_str = ', '.join(repr(arg) for arg in args) if kwargs: pairs = ['%s=%s' % (k, w) for k, w in sorted(kwargs.items())] arg_lst.append(', '.join(pairs)) arg_str = ', '.join(arg_lst) print('[%0.8fs] %s(%s) -\u003e % r' %(elapsed, name, arg_str, result)) return result return clocked if __name__=='__main__': print('*' * 40, 'Calling snooze(.123)') snooze(.123) print('*' * 40, 'Calling factorial(6)') print('6! =', factorial(6)) æ ‡å‡†åº“ä¸­çš„è£…é¥°å™¨ Python å†…ç½®çš„ä¸‰ä¸ªè£…é¥°å™¨åˆ†åˆ«ä¸º property, classmethod å’Œ staticmethod.\nä½† Python å†…ç½®çš„åº“ä¸­ï¼Œæœ‰ä¸¤ä¸ªè£…é¥°å™¨å¾ˆå¸¸ç”¨ï¼Œåˆ†åˆ«ä¸º functools.lru_cache å’Œ functools.singledispatch.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 @clock def fibonacci(n): if n \u003c 2: return n return fibonacci(n-2) + fibonacci(n-1) print(fibonacci(6)) @functools.lru_cache() # () æ˜¯å› ä¸º lru_cache å¯ä»¥æ¥å—é…ç½®å‚æ•° # functools.lru_cache(maxsize=128, typed=False) @clock # å æ”¾è£…é¥°å™¨ def fibonacci(n): if n \u003c 2: return n return fibonacci(n-2) + fibonacci(n-1) print(fibonacci(6)) å•åˆ†æ´¾åå‡½æ•° Python ä¸æ”¯æŒé‡è½½æ–¹æ³•æˆ–å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ä¸åŒçš„ç­¾åå®šä¹‰ htmlize çš„è¾©é¢˜ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨ä¸åŒçš„æ–¹å¼å¤„ç†ä¸åŒçš„æ•°æ®ç±»å‹ã€‚\nä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯æŠŠ htmlize ç¼–ç¨‹ä¸€ä¸ªåˆ†æ´¾å‡½æ•°ï¼Œä½¿ç”¨ if-elif-else åˆ†åˆ«è°ƒç”¨ä¸“é—¨çš„å‡½æ•°ã€‚ä½†è¿™æ ·ä¸ä¾¿äºæ¨¡å—çš„æ‹“å±•ï¼Œè€Œä¸”è‡ƒè‚¿\nfunctoos.singledispatch è£…é¥°å™¨å¯ä»¥æŠŠæ•´ä½“æ–¹æ¡ˆæ‹†åˆ†æˆå¤šä¸ªæ¨¡å—ï¼Œç”šè‡³å¯ä»¥ä¸ºä½ æ— æ³•ä¿®æ”¹çš„ç±»æä¾›ä¸“é—¨çš„å‡½æ•°ã€‚ ä½¿ç”¨ functoos.singledispatch è£…é¥°çš„æ™®é€šå‡½æ•°ä¼šå˜æˆåå‡½æ•°ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 # ç”Ÿæˆ HTML æ˜¾ç¤ºä¸åŒç±»å‹çš„ python å¯¹è±¡ import html def htmlize(obj): content = html.escape(repr(obj)) return '\u003cpre\u003e{}\u003c/pre\u003e'.format(content) # htmlize({1, 2, 3}) # htmlize(abs) # htmlize('hwimich \u0026 Co.\\n- a game') # htmlize(42) # print(htmlize(['alpha', 66, {3, 2, 1}])) from functools import singledispatch from collections import abc import numbers @singledispatch # æ ‡è®°å¤„ç† object ç±»å‹çš„åŸºå‡½æ•° def htmlize(obj): content = html.escape(repr(obj)) return '\u003cpre\u003e{}\u003c/pre\u003e'.format(content) @htmlize.register(str) def _(text): content = html.escape(text).replace('\\n', '\u003cbr\u003e\\n') return '\u003cp\u003e{0}\u003c/p\u003e'.format(content) @htmlize.register(numbers.Integral) # Integral æ˜¯ int çš„è™šæ‹Ÿè¶…ç±» def _(n): return '\u003cpre\u003e{0} (0x{0:x})\u003c/pre\u003e'.format(n) @htmlize.register(tuple) @htmlize.register(abc.MutableSequence) def _(seq): inner = '\u003c/li\u003e\\n\u003cli\u003e'.join(htmlize(item) for item in seq) return '\u003cul\u003e\\n\u003cli\u003e' + inner + '\u003c/li\u003e\\n\u003cul\u003e' htmlize({1, 2, 3}) htmlize(abs) htmlize('hwimich \u0026 Co.\\n- a game') htmlize(42) print(htmlize(['alpha', 66, {3, 2, 1}])) åªè¦å¯èƒ½ï¼Œæ³¨å†Œçš„ä¸“é—¨å‡½æ•°åº”è¯¥å¤„ç†æŠ½è±¡åŸºç±»(numbers.Integral, abc.MutableSequence)ï¼Œ ä¸è¦å¤„ç†å…·ä½“å®ç°ï¼ˆintï¼Œlistï¼‰\nè¿™æ ·ä»£ç æ”¯æŒçš„å…¼å®¹ç±»å‹æ›´å¹¿æ³›ã€‚\nä½¿ç”¨ singledispatch å¯ä»¥åœ¨ç³»ç»Ÿçš„ä»»ä½•åœ°æ–¹å’Œä»»ä½•æ¨¡å—æ³¨å†Œä¸“é—¨å‡½æ•°ã€‚\nå æ”¾è£…é¥°å™¨ 1 2 3 4 5 6 7 @d1 @d2 def func(): pass # ç­‰åŒäº func = d1(d2(func)) å‚æ•°åŒ–è£…é¥°å™¨ ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œå¯ä»¥æŠŠå‚æ•°åŒ–è£…é¥°å™¨çœ‹æˆä¸€ä¸ªå‡½æ•°ï¼šè¿™ä¸ªå‡½æ•°æ¥å—ä»»æ„å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªè£…é¥°å™¨ï¼ˆå‚æ•°ä¸º func çš„å¦ä¸€ä¸ªå‡½æ•°ï¼‰ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 # å‚æ•°åŒ–çš„æ³¨å†Œè£…é¥°å™¨ registry = set() # è¿™æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œç”¨æ¥æ„å»ºè£…é¥°å™¨å‡½æ•° def register(active=True): # decorate æ˜¯çœŸæ­£çš„è£…é¥°å™¨ def decorate(func): print('running register(active=%s)-\u003edecorate(%s)' % (active, func)) if active: registry.add(func) else: registry.discard(func) return func return decorate @register(active=False) def f1(): print('running f1()') @register() def f2(): print('running f2()') def f3(): print('running f3()') f1() f2() f3() register()(f3) registry register(active=False)(f2) å‚æ•°åŒ– clock è£…é¥°å™¨ ä¸º clock è£…é¥°å™¨æ·»åŠ ä¸€ä¸ªåŠŸèƒ½ï¼Œè®©ç”¨æˆ·ä¼ å…¥ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ§åˆ¶è¢«è£…é¥°å‡½æ•°çš„è¾“å‡ºã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import time DEFAULT_FMT = '[{elapsed:0.8f}s] {name}({args}) -\u003e {result}' def clock(fmt=DEFAULT_FMT): def decorate(func): def clocked(*_args): t0 = time.time() _result = func(*_args) elapsed = time.time() - t0 name = func.__name__ args = ', '.join(repr(arg) for arg in _args) result = repr(_result) print(fmt.format(**locals())) return _result return clocked return decorate # @clock() # @clock('{name}: {elapsed}s') @clock('{name}{args} dt={elapsed:0.3f}s') def snooze(seconds): time.sleep(seconds) for i in range(3): snooze(.123) å°ç»“ æœ¬èŠ‚å…ˆç¼–å†™äº†ä¸€ä¸ªæ²¡æœ‰å†…éƒ¨å‡½æ•°çš„ @register è£…é¥°å™¨ã€‚ ç„¶åå®ç°äº†æœ‰ä¸¤å±‚åµŒå¥—å‡½æ•°çš„å‚æ•°åŒ–è£…é¥°å™¨ @clock()\nå‚æ•°åŒ–è£…é¥°å™¨åŸºæœ¬ä¸Šè®¾è®¡è‡³å°‘ä¸¤å±‚åµŒå¥—å‡½æ•°ã€‚\næ ‡å‡†åº“ functools æä¾›ä¸¤ä¸ªéå¸¸é‡è¦çš„è£…é¥°å™¨ @lru_cache() å’Œ @singledispatch\nç†è§£è£…é¥°å™¨ï¼Œéœ€è¦åŒºåˆ†å¯¼å…¥æ—¶ã€è¿è¡Œæ—¶ã€å˜é‡ä½œç”¨åŸŸï¼Œé—­åŒ…ç­‰ã€‚\næ¨èé˜…è¯»ï¼šdecorator ç¬¬ä¸‰æ–¹åº“\n","description":"","tags":["python"],"title":"ã€Šæµç•…çš„Pythonã€‹å‡½æ•°è£…é¥°å™¨ä¸é—­åŒ…","uri":"/blog/posts/Python/Fluent-Python/fluent-python-function-decorators-and-closures/"},{"categories":["Python","Fluent-Python"],"content":"\nä¸ç®¡åˆ«äººæ€ä¹ˆè¯´æˆ–æ€ä¹ˆæƒ³ï¼Œæˆ‘ä»æœªè§‰å¾— Python å—åˆ°æ¥è‡ªå‡½æ•°å¼è¯­è¨€çš„å¤ªå¤šå½±å“ã€‚æˆ‘éå¸¸ç†Ÿæ‚‰å‘½ä»¤å¼è¯­è¨€ï¼Œå¦‚ C å’Œ Algol 68ï¼Œè™½ç„¶æˆ‘æŠŠå‡½æ•°å®šä¸ºä¸€ç­‰å¯¹è±¡ï¼Œä½†æ˜¯æˆ‘å¹¶ä¸æŠŠ Python å½“ä½œå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ã€‚\nâ€”â€” Guido van Rossum: Python ä»æ…ˆçš„ç‹¬è£è€…\nåœ¨ Python ä¸­ï¼Œå‡½æ•°æ˜¯ä¸€ç­‰å¯¹è±¡ã€‚\nç¼–ç¨‹è¯­è¨€ç†è®ºå®¶æŠŠâ€œä¸€ç­‰å¯¹è±¡â€å®šä¹‰ä¸ºæ»¡è¶³ä¸‹è¿°æ¡ä»¶çš„ç¨‹åºå®ä½“ï¼š\nåœ¨è¿è¡Œæ—¶åˆ›å»º èƒ½èµ‹å€¼ç»™å˜é‡æˆ–æ•°æ®ç»“æ„ä¸­çš„å…ƒç´  èƒ½ä½œä¸ºå‚æ•°ä¼ ç»™å‡½æ•° èƒ½ä½œä¸ºå‡½æ•°çš„è¿”å›ç»“æœ å‡½æ•°å³ä¸ºå¯¹è±¡ 1 2 3 4 5 6 7 def factorial(n): \"\"\"returns n!\"\"\" return 1 if n \u003c 2 else n * factorial(n-1) factorial(42) factorial.__doc__ type(factorial) é€šè¿‡ type(factorial) å¯ä»¥çœ‹åˆ° function æ˜¯ä¸€ç§ç±»å‹ï¼Œæˆ–è€…è¯´ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡__doc__ å»è®¿é—®å®ƒçš„å±æ€§ã€‚\né‚£ä¹ˆä½œä¸ºå¯¹è±¡çš„å‡½æ•°ï¼Œä¹Ÿèƒ½ä½œä¸ºå‚æ•°è¢«ä¼ é€’ã€‚å‡½æ•°å¼é£æ ¼ç¼–ç¨‹ä¹ŸåŸºäºæ­¤\n1 2 3 4 5 fact = factorial fact fact(5) map(factorial, range(11)) list(map(fact, range(11))) é«˜é˜¶å‡½æ•° è¾“å…¥æˆ–è€…è¾“å‡ºæ˜¯å‡½æ•°çš„å³ä¸ºé«˜é˜¶å‡½æ•°(higher order function)ã€‚ä¾‹å¦‚ï¼šmapï¼Œ sortedã€‚\n1 2 3 fruits = ['strawberry', 'fig', 'apple', 'cherry', 'raspberry', 'banana'] # function len() as key sorted(fruits, key=len) mapã€filter å’Œ reduce çš„æ›¿ä»£å“ å‡½æ•°å¼è¯­è¨€é€šå¸¸æä¾› mapã€filter å’Œ reduce ä¸‰ä¸ªé«˜é˜¶å‡½æ•°ã€‚ åœ¨ Python ä¸­å¼•å…¥äº†åˆ—è¡¨æ¨å¯¼å’Œç”Ÿæˆå¼è¡¨è¾¾å¼ï¼Œå¯ä»¥æ›¿ä»£å®ƒä»¬ä¸”æ›´å®¹æ˜“é˜…è¯»ã€‚\n1 2 3 4 list(map(fact, range(6))) [fact(n) for n in range(6)] list(map(factorial, filter(lambda n : n % 2, range(6)))) [factorial(n) for n in range(6) if n % 2] map å’Œ filter è¿”å›ç”Ÿæˆå™¨ï¼Œå¯ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼æ›¿ä»£ reduce å¸¸ç”¨æ±‚å’Œï¼Œç›®å‰æœ€å¥½ä½¿ç”¨ sum æ›¿ä»£\n1 2 3 4 5 from functools import reduce from operator import add reduce(add, range(100)) sum(range(100)) sum å’Œ reduce æŠŠæ“ä½œè¿ç»­åº”ç”¨åœ¨åºåˆ—å…ƒç´ ä¸Šï¼Œå¾—åˆ°è¿”å›å€¼\nall(iterable), any(iterable) ä¹Ÿæ˜¯è§„çº¦å‡½æ•°\nall(iterable): æ¯ä¸ªå…ƒç´ ä¸ºçœŸï¼Œè¿”å›çœŸ any(iterable): å­˜åœ¨ä¸€ä¸ªå…ƒç´ ä¸ºçœŸï¼Œè¿”å›çœŸ åŒ¿åå‡½æ•° Python æ”¯æŒ lambda è¡¨è¾¾å¼ã€‚ å®ƒæ˜¯å‡½æ•°å¯¹è±¡ï¼Œåœ¨å¥æ³•ä¸Šè¢«é™åˆ¶åªèƒ½ç”¨å­˜è¡¨è¾¾å¼ã€‚\nå‚æ•°åˆ—è¡¨ä¸­æœ€é€‚åˆä½¿ç”¨åŒ¿åå‡½æ•°ã€‚\n1 2 3 4 # æ ¹æ®å•è¯æœ«å°¾å­—ç¬¦æ’åº fruits = ['strawberry', 'fig', 'apple', 'cherry', 'raspberry', 'banana'] sorted(fruits, key=lambda word: word[::-1]) Python çš„å¯è°ƒç”¨å¯¹è±¡\nç”¨æˆ·å®šä¹‰çš„å‡½æ•°ï¼šä½¿ç”¨ def æˆ– lambda åˆ›å»º å†…ç½®å‡½æ•°ï¼šå¦‚ len æˆ– time.strfttime å†…ç½®æ–¹æ³•ï¼šå¦‚ dict.get ç±»ï¼šå…ˆè°ƒç”¨ __new__ åˆ›å»ºå®ä¾‹ï¼Œå†å¯¹å®ä¾‹è¿è¡Œ __init__ æ–¹æ³• ç±»çš„å®ä¾‹ï¼šå¦‚æœç±»ä¸Šå®šä¹‰äº† __call__ æ–¹æ³•ï¼Œåˆ™å®ä¾‹å¯ä»¥ä½œä¸ºå‡½æ•°è°ƒç”¨ ç”Ÿæˆå™¨å‡½æ•°ï¼šä½¿ç”¨ yield å…³é”®å­—çš„å‡½æ•°æˆ–æ–¹æ³•ï¼Œè°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ä¼šè¿”å›ç”Ÿæˆå™¨å¯¹è±¡ åˆ¤æ–­å¯¹è±¡æ˜¯å¦èƒ½è°ƒç”¨ï¼Œä½¿ç”¨å†…ç½®çš„ callable() å‡½æ•°\n1 2 abs, str, 13 [callable(obj) for obj in (abs, str, 13)] ç”¨æˆ·å®šä¹‰çš„å¯è°ƒç”¨ç±»å‹ ä»»ä½• Python å¯¹è±¡éƒ½å¯ä»¥è¡¨ç°å¾—åƒå‡½æ•°ï¼Œåªéœ€å®ç°å®ä¾‹æ–¹æ³• __call__\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 import random class BingoCage: def __init__(self, items): self._items = list(items) random.shuffle(self._items) def pick(self): try: return self._items.pop() except IndexError: raise LookupError('pick from empty BingoCage') def __call__(self): return self.pick() bingo = BingoCage(range(3)) bingo.pick() bingo() callable(bingo) å®ç° __call__ æ–¹æ³•çš„ç±»æ˜¯åˆ›å»ºå‡½æ•°ç±»å¯¹è±¡çš„ç®€ä¾¿æ–¹å¼ã€‚ å‡½æ•°ç±»å¯¹è±¡æœ‰è‡ªå·±çš„çŠ¶æ€ï¼Œå³ä¸ºå®ä¾‹å˜é‡ã€‚è£…é¥°å™¨å‡½æ•°ä¹Ÿå¯ä»¥æœ‰.\nå‡½æ•°å†…çœ å†…çœï¼ˆintrospectionï¼‰å¯ä»¥æŸ¥çœ‹å‡½æ•°å†…éƒ¨çš„ç»†èŠ‚ï¼Œå‡½æ•°æœ‰è®¸å¤šå±æ€§ã€‚ä½¿ç”¨ dir å‡½æ•°å¯ä»¥æŸ¥çœ‹ï¼Œæˆ–ä½¿ç”¨ code å±æ€§\n1 2 dir(factorial) # factorial.__code__.co_varnames 1 2 3 4 5 6 7 # eg:5-9 # åˆ—å‡ºå¸¸è§„å¯¹è±¡æ²¡æœ‰è€Œå‡½æ•°æœ‰çš„å±æ€§ class C: pass obj = C() def func(): pass sorted(set(dir(func)) - set(dir(obj))) å‡½æ•°å±æ€§è¯´æ˜ // æ’å…¥è¡¨æ ¼\nä»å®šä½å‚æ•°åˆ°ä»…é™å…³é”®å­—å‚æ•° æœ¬èŠ‚è®¨è®º python å‚æ•°å¤„ç†æœºåˆ¶ã€‚py3 æä¾›äº†ä»…é™å…³é”®å­—å‚æ•°ï¼ˆkeyword-only argumentï¼‰ è°ƒç”¨å‡½æ•°ä½¿ç”¨ * å’Œ ** å±•å¼€å¯è¿­ä»£å¯¹è±¡ã€‚\npositional argument ä½ç½®å‚æ•° keyword-only argument ä»…é™å…³é”®å­—å‚æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 def tag(name, *content, cls=None, **attrs): \"\"\"ç”Ÿæˆä¸€ä¸ªæˆ–å¤šä¸ª HTML æ ‡ç­¾\"\"\" if cls is not None: attrs['class'] = cls if attrs: attr_str = ''.join(' %s=\"%s\"' % (attr, value) for attr, value in sorted(attrs.items())) else: attr_str = '' if content: return '\\n'.join('\u003c%s%s\u003e%s\u003c/%s\u003e' % (name, attr_str, c, name) for c in content) else: return '\u003c%s%s /\u003e' % (name, attr_str) tag('br') tag('p', 'hello') tag('p', 'hello', 'world') # 'hello', 'world' -\u003e *content tag('p', 'hello', id=33) # id=33 -\u003e **attrs tag('p', 'hello', 'world', cls='sidebar') tag(content='testing', name=\"img\") my_tag = { 'name': 'img', 'title': 'Sunset Boulevard', 'src': 'sunset.jpg', 'cls': 'framed' } tag(**my_tag) cls å‚æ•°åªèƒ½é€šè¿‡å…³é”®å­—æŒ‡å®šï¼Œè€Œä¸èƒ½é€šè¿‡ä½ç½®å‚æ•°æŒ‡å®šã€‚\nå®šä¹‰å‡½æ•°æ—¶è‹¥åªæƒ³å®šä»…é™å…³é”®å­—å‚æ•°ï¼Œè¦æŠŠå®ƒæ”¾åœ¨å¸¦æœ‰ * å‚æ•°åé¢ï¼Œå¦‚æœä¸æƒ³æ”¯æŒæ•°é‡ä¸å®šçš„ä½ç½®å‚æ•°ï¼Œä½†æ”¯æŒ keyowrd-only, åœ¨å‡½æ•°ç­¾åä¸­æ”¾ä¸€ä¸ª *\n1 2 3 4 5 def f(a, *, b): return a, b # f(1, 2) f(1, b=2) è·å–å…³äºå‚æ•°çš„ä¿¡æ¯ ä¸Šé¢æåˆ°ï¼Œå‡½æ•°å†…çœå¯ä»¥æŸ¥çœ‹å‡½æ•°å†…éƒ¨ä¿¡æ¯ï¼Œé€šè¿‡ HTTP å¾®æ¡†æ¶ Bobo ä½œä¸ºä¾‹å­æ¥çœ‹ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 # eg: 5-12 # hello.py import bobo @bobo.query('/') def hello(person): return 'Hello %s!' % person # åœ¨ç¯å¢ƒä¸­æ‰§è¡Œ bobo -f hello.py, è‹¥è¿è¡Œç«¯å£ä¸º http://localhost:8080/ # æ²¡æœ‰ä¼ å…¥å‚æ•° # curl -i http://localhost:8080/ # HTTP/1.0 403 Forbidden # Date: Wed, 22 Apr 2020 06:23:33 GMT # Server: WSGIServer/0.2 CPython/3.7.4 # Content-Type: text/html; charset=UTF-8 # Content-Length: 103 # \u003chtml\u003e # \u003chead\u003e\u003ctitle\u003eMissing parameter\u003c/title\u003e\u003c/head\u003e # \u003cbody\u003eMissing form variable person\u003c/body\u003e # \u003c/html\u003e # ä¼ å…¥å‚æ•° # curl -i http://localhost:8080/?person=Jim # HTTP/1.0 200 OK # Date: Wed, 22 Apr 2020 06:24:47 GMT # Server: WSGIServer/0.2 CPython/3.7.4 # Content-Type: text/html; charset=UTF-8 # Content-Length: 10 # Hello Jim!% Bobo å¦‚ä½•çŸ¥é“å‡½æ•°éœ€è¦å“ªä¸ªå‚æ•°å‘¢ï¼Ÿ\nå‡½æ•°å¯¹è±¡æœ‰ __defaults__ å±æ€§ï¼Œå…¶å€¼ä¸ºä¸€ä¸ªå…ƒç¥–ï¼Œä¿å­˜ç€ä½ç½®å‚æ•°å’Œå…³é”®å­—å‚æ•°çš„é»˜è®¤å€¼ã€‚\nkeyword-only å‚æ•°é»˜è®¤å€¼ä¿å­˜åœ¨ __kwdefaults__ å±æ€§ä¸­ã€‚\nå‚æ•°çš„åç§°åœ¨ __code__ å±æ€§ä¸­ï¼Œå…¶å€¼ä¸º code å¯¹è±¡çš„å¼•ç”¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 def clip(text, max_len=80): \"\"\"åœ¨ max_len å‰åçš„ç¬¬ä¸€ä¸ªç©ºæ ¼å¤„æˆªæ–­æ–‡æœ¬\"\"\" end = None if (len(text)) \u003e max_len: space_before = text.rfind(' ', 0, max_len) if space_before \u003e= 0: end = space_before else: space_after = text.rfind(' ', max_len) if space_after \u003e= 0: end = space_after if end is None: end = len(text) return text[:end].rstrip() clip.__defaults__ # clip.__code__ # clip.__code__.co_varnames # clip.__code__.co_argcount å‡½æ•°ç­¾åä¿¡æ¯ï¼Œå‚æ•°å’Œé»˜è®¤å€¼æ˜¯åˆ†å¼€çš„ã€‚å¯ä»¥ä½¿ç”¨ inspect æ¨¡å—æå–è¿™äº›ä¿¡æ¯\n1 2 3 4 5 6 7 from inspect import signature sig = signature(clip) sig str(sig) for name, param in sig.parameters.items(): print(param.kind, ':', name, '=', param.default) kind å±æ€§å€¼åœ¨ _Parameterkind ç±»ä¸­ï¼Œåˆ—ä¸¾å¦‚ä¸‹ï¼š\nPOSTIONAL_OR_KEYWORD VAR_POSITIONAL VAR_KEYWORD KEYWORD-ONLY POSITIONAL_ONLY inspect.Signature æœ‰ bind æ–¹æ³•ï¼Œå¯ä»¥æŠŠä»»æ„ä¸ªå‚æ•°ç»‘å®šåœ¨ç­¾åä¸­çš„å½¢å‚ä¸Šã€‚\næ¡†æ¶å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•åœ¨è°ƒç”¨å‡½æ•°å‰éªŒè¯å‚æ•°\n1 2 3 4 5 6 7 8 9 10 11 12 13 import inspect sig = inspect.signature(tag) my_tag = { 'name': 'img', 'title': 'Sunset Boulevard', 'src': 'sunset.jpg', 'cls': 'framed'} bound_args = sig.bind(**my_tag) bound_args del my_tag['name'] # missing argument error bound_args = sig.bind(**my_tag) æ¡†æ¶å’Œ IDE å·¥å…·å¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯éªŒè¯ä»£ç \nå‡½æ•°æ³¨è§£ï¼ˆannotationï¼‰ å„ä¸ªå‚æ•°å¯ä»¥åœ¨ : åæ·»åŠ æ³¨è§£è¡¨è¾¾å¼ã€‚\nå‚æ•°æœ‰é»˜è®¤å€¼ï¼Œæ³¨è§£æ”¾åœ¨å‚æ•°åå’Œ = å·ä¹‹é—´ï¼Œæ³¨è§£è¿”å›å€¼åœ¨å‡½æ•°å£°æ˜æœ«å°¾æ·»åŠ  -\u003e å’Œè¡¨è¾¾å¼\næ³¨è§£ä¸ä¼šåšä»»ä½•å¤„ç†ï¼Œåªå­˜å‚¨åœ¨å‡½æ•° __annotations__ å±æ€§ä¸­ã€‚\næ³¨è§£åªæ˜¯å…ƒæ•°æ®ï¼Œå¯ä»¥ä¾› IDEï¼Œæ¡†æ¶å’Œè£…é¥°å™¨ç­‰å·¥å…·ä½¿ç”¨\ninspect.signature() å‡½æ•°çŸ¥é“æ€ä¹ˆæå–æ³¨è§£\n1 2 3 4 def clip(text: str, max_len: 'int \u003e 0' = 80) -\u003e str: pass clip.__annotations__ 1 2 3 4 5 6 7 8 from inspect import signature sig = signature(clip) sig.return_annotation for param in sig.parameters.values(): note = repr(param.annotation).ljust(13) print(note, ':', param.name, '=', param.default) æ”¯æŒå‡½æ•°å¼ç¼–ç¨‹çš„åŒ… operator æ¨¡å— operator é‡Œæœ‰å¾ˆå¤šå‡½æ•°ï¼Œå¯¹åº”ç€ Python ä¸­çš„å†…ç½®è¿ç®—ç¬¦ï¼Œä½¿ç”¨å®ƒä»¬å¯ä»¥é¿å…ç¼–å†™å¾ˆå¤šæ— è¶£çš„ lambda å‡½æ•°ï¼Œå¦‚ï¼š\nadd: lambda a, b: a + b or_: lambda a, b: a or b itemgetter: lambda a, b: a[b] attrgetter: lambda a, b: getattr(a, b) 1 2 3 4 5 6 7 8 from functools import reduce from operator import mul def fact(n): return reduce(lambda a, b: a*b, range(1, n+1)) def fact(n): return reduce(mul, range(1, n+1)) è¿˜æœ‰ä¸€ç±»å‡½æ•°ï¼Œèƒ½æ›¿ä»£ä»åºåˆ—ä¸­å–å‡ºæˆ–è¯»å–å…ƒç´ å±æ€§çš„ lambda è¡¨è¾¾å¼ã€‚å¦‚ itemgetterï¼Œattrgetter\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 metro_data = [ ('Tokyo', 'JP', 36.933, (35.689722, 139.691667)), # \u003c1\u003e ('Delhi NCR', 'IN', 21.935, (28.613889, 77.208889)), ('Mexico City', 'MX', 20.142, (19.433333, -99.133333)), ('New York-Newark', 'US', 20.104, (40.808611, -74.020386)), ('Sao Paulo', 'BR', 19.649, (-23.547778, -46.635833)), ] from operator import itemgetter for city in sorted(metro_data, key=lambda fields: fields[1]): print(city) for city in sorted(metro_data, key=itemgetter(1)): print(city) # itemgetter è¿”å›æå–çš„å€¼æ„æˆçš„å…ƒç¥–ï¼Œå¯ä»¥ç”¨æ¥æå–æŒ‡å®šå­—æ®µæˆ–è°ƒæ•´å…ƒç¥–é¡ºåº cc_name = itemgetter(1, 0) for city in metro_data: print(cc_name(city)) itemgetter ä½¿ç”¨ [] è¿ç®—ç¬¦ï¼Œå› ä¸ºå®ƒä¸ä»…æ”¯æŒåºåˆ—ï¼Œè¿˜æ”¯æŒæ˜ å°„å’Œä»»ä½•å®ç° __getitem__ çš„ç±»\nattrgetter ä½œç”¨ç›¸ä¼¼ï¼Œå®ƒåˆ›å»ºçš„å‡½æ•°æ ¹æ®åç§°æå–å¯¹è±¡çš„å±æ€§ã€‚åŒ…å« . çš„ï¼Œä¼šè¿›å…¥åˆ°åµŒå¥—å¯¹è±¡æå–å±æ€§\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 from collections import namedtuple LatLong = namedtuple('Latlong', 'lat long') Metorpolis = namedtuple('Metorpolis', 'name cc pop coord') metro_areas = [Metorpolis(name, cc, pop, LatLong(lat, long)) for name, cc, pop, (lat, long) in metro_data] metro_areas[0] metro_areas[0].coord.lat from operator import attrgetter name_lat = attrgetter('name', 'coord.lat') for city in sorted(metro_areas, key=attrgetter('coord.lat')): print(name_lat(city)) 1 2 import operator [name for name in dir(operator) if not name.startswith('_')] operator æ¨¡å—çš„å‡½æ•°å¯ä»¥é€šè¿‡ dir(operator) æŸ¥çœ‹ã€‚\nä»‹ç» methodcaller, å®ƒçš„ä½œç”¨ä¸å‰ä¸¤ä¸ªå‡½æ•°ç›¸ä¼¼ï¼Œå®ƒåˆ›å»ºçš„å‡½æ•°ä¼šåœ¨å¯¹è±¡è°ƒç”¨å‚æ•°æŒ‡å®šçš„æ–¹æ³•\n1 2 3 4 5 6 7 from operator import methodcaller s = 'The time has come' upcase = methodcaller('upper') upcase(s) hiphenate = methodcaller('replace', ' ', '-') hiphenate(s) ä½¿ç”¨ functools.partial å†»ç»“å‚æ•° functools æœ€å¸¸ç”¨çš„å‡½æ•°æœ‰ reduceï¼Œä¹‹å‰å·²ç»ä»‹ç»è¿‡ã€‚ä½™ä¸‹å‡½æ•°ä¸­æœ€æœ‰ç”¨çš„æ˜¯ partial åŠå…¶å˜ä½“ partialmethod\nå®ƒçš„ä½œç”¨æ˜¯ï¼šæŠŠåŸå‡½æ•°æŸäº›å‚æ•°å›ºå®šã€‚\npartial ç¬¬ä¸€ä¸ªå‡½æ•°æ˜¯å¯è°ƒç”¨å¯¹è±¡ï¼Œåé¢è·Ÿä»»æ„ä¸ªä½ç½®å‚æ•°å’Œå…³é”®å­—å‚æ•°\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 from operator import mul from functools import partial triple = partial(mul, 3) triple(7) list(map(triple, range(1, 10))) picture = partial(tag, 'img', cls='pic-frame') picture(src='wumpus.jepg') picture picture.func picture.args picture.keywords functoos.partialmethod ä½œç”¨ä¸ partial ä¸€æ ·ï¼Œä¸è¿‡é€‚ç”¨äºå¤„ç†æ–¹æ³•çš„\nå°ç»“ æ¢è®¨ Python å‡½æ•°çš„ä¸€ç­‰ç‰¹æ€§ã€‚æ„å‘³ç€å¯ä»¥æŠŠå‡½æ•°èµ‹å€¼ç»™å˜é‡ï¼Œä¼ å…¥å…¶ä»–å‡½æ•°ï¼Œå­˜å‚¨äºæ•°æ®ç»“æ„ä¸­ï¼Œä»¥åŠè®¿é—®å‡½æ•°å±æ€§ã€‚\né«˜é˜¶å‡½æ•°æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„é‡è¦ç»„æˆã€‚\nPython çš„å¯è°ƒç”¨å¯¹è±¡: 7ç§\nå‡½æ•°åŠå…¶æ³¨è§£æœ‰ä¸°å¯Œçš„ç‰¹æ€§ã€‚å¯é€šè¿‡ inspect æ¨¡å—è¯»å–\næœ€åä»‹ç»äº† operator æ¨¡å—ä¸­çš„ä¸€äº›å‡½æ•°ï¼Œå¯ä»¥æ›¿æ¢æ‰åŠŸèƒ½æœ‰é™çš„ lambda è¡¨è¾¾å¼ã€‚\n","description":"","tags":["python"],"title":"ã€Šæµç•…çš„ Pythonã€‹ä¸€ç­‰å‡½æ•°","uri":"/blog/posts/Python/Fluent-Python/fluent-python-first-class-function/"},{"categories":["Python"],"content":"\nBeautiful is better than ugly. ï¼ˆä¼˜ç¾æ¯”ä¸‘é™‹å¥½ï¼‰\nExplicit is better than implicit.ï¼ˆæ¸…æ™°æ¯”æ™¦æ¶©å¥½ï¼‰\nSimple is better than complex.ï¼ˆç®€å•æ¯”å¤æ‚å¥½ï¼‰\nComplex is better than complicated.ï¼ˆå¤æ‚æ¯”é”™ç»¼å¤æ‚å¥½ï¼‰\nFlat is better than nested.ï¼ˆæ‰å¹³æ¯”åµŒå¥—å¥½ï¼‰\nSparse is better than dense.ï¼ˆç¨€ç–æ¯”å¯†é›†å¥½ï¼‰\nReadability counts.ï¼ˆå¯è¯»æ€§å¾ˆé‡è¦ï¼‰\nSpecial cases aren't special enough to break the rules.ï¼ˆç‰¹æ®Šæƒ…å†µä¹Ÿä¸åº”è¯¥è¿åè¿™äº›è§„åˆ™ï¼‰\nAlthough practicality beats purity.ï¼ˆä½†ç°å®å¾€å¾€å¹¶ä¸é‚£ä¹ˆå®Œç¾ï¼‰\nErrors should never pass silently.ï¼ˆå¼‚å¸¸ä¸åº”è¯¥è¢«é™é»˜å¤„ç†ï¼‰\nUnless explicitly silenced.ï¼ˆé™¤éä½ å¸Œæœ›å¦‚æ­¤ï¼‰\nIn the face of ambiguity, refuse the temptation to guess.ï¼ˆé‡åˆ°æ¨¡æ£±ä¸¤å¯çš„åœ°æ–¹ï¼Œä¸è¦èƒ¡ä¹±çŒœæµ‹ï¼‰\nThere should be one-- and preferably only one --obvious way to do it.ï¼ˆè‚¯å®šæœ‰ä¸€ç§é€šå¸¸ä¹Ÿæ˜¯å”¯ä¸€ä¸€ç§æœ€ä½³çš„è§£å†³æ–¹æ¡ˆï¼‰\nAlthough that way may not be obvious at first unless you're Dutch.ï¼ˆè™½ç„¶è¿™ç§æ–¹æ¡ˆå¹¶ä¸æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå› ä¸ºä½ ä¸æ˜¯é‚£ä¸ªè·å…°äºº^è¿™é‡ŒæŒ‡çš„æ˜¯Pythonä¹‹çˆ¶Guido^ï¼‰\nNow is better than never.ï¼ˆç°åœ¨å¼€å§‹åšæ¯”ä¸åšå¥½ï¼‰\nAlthough never is often better than *right* now.ï¼ˆä¸åšæ¯”ç›²ç›®å»åšå¥½^æé™ç¼–ç¨‹ä¸­çš„YAGNIåŸåˆ™^ï¼‰\nIf the implementation is hard to explain, it's a bad idea.ï¼ˆå¦‚æœä¸€ä¸ªå®ç°æ–¹æ¡ˆéš¾äºç†è§£ï¼Œå®ƒå°±ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ–¹æ¡ˆï¼‰\nIf the implementation is easy to explain, it may be a good idea.ï¼ˆå¦‚æœä¸€ä¸ªå®ç°æ–¹æ¡ˆæ˜“äºç†è§£ï¼Œå®ƒå¾ˆæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªå¥½çš„æ–¹æ¡ˆï¼‰\nNamespaces are one honking great idea -- let's do more of those!ï¼ˆå‘½åç©ºé—´éå¸¸æœ‰ç”¨ï¼Œæˆ‘ä»¬åº”å½“å¤šåŠ åˆ©ç”¨ï¼‰\n","description":"","tags":["python"],"title":"Python ä¹‹ç¦…","uri":"/blog/posts/Python/zen-of-python/"},{"categories":["Web"],"content":"dumpdata å‘½ä»¤ï¼š\nå®ƒå¯ä»¥ç”¨æ¥å¤‡ä»½ï¼ˆå¯¼å‡ºï¼‰æ¨¡å‹å®ä¾‹æˆ–æ•´ä¸ªæ•°æ®åº“\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 ./manage.py dumpdata --help usage: manage.py dumpdata [-h] [--format FORMAT] [--indent INDENT] [--database DATABASE] [-e EXCLUDE] [--natural-foreign] [--natural-primary] [-a] [--pks PRIMARY_KEYS] [-o OUTPUT] [--version] [-v {0,1,2,3}] [--settings SETTINGS] [--pythonpath PYTHONPATH] [--traceback] [--no-color] [--force-color] [app_label[.ModelName] [app_label[.ModelName] ...]] Output the contents of the database as a fixture of the given format (using each model's default manager unless --all is specified). positional arguments: app_label[.ModelName] Restricts dumped data to the specified app_label or app_label.ModelName. optional arguments: -h, --help show this help message and exit --format FORMAT Specifies the output serialization format for fixtures. --indent INDENT Specifies the indent level to use when pretty-printing output. --database DATABASE Nominates a specific database to dump fixtures from. Defaults to the \"default\" database. -e EXCLUDE, --exclude EXCLUDE An app_label or app_label.ModelName to exclude (use multiple --exclude to exclude multiple apps/models). --natural-foreign Use natural foreign keys if they are available. --natural-primary Use natural primary keys if they are available. -a, --all Use Django's base manager to dump all models stored in the database, including those that would otherwise be filtered or modified by a custom manager. --pks PRIMARY_KEYS Only dump objects with given primary keys. Accepts a comma-separated list of keys. This option only works when you specify one model. -o OUTPUT, --output OUTPUT Specifies file to which the output is written. --version show program's version number and exit -v {0,1,2,3}, --verbosity {0,1,2,3} Verbosity level; 0=minimal output, 1=normal output, 2=verbose output, 3=very verbose output --settings SETTINGS The Python path to a settings module, e.g. \"myproject.settings.main\". If this isn't provided, the DJANGO_SETTINGS_MODULE environment variable will be used. --pythonpath PYTHONPATH A directory to add to the Python path, e.g. \"/home/djangoprojects/myproject\". --traceback Raise on CommandError exceptions --no-color Don't colorize the command output. --force-color Force colorization of the command output. åŸºç¡€æ•°æ®åº“å¯¼å‡º\n1 ./manage.py dumpdata \u003e db.json è¿™ä¼šå¯¼å‡ºæ•´ä¸ªæ•°æ®åº“åˆ° db.json\nå¤‡ä»½æŒ‡å®šçš„ app\n1 ./manage.py dumpdata admin \u003e admin.json è¿™ä¼šå¯¼å‡º admin åº”ç”¨çš„å†…å®¹åˆ° admin.json\nå¤‡ä»½æŒ‡å®šçš„æ•°æ®è¡¨\n1 ./manage.py dumpdata admin.logentry \u003e logentry.json è¿™ä¼šå¯¼å‡º admin.logentry æ•°æ®è¡¨çš„æ‰€æœ‰æ•°æ®\n1 ./manage.py dumpdata auth.user \u003e user.json è¿™ä¼šå¯¼å‡º auth.user æ•°æ®è¡¨çš„æ‰€æœ‰æ•°æ®\ndumpdata â€”exclude\nâ€”exclude é€‰é¡¹ç”¨æ¥æŒ‡å®šæ— éœ€è¢«å¯¼å‡ºçš„ apps/tables\n1 ./manage.py dumpdata --exclude auth.permission \u003e db.json è¿™ä¼šå¯¼å‡ºæ•´ä¸ªæ•°æ®åº“ï¼Œä½†ä¸åŒ…æ‹¬ auth.permisson\ndumpdata â€”intent\né»˜è®¤æƒ…å†µï¼Œdumpdata çš„è¾“å‡ºä¼šæŒ¤åœ¨åŒä¸€è¡Œï¼Œå¯è¯»æ€§å¾ˆå·®ã€‚ä½¿ç”¨ â€”indent å¯ä»¥è®¾å®šç¼©è¿›ç¾åŒ–è¾“å‡º\n1 ./manage.py dumpdata auth.user --indent 2 \u003e user.json 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 [ { \"model\": \"auth.user\", \"pk\": 1, \"fields\": { \"password\": \"pbkdf2_sha256$150000$i8oET981EnSJ$d2RCpfY76gFHbwUs1HekSK+pOLYMJFcJ1wFcuyf6R28=\", \"last_login\": \"2020-04-13T09:21:34.639Z\", \"is_superuser\": true, \"username\": \"xiao\", \"first_name\": \"\", \"last_name\": \"\", \"email\": \"yuechuan.xiao@artosyn.cn\", \"is_staff\": true, \"is_active\": true, \"date_joined\": \"2020-04-13T08:59:01.310Z\", \"groups\": [], \"user_permissions\": [] } }, { \"model\": \"auth.user\", \"pk\": 2, \"fields\": { \"password\": \"pbkdf2_sha256$150000$PgBKh5sMAE1y$xdFkYi+gprF1v2rlOyw2OOsRn87zSeTVLJ9dGfoXzIw=\", \"last_login\": null, \"is_superuser\": true, \"username\": \"qa\", \"first_name\": \"\", \"last_name\": \"\", \"email\": \"qa@artosyn.cn\", \"is_staff\": true, \"is_active\": true, \"date_joined\": \"2020-04-13T08:59:16.279Z\", \"groups\": [], \"user_permissions\": [] } } ] dumpdata â€”format\né»˜è®¤è¾“å‡ºæ ¼å¼ä¸º JSONã€‚ä½¿ç”¨ â€”format å¯ä»¥æŒ‡å®šè¾“å‡ºæ ¼å¼\njson xml yaml 1 ./manage.py dumpdata auth.user --indent 2 --format xml \u003e user.xml è¿™ä¼šè¾“å‡º xml æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 \u003c?xml version=\"1.0\" encoding=\"utf-8\"?\u003e \u003cdjango-objects version=\"1.0\"\u003e \u003cobject model=\"auth.user\" pk=\"1\"\u003e \u003cfield name=\"password\" type=\"CharField\"\u003epbkdf2_sha256$150000$i8oET981EnSJ$d2RCpfY76gFHbwUs1HekSK+pOLYMJFcJ1wFcuyf6R28=\u003c/field\u003e \u003cfield name=\"last_login\" type=\"DateTimeField\"\u003e2020-04-13T09:21:34.639297+00:00\u003c/field\u003e \u003cfield name=\"is_superuser\" type=\"BooleanField\"\u003eTrue\u003c/field\u003e \u003cfield name=\"username\" type=\"CharField\"\u003exiao\u003c/field\u003e \u003cfield name=\"first_name\" type=\"CharField\"\u003e\u003c/field\u003e \u003cfield name=\"last_name\" type=\"CharField\"\u003e\u003c/field\u003e \u003cfield name=\"email\" type=\"CharField\"\u003eyuechuan.xiao@artosyn.cn\u003c/field\u003e \u003cfield name=\"is_staff\" type=\"BooleanField\"\u003eTrue\u003c/field\u003e \u003cfield name=\"is_active\" type=\"BooleanField\"\u003eTrue\u003c/field\u003e \u003cfield name=\"date_joined\" type=\"DateTimeField\"\u003e2020-04-13T08:59:01.310568+00:00\u003c/field\u003e \u003cfield name=\"groups\" rel=\"ManyToManyRel\" to=\"auth.group\"\u003e\u003c/field\u003e \u003cfield name=\"user_permissions\" rel=\"ManyToManyRel\" to=\"auth.permission\"\u003e\u003c/field\u003e \u003c/object\u003e \u003cobject model=\"auth.user\" pk=\"2\"\u003e \u003cfield name=\"password\" type=\"CharField\"\u003epbkdf2_sha256$150000$PgBKh5sMAE1y$xdFkYi+gprF1v2rlOyw2OOsRn87zSeTVLJ9dGfoXzIw=\u003c/field\u003e \u003cfield name=\"last_login\" type=\"DateTimeField\"\u003e\u003cNone\u003e\u003c/None\u003e\u003c/field\u003e \u003cfield name=\"is_superuser\" type=\"BooleanField\"\u003eTrue\u003c/field\u003e \u003cfield name=\"username\" type=\"CharField\"\u003eqa\u003c/field\u003e \u003cfield name=\"first_name\" type=\"CharField\"\u003e\u003c/field\u003e \u003cfield name=\"last_name\" type=\"CharField\"\u003e\u003c/field\u003e \u003cfield name=\"email\" type=\"CharField\"\u003eqa@artosyn.cn\u003c/field\u003e \u003cfield name=\"is_staff\" type=\"BooleanField\"\u003eTrue\u003c/field\u003e \u003cfield name=\"is_active\" type=\"BooleanField\"\u003eTrue\u003c/field\u003e \u003cfield name=\"date_joined\" type=\"DateTimeField\"\u003e2020-04-13T08:59:16.279788+00:00\u003c/field\u003e \u003cfield name=\"groups\" rel=\"ManyToManyRel\" to=\"auth.group\"\u003e\u003c/field\u003e \u003cfield name=\"user_permissions\" rel=\"ManyToManyRel\" to=\"auth.permission\"\u003e\u003c/field\u003e \u003c/object\u003e \u003c/django-objects\u003e loaddata å‘½ä»¤\nç”¨æ¥å¯¼å…¥ fixturesï¼ˆdumpdata å¯¼å‡ºçš„æ•°æ®ï¼‰åˆ°æ•°æ®åº“\n1 ./manage.py loaddata user.json è¿™ä¼šå¯¼å…¥ user.json é‡Œçš„å†…å®¹åˆ°æ•°æ®åº“\næ¢å¤ fresh database\nå½“ä½ é€šè¿‡ dumpdata å‘½ä»¤å¤‡ä»½æ•´ä¸ªæ•°æ®åº“æ—¶ï¼Œå®ƒå°†å¤‡ä»½æ‰€æœ‰æ•°æ®è¡¨ã€‚è‹¥ä½¿ç”¨ dump æ–‡ä»¶å¯¼å…¥åˆ°å¦å¤–çš„ Django é¡¹ç›®ï¼Œä¼šå¯¼è‡´ IntegrityErrorã€‚\nå¯ä»¥é€šè¿‡å¤‡ä»½æ—¶åŠ å…¥é€‰é¡¹ â€”exclude contenttypes å’Œ auth.permissions æ•°æ®è¡¨ä¿®å¤æ­¤é—®é¢˜\n1 ./manage.py dumpdata --exclude auth.permission --exclude contenttypes \u003e db.json ç°åœ¨å†ç”¨ loaddata å‘½ä»¤å¯¼å…¥ fresh dababase\n1 ./manage.py loaddata db.json ","description":"","tags":["django"],"title":"Django å¯¼å‡ºå’Œå¯¼å…¥æ•°æ®","uri":"/blog/posts/Web/django-export-and-import-data/"},{"categories":["Python"],"content":"\nä»¥ä¸‹æ‰€æœ‰å†…å®¹åŒ…å«åœ¨å®˜æ–¹ PEP(Python Enhancement Proposals) é“¾æ¥ä¸º [pep8][https://www.python.org/dev/peps/pep-0008/]\nç®€è¦ç‰ˆæœ¬ ä»£ç ç¼–æ’\nç¼©è¿›ã€‚4ä¸ªç©ºæ ¼çš„ç¼©è¿›ï¼ˆç¼–è¾‘å™¨éƒ½å¯ä»¥å®Œæˆæ­¤åŠŸèƒ½ï¼‰ï¼Œä¸ä½¿ç”¨Tapï¼Œæ›´ä¸èƒ½æ··åˆä½¿ç”¨Tapå’Œç©ºæ ¼ã€‚\né’ˆå¯¹ä¸åŒç¼–è¾‘å™¨å…¼å®¹æ€§ï¼Œå¯¹ tab å¯èƒ½æœ‰ä¸åŒçš„æ ‡å‡†ï¼Œå¯¼è‡´æ ·å¼ä¸ç»Ÿä¸€ã€‚\næ¯è¡Œæœ€å¤§é•¿åº¦79ï¼Œæ¢è¡Œå¯ä»¥ä½¿ç”¨åæ–œæ ï¼Œæœ€å¥½ä½¿ç”¨åœ†æ‹¬å·ã€‚æ¢è¡Œç‚¹è¦åœ¨æ“ä½œç¬¦çš„åè¾¹æ•²å›è½¦ã€‚\næ—©æœŸ unix ä¸»æœºç»ˆç«¯åªèƒ½æ˜¾ç¤º 80 ä¸ªå­—ç¬¦ã€‚\né€šè¿‡é™åˆ¶æ‰€éœ€çš„ç¼–è¾‘å™¨çª—å£å®½åº¦ï¼Œå¯ä»¥å¹¶æ’æ‰“å¼€å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨åœ¨ç›¸é‚»åˆ—ä¸­æ˜¾ç¤ºä¸¤ä¸ªç‰ˆæœ¬çš„ä»£ç æŸ¥çœ‹å·¥å…·æ—¶ï¼Œæ•ˆæœå¾ˆå¥½ã€‚\nç±»å’Œtop-levelå‡½æ•°å®šä¹‰ä¹‹é—´ç©ºä¸¤è¡Œï¼›\nç±»ä¸­çš„æ–¹æ³•å®šä¹‰ä¹‹é—´ç©ºä¸€è¡Œï¼›\nå‡½æ•°å†…é€»è¾‘æ— å…³æ®µè½ä¹‹é—´ç©ºä¸€è¡Œï¼›\nå…¶ä»–åœ°æ–¹å°½é‡ä¸è¦å†ç©ºè¡Œã€‚\næ–‡æ¡£ç¼–æ’\næ¨¡å—å†…å®¹çš„é¡ºåºï¼š\næ¨¡å—è¯´æ˜å’Œdocstring\nimport\nglobals\u0026constants\nå…¶ä»–å®šä¹‰ã€‚\nå…¶ä¸­importéƒ¨åˆ†ï¼ŒåˆæŒ‰æ ‡å‡†ã€ä¸‰æ–¹å’Œè‡ªå·±ç¼–å†™é¡ºåºä¾æ¬¡æ’æ”¾ï¼Œä¹‹é—´ç©ºä¸€è¡Œã€‚\nä¸è¦åœ¨ä¸€å¥importä¸­å¤šä¸ªåº“ï¼Œæ¯”å¦‚import os, sysä¸æ¨èã€‚ å¦‚æœé‡‡ç”¨from XX import XXå¼•ç”¨åº“ï¼Œå¯ä»¥çœç•¥â€˜module.â€™ï¼Œéƒ½æ˜¯å¯èƒ½å‡ºç°å‘½åå†²çªï¼Œè¿™æ—¶å°±è¦é‡‡ç”¨import XXã€‚\nå¦‚æœæœ‰å‘½åå†²çªã€‚å¯ä»¥ä½¿ç”¨ from X import Y as Z\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 # -*- coding: utf-8 -*- #!/bin/python3 # ------------------------------------------------------------------------- # Author: Yuechuan Xiao # @Date: 2020-01-09 14:56:57 # @LastEditors: Yuechuan Xiao # @LastEditTime: 2020-03-30 16:33:48 # @Description: # report.py: gen build's jira issues html report. # ------------------------------------------------------------------------- \"\"\" Docstring reporter.py is used to generate a html report for specific build. \"\"\" # Standard library import os import re from collections import namedtuple # Third party lib # Import multi-subcass from A package. from jinja2 import ( Environment, FileSystemLoader, Template, select_autoescape) from jira import JIRA # If you have lcoal import # from .utils import X # from . import utils ç©ºæ ¼çš„ä½¿ç”¨ æ€»ä½“åŸåˆ™ï¼Œé¿å…ä¸å¿…è¦çš„ç©ºæ ¼ã€‚\nå„ç§å³æ‹¬å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚ é€—å·ã€å†’å·ã€åˆ†å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚ å‡½æ•°çš„å·¦æ‹¬å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚å¦‚func(1)ã€‚ åºåˆ—çš„å·¦æ‹¬å·å‰ä¸è¦åŠ ç©ºæ ¼ã€‚å¦‚list[2]ã€‚ æ“ä½œç¬¦å·¦å³å„åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œä¸è¦ä¸ºäº†å¯¹é½å¢åŠ ç©ºæ ¼ã€‚ å‡½æ•°é»˜è®¤å‚æ•°ä½¿ç”¨çš„èµ‹å€¼ç¬¦å·¦å³çœç•¥ç©ºæ ¼ã€‚ ä¸è¦å°†å¤šå¥è¯­å¥å†™åœ¨åŒä¸€è¡Œï¼Œå°½ç®¡ä½¿ç”¨â€˜ï¼›â€™å…è®¸ã€‚ if/for/whileè¯­å¥ä¸­ï¼Œå³ä½¿æ‰§è¡Œè¯­å¥åªæœ‰ä¸€å¥ï¼Œä¹Ÿå¿…é¡»å¦èµ·ä¸€è¡Œã€‚ å‘½åè§„èŒƒ æ€»ä½“åŸåˆ™ï¼Œæ–°ç¼–ä»£ç å¿…é¡»æŒ‰ä¸‹é¢å‘½åé£æ ¼è¿›è¡Œï¼Œç°æœ‰åº“çš„ç¼–ç å°½é‡ä¿æŒé£æ ¼ã€‚\nå°½é‡å•ç‹¬ä½¿ç”¨å°å†™å­—æ¯lï¼Œå¤§å†™å­—æ¯Oç­‰å®¹æ˜“æ··æ·†çš„å­—æ¯ã€‚ æ¨¡å—å‘½åå°½é‡çŸ­å°ï¼Œä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ åŒ…å‘½åå°½é‡çŸ­å°ï¼Œä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œä¸å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ ç±»çš„å‘½åä½¿ç”¨CapWordsçš„æ–¹å¼ï¼Œæ¨¡å—å†…éƒ¨ä½¿ç”¨çš„ç±»é‡‡ç”¨_CapWordsçš„æ–¹å¼ã€‚_ å¼‚å¸¸å‘½åä½¿ç”¨CapWords+Erroråç¼€çš„æ–¹å¼ã€‚ å…¨å±€å˜é‡å°½é‡åªåœ¨æ¨¡å—å†…æœ‰æ•ˆï¼Œç±»ä¼¼Cè¯­è¨€ä¸­çš„staticã€‚å®ç°æ–¹æ³•æœ‰ä¸¤ç§ï¼Œä¸€æ˜¯__all__æœºåˆ¶;äºŒæ˜¯å‰ç¼€ä¸€ä¸ªä¸‹åˆ’çº¿ å‡½æ•°å‘½åä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ å¸¸é‡å‘½åä½¿ç”¨å…¨éƒ¨å¤§å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ ç±»çš„å±æ€§ï¼ˆæ–¹æ³•å’Œå˜é‡ï¼‰å‘½åä½¿ç”¨å…¨éƒ¨å°å†™çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ã€‚ ç±»çš„å±æ€§æœ‰3ç§ä½œç”¨åŸŸpublicã€non-publicå’Œsubclass APIï¼Œå¯ä»¥ç†è§£æˆC++ä¸­çš„publicã€privateã€protectedï¼Œnon-publicå±æ€§å‰ï¼Œå‰ç¼€ä¸€æ¡ä¸‹åˆ’çº¿ã€‚ ç±»çš„å±æ€§è‹¥ä¸å…³é”®å­—åå­—å†²çªï¼Œåç¼€ä¸€ä¸‹åˆ’çº¿ï¼Œå°½é‡ä¸è¦ä½¿ç”¨ç¼©ç•¥ç­‰å…¶ä»–æ–¹å¼ã€‚ ä¸ºé¿å…ä¸å­ç±»å±æ€§å‘½åå†²çªï¼Œåœ¨ç±»çš„ä¸€äº›å±æ€§å‰ï¼Œå‰ç¼€ä¸¤æ¡ä¸‹åˆ’çº¿ã€‚æ¯”å¦‚ï¼šç±»Fooä¸­å£°æ˜__a,è®¿é—®æ—¶ï¼Œåªèƒ½é€šè¿‡Foo._Foo__aï¼Œé¿å…æ­§ä¹‰ã€‚å¦‚æœå­ç±»ä¹Ÿå«Fooï¼Œé‚£å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚ ç±»çš„æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯selfï¼Œè€Œé™æ€æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯clsã€‚ æ³¨é‡Š æ€»ä½“åŸåˆ™ï¼Œé”™è¯¯çš„æ³¨é‡Šä¸å¦‚æ²¡æœ‰æ³¨é‡Šã€‚æ‰€ä»¥å½“ä¸€æ®µä»£ç å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯è¦ä¿®æ”¹æ³¨é‡Šï¼ é’ˆå¯¹å›¢é˜Ÿæƒ…å†µï¼ˆæ˜¯å¦å›½é™…åŒ–ï¼‰ï¼Œæ³¨é‡Šå€¾å‘ä½¿ç”¨è‹±æ–‡ï¼Œæœ€å¥½æ˜¯å®Œæ•´çš„å¥å­ï¼Œé¦–å­—æ¯å¤§å†™ï¼Œå¥åè¦æœ‰ç»“æŸç¬¦ï¼Œç»“æŸç¬¦åè·Ÿä¸¤ä¸ªç©ºæ ¼ï¼Œå¼€å§‹ä¸‹ä¸€å¥ã€‚å¦‚æœæ˜¯çŸ­è¯­ï¼Œå¯ä»¥çœç•¥ç»“æŸç¬¦ã€‚\nå—æ³¨é‡Šï¼Œåœ¨ä¸€æ®µä»£ç å‰å¢åŠ çš„æ³¨é‡Šã€‚åœ¨â€˜#â€™ååŠ ä¸€ç©ºæ ¼ã€‚æ®µè½ä¹‹é—´ä»¥åªæœ‰â€˜#â€™çš„è¡Œé—´éš”ã€‚æ¯”å¦‚ï¼š # Description : Module config. # # Input : None # # Output : None è¡Œæ³¨é‡Šï¼Œåœ¨ä¸€å¥ä»£ç ååŠ æ³¨é‡Šã€‚æ¯”å¦‚ï¼šx = x + 1 # Increment x ä½†æ˜¯è¿™ç§æ–¹å¼å°½é‡å°‘ä½¿ç”¨ã€‚å¯ä»¥åœ¨ Magic Number æ—¶ä½¿ç”¨ã€‚ é¿å…æ— è°“çš„æ³¨é‡Šã€‚ æ–‡æ¡£æè¿° 1 ä¸ºæ‰€æœ‰çš„å…±æœ‰æ¨¡å—ã€å‡½æ•°ã€ç±»ã€æ–¹æ³•å†™docstringsï¼›éå…±æœ‰çš„æ²¡æœ‰å¿…è¦ï¼Œä½†æ˜¯å¯ä»¥å†™æ³¨é‡Šï¼ˆåœ¨defçš„ä¸‹ä¸€è¡Œï¼‰ã€‚ 2 å¦‚æœdocstringè¦æ¢è¡Œï¼Œå‚è€ƒå¦‚ä¸‹ä¾‹å­,è¯¦è§PEP 257\n1 2 3 4 5 \"\"\"Return a foobang Optional plotz says to frobnicate the bizbaz first. \"\"\" ç¼–ç å»ºè®®\nç¼–ç ä¸­è€ƒè™‘åˆ°å…¶ä»–pythonå®ç°çš„æ•ˆç‡ç­‰é—®é¢˜ï¼Œæ¯”å¦‚è¿ç®—ç¬¦â€˜+â€™åœ¨CPythonï¼ˆPythonï¼‰ä¸­æ•ˆç‡å¾ˆé«˜ï¼Œéƒ½æ˜¯Jythonä¸­å´éå¸¸ä½ï¼Œæ‰€ä»¥åº”è¯¥é‡‡ç”¨.join()çš„æ–¹å¼ã€‚ 2 å°½å¯èƒ½ä½¿ç”¨i\ns is notå–ä»£==ï¼Œæ¯”å¦‚if x is not None è¦ä¼˜äºif xã€‚ 3 ä½¿ç”¨åŸºäºç±»çš„å¼‚å¸¸ï¼Œæ¯ä¸ªæ¨¡å—æˆ–åŒ…éƒ½æœ‰è‡ªå·±çš„å¼‚å¸¸ç±»ï¼Œæ­¤å¼‚å¸¸ç±»ç»§æ‰¿è‡ªExceptionã€‚ 4 å¼‚å¸¸ä¸­ä¸è¦ä½¿ç”¨è£¸éœ²çš„exceptï¼Œexceptåè·Ÿå…·ä½“çš„exceptionsã€‚ 5 å¼‚å¸¸ä¸­tryçš„ä»£ç å°½å¯èƒ½å°‘ã€‚æ¯”å¦‚ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 try: value = collection[key] except KeyError: return key_not_found(key) else: return handle_value(value) è¦ä¼˜äº try: # Too broad! return handle_value(collection[key]) except KeyError: # Will also catch KeyError raised by handle_value() return key_not_found(key) ä½¿ç”¨startswith() and endswith()ä»£æ›¿åˆ‡ç‰‡è¿›è¡Œåºåˆ—å‰ç¼€æˆ–åç¼€çš„æ£€æŸ¥ã€‚æ¯”å¦‚\n1 2 3 4 5 Yes: if foo.startswith(â€˜barâ€™):ä¼˜äº No: if foo[:3] == â€˜barâ€™: - ä½¿ç”¨isinstance()æ¯”è¾ƒå¯¹è±¡çš„ç±»å‹ã€‚æ¯”å¦‚ Yes: if isinstance(obj, int): ä¼˜äº No: if type(obj) is type(1): åˆ¤æ–­åºåˆ—ç©ºæˆ–ä¸ç©ºï¼Œæœ‰å¦‚ä¸‹è§„åˆ™\n1 2 3 4 5 Yes: if not seq: if seq: ä¼˜äº No: if len(seq) if not len(seq) å­—ç¬¦ä¸²ä¸è¦ä»¥ç©ºæ ¼æ”¶å°¾ã€‚\näºŒè¿›åˆ¶æ•°æ®åˆ¤æ–­ä½¿ç”¨ if boolvalueçš„æ–¹å¼ã€‚\nReference [PEP8][https://www.python.org/dev/peps/pep-0008/]\nGoogle Python å¼€æºé¡¹ç›®é£æ ¼æŒ‡å—\n","description":"","tags":["python","codestyle"],"title":"Python ä¹‹ä»£ç è§„èŒƒ","uri":"/blog/posts/Python/python-codestyle/"},{"categories":["Web"],"content":"\nDjango é¡¹ç›®æœ¬èº«å¯ä»¥é€šè¿‡ django-admin æˆ–è€…ç›´æ¥è¿è¡Œ python manage.py ARGS æ¥è¿›è¡Œè„šæ‰‹æ¶ç”Ÿæˆã€‚ä½†æ˜¯ç”Ÿæˆçš„é¡¹ç›®æ¡†æ¶å±‚æ¬¡ä¸ç®—å¤ªå¥½ã€‚\né¦–å…ˆç”Ÿæˆä¸€ä¸ª Django é¡¹ç›®ï¼š\n1 django-admin startproject backend ç”Ÿæˆçš„é¡¹ç›®æ¡†æ¶å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 backend â”œâ”€â”€ backend â”‚Â â”œâ”€â”€ __init__.py â”‚Â â”œâ”€â”€ settings.py â”‚Â â”œâ”€â”€ urls.py â”‚Â â””â”€â”€ wsgi.py â””â”€â”€ manage.py å…¶ä¸­çš„ä¸¤ä¸ª backend åˆ†åˆ«è¡¨ç¤ºé¡¹ç›®ï¼Œä»¥åŠ app å…¨å±€é…ç½®\nå»ºç«‹æ–‡ä»¶å¤¹ apps ç”¨æ¥æ”¾ç½®åº”ç”¨ï¼ŒæŠŠå†…å±‚ backend æ”¹ä¸º conf\n1 2 3 4 5 6 7 8 backend â”œâ”€â”€ apps â”œâ”€â”€ conf â”‚ â”œâ”€â”€ __init__.py â”‚ â”œâ”€â”€ settings.py â”‚ â”œâ”€â”€ urls.py â”‚ â””â”€â”€ wsgi.py â””â”€â”€ manage.py æ³¨æ„è¿™é‡Œéœ€è¦é…ç½®ä»¥ä¸‹å‡ ä¸ªæ–‡ä»¶ï¼š\n1 2 3 4 5 # manage.py ... # os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'backend.settings') os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'conf.settings') ... 1 2 3 4 5 6 7 8 # settings.py ... # ROOT_URLCONF = 'backend.urls' ROOT_URLCONF = 'conf.urls' ... # WSGI_APPLICATION = 'backend.wsgi.application' WSGI_APPLICATION = 'conf.wsgi.application' ... ç°åœ¨å¯ä»¥æµ‹è¯• python manage.py runserver æ˜¯å¦å¯ä»¥èµ·æ¥ã€‚\næ¥ä¸‹æ¥æ–°å»º Apps\n1 2 mkdir apps/login python manage.py startapp login apps/login æ³¨å†Œ app\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 # settings.py TEMPLATES = [ { 'BACKEND': 'django.template.backends.django.DjangoTemplates', 'DIRS': ['apps'], # æ·»åŠ  apps æ–‡ä»¶å¤¹ 'APP_DIRS': True, 'OPTIONS': { 'context_processors': [ 'django.template.context_processors.debug', 'django.template.context_processors.request', 'django.contrib.auth.context_processors.auth', 'django.contrib.messages.context_processors.messages', ], }, }, ] INSTALLED_APPS = [ 'django.contrib.admin', 'django.contrib.auth', 'django.contrib.contenttypes', 'django.contrib.sessions', 'django.contrib.messages', 'django.contrib.staticfiles', 'apps.login', ] å¯¼å…¥ URL\n1 2 3 4 5 6 7 ... from apps.login import urls as login_urls urlpatterns = [ path('admin/', admin.site.urls), path('login/', include(login_urls)), ] ç°åœ¨ä¸€ä¸ªåŸºæœ¬çš„é¡¹ç›®ç»“æ„å°±å»ºç«‹å¥½äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 backend â”œâ”€â”€ apps â”‚ â””â”€â”€ login â”‚ â”œâ”€â”€ __init__.py â”‚ â”œâ”€â”€ admin.py â”‚ â”œâ”€â”€ apps.py â”‚ â”œâ”€â”€ migrations â”‚ â”‚ â””â”€â”€ __init__.py â”‚ â”œâ”€â”€ models.py â”‚ â”œâ”€â”€ tests.py â”‚ â””â”€â”€ views.py â”œâ”€â”€ conf â”‚ â”œâ”€â”€ __init__.py â”‚ â”œâ”€â”€ settings.py â”‚ â”œâ”€â”€ urls.py â”‚ â””â”€â”€ wsgi.py â”œâ”€â”€ db.sqlite3 â””â”€â”€ manage.py ç›¸æ¯”èµ·æ¥å±‚æ¬¡æ›´æ¸…æ™°ï¼Œè€Œä¸”ä¹Ÿæ›´é€‚åˆç”¨ä½œå‰åç«¯åˆ†ç¦»çš„å‘½å\n","description":"","tags":["web","django"],"title":"Django é¡¹ç›®åç«¯æ¨¡æ¿","uri":"/blog/posts/Web/django-project-backend-template/"},{"categories":null,"content":"ç†è§£é€’å½’çš„å°æ•…äº‹ è½¬è½½ä¸€ç¯‡å¯¹é€’å½’ç†è§£æœ‰å¸®åŠ©çš„å°æ•…äº‹\nå¯¹é€’å½’çš„ç†è§£çš„è¦ç‚¹ä¸»è¦åœ¨äºæ”¾å¼ƒ!\næ”¾å¼ƒä½ å¯¹äºç†è§£å’Œè·Ÿè¸ªé€’å½’å…¨ç¨‹çš„ä¼å›¾ï¼Œåªç†è§£é€’å½’ä¸¤å±‚ä¹‹é—´çš„äº¤æ¥ï¼Œä»¥åŠé€’å½’ç»ˆç»“çš„æ¡ä»¶ã€‚\næƒ³è±¡ä½ æ¥åˆ°æŸä¸ªçƒ­å¸¦ä¸›æ—ï¼Œæ„å¤–å‘ç°äº†åå±‚ä¹‹é«˜çš„æ±‰è¯ºå¡”ã€‚æ­£å½“ä½ è‹¦è‹¦æ€ç´¢å¦‚ä½•æ¬åŠ¨å®ƒæ—¶ï¼Œæ—ä¸­å‡ºæ¥ä¸€ä¸ªåœŸè‘—ï¼Œæ¯›é‚è‡ªèè¦å¸®ä½ æ¬å¡”ã€‚ä»–åå«äºŒå‚»ï¼Œæˆ´ç€ä¸€ä¸ªè‰å¸½ï¼Œè‰å¸½ä¸Šæœ‰ä¸€ä¸ª2å­—ï¼Œå·ç§°ä¼šæŠŠä¸€åˆ°äºŒå·ç›˜æ¬åˆ°ä»»æ„æŸ±ã€‚\nä½ çµæœºä¸€åŠ¨ï¼Œé—®é“ï¼šâ€œä½ è¯¥ä¸ä¼šæœ‰ä¸ªå…„å¼Ÿå«ä¸‰å‚»å§ï¼Ÿâ€ â€œå¯¹å¯¹ï¼Œè€çˆ·ä½ å’‹çŸ¥é“çš„ï¼Ÿä»–ä¼šæ¬ä¸€åˆ°ä¸‰å·ç›˜ã€‚â€œ â€é‚£ä½ å»æŠŠä»–å«æ¥ï¼Œæˆ‘ä¸éœ€è¦ä½ äº†ã€‚â€œ äºæ˜¯ä¸‰å‚»æ¥äº†ï¼Œä»–ä¹Ÿå¸¦ç€ä¸ªè‰å¸½ï¼Œä¸Šé¢æœ‰ä¸ª3å­—ã€‚\nä½ è¯´ï¼šâ€ä¸‰å‚»ï¼Œä½ å¸®æˆ‘æŠŠå¤´ä¸‰ä¸ªç›˜å­ç§»åˆ°cæŸ±å§ã€‚â€œ ä¸‰å‚»æ²‰åŸäº†ä¸€ä¼šï¼Œèµ°è¿›æ ‘æ—ï¼Œä½ å¬è§ä»–å¤§å«ï¼šâ€äºŒå‚»ï¼Œå‡ºæ¥å¸®æˆ‘æŠŠå¤´ä¸¤ä¸ªç›˜å­æ¬åˆ°C!â€œ\nç”±äºå¤©æ°”ç‚çƒ­ä½ å¼€å§‹æ‰“çŒç¡ã€‚æœ¦èƒ§ä¸­ä½ æ²¡çœ‹è§äºŒå‚»æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼ŒäºŒå‚»å¹²å®Œä»¥åï¼Œèµ°å…¥æ—ä¸­å¤§å«ä¸€å£°ï¼šâ€œè€ä¸‰ï¼Œæˆ‘å¹²å®Œäº†!â€\nä¸‰å‚»å‡ºæ¥ï¼ŒæŠŠä¸‰å·ç›˜ä»Aæ¬åˆ°Bï¼Œç„¶ååˆå»å«äºŒå‚»ï¼šâ€œè€äºŒï¼Œå¸®æˆ‘æŠŠå¤´ä¸¤ä¸ªç›˜å­æ¬å›A!â€\nä½™ä¸‹çš„æˆ‘å°±ä¸å¤šè¯´äº†ï¼Œæ€»ä¹‹ä¸‰å‚»å…¶å®åªæ¬ä¸‰å·ç›˜ï¼Œå…¶ä»–å«äºŒå‚»å‡ºæ¥å¹²ã€‚æœ€åä¸€æ­¥æ˜¯ä¸‰å‚»æŠŠä¸‰å·ç›˜æ¬åˆ°Cï¼Œç„¶åå‘¼å«äºŒå‚»æ¥æŠŠå¤´ä¸¤ä¸ªç›˜å­æ¬å›C\näº‹æƒ…å®Œäº†ä¹‹åä½ æŠŠä¸‰å‚»å«æ¥ï¼Œå¯¹ä»–è¯´ï¼šâ€œå…¶å®ä½ ä¸çŸ¥é“æ€ä¹ˆå…·ä½“ä¸€æ­¥ä¸€æ­¥æŠŠä¸‰ä¸ªç›˜å­æ¬åˆ°Cï¼Œæ˜¯å§ï¼Ÿâ€\nä¸‰å‚»ä¸è§£åœ°è¯´ï¼šâ€œæˆ‘ä¸æ˜¯æŠŠä»»åŠ¡å¹²å®Œäº†ï¼Ÿâ€\nä½ è¯´ï¼šâ€œå¯ä½ å…¶å®å«ä½ å…„å¼ŸäºŒå‚»å¹²äº†å¤§éƒ¨åˆ†å·¥ä½œå‘€ï¼Ÿâ€\nä¸‰å‚»è¯´ï¼šâ€œæˆ‘å¤–åŒ…ç»™ä»–å’Œä½ å±ç›¸å¹²ï¼Ÿâ€\nä½ é—®åˆ°ï¼šâ€œäºŒå‚»æ˜¯ä¸æ˜¯ä¹Ÿå¤–åŒ…ç»™äº†è°ï¼Ÿâ€œ\nä¸‰å‚»ç¬‘äº†ï¼šâ€œè¿™è·Ÿæˆ‘æœ‰å±ç›¸å¹²ï¼Ÿâ€\nä½ è‹¦è‹¦æ€ç´¢äº†ä¸€å¤œï¼Œç¬¬äºŒå¤©ï¼Œä½ èµ°å…¥æ—ä¸­å¤§å«ï¼šâ€œåå‚»ï¼Œä½ åœ¨å“ªï¼Ÿâ€\nä¸€ä¸ªå¤´ä¸Šå¸¦ç€10å·è‰å¸½çš„äººï¼Œåå‚»ï¼Œåº”å£°è€Œå‡ºï¼šâ€œè€çˆ·ï¼Œä½ æœ‰ä»€ä¹ˆäº‹ï¼Ÿâ€\nâ€œæˆ‘è¦ä½ å¸®æŠŠ1åˆ°10å·ç›˜å­æ¬åˆ°CæŸ±â€œ\nâ€œå¥½çš„ï¼Œè€çˆ·ã€‚â€œåå‚»è½¬èº«å°±å‘æ—å†…èµ°ã€‚\nâ€œæ…¢ç€ï¼Œä½ è¯¥ä¸æ˜¯å›å»å«ä½ å…„å¼Ÿä¹å‚»å§â€œ\nâ€œè€çˆ·ä½ æ€ä¹ˆçŸ¥é“çš„ï¼Ÿâ€œ\nâ€œæ‰€ä»¥ä½ ä½¿å”¤ä»–æŠŠå¤´ä¹ä¸ªç›˜å­æ¬è¿‡æ¥æ¬è¿‡å»ï¼Œä½ åªè¦æ¬å‡ æ¬¡åå·ç›˜å°±å¥½äº†ï¼Œå¯¹å—ï¼Ÿâ€œ\nâ€œå¯¹å‘€ï¼â€œ\nâ€œä½ çŸ¥ä¸çŸ¥é“ä»–æ˜¯æ€ä¹ˆå¹²çš„ï¼Ÿâ€œ\nâ€œè¿™å’Œæˆ‘æœ‰å±ç›¸å¹²ï¼Ÿâ€œ\nä½ å¹äº†ä¸€å£æ°”ï¼Œå†³å®šæ”¾å¼ƒã€‚åå‚»å¼€å§‹å¹²æ´»ã€‚æ ‘æ—é‡Œå……æ»¡äº†æ­¤èµ·å½¼ä¼çš„å«å£°ï¼šâ€œä¹å‚»ï¼Œæ¥ä¸€ä¸‹ï¼â€œ â€œè€å…«ï¼Œåˆ°ä½ äº†ï¼â€œâ€œäº”å‚»ï¼ã€‚ã€‚ã€‚â€œâ€ä¸‰å‚»ï¼ã€‚ã€‚ã€‚â€œâ€å¤§å‚»ï¼â€œ\nä½ æ³¨æ„åˆ°å¤§å‚»ä»ä¸å«äººï¼Œä½†æ˜¯å¤§å‚»çš„å·¥ä½œä¹Ÿæœ€ç®€å•ï¼Œä»–åªæ˜¯æŠŠä¸€å·ç›˜æ¬æ¥æ¬å»ã€‚\nè‹¥å¹²å¹´åï¼Œå·¥ä½œç»“æŸäº†ã€‚åå‚»æ¥åˆ°ä½ é¢å‰ã€‚ä½ é—®åå‚»ï¼šâ€œæ˜¯è°æ•™ç»™ä½ ä»¬è¿™ä¹ˆå¹²æ´»çš„ï¼Ÿâ€œ\nåå‚»è¯´ï¼šâ€œæˆ‘çˆ¸çˆ¸ã€‚ä»–ç»™æˆ‘ç•™äº†è¿™å¼ çº¸æ¡ã€‚â€\nä»–ä»å£è¢‹é‡Œæå‡ºä¸€å¼ å°çº¸æ¡ï¼Œä¸Šé¢å†™ç€ï¼šâ€œç…§ä½ å¸½å­çš„å·ç æ¬ç›˜å­åˆ°ç›®æ ‡æŸ±ã€‚å¦‚æœæœ‰ç›˜å­å‹ä½ä½ ï¼Œå«ä½ ä¸Šé¢ä¸€ä½å“¥å“¥æŠŠä»–æ¬èµ°ã€‚å¦‚æœæœ‰ç›˜å­å ä½ä½ è¦å»çš„æŸ±å­ï¼Œå«ä½ å“¥å“¥æŠŠå®ƒæ¬åˆ°ä¸ç¢äº‹çš„åœ°æ–¹ã€‚ç­‰ä½ çš„ç›˜å­æ¬åˆ°äº†ç›®æ ‡ï¼Œå«ä½ å“¥å“¥æŠŠè¯¥å‹åœ¨ä½ ä¸Šé¢çš„ç›˜å­æ¬å›åˆ°ä½ ä¸Šå¤´ã€‚â€œ\nä½ ä¸è§£åœ°é—®ï¼šâ€œé‚£å¤§å‚»æ²¡æœ‰å“¥å“¥æ€ä¹ˆåŠï¼Ÿâ€œ\nåå‚»ç¬‘äº†ï¼šâ€œä»–åªç®¡ä¸€å·ç›˜ï¼Œæ‰€ä»¥æ°¸è¿œä¸ä¼šç¢°åˆ°é‚£ä¸¤ä¸ªâ€˜å¦‚æœâ€™ï¼Œä¹Ÿæ²¡æœ‰ç›˜å­è¯¥å‹åœ¨ä¸€å·ä¸Šå•Šã€‚â€\nä½†è¿™æ—¶ä»–å¿½ç„¶å˜äº†é¢œè‰²ï¼Œå¥½åƒæ³„æ¼äº†å·¨å¤§çš„æœºå¯†ã€‚ä»–æƒŠæ…Œåœ°çœ‹äº†ä½ ä¸€çœ¼ï¼Œé£å¿«åœ°é€ƒå…¥æ ‘æ—ã€‚\nç¬¬äºŒå¤©ï¼Œä½ åˆ°æ ‘æ—é‡Œå»æœå¯»è¿™åå…„å¼Ÿã€‚ä»–ä»¬å·²ç»ä¸çŸ¥å»å‘ã€‚ä½ æ‰¾åˆ°äº†ä¸€ä¸ªå°å±‹ï¼Œåªå®¹ä¸€ä¸ªäººå±…ä½ï¼Œä½†æ˜¯å±‹é‡Œæœ‰åé¡¶è‰å¸½ï¼Œå†™ç€ä¸€åˆ°åå·çš„å·ç ã€‚\nä½œè€…ï¼šFireman A é“¾æ¥ï¼šhttps://www.zhihu.com/question/24385418/answer/257751077\n","description":"","tags":["recursion"],"title":"ç†è§£é€’å½’çš„å°æ•…äº‹","uri":"/blog/posts/a-story-to-understand-the-recursion/"},{"categories":["Python","Fluent-Python"],"content":"\nå­—å…¸è¿™ä¸ªæ•°æ®ç»“æ„æ´»è·ƒåœ¨æ‰€æœ‰ Python ç¨‹åºçš„èƒŒåï¼Œå³ä¾¿ä½ çš„æºç é‡Œå¹¶æ²¡æœ‰ç›´æ¥ç”¨åˆ°å®ƒã€‚\nâ€”â€”A. M. Kuchling\ndict æ˜¯ Python è¯­è¨€çš„åŸºçŸ³ã€‚\nå¯æ•£åˆ—å¯¹è±¡éœ€è¦å®ç° __hash__ å’Œ __eq__ å‡½æ•°ã€‚\nå¦‚æœä¸¤ä¸ªå¯æ•£åˆ—å¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆå®ƒä»¬çš„æ•£åˆ—å€¼ä¸€å®šæ˜¯ä¸€æ ·çš„ã€‚\nèŒƒæ˜ å°„ç±»å‹ collections.abc æ¨¡å—ä¸­æœ‰ Mapping å’Œ MutableMapping ä¸¤ä¸ªæŠ½è±¡åŸºç±»ï¼Œèµ·ä½œç”¨æ˜¯ä¸º dict å’Œå…¶ä»–ç±»ä¼¼çš„ç±»å‹å®šä¹‰å½¢å¼æ¥å£ã€‚\n//pic\nä½†éæŠ½è±¡æ˜ å°„ç±»å‹ä¸€èˆ¬ä¸ä¼šç›´æ¥ç»§æ‰¿è¿™äº›æŠ½è±¡åŸºç±»ï¼Œè€Œæ˜¯ç›´æ¥å¯¹ dict æˆ– collections.User.Dict è¿›è¡Œæ‰©å±•ã€‚\nè¿™äº›æŠ½è±¡åŸºç±»çš„ä¸»è¦ä½œç”¨æ˜¯ä½œä¸ºå½¢å¼åŒ–çš„æ–‡æ¡£ï¼Œä»¥åŠè·Ÿ isinstance ä¸€èµ·è¢«ç”¨æ¥åˆ¤å®šæŸä¸ªæ•°æ®æ˜¯å¦ä¸ºå¹¿ä¹‰ä¸Šçš„æ˜ å°„ç±»å‹ã€‚\n1 2 my_dict = {} isinstance(my_dict, collections.abc.Mapping) True ç”¨ instance è€Œä¸æ˜¯ç”¨ type æ˜¯ç”¨æ¥é¿å…å‚æ•°å¯èƒ½ä¸æ˜¯ dict è€Œæ˜¯å…¶ä»–çš„æ˜ å°„ç±»å‹\næ ‡å‡†åº“çš„æ‰€æœ‰æ˜ å°„ç±»å‹éƒ½æ˜¯åˆ©ç”¨ dict å®ç°ã€‚\nä»€ä¹ˆæ˜¯å¯æ•£åˆ—çš„æ•°æ®ç±»å‹ï¼Ÿ\nå­—å…¸çš„æä¾›äº†å¤šç§æ„é€ æ–¹æ³• link\n1 2 3 4 5 6 7 # å­—å…¸æä¾›äº†å¾ˆå¤šç§æ„é€ æ–¹æ³• a = dict(one=1, two=2, three=3) b = {'one': 1, 'two': 2, 'three': 3} c = dict(zip(['one', 'two', 'three'], [1, 2, 3])) d = dict([('two', 2), ('one', 1), ('three', 3)]) e = dict({'three': 3, 'one': 1, 'two': 2}) a == b == c == d == e True å­—å…¸æ¨å¯¼ å­—å…¸æ¨å¯¼ï¼ˆdictcompï¼‰å¯ä»¥ä»ä»»ä½•ä»¥é”®å€¼å¯¹ä¸ºå…ƒç´ çš„å¯è¿­ä»£å¯¹è±¡æ„å»ºå‡ºå­—å…¸\n1 2 3 4 5 6 7 8 DIAL_CODES = [ (86, 'China'), (91, 'India'), (1, 'United States') ] country_code = {country: code for code, country in DIAL_CODES} country_code {'China': 86, 'India': 91, 'United States': 1} å¸¸è§çš„æ˜ å°„æ–¹æ³• dictã€defaultdictã€OrderedDict çš„å¸¸è§æ–¹æ³•ï¼Œåä¸¤ä¸ªæ•°æ®ç±»å‹æ˜¯ dict çš„å˜ç§ï¼Œä½äº collections æ¨¡å—å†…ã€‚\nsetdefault å¤„ç†æ‰¾ä¸åˆ°çš„é”®\nd[k] æ— æ³•æ‰¾åˆ°æ­£ç¡®çš„é”®æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚\nç”¨ d.get(k, default) æ¥ä»£æ›¿ d[k], å¯ä»¥å¯¹æ‰¾ä¸åˆ°çš„é”®è®¾ç½®é»˜è®¤è¿”å›å€¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 \"\"\" 03-dict-set/index0.py åˆ›å»ºä¸€ä¸ªä»å•è¯åˆ°å…¶å‡ºç°é¢‘ç‡çš„æ˜ å°„ \"\"\" import sys import re WORD_RE = re.compile(r'\\w+') index = {} with open(sys.argv[1], encoding='uft-8') as fp: for line_no, line in enumerate(fp, 1): for match in WORD_RE.finditer(line): word = match.group() column_no = match.start() + 1 location = (line_no, column_no) # æå–å•è¯å‡ºç°æƒ…å†µï¼Œå¦‚æœæ²¡æœ‰å‡ºç°è¿‡è¿”å› [] occurences = index.get(word, []) occurences.append(location) index[word] = occurences # ä»¥å­—ç¬¦é¡ºåºæ‰“å°ç»“æœ for word in sorted(index, key=str.upper): print(word, index[word]) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 $ python index0.py zen.txt a [(19, 48), (20, 53)] Although [(11, 1), (16, 1), (18, 1)] ambiguity [(14, 16)] and [(15, 23)] are [(21, 12)] aren [(10, 15)] at [(16, 38)] bad [(19, 50)] be [(15, 14), (16, 27), (20, 50)] beats [(11, 23)] Beautiful [(3, 1)] better [(3, 14), (4, 13), (5, 11), (6, 12), (7, 9), (8, 11), (17, 8), (18, 25)] break [(10, 40)] by [(1, 20)] cases [(10, 9)] complex [(5, 23)] ... ä½¿ç”¨ dict.setdefault\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \"\"\" 03-dict-set/index.py åˆ›å»ºä¸€ä¸ªä»å•è¯åˆ°å…¶å‡ºç°é¢‘ç‡çš„æ˜ å°„ \"\"\" import sys import re WORD_RE = re.compile(r'\\w+') index = {} with open(sys.argv[1], encoding='uft-8') as fp: for line_no, line in enumerate(fp, 1): for match in WORD_RE.finditer(line): word = match.group() column_no = match.start() + 1 location = (line_no, column_no) # æ³¨æ„è¿™è¡Œä¸ä¸Šé¢çš„åŒºåˆ« index.setdefault(word, []).append(location) # æ•ˆæœç­‰åŒäºï¼š # if key not in my_dict: # my_dict[key] = [] # my_dict[key].append(new_value) # ä»¥å­—ç¬¦é¡ºåºæ‰“å°ç»“æœ for word in sorted(index, key=str.upper): print(word, index[word]) æ˜ å°„çš„å¼¹æ€§é”®æŸ¥è¯¢ æŸä¸ªé”®ä¸å­˜åœ¨æ—¶ï¼Œå¸Œæœ›è¯»å–æ—¶èƒ½å¾—åˆ°ä¸€ä¸ªé»˜è®¤å€¼ï¼Œæœ‰ä¸¤ä¸ªæ–¹å¼ï¼š\né€šè¿‡ defaultdict ç±»å‹ è‡ªå®šä¹‰ dict å­ç±» defaultdict å¤„ç†æ‰¾ä¸åˆ°çš„é”® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 \"\"\" 03-dict-set/index_default.py åˆ›å»ºä¸€ä¸ªä»å•è¯åˆ°å…¶å‡ºç°é¢‘ç‡çš„æ˜ å°„ \"\"\" import sys import re import collections WORD_RE = re.compile(r'\\w+') index = collections.defaultdict(list) with open(sys.argv[1], encoding='utf-8') as fp: for line_no, line in enumerate(fp, 1): for match in WORD_RE.finditer(line): word = match.group() column_no = match.start()+1 location = (line_no, column_no) # index å¦‚ä½•æ²¡æœ‰ word çš„è®°å½•ï¼Œ default_factory ä¼šè¢«è°ƒç”¨ï¼Œè¿™é‡Œæ˜¯åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨è¿”å› index[word].append(location) # print in alphabetical order for word in sorted(index, key=str.upper): print(word, index[word]) defaultdict é‡Œçš„ default_factory åªåœ¨ getitem é‡Œè°ƒç”¨ã€‚ å®é™…ä¸Šï¼Œä¸Šé¢çš„æœºåˆ¶æ˜¯é€šè¿‡ç‰¹æ®Šæ–¹æ³• missing æ”¯æŒçš„ã€‚\nmissing å¦‚æœ dict ç»§æ‰¿ç±»æä¾›äº† missing æ–¹æ³•ï¼Œä¸” getitem é‡åˆ°æ‰¾ä¸åˆ°é”®çš„æƒ…å†µæ˜¯ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒï¼Œè€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 class StrKeyDict0(dict): # \u003c1\u003e def __missing__(self, key): if isinstance(key, str): # \u003c2\u003e raise KeyError(key) return self[str(key)] # \u003c3\u003e def get(self, key, default=None): try: return self[key] # \u003c4\u003e except KeyError: return default # \u003c5\u003e def __contains__(self, key): return key in self.keys() or str(key) in self.keys() # \u003c6\u003e d = StrKeyDict0([('2', 'Two'), ('4', 'Four')]) print(d['2']) print(d['4']) # d[1] error print(d.get('2')) print(d.get('4')) print(d.get(1, 'N/A')) # defaultdcit \u0026 __missing__ class mydefaultdict(dict): def __init__(self, value, value_factory): super().__init__(value) self._value_factory = value_factory def __missing__(self, key): # è¦é¿å…å¾ªç¯è°ƒç”¨ # return self[key] self[key] = self._value_factory() return self[key] d = mydefaultdict({1:1}, list) print(d[1]) print(d[2]) d[3].append(1) print(d) Two Four Two Four 'N/A' å­—å…¸çš„å˜ç§ æ­¤èŠ‚æ€»ç»“äº†æ ‡å‡†åº“ collections æ¨¡å—ä¸­ï¼Œé™¤äº† defaultdict ä¹‹å¤–çš„ä¸åŒæ˜ å°„ç±»å‹\ncollections.OrderedDict\ncollections.ChainMap\nå®¹çº³å¤šä¸ªä¸åŒçš„æ˜ å°„å¯¹è±¡ï¼Œç„¶ååœ¨è¿›è¡Œé”®æŸ¥æ‰¾æ“ä½œæ—¶ä¼šä»å‰åˆ°åé€ä¸€æŸ¥æ‰¾ï¼Œç›´åˆ°è¢«æ‰¾åˆ°ä¸ºæ­¢\ncollections.Counter\ncollections.UserDict\ndict çš„çº¯ Python å®ç°ï¼Œè®©ç”¨æˆ·é›†æˆå†™å­ç±»çš„\n1 2 3 4 5 6 7 8 9 10 11 # UserDict # å®šåˆ¶åŒ–å­—å…¸æ—¶ï¼Œå°½é‡ç»§æ‰¿ UserDict è€Œä¸æ˜¯ dict from collections import UserDict class mydict(UserDict): def __getitem__(self, key): print('Getting key', key) return super().__getitem__(key) d = mydict({1:1}) print(d[1], d[2]) 1 2 3 4 5 6 7 8 9 10 11 12 13 # MyppingProxyType ç”¨äºæ„å»º Mapping çš„åªè¯»å®ä¾‹ from types import MappingProxyType d = {1: 1} d_proxy = MappingProxyType(d) print(d_proxy[1]) try: d_proxy[1] = 1 except Exception as e: print(repr(e)) d[1] = 2 print(d_proxy[1]) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # set çš„æ“ä½œ # å­é›† \u0026 çœŸå­é›† a, b = {1, 2}, {1, 2} print(a \u003c= b, a \u003c b) # discard a = {1, 2, 3} a.discard(3) print(a) # pop print(a.pop(), a.pop()) try: a.pop() except Exception as e: print(repr(e)) é›†åˆå­—é¢é‡ é™¤ç©ºé›†ä¹‹å¤–ï¼Œé›†åˆçš„å­—é¢é‡â€”â€”{1}ã€{1, 2}ï¼Œç­‰ç­‰â€”â€”çœ‹èµ·æ¥è·Ÿå®ƒçš„æ•°å­¦å½¢å¼ä¸€æ¨¡ä¸€æ ·ã€‚å¦‚æœæ˜¯ç©ºé›†ï¼Œé‚£ä¹ˆå¿…é¡»å†™æˆ set() çš„å½¢å¼ï¼Œå¦åˆ™å®ƒä¼šå˜æˆä¸€ä¸ª dict.\nè·Ÿ list ä¸€æ ·ï¼Œå­—é¢é‡å¥æ³•ä¼šæ¯” set æ„é€ æ–¹æ³•è¦æ›´å¿«ä¸”æ›´æ˜“è¯»ã€‚\né›†åˆå’Œå­—å…¸çš„å®ç° é›†åˆå’Œå­—å…¸é‡‡ç”¨æ•£åˆ—è¡¨æ¥å®ç°ï¼š\nå…ˆè®¡ç®— key çš„ hash, æ ¹æ® hash çš„æŸå‡ ä½ï¼ˆå–å†³äºæ•£åˆ—è¡¨çš„å¤§å°ï¼‰æ‰¾åˆ°å…ƒç´ åï¼Œå°†è¯¥å…ƒç´ ä¸ key è¿›è¡Œæ¯”è¾ƒ è‹¥ä¸¤å…ƒç´ ç›¸ç­‰ï¼Œåˆ™å‘½ä¸­ è‹¥ä¸¤å…ƒç´ ä¸ç­‰ï¼Œåˆ™å‘ç”Ÿæ•£åˆ—å†²çªï¼Œä½¿ç”¨çº¿æ€§æ¢æµ‹å†æ•£åˆ—æ³•è¿›è¡Œä¸‹ä¸€æ¬¡æŸ¥è¯¢ã€‚ è¿™æ ·å¯¼è‡´çš„åæœï¼š\nå¯æ•£åˆ—å¯¹è±¡å¿…é¡»æ”¯æŒ hash å‡½æ•°ï¼› å¿…é¡»æ”¯æŒ __eq__ åˆ¤æ–­ç›¸ç­‰æ€§ï¼› è‹¥ a == b, åˆ™å¿…é¡»æœ‰ hash(a) == hash(b)ã€‚ æ³¨ï¼šæ‰€æœ‰ç”±ç”¨æˆ·è‡ªå®šä¹‰çš„å¯¹è±¡éƒ½æ˜¯å¯æ•£åˆ—çš„ï¼Œå› ä¸ºä»–ä»¬çš„æ•£åˆ—å€¼ç”± id() æ¥è·å–ï¼Œè€Œä¸”å®ƒä»¬éƒ½æ˜¯ä¸ç›¸ç­‰çš„ã€‚\nå­—å…¸çš„ç©ºé—´å¼€é”€ ç”±äºå­—å…¸ä½¿ç”¨æ•£åˆ—è¡¨å®ç°ï¼Œæ‰€ä»¥å­—å…¸çš„ç©ºé—´æ•ˆç‡ä½ä¸‹ã€‚ä½¿ç”¨ tuple ä»£æ›¿ dict å¯ä»¥æœ‰æ•ˆé™ä½ç©ºé—´æ¶ˆè´¹ã€‚\nä¸è¿‡ï¼šå†…å­˜å¤ªä¾¿å®œäº†ï¼Œä¸åˆ°ä¸‡ä¸å¾—å·²ä¹Ÿä¸è¦å¼€å§‹è€ƒè™‘è¿™ç§ä¼˜åŒ–æ–¹å¼ï¼Œå› ä¸ºä¼˜åŒ–å¾€å¾€æ˜¯å¯ç»´æŠ¤æ€§çš„å¯¹ç«‹é¢ã€‚\nå¾€å­—å…¸ä¸­æ·»åŠ é”®æ—¶ï¼Œå¦‚æœæœ‰æ•£åˆ—è¡¨æ‰©å¼ çš„æƒ…å†µå‘ç”Ÿï¼Œåˆ™å·²æœ‰é”®çš„é¡ºåºä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ã€‚æ‰€ä»¥ï¼Œä¸åº”è¯¥åœ¨è¿­ä»£å­—å…¸çš„è¿‡ç¨‹å„ç§å¯¹å­—å…¸è¿›è¡Œæ›´æ”¹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 # å­—å…¸ä¸­å°±é”®çš„é¡ºåºå–å†³äºæ·»åŠ é¡ºåº keys = [1, 2, 3] dict_ = {} for key in keys: dict_[key] = None for key, dict_key in zip(keys, dict_): print(key, dict_key) assert key == dict_key # å­—å…¸ä¸­é”®çš„é¡ºåºä¸ä¼šå½±å“å­—å…¸æ¯”è¾ƒ ","description":"","tags":["python"],"title":"ã€Šæµç•…çš„Pythonã€‹ å­—å…¸å’Œé›†åˆ","uri":"/blog/posts/Python/Fluent-Python/fluent-python-dict-and-collections/"},{"categories":["Python","Fluent-Python"],"content":"\nä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œä¹‹å‰æåˆ°çš„å‡ ä¸ªæ“ä½œå¯ä»¥æ— å·®åˆ«åœ°åº”ç”¨äºæ–‡æœ¬ã€åˆ—è¡¨å’Œè¡¨æ ¼ä¸Šã€‚\næˆ‘ä»¬æŠŠæ–‡æœ¬ã€åˆ—è¡¨å’Œè¡¨æ ¼å«ä½œæ•°æ®ç«è½¦â€¦â€¦FOR å‘½ä»¤é€šå¸¸èƒ½ä½œç”¨äºæ•°æ®ç«è½¦ä¸Šã€‚\nâ€”â€”Geurtsã€Meertens å’Œ Pemberton\nABC Programmerâ€™s Handbook\nå†…ç½®åºåˆ—ç±»å‹æ¦‚è§ˆ å®¹å™¨åºåˆ—\nlistã€tuple å’Œ collections.deque è¿™äº›åºåˆ—èƒ½å­˜æ”¾ä¸åŒç±»å‹çš„æ•°æ®ã€‚ æ‰å¹³åºåˆ—\nstrã€bytesã€bytearrayã€memoryview å’Œ array.arrayï¼Œè¿™ç±»åºåˆ—åªèƒ½å®¹çº³ä¸€ç§ç±»å‹ã€‚ å®¹å™¨åºåˆ—å­˜æ”¾çš„æ˜¯å®ƒä»¬æ‰€åŒ…å«çš„ä»»æ„ç±»å‹çš„å¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œæ‰å¹³åºåˆ—é‡Œå­˜æ”¾çš„æ˜¯å€¼è€Œä¸æ˜¯å¼•ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œæ‰å¹³åºåˆ—å…¶å®æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ã€‚ç”±æ­¤å¯è§æ‰å¹³åºåˆ—å…¶å®æ›´åŠ ç´§å‡‘ï¼Œä½†æ˜¯å®ƒé‡Œé¢åªèƒ½å­˜æ”¾è¯¸å¦‚å­—ç¬¦ã€å­—èŠ‚å’Œæ•°å€¼è¿™ç§åŸºç¡€ç±»å‹ã€‚\nåºåˆ—ç±»å‹è¿˜èƒ½æŒ‰ç…§èƒ½å¦è¢«ä¿®æ”¹æ¥åˆ†ç±»ã€‚\nå¯å˜åºåˆ—\nlistã€bytearrayã€array.arrayã€collections.deque å’Œ memoryviewã€‚ ä¸å¯å˜åºåˆ—\ntupleã€str å’Œ bytes åˆ—è¡¨æ¨å¯¼å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼ åˆ—è¡¨æ¨å¯¼å’Œå¯è¯»æ€§ åˆ—è¡¨æ¨å¯¼æ˜¯æ„å»ºåˆ—è¡¨(list)çš„å¿«æ·æ–¹å¼ï¼Œç”Ÿæˆå™¨è¡¨è¾¾å¼ç”¨æ¥ç©¿ä»¶å…¶ä»–ä»»ä½•ç±»å‹çš„åºåˆ—ã€‚\n1 2 3 4 5 6 7 8 9 10 # æ¯”è¾ƒä¸¤æ®µä»£ç  symbols = 'abcde' # 1 codes = [] for symbol in symbols: codes.append(ord(symbol)) print(codes) # 2 codes = [ord(symbol) for symbol in symbols] print(codes) åˆ—è¡¨æ¨å¯¼èƒ½å¤Ÿæå‡å¯è¯»æ€§ã€‚ åªç”¨åˆ—è¡¨æ¨å¯¼æ¥åˆ›å»ºæ–°çš„åˆ—è¡¨ï¼Œå¹¶å°½é‡ä¿æŒç®€çŸ­ï¼ˆä¸è¦è¶…è¿‡ä¸€è¡Œï¼‰\nåˆ—è¡¨æ¨å¯¼åŒ filter å’Œ map çš„æ¯”è¾ƒ 1 2 3 4 5 6 7 symbols = 'abcde' beyond_ascii = [ord(s) for s in symbols if ord(s) \u003e 100] print(beyond_ascii) beyond_ascii = list(filter(lambda c: c \u003e 100, map(ord, symbols))) print(beyond_ascii) [101] [101] ç¬›å¡å°”ç§¯ 1 2 3 4 5 6 7 8 9 10 11 colors = ['black', 'white'] sizes = ['S', 'M', 'L'] tshirts = [(color, size) for color in colors for size in sizes] print(tshirts) tshirts = [(color, size) for size in sizes for color in colors] print(tshirts) # æ³¨æ„é¡ºåºæ˜¯ä¾ç…§ for-loop [('black', 'S'), ('black', 'M'), ('black', 'L'), ('white', 'S'), ('white', 'M'), ('white', 'L')] [('black', 'S'), ('white', 'S'), ('black', 'M'), ('white', 'M'), ('black', 'L'), ('white', 'L')] ç”Ÿæˆå™¨è¡¨è¾¾å¼ åˆ—è¡¨æ¨å¯¼ä¸ç”Ÿæˆå™¨è¡¨è¾¾å¼çš„åŒºåˆ«ï¼š\nç”Ÿæˆå™¨è¡¨è¾¾å¼éµå®ˆå®ç°äº†è¿­ä»£å™¨æ¥å£ï¼Œå¯ä»¥é€ä¸ªåœ°äº§å‡ºå…ƒç´ ã€‚åˆ—è¡¨æ¨å¯¼æ˜¯å…ˆå»ºç«‹ä¸€ä¸ªå®Œæ•´çš„åˆ—è¡¨ï¼Œå†å°†è¿™ä¸ªåˆ—è¡¨ä¼ é€’åˆ°æ„é€ å‡½æ•°é‡Œã€‚ è¯­æ³•ä¸Šè¿‘ä¼¼ï¼Œæ–¹æ‹¬å·æ¢æˆåœ†æ‹¬å· 1 2 3 4 5 # symbols = 'abcde' print(tuple(ord(symbol) for symbol in symbols)) import array print(array.array('I', (ord(symbol) for symbol in symbols))) å¦‚æœç”Ÿæˆå™¨è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­çš„å”¯ä¸€å‚æ•°ï¼Œåˆ™ä¸éœ€è¦é¢å¤–æ‹¬å· ç”Ÿæˆå™¨ä¼šåœ¨ for-loop è¿è¡Œæ—¶æ‰ç”Ÿæˆä¸€ä¸ªç»„åˆã€‚é€ä¸ªäº§å‡ºå…ƒç´  1 2 3 4 5 colors = ['black', 'white'] sizes = ['S', 'M', 'L'] for tshirt in ('%s %s' %(c, s) for c in colors for s in sizes): print(tshirt) black S black M black L white S white M white L å…ƒç¥–ä¸ä»…ä»…æ˜¯ä¸å¯å˜çš„åˆ—è¡¨ å…ƒç¥–ä¸è®°å½• å…ƒç¥–æ˜¯å¯¹æ•°æ®çš„è®°å½• å…ƒç¥–çš„ä½ç½®ä¿¡æ¯ä¸ºæ•°æ®èµ‹äºˆäº†æ„ä¹‰ã€‚å¯¹å…ƒç¥–å†…å…ƒç´ æ’åºï¼Œä½ç½®ä¿¡æ¯å°†ä¸¢å¤± 1 2 3 4 5 6 7 8 9 10 11 12 13 # LA å›½é™…æœºåœºç»çº¬åº¦ lax_coordinates = (33.9425, -118.408056) # åŸå¸‚ï¼Œå¹´ä»½ï¼Œäººå£ï¼ˆå•ä½ï¼šç™¾ä¸‡ï¼‰ï¼Œäººå£å˜åŒ–ï¼ˆå•ä½ï¼šç™¾åˆ†æ¯”ï¼‰ï¼Œé¢ç§¯ city, year, pop, chg, area = ('Tokyo', 2003, 32450, 0.66, 8014) # country_code, passport number traveler_ids = [('USA', '31195855'), ('BBA', 'CE342567'), ('ESP', 'XDA205856')] for passport in sorted(traveler_ids): print('%s%s' % passport) # æ‹†åŒ…ï¼ˆunpackingï¼‰ for country, _ in traveler_ids: print(country) BBACE342567 ESPXDA205856 USA31195855 USA BBA ESP å…ƒç¥–æ‹†åŒ… å¹³è¡Œèµ‹å€¼ 1 2 3 4 5 lax_coordinates = (33.9425, -118.408056) # å…ƒç¥–æ‹†åŒ… latitude, longtitude = lax_coordinates print(latitude) print(longtitude) 33.9425 -118.408056 äº¤æ¢å˜é‡å€¼ï¼Œä¸ä½¿ç”¨ä¸­é—´å˜é‡ 1 2 3 4 5 a = 3 b = 4 b, a = a, b print(a) print(b) 4 3 * è¿ç®—ç¬¦ï¼ŒæŠŠä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡æ‹†å¼€ä½œä¸ºå‡½æ•°å‚æ•° 1 2 3 4 5 6 7 8 divmod(20, 8) t = (20, 8) divmod(*t) quotient, remainder = divmod(*t) print(quotient) print(remainder) 2 4 å‡½æ•°ç”¨å…ƒç¥–å½¢å¼è¿”å›å¤šä¸ªå€¼ _ ç”¨ä½œå ä½ç¬¦ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†ä¸éœ€è¦çš„æ•°æ®\n1 2 3 4 import os _, filename = os.path.split('/home/xiao/.ssh/id_rsa.pub') print(filename) id_rsa.pub ç”¨* å¤„ç†çœä¸‹çš„å…ƒç´  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 a, b, *rest = range(5) print(a, b, rest) a, b, *rest = range(3) print(a, b, rest) a, b, *rest = range(2) print(a, b, rest) # * å‰ç¼€åªèƒ½ç”¨åœ¨ä¸€ä¸ªå˜é‡å‰ï¼Œè¯¥å˜é‡å¯å‡ºç°åœ¨èµ‹å€¼è¡¨è¾¾å¼ä¸­ä»»æ„ä½ç½® a, *body, c, d = range(5) print(a, body, c, d) *head, b, c, d = range(5) print(head, b, c, d) 0 1 [2, 3, 4] 0 1 [2] 0 1 [] 0 [1, 2] 3 4 [0, 1] 2 3 4 åµŒå¥—å…ƒç¥–æ‹†åŒ… 1 2 3 4 5 6 7 8 9 10 11 12 13 metro_areas = [ ('Tokyo', 'JP', 36.933, (35.689722, 139.691667)), # \u003c1\u003e ('Delhi NCR', 'IN', 21.935, (28.613889, 77.208889)), ('Mexico City', 'MX', 20.142, (19.433333, -99.133333)), ('New York-Newark', 'US', 20.104, (40.808611, -74.020386)), ('Sao Paulo', 'BR', 19.649, (-23.547778, -46.635833)), ] print('{:15} | {:^9} | {:^9}'.format('', 'lat.', 'long.')) fmt = '{:15} | {:9.4f} | {:9.4f}' for name, cc, pop, (latitude, longitude) in metro_areas: # \u003c2\u003e if longitude \u003c= 0: # \u003c3\u003e print(fmt.format(name, latitude, longitude)) | lat. | long. Mexico City | 19.4333 | -99.1333 New York-Newark | 40.8086 | -74.0204 Sao Paulo | -23.5478 | -46.6358 å°†å…ƒç¥–ä½œä¸ºè®°å½•ä»ç¼ºå°‘ä¸€ä¸ªåŠŸèƒ½ï¼šå­—æ®µå‘½å\nå…·åå…ƒç¥–(numedtuple) collections.namedtuple æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œç”¨æ¥æ„å»ºå¸¦å­—æ®µåçš„å…ƒç¥–å’Œä¸€ä¸ªæœ‰åå­—çš„\nnamedtuple æ„å»ºçš„ç±»çš„å®ä¾‹æ‰€æ¶ˆè€—çš„å†…å­˜å’Œå…ƒç¥–æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºå­—æ®µåéƒ½å­˜åœ¨å¯¹åº”çš„ç±»é‡Œã€‚ å®ä¾‹å’Œæ™®é€šçš„å¯¹è±¡å®ä¾‹å°ä¸€ç‚¹ï¼Œå› ä¸º Python ä¸ä¼šç”¨ __dict__ å­˜æ”¾å®ä¾‹çš„å±æ€§\n1 2 3 4 5 6 7 8 from collections import namedtuple # éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œç±»åå’Œç±»å„ä¸ªå­—æ®µçš„åå­— City = namedtuple('City', 'name country population coordinates') tokyo = City('Tokyo', 'JP', 36.933, (35.689722, 129.691667)) print(tokyo) print(tokyo.population) print(tokyo.coordinates) City(name='Tokyo', country='JP', population=36.933, coordinates=(35.689722, 129.691667)) 36.933 (35.689722, 129.691667) namedtuple é™¤äº†ä»æ™®é€šå…ƒç¥–ç»§æ‰¿çš„å±æ€§å¤–ï¼Œè¿˜æœ‰ä¸€äº›ä¸“æœ‰å±æ€§ã€‚ å¸¸ç”¨çš„æœ‰ï¼š\n_fields ç±»å±æ€§ _make(iterable) ç±»æ–¹æ³• _asdict() å®ä¾‹æ–¹æ³• 1 2 3 4 5 6 7 8 print(City._fields) LatLong = namedtuple('LatLong', 'lat long') delhi_data = ('Delhi NCR', 'IN', 21.935, LatLong(28.613889, 77.208889)) delhi = City._make(delhi_data) print(delhi._asdict()) for key, value in delhi._asdict().items(): print(key + ':', value) ('name', 'country', 'population', 'coordinates') OrderedDict([('name', 'Delhi NCR'), ('country', 'IN'), ('population', 21.935), ('coordinates', LatLong(lat=28.613889, long=77.208889))]) name: Delhi NCR country: IN population: 21.935 coordinates: LatLong(lat=28.613889, long=77.208889) ä½œä¸ºä¸å¯å˜åˆ—è¡¨çš„å…ƒç¥– å¯¹æ¯”åˆ—è¡¨å’Œå…ƒç¥–çš„æ–¹æ³• // æ’å…¥è¡¨æ ¼\nç»“è®ºï¼š\né™¤äº†å¢å‡å…ƒç´ ç›¸å…³çš„æ–¹æ³•å’Œ__reversed__ å¤–ï¼Œå…ƒç¥–æ”¯æŒåˆ—è¡¨çš„å…¶ä»–æ‰€æœ‰æ–¹æ³•ã€‚ åˆ‡ç‰‡ åœ¨ Python é‡Œ, åˆ—è¡¨ï¼ˆlistï¼‰ï¼Œå…ƒç¥–ï¼ˆtupleï¼‰å’Œå­—ç¬¦ä¸²ï¼ˆstrï¼‰è¿™ç±»åºåˆ—ç±»å‹éƒ½æ”¯æŒåˆ‡ç‰‡æ“ä½œ\nä¸ºä»€ä¹ˆåˆ‡ç‰‡çš„åŒºé—´ä¼šå¿½ç•¥æœ€åä¸€ä¸ªå…ƒç´  Python ä»¥0 ä½œä¸ºèµ·å§‹ä¸‹æ ‡ å½“åªæœ‰åä¸€ä¸ªä½ç½®ä¿¡æ¯æ—¶ï¼Œå¯ä»¥å¿«é€Ÿå¯¼å‡ºåˆ‡ç‰‡å’ŒåŒºé—´çš„å…ƒç´ æ•°é‡ å½“èµ·æ­¢ä½ç½®ä¿¡æ¯è¯¾ä»¶æ˜¯ï¼Œå¯ä»¥å¿«é€Ÿè®¡ç®—å‡ºåˆ‡ç‰‡å’ŒåŒºé—´çš„é•¿åº¦ ï¼ˆstop - startï¼‰ å¯åˆ©ç”¨ä»»æ„ä¸€ä¸ªä¸‹æ ‡æŠŠåºåˆ—åˆ†å‰²æˆä¸é‡å çš„ä¸¤éƒ¨åˆ†ã€‚my_list[:x] my_list[x:] 1 2 3 ### å¯¹å¯¹è±¡è¿›è¡Œåˆ‡ç‰‡ - å¯ä»¥é€šè¿‡ s[ağŸ…±ï¸c] çš„å½¢å¼å¯¹ s åœ¨ a å’Œ b åŒºé—´ä»¥ c ä¸ºé—´éš”å–å€¼ 1 2 3 4 s = 'bicycle' print(s[::3]) print(s[::-1]) print(s[::-2]) bye elcycib eccb å¤šç»´åˆ‡ç‰‡å’Œçœç•¥ [] è¿ç®—ç¬¦å¯ä»¥ä½¿ç”¨ä»¥é€—å·åˆ†å¼€çš„å¤šä¸ªç´¢å¼•æˆ–åˆ‡ç‰‡ã€‚\nå¦‚ a[i, j]ï¼Œa[m:n, k:1]å¾—åˆ°äºŒç»´åˆ‡ç‰‡\nè¦æ­£ç¡®å¤„ç†[] è¿ç®—ç¬¦ï¼Œå¯¹è±¡çš„ç‰¹æ®Šæ–¹æ³• __getitem__ï¼Œ__setitem__ éœ€è¦ä»¥å…ƒç¥–çš„å½¢å¼æ¥æ¥å— a[i, j]çš„ç´¢å¼•ã€‚\nç»™åˆ‡ç‰‡èµ‹å€¼ åˆ‡ç‰‡æ”¾åœ¨èµ‹å€¼è¯­å¥å·¦è¾¹ï¼Œæˆ–ä½œä¸º del æ“ä½œå¯¹è±¡ï¼Œå¯ä»¥å¯¹åºåˆ—è¿›è¡Œå«æ¥ã€åˆ‡é™¤æˆ–å°±åœ°ä¿®æ”¹\n1 2 3 4 5 6 7 8 9 10 11 12 13 l = list(range(10)) print(l) l[2:5] = [20, 30] print(l) del l[5:7] print(l) l[3::2] = [11, 22] print(l) # l[2:5] = 100 WRONG [0, 1, 2, 3, 4, 5, 6, 7, 8, 9] [0, 1, 20, 30, 5, 6, 7, 8, 9] [0, 1, 20, 30, 5, 8, 9] [0, 1, 20, 11, 5, 22, 9] å¯¹åºåˆ—ä½¿ç”¨ + å’Œ * + å’Œ * ä¸ä¿®æ”¹åŸæœ‰çš„æ“ä½œå¯¹è±¡ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªæ–°çš„åºåˆ— 1 2 3 4 l = [1, 2, 3] print(l * 5) print(5 * 'abcd') [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3] abcdabcdabcdabcdabcd å»ºç«‹ç”±åˆ—è¡¨ç»„æˆçš„åˆ—è¡¨ a * nï¼Œå¦‚æœåœ¨åºåˆ— a ä¸­å­˜åœ¨å¯¹å…¶ä»–å¯å˜å˜é‡çš„å¼•ç”¨çš„è¯ï¼Œå¾—åˆ°çš„åºåˆ—ä¸­åŒ…å«çš„æ˜¯ n ä¸ªå¯¹æŒ‡å‘åŒä¸€åœ°å€çš„å¼•ç”¨\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 board = [['_'] * 3 for i in range(3)] # æ¢ä¸€ç§å½¢å¼ # board = [] # for i in range(3): # row = ['_'] * 3 # board.append(row) print(board) board[1][2] = 'X' print(board) # weird_board = [['_'] * 3] * 3 # æ¢ä¸€ç§å½¢å¼ weird_board = [] row = ['_'] * 3 for i in range(3): weird_board.append(row) weird_board[1][2] = 'O' # ä¼šå‘ç° 3 ä¸ªæŒ‡å‘åŒä¸€åˆ—è¡¨çš„å¼•ç”¨ print(weird_board) [['_', '_', '_'], ['_', '_', '_'], ['_', '_', '_']] [['_', '_', '_'], ['_', '_', 'X'], ['_', '_', '_']] [['_', '_', 'O'], ['_', '_', 'O'], ['_', '_', 'O']] åºåˆ—çš„å¢é‡èµ‹å€¼ +=ã€*= += èƒŒåçš„ç‰¹æ®Šæ–¹æ³•æ˜¯ __iadd__ æ–¹æ³•ï¼Œæ²¡æœ‰åˆ™é€€ä¸€æ­¥è°ƒç”¨ __add__ åŒç† *= çš„ç‰¹æ®Šæ–¹æ³•æ˜¯ __imul__ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 l = [1, 2, 3] print(id(l)) l *= 2 print(l) # åˆ—è¡¨ID æ— æ”¹å˜ print(id(l)) t = (1, 2, 3) print(id(t)) t *= 2 print(t) # æ–°å…ƒç¥–è¢«åˆ›å»º print(id(t)) 4534358344 [1, 2, 3, 1, 2, 3] 4534358344 4536971408 (1, 2, 3, 1, 2, 3) 4546754024 list.sortæ–¹æ³•å’Œå†…ç½®å‡½æ•°sorted list.sort ä¼šå°±åœ°æ’åºåˆ—è¡¨ï¼Œæ–¹æ³•è¿”å›å€¼ä¸º None sorted ä¼šæ–°å»ºä¸€ä¸ªåˆ—è¡¨ä½œä¸ºè¿”å›å€¼ ä¸¤ä¸ªæ–¹æ³•éƒ½æœ‰ reverse å’Œ key ä½œä¸ºå¯é€‰çš„å…³é”®å­—å‚æ•° reserve ä¸º True æ—¶ï¼Œé™åºè¾“å‡ºã€‚é»˜è®¤ä¸º false key åªæœ‰ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå°†è¢«ç”¨åœ¨åºåˆ—çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œå…¶ç»“æœä½œä¸ºæ’åºç®—æ³•ä¾èµ–çš„å¯¹æ¯”å…³é”®å­— ç”¨bisectç®¡ç†å·²æ’åºçš„åºåˆ— bisect æ¨¡å—æœ‰ä¸¤ä¸ªä¸»è¦å‡½æ•°ï¼š\nbisect insort éƒ½åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ³•æ¥åœ¨æœ‰åºåºåˆ—ä¸­æŸ¥æ‰¾æˆ–æ’å…¥äººå…ƒç´  ç”¨ bisect æ¥æœç´¢ bisect(haystack, needle) é»˜è®¤ä¸ºå‡åºï¼Œhaystack éœ€è¦ä¿æŒæœ‰åºã€‚ ä½¿ç”¨æ–¹æ³•ï¼š bisect(index, needle) æŸ¥æ‰¾ä½ç½® indexï¼Œå†ä½¿ç”¨ haystack.insert(index, needle) æ’å…¥æ–°å€¼\nä¹Ÿå¯ä»¥ç”¨ insort æ¥ä¸€æ­¥åˆ°ä½ï¼Œä¸”åè€…é€Ÿåº¦æ›´å¿«\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # BEGIN BISECT_DEMO import bisect import sys HAYSTACK = [1, 4, 5, 6, 8, 12, 15, 20, 21, 23, 23, 26, 29, 30] NEEDLES = [0, 1, 2, 5, 8, 10, 22, 23, 29, 30, 31] ROW_FMT = '{0:2d} @ {1:2d} {2}{0:\u003c2d}' def demo(bisect_fn): for needle in reversed(NEEDLES): position = bisect_fn(HAYSTACK, needle) # \u003c1\u003e offset = position * ' |' # \u003c2\u003e print(ROW_FMT.format(needle, position, offset)) # \u003c3\u003e if __name__ == '__main__': if sys.argv[-1] == 'left': # \u003c4\u003e bisect_fn = bisect.bisect_left else: bisect_fn = bisect.bisect print('DEMO:', bisect_fn.__name__) # \u003c5\u003e print('haystack -\u003e', ' '.join('%2d' % n for n in HAYSTACK)) demo(bisect_fn) # END BISECT_DEMO DEMO: bisect_right haystack -\u003e 1 4 5 6 8 12 15 20 21 23 23 26 29 30 31 @ 14 | | | | | | | | | | | | | |31 30 @ 14 | | | | | | | | | | | | | |30 29 @ 13 | | | | | | | | | | | | |29 23 @ 11 | | | | | | | | | | |23 22 @ 9 | | | | | | | | |22 10 @ 5 | | | | |10 8 @ 5 | | | | |8 5 @ 3 | | |5 2 @ 1 |2 1 @ 1 |1 0 @ 0 0 Array è™½ç„¶åˆ—è¡¨æ—¢çµæ´»åˆç®€å•ï¼Œä½†é¢å¯¹å„ç±»éœ€æ±‚æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰æ›´å¥½çš„é€‰æ‹©ã€‚æ¯”å¦‚ï¼Œè¦å­˜æ”¾ 1000 ä¸‡ä¸ªæµ®ç‚¹æ•°çš„è¯ï¼Œæ•°ç»„ï¼ˆarrayï¼‰çš„æ•ˆç‡è¦é«˜å¾—å¤šï¼Œå› ä¸ºæ•°ç»„åœ¨èƒŒåå­˜çš„å¹¶ä¸æ˜¯ float å¯¹è±¡ï¼Œè€Œæ˜¯æ•°å­—çš„æœºå™¨ç¿»è¯‘ï¼Œä¹Ÿå°±æ˜¯å­—èŠ‚è¡¨è¿°ã€‚è¿™ä¸€ç‚¹å°±è·Ÿ C è¯­è¨€ä¸­çš„æ•°ç»„ä¸€æ ·ã€‚å†æ¯”å¦‚è¯´ï¼Œå¦‚æœéœ€è¦é¢‘ç¹å¯¹åºåˆ—åšå…ˆè¿›å…ˆå‡ºçš„æ“ä½œï¼Œdequeï¼ˆåŒç«¯é˜Ÿåˆ—ï¼‰çš„é€Ÿåº¦åº”è¯¥ä¼šæ›´å¿«ã€‚\narray.tofile å’Œ fromfile å¯ä»¥å°†æ•°ç»„ä»¥äºŒè¿›åˆ¶æ ¼å¼å†™å…¥æ–‡ä»¶ï¼Œé€Ÿåº¦è¦æ¯”å†™å…¥æ–‡æœ¬æ–‡ä»¶å¿«å¾ˆå¤šï¼Œæ–‡ä»¶çš„ä½“ç§¯ä¹Ÿå°ã€‚\nå¦å¤–ä¸€ä¸ªå¿«é€Ÿåºåˆ—åŒ–æ•°å­—ç±»å‹çš„æ–¹æ³•æ˜¯ä½¿ç”¨ pickleï¼ˆhttps://docs.python.org/3/library/pickle.htmlï¼‰æ¨¡å—ã€‚pickle.dump å¤„ç†æµ®ç‚¹æ•°ç»„çš„é€Ÿåº¦å‡ ä¹è·Ÿarray.tofile ä¸€æ ·å¿«ã€‚ä¸è¿‡å‰è€…å¯ä»¥å¤„ç†å‡ ä¹æ‰€æœ‰çš„å†…ç½®æ•°å­—ç±»å‹ï¼ŒåŒ…å«å¤æ•°ã€åµŒå¥—é›†åˆï¼Œç”šè‡³ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»ã€‚å‰ææ˜¯è¿™äº›ç±»æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«å¤æ‚çš„å®ç°ã€‚\narray å…·æœ‰ type code æ¥è¡¨ç¤ºæ•°ç»„ç±»å‹ï¼šå…·ä½“å¯è§ array æ–‡æ¡£.\nmemoryview memoryview.cast çš„æ¦‚å¿µè·Ÿæ•°ç»„æ¨¡å—ç±»ä¼¼ï¼Œèƒ½ç”¨ä¸åŒçš„æ–¹å¼è¯»å†™åŒä¸€å—å†…å­˜æ•°æ®ï¼Œè€Œä¸”å†…å®¹å­—èŠ‚ä¸ä¼šéšæ„ç§»åŠ¨ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 import array arr = array.array('h', [1, 2, 3]) memv_arr = memoryview(arr) # æŠŠ signed short çš„å†…å­˜ä½¿ç”¨ char æ¥å‘ˆç° memv_char = memv_arr.cast('B') print('Short', memv_arr.tolist()) print('Char', memv_char.tolist()) memv_char[1] = 2 # æ›´æ”¹ array ç¬¬ä¸€ä¸ªæ•°çš„é«˜ä½å­—èŠ‚ # 0x1000000001 print(memv_arr.tolist(), arr) print('-' * 10) bytestr = b'123' # bytes æ˜¯ä¸å…è®¸æ›´æ”¹çš„ try: bytestr[1] = '3' except TypeError as e: print(repr(e)) memv_byte = memoryview(bytestr) print('Memv_byte', memv_byte.tolist()) # åŒæ ·è¿™å—å†…å­˜ä¹Ÿæ˜¯åªè¯»çš„ try: memv_byte[1] = 1 except TypeError as e: print(repr(e)) Deque collections.deque æ˜¯æ¯” list æ•ˆç‡æ›´é«˜ï¼Œä¸”çº¿ç¨‹å®‰å…¨çš„åŒå‘é˜Ÿåˆ—å®ç°ã€‚\né™¤äº† collections ä»¥å¤–ï¼Œä»¥ä¸‹ Python æ ‡å‡†åº“ä¹Ÿæœ‰å¯¹é˜Ÿåˆ—çš„å®ç°ï¼š\nqueue.Queue (å¯ç”¨äºçº¿ç¨‹é—´é€šä¿¡) multiprocessing.Queue (å¯ç”¨äºè¿›ç¨‹é—´é€šä¿¡) asyncio.Queue heapq ","description":"","tags":["python"],"title":"ã€Šæµç•…çš„Pythonã€‹ åºåˆ—æ„æˆçš„æ•°ç»„","uri":"/blog/posts/Python/Fluent-Python/fluent-python-array-of-sequences/"},{"categories":null,"content":"Markdown è¯­æ³•æ€»ç»“ æ–œä½“å’Œç²—ä½“ 1 2 3 4 *æ–œä½“*æˆ–_æ–œä½“_ **ç²—ä½“** ***åŠ ç²—æ–œä½“*** ~~åˆ é™¤çº¿~~ æ–œä½“æˆ–_æ–œä½“_\nç²—ä½“\nåŠ ç²—æ–œä½“\nåˆ é™¤çº¿\nåˆ†çº§æ ‡é¢˜ 1 2 3 4 5 6 # ä¸€çº§æ ‡é¢˜ ## äºŒçº§æ ‡é¢˜ ###ä¸‰çº§æ ‡é¢˜ ### å››çº§æ ‡é¢˜ #### äº”çº§æ ‡é¢˜ ##### å…­çº§æ ‡é¢˜ ä¸€çº§æ ‡é¢˜å­—å·æœ€å¤§ï¼Œä¾çº§é€’å‡ã€‚\nè¶…é“¾æ¥ Markdown æ”¯æŒä¸¤ç§å½¢å¼çš„é“¾æ¥è¯­æ³•ï¼š è¡Œå†…å¼å’Œå‚è€ƒå¼ä¸¤ç§å½¢å¼ï¼Œè¡Œå†…å¼ä¸€èˆ¬ä½¿ç”¨è¾ƒå¤šã€‚\nè¡Œå†…å¼ è¯­æ³•è¯´æ˜ï¼š[æ–‡å­—](é“¾æ¥)\n[]é‡Œå†™é“¾æ¥æ–‡å­—ï¼Œ()é‡Œå†™é“¾æ¥åœ°å€, ()ä¸­çš„â€œâ€ä¸­å¯ä»¥ä¸ºé“¾æ¥æŒ‡å®štitleå±æ€§ï¼Œtitleå±æ€§å¯åŠ å¯ä¸åŠ ã€‚titleå±æ€§çš„æ•ˆæœæ˜¯é¼ æ ‡æ‚¬åœåœ¨é“¾æ¥ä¸Šä¼šå‡ºç°æŒ‡å®šçš„ titleæ–‡å­—ã€‚é“¾æ¥åœ°å€ä¸é“¾æ¥æ ‡é¢˜å‰æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚\n1 2 3 æ¬¢è¿æ¥åˆ°[Django](https://docs.djangoproject.com/zh-hans/3.0/) æ¬¢è¿æ¥åˆ°[Django](https://docs.djangoproject.com/zh-hans/3.0/ â€œDjangoâ€) æ¬¢è¿æ¥åˆ°Django\næ¬¢è¿æ¥åˆ°Django\nå‚è€ƒå¼ å‚è€ƒå¼è¶…é“¾æ¥ä¸€èˆ¬ç”¨åœ¨å­¦æœ¯è®ºæ–‡ä¸Šé¢ï¼Œæˆ–è€…å¦ä¸€ç§æƒ…å†µï¼Œå¦‚æœæŸä¸€ä¸ªé“¾æ¥åœ¨æ–‡ç« ä¸­å¤šå¤„ä½¿ç”¨ï¼Œé‚£ä¹ˆä½¿ç”¨å¼•ç”¨ çš„æ–¹å¼åˆ›å»ºé“¾æ¥å°†éå¸¸å¥½ï¼Œå®ƒå¯ä»¥è®©ä½ å¯¹é“¾æ¥è¿›è¡Œç»Ÿä¸€çš„ç®¡ç†ã€‚\nè¯­æ³•è¯´æ˜ï¼š [æ–‡å­—][é“¾æ¥æ–‡å­—] å‚è€ƒå¼é“¾æ¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œæ–‡ä¸­çš„å†™æ³• [é“¾æ¥æ–‡å­—][é“¾æ¥æ ‡è®°]ï¼Œåœ¨æ–‡æœ¬çš„ä»»æ„ä½ç½®æ·»åŠ [é“¾æ¥æ ‡è®°]:é“¾æ¥åœ°å€ â€œé“¾æ¥æ ‡é¢˜â€ï¼Œé“¾æ¥åœ°å€ä¸é“¾æ¥æ ‡é¢˜å‰æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚\nå¦‚æœé“¾æ¥æ–‡å­—æœ¬èº«å¯ä»¥åšä¸ºé“¾æ¥æ ‡è®°ï¼Œä½ ä¹Ÿå¯ä»¥å†™æˆ[é“¾æ¥æ–‡å­—][] [é“¾æ¥æ–‡å­—]ï¼šé“¾æ¥åœ°å€çš„å½¢å¼ï¼Œè§ä»£ç çš„æœ€åä¸€è¡Œã€‚\n1 2 3 4 5 æˆ‘ç»å¸¸å»çš„å‡ ä¸ªç½‘ç«™[Google][1],[æŠ€æœ¯åšå®¢1][2],[æŠ€æœ¯åšå®¢2][]ã€‚ [1]:http://www.google.com [2]:https://yuechuanx.top \"æŠ€æœ¯åšå®¢\" [æŠ€æœ¯åšå®¢]:https://yuechuanx.top/ æˆ‘ç»å¸¸å»çš„å‡ ä¸ªç½‘ç«™Google,Demiçš„éšç¬”å’ŒæŠ€æœ¯ç©ºé—´,[Demiçš„éšç¬”å’ŒæŠ€æœ¯ç©ºé—´][]ã€‚\næˆ‘ç»å¸¸å»çš„å‡ ä¸ªç½‘ç«™Google,æŠ€æœ¯åšå®¢1,[æŠ€æœ¯åšå®¢2][]ã€‚\nè‡ªåŠ¨é“¾æ¥ è¯­æ³•è¯´æ˜ï¼š Markdown æ”¯æŒä»¥æ¯”è¾ƒç®€çŸ­çš„è‡ªåŠ¨é“¾æ¥å½¢å¼æ¥å¤„ç†ç½‘å€å’Œç”µå­é‚®ä»¶ä¿¡ç®±ï¼Œåªè¦æ˜¯ç”¨\u003c\u003eåŒ…èµ·æ¥ï¼Œ Markdown å°±ä¼šè‡ªåŠ¨æŠŠå®ƒè½¬æˆé“¾æ¥ã€‚ä¸€èˆ¬ç½‘å€çš„é“¾æ¥æ–‡å­—å°±å’Œé“¾æ¥åœ°å€ä¸€æ ·ï¼Œä¾‹å¦‚ï¼š\n1 2 \u003chttp://example.com/\u003e \u003caddress@example.com\u003e http://example.com/ address@example.com\né”šç‚¹ ç½‘é¡µä¸­ï¼Œé”šç‚¹å…¶å®å°±æ˜¯é¡µå†…è¶…é“¾æ¥ï¼Œä¹Ÿå°±æ˜¯é“¾æ¥æœ¬æ–‡æ¡£å†…éƒ¨çš„æŸäº›å…ƒç´ ï¼Œå®ç°å½“å‰é¡µé¢ä¸­çš„è·³è½¬ã€‚æ¯”å¦‚æˆ‘è¿™é‡Œå†™ä¸‹ä¸€ä¸ªé”šç‚¹ï¼Œç‚¹å‡»å›åˆ°ç›®å½•ï¼Œå°±èƒ½è·³è½¬åˆ°ç›®å½•ã€‚ åœ¨ç›®å½•ä¸­ç‚¹å‡»è¿™ä¸€èŠ‚ï¼Œå°±èƒ½è·³è¿‡æ¥ã€‚è¿˜æœ‰ä¸‹ä¸€èŠ‚çš„æ³¨è„šã€‚è¿™äº›æ ¹æœ¬ä¸Šéƒ½æ˜¯ç”¨é”šç‚¹æ¥å®ç°çš„ã€‚\næ³¨æ„ï¼š\nMarkdown Extra åªæ”¯æŒåœ¨æ ‡é¢˜åæ’å…¥é”šç‚¹ï¼Œå…¶å®ƒåœ°æ–¹æ— æ•ˆã€‚ Leanote ç¼–è¾‘å™¨å³ä¾§æ˜¾ç¤ºæ•ˆæœåŒºåŸŸæš‚æ—¶ä¸æ”¯æŒé”šç‚¹è·³è½¬ï¼Œæ‰€ä»¥ç‚¹æ¥ç‚¹å»å‘ç°æ²¡æœ‰è·³è½¬ä¸å¿…æƒŠæ…Œï¼Œä½†æ˜¯ä½ å‘å¸ƒæˆç¬”è®°æˆ–åšæ–‡åæ˜¯æ”¯æŒè·³è½¬çš„ã€‚ 1 2 3 ## è·³è½¬æµ‹è¯•{#index} è·³è½¬åˆ°[è·³è½¬æµ‹è¯•](#index) åˆ—è¡¨ æ— åºåˆ—è¡¨ ä½¿ç”¨ *ï¼Œ+ï¼Œ- è¡¨ç¤ºæ— åºåˆ—è¡¨ã€‚\n1 2 3 - æ— åºåˆ—è¡¨é¡¹ ä¸€ - æ— åºåˆ—è¡¨é¡¹ äºŒ - æ— åºåˆ—è¡¨é¡¹ ä¸‰ æ— åºåˆ—è¡¨é¡¹ ä¸€ æ— åºåˆ—è¡¨é¡¹ äºŒ æ— åºåˆ—è¡¨é¡¹ ä¸‰ æœ‰åºåˆ—è¡¨ æœ‰åºåˆ—è¡¨åˆ™ä½¿ç”¨æ•°å­—æ¥ç€ä¸€ä¸ªè‹±æ–‡å¥ç‚¹ã€‚\n1 2 3 1. æœ‰åºåˆ—è¡¨é¡¹ ä¸€ 2. æœ‰åºåˆ—è¡¨é¡¹ äºŒ 3. æœ‰åºåˆ—è¡¨é¡¹ ä¸‰ æœ‰åºåˆ—è¡¨é¡¹ ä¸€ æœ‰åºåˆ—è¡¨é¡¹ äºŒ æœ‰åºåˆ—è¡¨é¡¹ ä¸‰ å®šä¹‰å‹åˆ—è¡¨ è¯­æ³•è¯´æ˜ï¼š\nå®šä¹‰å‹åˆ—è¡¨ç”±åè¯å’Œè§£é‡Šç»„æˆã€‚ä¸€è¡Œå†™ä¸Šå®šä¹‰ï¼Œç´§è·Ÿä¸€è¡Œå†™ä¸Šè§£é‡Šã€‚è§£é‡Šçš„å†™æ³•:ç´§è·Ÿä¸€ä¸ªç¼©è¿›(Tab)\n1 2 3 4 5 6 7 ä»£ç å— 1 Markdown : è½»é‡çº§æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œå¯ä»¥è½¬æ¢æˆhtmlï¼Œpdfç­‰æ ¼å¼ï¼ˆå·¦ä¾§æœ‰ä¸€ä¸ªå¯è§çš„å†’å·å’Œå››ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ ä»£ç å— 2 : è¿™æ˜¯ä»£ç å—çš„å®šä¹‰ï¼ˆå·¦ä¾§æœ‰ä¸€ä¸ªå¯è§çš„å†’å·å’Œå››ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ ä»£ç å—ï¼ˆå·¦ä¾§æœ‰å…«ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ view\nä»£ç å— 1 Markdown è½»é‡çº§æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œå¯ä»¥è½¬æ¢æˆhtmlï¼Œpdfç­‰æ ¼å¼ï¼ˆå·¦ä¾§æœ‰ä¸€ä¸ªå¯è§çš„å†’å·å’Œå››ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ ä»£ç å— 2 è¿™æ˜¯ä»£ç å—çš„å®šä¹‰ï¼ˆå·¦ä¾§æœ‰ä¸€ä¸ªå¯è§çš„å†’å·å’Œå››ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ ä»£ç å—ï¼ˆå·¦ä¾§æœ‰å…«ä¸ªä¸å¯è§çš„ç©ºæ ¼ï¼‰ åˆ—è¡¨ç¼©è¿› è¯­æ³•è¯´æ˜ï¼š\nåˆ—è¡¨é¡¹ç›®æ ‡è®°é€šå¸¸æ˜¯æ”¾åœ¨æœ€å·¦è¾¹ï¼Œä½†æ˜¯å…¶å®ä¹Ÿå¯ä»¥ç¼©è¿›ï¼Œæœ€å¤š 3 ä¸ªç©ºæ ¼ï¼Œé¡¹ç›®æ ‡è®°åé¢åˆ™ä¸€å®šè¦æ¥ç€è‡³å°‘ä¸€ä¸ªç©ºæ ¼æˆ–åˆ¶è¡¨ç¬¦ã€‚\n1 2 3 4 5 6 7 * è½»è½»çš„æˆ‘èµ°äº†ï¼Œ æ­£å¦‚æˆ‘è½»è½»çš„æ¥ï¼› æˆ‘è½»è½»çš„æ‹›æ‰‹ï¼Œ ä½œåˆ«è¥¿å¤©çš„äº‘å½©ã€‚ é‚£æ²³ç•”çš„é‡‘æŸ³ï¼Œ æ˜¯å¤•é˜³ä¸­çš„æ–°å¨˜ï¼› æ³¢å…‰é‡Œçš„è‰³å½±ï¼Œ åœ¨æˆ‘çš„å¿ƒå¤´è¡æ¼¾ã€‚ è½¯æ³¥ä¸Šçš„é’è‡ï¼Œ æ²¹æ²¹çš„åœ¨æ°´åº•æ‹›æ‘‡ï¼› åœ¨åº·æ²³çš„æŸ”æ³¢é‡Œï¼Œ æˆ‘ç”˜å¿ƒåšä¸€æ¡æ°´è‰ï¼ * é‚£æ¦†è«ä¸‹çš„ä¸€æ½­ï¼Œ ä¸æ˜¯æ¸…æ³‰ï¼Œ æ˜¯å¤©ä¸Šè™¹ï¼› æ‰ç¢åœ¨æµ®è—»é—´ï¼Œ æ²‰æ·€ç€å½©è™¹ä¼¼çš„æ¢¦ã€‚ å¯»æ¢¦ï¼Ÿæ’‘ä¸€æ”¯é•¿ç¯™ï¼Œ å‘é’è‰æ›´é’å¤„æ¼«æº¯ï¼› æ»¡è½½ä¸€èˆ¹æ˜Ÿè¾‰ï¼Œ åœ¨æ˜Ÿè¾‰æ–‘æ–“é‡Œæ”¾æ­Œã€‚ ä½†æˆ‘ä¸èƒ½æ”¾æ­Œï¼Œ æ‚„æ‚„æ˜¯åˆ«ç¦»çš„ç¬™ç®«ï¼› å¤è™«ä¹Ÿä¸ºæˆ‘æ²‰é»˜ï¼Œ æ²‰é»˜æ˜¯ä»Šæ™šçš„åº·æ¡¥ï¼ æ‚„æ‚„çš„æˆ‘èµ°äº†ï¼Œ æ­£å¦‚æˆ‘æ‚„æ‚„çš„æ¥ï¼› æˆ‘æŒ¥ä¸€æŒ¥è¡£è¢–ï¼Œ ä¸å¸¦èµ°ä¸€ç‰‡äº‘å½©ã€‚ view\nè½»è½»çš„æˆ‘èµ°äº†ï¼Œ æ­£å¦‚æˆ‘è½»è½»çš„æ¥ï¼› æˆ‘è½»è½»çš„æ‹›æ‰‹ï¼Œ ä½œåˆ«è¥¿å¤©çš„äº‘å½©ã€‚ é‚£æ²³ç•”çš„é‡‘æŸ³ï¼Œ æ˜¯å¤•é˜³ä¸­çš„æ–°å¨˜ï¼› æ³¢å…‰é‡Œçš„è‰³å½±ï¼Œ åœ¨æˆ‘çš„å¿ƒå¤´è¡æ¼¾ã€‚ è½¯æ³¥ä¸Šçš„é’è‡ï¼Œ æ²¹æ²¹çš„åœ¨æ°´åº•æ‹›æ‘‡ï¼› åœ¨åº·æ²³çš„æŸ”æ³¢é‡Œï¼Œ æˆ‘ç”˜å¿ƒåšä¸€æ¡æ°´è‰ï¼ é‚£æ¦†è«ä¸‹çš„ä¸€æ½­ï¼Œ ä¸æ˜¯æ¸…æ³‰ï¼Œ æ˜¯å¤©ä¸Šè™¹ï¼› æ‰ç¢åœ¨æµ®è—»é—´ï¼Œ æ²‰æ·€ç€å½©è™¹ä¼¼çš„æ¢¦ã€‚ å¯»æ¢¦ï¼Ÿæ’‘ä¸€æ”¯é•¿ç¯™ï¼Œ å‘é’è‰æ›´é’å¤„æ¼«æº¯ï¼› æ»¡è½½ä¸€èˆ¹æ˜Ÿè¾‰ï¼Œ åœ¨æ˜Ÿè¾‰æ–‘æ–“é‡Œæ”¾æ­Œã€‚ ä½†æˆ‘ä¸èƒ½æ”¾æ­Œï¼Œ æ‚„æ‚„æ˜¯åˆ«ç¦»çš„ç¬™ç®«ï¼› å¤è™«ä¹Ÿä¸ºæˆ‘æ²‰é»˜ï¼Œ æ²‰é»˜æ˜¯ä»Šæ™šçš„åº·æ¡¥ï¼ æ‚„æ‚„çš„æˆ‘èµ°äº†ï¼Œ æ­£å¦‚æˆ‘æ‚„æ‚„çš„æ¥ï¼› æˆ‘æŒ¥ä¸€æŒ¥è¡£è¢–ï¼Œ ä¸å¸¦èµ°ä¸€ç‰‡äº‘å½©ã€‚ åŒ…å«æ®µè½çš„åˆ—è¡¨ è¯­æ³•è¯´æ˜ï¼š\nåˆ—è¡¨é¡¹ç›®å¯ä»¥åŒ…å«å¤šä¸ªæ®µè½ï¼Œæ¯ä¸ªé¡¹ç›®ä¸‹çš„æ®µè½éƒ½å¿…é¡»ç¼©è¿› 4 ä¸ªç©ºæ ¼æˆ–æ˜¯ 1 ä¸ªåˆ¶è¡¨ç¬¦ï¼ˆæ˜¾ç¤ºæ•ˆæœä¸ä»£ç ä¸€è‡´ï¼‰ï¼š\n1 2 3 4 5 6 7 8 9 * è½»è½»çš„æˆ‘èµ°äº†ï¼Œ æ­£å¦‚æˆ‘è½»è½»çš„æ¥ï¼› æˆ‘è½»è½»çš„æ‹›æ‰‹ï¼Œ ä½œåˆ«è¥¿å¤©çš„äº‘å½©ã€‚ é‚£æ²³ç•”çš„é‡‘æŸ³ï¼Œ æ˜¯å¤•é˜³ä¸­çš„æ–°å¨˜ï¼› æ³¢å…‰é‡Œçš„è‰³å½±ï¼Œ åœ¨æˆ‘çš„å¿ƒå¤´è¡æ¼¾ã€‚ è½¯æ³¥ä¸Šçš„é’è‡ï¼Œ æ²¹æ²¹çš„åœ¨æ°´åº•æ‹›æ‘‡ï¼› åœ¨åº·æ²³çš„æŸ”æ³¢é‡Œï¼Œ æˆ‘ç”˜å¿ƒåšä¸€æ¡æ°´è‰ï¼ é‚£æ¦†è«ä¸‹çš„ä¸€æ½­ï¼Œ ä¸æ˜¯æ¸…æ³‰ï¼Œ æ˜¯å¤©ä¸Šè™¹ï¼› æ‰ç¢åœ¨æµ®è—»é—´ï¼Œ æ²‰æ·€ç€å½©è™¹ä¼¼çš„æ¢¦ã€‚ å¯»æ¢¦ï¼Ÿæ’‘ä¸€æ”¯é•¿ç¯™ï¼Œ å‘é’è‰æ›´é’å¤„æ¼«æº¯ï¼› æ»¡è½½ä¸€èˆ¹æ˜Ÿè¾‰ï¼Œ åœ¨æ˜Ÿè¾‰æ–‘æ–“é‡Œæ”¾æ­Œã€‚ ä½†æˆ‘ä¸èƒ½æ”¾æ­Œï¼Œ æ‚„æ‚„æ˜¯åˆ«ç¦»çš„ç¬™ç®«ï¼› å¤è™«ä¹Ÿä¸ºæˆ‘æ²‰é»˜ï¼Œ æ²‰é»˜æ˜¯ä»Šæ™šçš„åº·æ¡¥ï¼ * æ‚„æ‚„çš„æˆ‘èµ°äº†ï¼Œ æ­£å¦‚æˆ‘æ‚„æ‚„çš„æ¥ï¼› æˆ‘æŒ¥ä¸€æŒ¥è¡£è¢–ï¼Œ ä¸å¸¦èµ°ä¸€ç‰‡äº‘å½©ã€‚ view\nè½»è½»çš„æˆ‘èµ°äº†ï¼Œ æ­£å¦‚æˆ‘è½»è½»çš„æ¥ï¼› æˆ‘è½»è½»çš„æ‹›æ‰‹ï¼Œ ä½œåˆ«è¥¿å¤©çš„äº‘å½©ã€‚ é‚£æ²³ç•”çš„é‡‘æŸ³ï¼Œ æ˜¯å¤•é˜³ä¸­çš„æ–°å¨˜ï¼› æ³¢å…‰é‡Œçš„è‰³å½±ï¼Œ åœ¨æˆ‘çš„å¿ƒå¤´è¡æ¼¾ã€‚ è½¯æ³¥ä¸Šçš„é’è‡ï¼Œ æ²¹æ²¹çš„åœ¨æ°´åº•æ‹›æ‘‡ï¼› åœ¨åº·æ²³çš„æŸ”æ³¢é‡Œï¼Œ æˆ‘ç”˜å¿ƒåšä¸€æ¡æ°´è‰ï¼\né‚£æ¦†è«ä¸‹çš„ä¸€æ½­ï¼Œ ä¸æ˜¯æ¸…æ³‰ï¼Œ æ˜¯å¤©ä¸Šè™¹ï¼› æ‰ç¢åœ¨æµ®è—»é—´ï¼Œ æ²‰æ·€ç€å½©è™¹ä¼¼çš„æ¢¦ã€‚ å¯»æ¢¦ï¼Ÿæ’‘ä¸€æ”¯é•¿ç¯™ï¼Œ å‘é’è‰æ›´é’å¤„æ¼«æº¯ï¼› æ»¡è½½ä¸€èˆ¹æ˜Ÿè¾‰ï¼Œ åœ¨æ˜Ÿè¾‰æ–‘æ–“é‡Œæ”¾æ­Œã€‚ ä½†æˆ‘ä¸èƒ½æ”¾æ­Œï¼Œ æ‚„æ‚„æ˜¯åˆ«ç¦»çš„ç¬™ç®«ï¼› å¤è™«ä¹Ÿä¸ºæˆ‘æ²‰é»˜ï¼Œ æ²‰é»˜æ˜¯ä»Šæ™šçš„åº·æ¡¥ï¼\næ‚„æ‚„çš„æˆ‘èµ°äº†ï¼Œ æ­£å¦‚æˆ‘æ‚„æ‚„çš„æ¥ï¼› æˆ‘æŒ¥ä¸€æŒ¥è¡£è¢–ï¼Œ ä¸å¸¦èµ°ä¸€ç‰‡äº‘å½©ã€‚\nåŒ…å«å¼•ç”¨çš„åˆ—è¡¨ è¯­æ³•è¯´æ˜ï¼š\nå¦‚æœè¦åœ¨åˆ—è¡¨é¡¹ç›®å†…æ”¾è¿›å¼•ç”¨ï¼Œé‚£ \u003e å°±éœ€è¦ç¼©è¿›ï¼š\n1 2 3 * é˜…è¯»çš„æ–¹æ³•: \u003e æ‰“å¼€ä¹¦æœ¬ã€‚ \u003e æ‰“å¼€ç”µç¯ã€‚ view\né˜…è¯»çš„æ–¹æ³•: æ‰“å¼€ä¹¦æœ¬ã€‚ æ‰“å¼€ç”µç¯ã€‚\nåŒ…å«ä»£ç åŒºå—çš„å¼•ç”¨ è¯­æ³•è¯´æ˜ï¼š å¦‚æœè¦æ”¾ä»£ç åŒºå—çš„è¯ï¼Œè¯¥åŒºå—å°±éœ€è¦ç¼©è¿›ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯ 8 ä¸ªç©ºæ ¼æˆ–æ˜¯ 2 ä¸ªåˆ¶è¡¨ç¬¦ï¼š\nä¸€ä¸ªç‰¹æ®Šæƒ…å†µ åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œé¡¹ç›®åˆ—è¡¨å¾ˆå¯èƒ½ä¼šä¸å°å¿ƒäº§ç”Ÿï¼Œåƒæ˜¯ä¸‹é¢è¿™æ ·çš„å†™æ³•ï¼š\n1 1986. What a great season. ä¼šæ˜¾ç¤ºæˆï¼š\nWhat a great season. æ¢å¥è¯è¯´ï¼Œä¹Ÿå°±æ˜¯åœ¨è¡Œé¦–å‡ºç°æ•°å­—-å¥ç‚¹-ç©ºç™½ï¼Œè¦é¿å…è¿™æ ·çš„çŠ¶å†µï¼Œä½ å¯ä»¥åœ¨å¥ç‚¹å‰é¢åŠ ä¸Šåæ–œæ ï¼š\n1 1986\\. What a great season. æ‰ä¼šæ­£å¸¸æ˜¾ç¤ºæˆï¼š\n1986. What a great season.\nå¼•ç”¨ è¯­æ³•è¯´æ˜ï¼š å¼•ç”¨éœ€è¦åœ¨è¢«å¼•ç”¨çš„æ–‡æœ¬å‰åŠ ä¸Š\u003eç¬¦å·ã€‚\n1 2 3 4 5 6 \u003e è¿™æ˜¯ä¸€ä¸ªæœ‰ä¸¤æ®µæ–‡å­—çš„å¼•ç”¨, æ— æ„ä¹‰çš„å è¡Œæ–‡å­—1. æ— æ„ä¹‰çš„å è¡Œæ–‡å­—2. \u003e æ— æ„ä¹‰çš„å è¡Œæ–‡å­—3. æ— æ„ä¹‰çš„å è¡Œæ–‡å­—4. view\nè¿™æ˜¯ä¸€ä¸ªæœ‰ä¸¤æ®µæ–‡å­—çš„å¼•ç”¨, æ— æ„ä¹‰çš„å è¡Œæ–‡å­—1. æ— æ„ä¹‰çš„å è¡Œæ–‡å­—2.\næ— æ„ä¹‰çš„å è¡Œæ–‡å­—3. æ— æ„ä¹‰çš„å è¡Œæ–‡å­—4.\nå¼•ç”¨çš„å¤šå±‚åµŒå¥— åŒºå—å¼•ç”¨å¯ä»¥åµŒå¥—ï¼ˆä¾‹å¦‚ï¼šå¼•ç”¨å†…çš„å¼•ç”¨ï¼‰ï¼Œåªè¦æ ¹æ®å±‚æ¬¡åŠ ä¸Šä¸åŒæ•°é‡çš„ \u003e ï¼š\n1 2 3 4 5 \u003e\u003e\u003e è¯·é—® Markdwon æ€ä¹ˆç”¨ï¼Ÿ - å°ç™½ \u003e\u003e è‡ªå·±çœ‹æ•™ç¨‹ï¼ - æ„¤é’ \u003e æ•™ç¨‹åœ¨å“ªï¼Ÿ - å°ç™½ è¯·é—® Markdwon æ€ä¹ˆç”¨ï¼Ÿ - å°ç™½\nè‡ªå·±çœ‹æ•™ç¨‹ï¼ - æ„¤é’\næ•™ç¨‹åœ¨å“ªï¼Ÿ - å°ç™½\nå¼•ç”¨å…¶å®ƒè¦ç´  å¼•ç”¨çš„åŒºå—å†…ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„ Markdown è¯­æ³•ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€åˆ—è¡¨ã€ä»£ç åŒºå—ç­‰ï¼š\n1 2 3 4 5 6 \u003e 1. è¿™æ˜¯ç¬¬ä¸€è¡Œåˆ—è¡¨é¡¹ã€‚ \u003e 2. è¿™æ˜¯ç¬¬äºŒè¡Œåˆ—è¡¨é¡¹ã€‚ \u003e \u003e ç»™å‡ºä¸€äº›ä¾‹å­ä»£ç ï¼š \u003e \u003e return shell_exec(\"echo $input | $markdown_script\"); è¿™æ˜¯ç¬¬ä¸€è¡Œåˆ—è¡¨é¡¹ã€‚ è¿™æ˜¯ç¬¬äºŒè¡Œåˆ—è¡¨é¡¹ã€‚ ç»™å‡ºä¸€äº›ä¾‹å­ä»£ç ï¼š\nreturn shell_exec(\"echo $input | $markdown_script\"); æ’å…¥å›¾åƒ å›¾ç‰‡çš„åˆ›å»ºæ–¹å¼ä¸è¶…é“¾æ¥ç›¸ä¼¼ï¼Œè€Œä¸”å’Œè¶…é“¾æ¥ä¸€æ ·ä¹Ÿæœ‰ä¸¤ç§å†™æ³•ï¼Œè¡Œå†…å¼å’Œå‚è€ƒå¼å†™æ³•ã€‚\nè¯­æ³•ä¸­å›¾ç‰‡Altçš„æ„æ€æ˜¯å¦‚æœå›¾ç‰‡å› ä¸ºæŸäº›åŸå› ä¸èƒ½æ˜¾ç¤ºï¼Œå°±ç”¨å®šä¹‰çš„å›¾ç‰‡Altæ–‡å­—æ¥ä»£æ›¿å›¾ç‰‡ã€‚ å›¾ç‰‡Titleåˆ™å’Œé“¾æ¥ä¸­çš„Titleä¸€æ ·ï¼Œè¡¨ç¤ºé¼ æ ‡æ‚¬åœä¸å›¾ç‰‡ä¸Šæ—¶å‡ºç°çš„æ–‡å­—ã€‚ Alt å’Œ Title éƒ½ä¸æ˜¯å¿…é¡»çš„ï¼Œå¯ä»¥çœç•¥ï¼Œä½†å»ºè®®å†™ä¸Šã€‚\nè¡Œå†…å¼ è¯­æ³•è¯´æ˜ï¼š![å›¾ç‰‡Alt](å›¾ç‰‡åœ°å€ â€œå›¾ç‰‡Titleâ€)\n1 2 ç¾ä¸½é£æ™¯ï¼š ![ç¾ä¸½é£æ™¯](https://yuhongjun.github.io/assets/media/scenery.jpeg \"ç¾ä¸½é£æ™¯\") view ç¾ä¸½é£æ™¯ï¼š å‚è€ƒå¼\u0010 è¯­æ³•è¯´æ˜ï¼š\nåœ¨æ–‡æ¡£è¦æ’å…¥å›¾ç‰‡çš„åœ°æ–¹å†™![å›¾ç‰‡Alt][æ ‡è®°]\nåœ¨æ–‡æ¡£çš„æœ€åå†™ä¸Š[æ ‡è®°]:å›¾ç‰‡åœ°å€ â€œTitleâ€\n1 2 3 ![ç¾ä¸½é£æ™¯](https://yuhongjun.github.io/assets/media/scenery.jpeg \"ç¾ä¸½é£æ™¯\") [scenery]:https://yuhongjun.github.io/assets/media/scenery.jpeg \"ç¾ä¸½é£æ™¯\" view å†…å®¹ç›®å½• åœ¨æ®µè½ä¸­å¡«å†™ {toc} ä»¥æ˜¾ç¤ºå…¨æ–‡å†…å®¹çš„ç›®å½•ç»“æ„ã€‚\næ•ˆæœå‚è§æœ€ä¸Šæ–¹çš„ç›®å½•\næ³¨è„š è¯­æ³•è¯´æ˜ï¼š\nåœ¨éœ€è¦æ·»åŠ æ³¨è„šçš„æ–‡å­—ååŠ ä¸Šè„šæ³¨åå­—[^æ³¨è„šåå­—],ç§°ä¸ºåŠ æ³¨ã€‚ ç„¶ååœ¨æ–‡æœ¬çš„ä»»æ„ä½ç½®(ä¸€èˆ¬åœ¨æœ€å)æ·»åŠ è„šæ³¨ï¼Œè„šæ³¨å‰å¿…é¡»æœ‰å¯¹åº”çš„è„šæ³¨åå­—ã€‚\næ³¨æ„ï¼šç»æµ‹è¯•æ³¨è„šä¸æ³¨è„šä¹‹é—´å¿…é¡»ç©ºä¸€è¡Œï¼Œä¸ç„¶ä¼šå¤±æ•ˆã€‚æˆåŠŸåä¼šå‘ç°ï¼Œå³ä½¿ä½ æ²¡æœ‰æŠŠæ³¨è„šå†™åœ¨æ–‡æœ«ï¼Œç»Markdownè½¬æ¢åï¼Œä¹Ÿä¼šè‡ªåŠ¨å½’ç±»åˆ°æ–‡ç« çš„æœ€åã€‚\n1 2 3 4 5 6 7 ä½¿ç”¨ Markdown[^1]å¯ä»¥æ•ˆç‡çš„ä¹¦å†™æ–‡æ¡£, ç›´æ¥è½¬æ¢æˆ HTML[^2], ä½ å¯ä»¥ä½¿ç”¨ Leanote[^Le] ç¼–è¾‘å™¨è¿›è¡Œä¹¦å†™ã€‚ [^1]:Markdownæ˜¯ä¸€ç§çº¯æ–‡æœ¬æ ‡è®°è¯­è¨€ [^2]:HyperText Markup Language è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ [^Le]:å¼€æºç¬”è®°å¹³å°ï¼Œæ”¯æŒMarkdownå’Œç¬”è®°ç›´æ¥å‘ä¸ºåšæ–‡ view\nä½¿ç”¨ Markdown1å¯ä»¥æ•ˆç‡çš„ä¹¦å†™æ–‡æ¡£, ç›´æ¥è½¬æ¢æˆ HTML2, ä½ å¯ä»¥ä½¿ç”¨ Leanote3 ç¼–è¾‘å™¨è¿›è¡Œä¹¦å†™ã€‚\næ³¨ï¼šè„šæ³¨è‡ªåŠ¨è¢«æ¬è¿åˆ°æœ€åé¢ï¼Œè¯·åˆ°æ–‡ç« æœ«å°¾æŸ¥çœ‹ï¼Œå¹¶ä¸”è„šæ³¨åæ–¹çš„é“¾æ¥å¯ä»¥ç›´æ¥è·³è½¬å›åˆ°åŠ æ³¨çš„åœ°æ–¹ã€‚\nLaTeX å…¬å¼ $ è¡¨ç¤ºè¡Œå†…å…¬å¼ï¼š 1 è´¨èƒ½å®ˆæ’æ–¹ç¨‹å¯ä»¥ç”¨ä¸€ä¸ªå¾ˆç®€æ´çš„æ–¹ç¨‹å¼ $E=mc^2$ æ¥è¡¨è¾¾ã€‚ view è´¨èƒ½å®ˆæ’æ–¹ç¨‹å¯ä»¥ç”¨ä¸€ä¸ªå¾ˆç®€æ´çš„æ–¹ç¨‹å¼ $E=mc^2$ æ¥è¡¨è¾¾ã€‚\n$$ è¡¨ç¤ºæ•´è¡Œå…¬å¼ï¼š 1 2 3 $$\\sum_{i=1}^n a_i=0$$ $$f(x_1,x_x,\\ldots,x_n) = x_1^2 + x_2^2 + \\cdots + x_n^2 $$ $$\\sum^{j-1}_{k=0}{\\widehat{\\gamma}_{kj} z_k}$$ $$\\sum_{i=1}^n a_i=0$$ $$f(x_1,x_x,\\ldots,x_n) = x_1^2 + x_2^2 + \\cdots + x_n^2 $$ $$\\sum^{j-1}{k=0}{\\widehat{\\gamma}{kj} z_k}$$\nè®¿é—® MathJax å‚è€ƒæ›´å¤šä½¿ç”¨æ–¹æ³•ã€‚\næµç¨‹å›¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 st=\u003estart: Start|past:\u003ehttps://yuhongjun.github.io[blank] e=\u003eend: End:\u003ehttps://yuhongjun.github.io op1=\u003eoperation: My Operation|past op2=\u003eoperation: Stuff|current sub1=\u003esubroutine: My Subroutine|invalid cond=\u003econdition: Yes or No?|approved:\u003ehttps://yuhongjun.github.io c2=\u003econdition: Good idea|rejected io=\u003einputoutput: catch something...|request st-\u003eop1(right)-\u003econd cond(yes, right)-\u003ec2 cond(no)-\u003esub1(left)-\u003eop1 c2(yes)-\u003eio-\u003ee c2(no)-\u003eop2-\u003ee st=\u003estart: Start|past:\u003ehttps://yuhongjun.github.io[blank] e=\u003eend: End:\u003ehttps://yuhongjun.github.io op1=\u003eoperation: My Operation|past op2=\u003eoperation: Stuff|current sub1=\u003esubroutine: My Subroutine|invalid cond=\u003econdition: Yes or No?|approved:\u003ehttps://yuhongjun.github.io c2=\u003econdition: Good idea|rejected io=\u003einputoutput: catch something...|request st-\u003eop1(right)-\u003econd cond(yes, right)-\u003ec2 cond(no)-\u003esub1(left)-\u003eop1 c2(yes)-\u003eio-\u003ee c2(no)-\u003eop2-\u003ee æ›´å¤šè¯­æ³•å‚è€ƒï¼šæµç¨‹å›¾è¯­æ³•å‚è€ƒ\nè¡¨æ ¼ è¯­æ³•è¯´æ˜ï¼š\nä¸ç®¡æ˜¯å“ªç§æ–¹å¼ï¼Œç¬¬ä¸€è¡Œä¸ºè¡¨å¤´ï¼Œç¬¬äºŒè¡Œåˆ†éš”è¡¨å¤´å’Œä¸»ä½“éƒ¨åˆ†ï¼Œç¬¬ä¸‰è¡Œå¼€å§‹æ¯ä¸€è¡Œä¸ºä¸€ä¸ªè¡¨æ ¼è¡Œã€‚ åˆ—äºåˆ—ä¹‹é—´ç”¨ç®¡é“ç¬¦|éš”å¼€ã€‚åŸç”Ÿæ–¹å¼çš„è¡¨æ ¼æ¯ä¸€è¡Œçš„ä¸¤è¾¹ä¹Ÿè¦æœ‰ç®¡é“ç¬¦ã€‚ ç¬¬äºŒè¡Œè¿˜å¯ä»¥ä¸ºä¸åŒçš„åˆ—æŒ‡å®šå¯¹é½æ–¹å‘ã€‚é»˜è®¤ä¸ºå·¦å¯¹é½ï¼Œåœ¨-å³è¾¹åŠ ä¸Š:å°±å³å¯¹é½ã€‚\nç®€å•æ–¹å¼å†™è¡¨æ ¼ï¼š 1 2 3 4 5 å­¦å·|å§“å|åˆ†æ•° -|-|- å°æ˜|ç”·|75 å°çº¢|å¥³|79 å°é™†|ç”·|92 2.åŸç”Ÿæ–¹å¼å†™è¡¨æ ¼ï¼š\n1 2 3 4 5 |å­¦å·|å§“å|åˆ†æ•°| |-|-|-| |å°æ˜|ç”·|75| |å°çº¢|å¥³|79| |å°é™†|ç”·|92| 3.ä¸ºè¡¨æ ¼ç¬¬äºŒåˆ—æŒ‡å®šæ–¹å‘ï¼š\n1 2 3 4 äº§å“|ä»·æ ¼ -|-: Leanote é«˜çº§è´¦å·|60å…ƒ/å¹´ Leanote è¶…çº§è´¦å·|120å…ƒ/å¹´ view\nç®€å•æ–¹å¼å†™è¡¨æ ¼ï¼š å­¦å· å§“å åˆ†æ•° å°æ˜ ç”· 75 å°çº¢ å¥³ 79 å°é™† ç”· 92 2.åŸç”Ÿæ–¹å¼å†™è¡¨æ ¼ï¼š\nå­¦å· å§“å åˆ†æ•° å°æ˜ ç”· 75 å°çº¢ å¥³ 79 å°é™† ç”· 92 3.ä¸ºè¡¨æ ¼ç¬¬äºŒåˆ—æŒ‡å®šæ–¹å‘ï¼š\näº§å“ ä»·æ ¼ Leanote é«˜çº§è´¦å· 60å…ƒ/å¹´ Leanote è¶…çº§è´¦å· 120å…ƒ/å¹´ åˆ†éš”çº¿ ä½ å¯ä»¥åœ¨ä¸€è¡Œä¸­ç”¨ä¸‰ä¸ªä»¥ä¸Šçš„æ˜Ÿå·ã€å‡å·ã€åº•çº¿æ¥å»ºç«‹ä¸€ä¸ªåˆ†éš”çº¿ï¼Œè¡Œå†…ä¸èƒ½æœ‰å…¶ä»–ä¸œè¥¿ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨æ˜Ÿå·æˆ–æ˜¯å‡å·ä¸­é—´æ’å…¥ç©ºæ ¼ã€‚ä¸‹é¢æ¯ç§å†™æ³•éƒ½å¯ä»¥å»ºç«‹åˆ†éš”çº¿ï¼š\n1 2 3 4 5 6 7 8 9 * * * *** ***** - - - --------------------------------------- æ˜¾ç¤ºæ•ˆæœéƒ½ä¸€æ ·\nä»£ç  å¯¹äºç¨‹åºå‘˜æ¥è¯´è¿™ä¸ªåŠŸèƒ½æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œæ’å…¥ç¨‹åºä»£ç çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯åˆ©ç”¨ç¼©è¿›(Tab), å¦ä¸€ç§æ˜¯åˆ©ç”¨ ` ç¬¦å·ï¼ˆä¸€èˆ¬åœ¨ESCé”®ä¸‹æ–¹ï¼‰åŒ…è£¹ä»£ç ã€‚\nè¯­æ³•è¯´æ˜ï¼š\næ’å…¥è¡Œå†…ä»£ç ï¼Œå³æ’å…¥ä¸€ä¸ªå•è¯æˆ–è€…ä¸€å¥ä»£ç çš„æƒ…å†µï¼Œä½¿ç”¨codeè¿™æ ·çš„å½¢å¼æ’å…¥ã€‚ æ’å…¥å¤šè¡Œä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ç¼©è¿›æˆ–è€…â€œ code â€œ,å…·ä½“çœ‹ç¤ºä¾‹ã€‚ æ³¨æ„ï¼š ç¼©è¿›å¼æ’å…¥å‰æ–¹å¿…é¡»æœ‰ç©ºè¡Œ\nè¡Œå†…å¼ 1 Cè¯­è¨€é‡Œçš„å‡½æ•° `scanf()` æ€ä¹ˆä½¿ç”¨ï¼Ÿ view Cè¯­è¨€é‡Œçš„å‡½æ•° scanf() æ€ä¹ˆä½¿ç”¨ï¼Ÿ\nç¼©è¿›å¼å¤šè¡Œä»£ç  ç¼©è¿› 4 ä¸ªç©ºæ ¼æˆ–æ˜¯ 1 ä¸ªåˆ¶è¡¨ç¬¦\nä¸€ä¸ªä»£ç åŒºå—ä¼šä¸€ç›´æŒç»­åˆ°æ²¡æœ‰ç¼©è¿›çš„é‚£ä¸€è¡Œï¼ˆæˆ–æ˜¯æ–‡ä»¶ç»“å°¾ï¼‰ã€‚\n1 2 3 4 5 #include \u003cstdio.h\u003e int main(void) { printf(\"Hello world\\n\"); } view\n#include \u003cstdio.h\u003e int main(void) { printf(\"Hello world\\n\"); } åŒ…è£¹å¤šè¡Œä»£ç  1 2 3 4 5 6 7 8 \u003c!-- ç”¨ ``` æˆ– ~~~ åŒ…è£¹å¤šè¡Œä»£ç  --\u003e ` ` ` #include \u003cstdio.h\u003e int main(void) { printf(\"Hello world\\n\"); } ã€ã€ã€ HTML åŸå§‹ç  åœ¨ä»£ç åŒºå—é‡Œé¢ï¼Œ \u0026 ã€ \u003c å’Œ \u003e ä¼šè‡ªåŠ¨è½¬æˆ HTML å®ä½“ï¼Œè¿™æ ·çš„æ–¹å¼è®©ä½ éå¸¸å®¹æ˜“ä½¿ç”¨ Markdown æ’å…¥èŒƒä¾‹ç”¨çš„ HTML åŸå§‹ç ï¼Œåªéœ€è¦å¤åˆ¶è´´ä¸Šï¼Œå‰©ä¸‹çš„ Markdown éƒ½ä¼šå¸®ä½ å¤„ç†ï¼Œä¾‹å¦‚ï¼š\nç¬¬ä¸€ä¸ªä¾‹å­ï¼š\n1 2 3 \u003cdiv class=\"footer\"\u003e Â© 2016 *** \u003c/div\u003e view\nÂ© 2016 *** Markdownæ˜¯ä¸€ç§çº¯æ–‡æœ¬æ ‡è®°è¯­è¨€Â â†©ï¸\nHyperText Markup Language è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€Â â†©ï¸\nå¼€æºç¬”è®°å¹³å°ï¼Œæ”¯æŒMarkdownå’Œç¬”è®°ç›´æ¥å‘ä¸ºåšæ–‡Â â†©ï¸\n","description":"","tags":["markdown"],"title":"Markdown è¯­æ³•æ€»ç»“","uri":"/blog/posts/markdown-syntax-summary/"},{"categories":["Python","Fluent-Python"],"content":"\nGuido å¯¹è¯­è¨€è®¾è®¡ç¾å­¦çš„æ·±å…¥ç†è§£è®©äººéœ‡æƒŠã€‚æˆ‘è®¤è¯†ä¸å°‘å¾ˆä¸é”™çš„ç¼–ç¨‹è¯­è¨€è®¾è®¡è€…ï¼Œä»–ä»¬è®¾è®¡å‡ºæ¥çš„ä¸œè¥¿ç¡®å®å¾ˆç²¾å½©ï¼Œä½†æ˜¯ä»æ¥éƒ½ä¸ä¼šæœ‰ç”¨æˆ·ã€‚Guido çŸ¥é“å¦‚ä½•åœ¨ç†è®ºä¸Šåšå‡ºä¸€å®šå¦¥åï¼Œè®¾è®¡å‡ºæ¥çš„è¯­è¨€è®©ä½¿ç”¨è€…è§‰å¾—å¦‚æ²æ˜¥é£ï¼Œè¿™çœŸæ˜¯ä¸å¯å¤šå¾—ã€‚\nâ€”â€”Jim Hugunin\nJython çš„ä½œè€…ï¼ŒAspectJ çš„ä½œè€…ä¹‹ä¸€ï¼Œ.NET DLR æ¶æ„å¸ˆ\nPython æœ€å¥½çš„å“è´¨ä¹‹ä¸€æ˜¯ä¸€è‡´æ€§ï¼šä½ å¯ä»¥è½»æ¾ç†è§£ Python è¯­è¨€ï¼Œå¹¶é€šè¿‡ Python çš„è¯­è¨€ç‰¹æ€§åœ¨ç±»ä¸Šå®šä¹‰è§„èŒƒçš„æ¥å£ï¼Œæ¥æ”¯æŒ Python çš„æ ¸å¿ƒè¯­è¨€ç‰¹æ€§ï¼Œä»è€Œå†™å‡ºå…·æœ‰â€œPython é£æ ¼â€çš„å¯¹è±¡ã€‚\nPython è§£é‡Šå™¨åœ¨ç¢°åˆ°ç‰¹æ®Šçš„å¥æ³•æ—¶ï¼Œä¼šä½¿ç”¨ç‰¹æ®Šæ–¹æ³•ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºé­”æœ¯æ–¹æ³•ï¼‰å»æ¿€æ´»ä¸€äº›åŸºæœ¬çš„å¯¹è±¡æ“ä½œã€‚\n__getitem__ ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´çš„ç‰¹æ®Šæ–¹æ³•ï¼Œç§°ä¸º dunder-getitemã€‚ç‰¹æ®Šæ–¹æ³•ä¹Ÿç§°ä¸ºåŒä¸‹æ–¹æ³•(dunder-method)\nå¦‚ my_c[key] è¯­å¥æ‰§è¡Œæ—¶ï¼Œå°±ä¼šè°ƒç”¨ my_c.__getitem__ å‡½æ•°ã€‚è¿™äº›ç‰¹æ®Šæ–¹æ³•åèƒ½è®©ä½ è‡ªå·±çš„å¯¹è±¡å®ç°å’Œæ”¯æŒä¸€ä¸‹çš„è¯­è¨€æ„æ¶ï¼Œå¹¶ä¸ä¹‹äº¤äº’ï¼š\nè¿­ä»£ é›†åˆç±» å±æ€§è®¿é—® è¿ç®—ç¬¦é‡è½½ å‡½æ•°å’Œæ–¹æ³•çš„è°ƒç”¨ å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯ å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼å’Œæ ¼å¼åŒ– ç®¡ç†ä¸Šä¸‹æ–‡ï¼ˆå³ with å—ï¼‰ å®ç°ä¸€ä¸ª Pythonic çš„ç‰Œç»„ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # é€šè¿‡å®ç°é­”æœ¯æ–¹æ³•ï¼Œæ¥è®©å†…ç½®å‡½æ•°æ”¯æŒä½ çš„è‡ªå®šä¹‰å¯¹è±¡ # https://github.com/fluentpython/example-code/blob/master/01-data-model/frenchdeck.py import collections import random Card = collections.namedtuple('Card', ['rank', 'suit']) class FrenchDeck: ranks = [str(n) for n in range(2, 11)] + list('JQKA') suits = 'spades diamonds clubs hearts'.split() def __init__(self): self._cards = [Card(rank, suit) for suit in self.suits for rank in self.ranks] def __len__(self): return len(self._cards) def __getitem__(self, position): return self._cards[position] deck = FrenchDeck() å¯ä»¥å®¹æ˜“åœ°è·å¾—ä¸€ä¸ªçº¸ç‰Œå¯¹è±¡\n1 2 beer_card = Card('7', 'diamonds') print(beer_card) å’Œæ ‡å‡† Python é›†åˆç±»å‹ä¸€æ ·ï¼Œä½¿ç”¨ len() æŸ¥çœ‹ä¸€å çº¸ç‰Œæœ‰å¤šå°‘å¼ \n1 2 3 deck = FrenchDeck() # å®ç° __len__ ä»¥æ”¯æŒä¸‹æ ‡æ“ä½œ print(len(deck)) å¯é€‰å–ç‰¹å®šä¸€å¼ çº¸ç‰Œï¼Œè¿™æ˜¯ç”± __getitem__ æ–¹æ³•æä¾›çš„\n1 2 3 # å®ç° __getitem__ ä»¥æ”¯æŒä¸‹æ ‡æ“ä½œ print(deck[1]) print(deck[5::13]) éšæœºæŠ½å–ä¸€å¼ çº¸ç‰Œï¼Œä½¿ç”¨ python å†…ç½®å‡½æ•° random.choice\n1 2 3 from random import choice # å¯ä»¥å¤šè¿è¡Œå‡ æ¬¡è§‚å¯Ÿ choice(deck) å®ç°ç‰¹æ®Šæ–¹æ³•çš„ä¸¤ä¸ªå¥½å¤„ï¼š\nå¯¹äºæ ‡å‡†æ“ä½œæœ‰å›ºå®šå‘½å æ›´æ–¹ä¾¿åˆ©ç”¨ Python æ ‡å‡†åº“ __getitem__ æ–¹æ³•æŠŠ [] æ“ä½œäº¤ç»™äº† self._cards åˆ—è¡¨ï¼Œdeck ç±»è‡ªåŠ¨æ”¯æŒåˆ‡ç‰‡æ“ä½œ\n1 2 deck[12::13] deck[:3] åŒæ—¶ deck ç±»æ”¯æŒè¿­ä»£\n1 2 3 4 5 6 for card in deck: print(card) # åå‘è¿­ä»£ for card in reversed(deck): print(card) è¿­ä»£é€šå¸¸æ˜¯éšå¼çš„ï¼Œå¦‚æœä¸€ä¸ªé›†åˆæ²¡æœ‰å®ç° __contains__ æ–¹æ³•ï¼Œé‚£ä¹ˆ in è¿ç®—ç¬¦ä¼šé¡ºåºåšä¸€æ¬¡è¿­ä»£æœç´¢ã€‚\n1 2 Card('Q', 'hearts') in deck Card('7', 'beasts') in deck False è¿›è¡Œæ’åºï¼Œæ’åºè§„åˆ™ï¼š 2 æœ€å°ï¼ŒAæœ€å¤§ã€‚èŠ±è‰² é»‘æ¡ƒ \u003e çº¢æ¡ƒ \u003e æ–¹å— \u003e æ¢…èŠ±\n1 card.rank 'A' 1 2 3 4 5 6 7 8 9 suit_values = dict(spades=3, hearts=2, diamonds=1, clubs=0) def spades_high(card): rank_value = FrenchDeck.ranks.index(card.rank) return rank_value * len(suit_values) + suit_values[card.suit] for card in sorted(deck, key=spades_high): print(card) FrenchDeck ç»§æ‰¿äº† object ç±»ã€‚é€šè¿‡ __len__, __getitem__ æ–¹æ³•ï¼ŒFrenchDeckå’Œ Python è‡ªæœ‰åºåˆ—æ•°æ®ç±»å‹ä¸€æ ·ï¼Œå¯ä½“ç° Python æ ¸å¿ƒè¯­è¨€ç‰¹æ€§ï¼ˆå¦‚è¿­ä»£å’Œåˆ‡ç‰‡ï¼‰ï¼Œ\nPython æ”¯æŒçš„æ‰€æœ‰é­”æœ¯æ–¹æ³•ï¼Œå¯ä»¥å‚è§ Python æ–‡æ¡£ Data Model éƒ¨åˆ†ã€‚\næ¯”è¾ƒé‡è¦çš„ä¸€ç‚¹ï¼šä¸è¦æŠŠ lenï¼Œstr ç­‰çœ‹æˆä¸€ä¸ª Python æ™®é€šæ–¹æ³•ï¼šç”±äºè¿™äº›æ“ä½œçš„é¢‘ç¹ç¨‹åº¦éå¸¸é«˜ï¼Œæ‰€ä»¥ Python å¯¹è¿™äº›æ–¹æ³•åšäº†ç‰¹æ®Šçš„å®ç°ï¼šå®ƒå¯ä»¥è®© Python çš„å†…ç½®æ•°æ®ç»“æ„èµ°åé—¨ä»¥æé«˜æ•ˆç‡ï¼›ä½†å¯¹äºè‡ªå®šä¹‰çš„æ•°æ®ç»“æ„ï¼Œåˆå¯ä»¥åœ¨å¯¹è±¡ä¸Šä½¿ç”¨é€šç”¨çš„æ¥å£æ¥å®Œæˆç›¸åº”å·¥ä½œã€‚ä½†åœ¨ä»£ç ç¼–å†™è€…çœ‹æ¥ï¼Œlen(deck) å’Œ len([1,2,3]) ä¸¤ä¸ªå®ç°å¯èƒ½å·®ä¹‹åƒé‡Œçš„æ“ä½œï¼Œåœ¨ Python è¯­æ³•å±‚é¢ä¸Šæ˜¯é«˜åº¦ä¸€è‡´çš„ã€‚\nå¦‚ä½•ä½¿ç”¨ç‰¹æ®Šæ–¹æ³• ç‰¹æ®Šæ–¹æ³•çš„å­˜åœ¨æ˜¯ä¸ºäº†è¢« Python è§£é‡Šå™¨è°ƒç”¨ é™¤éå¤§é‡å…ƒç¼–ç¨‹ï¼Œé€šå¸¸ä»£ç æ— éœ€ç›´æ¥ä½¿ç”¨ç‰¹æ®Šæ–¹æ³• é€šè¿‡å†…ç½®å‡½æ•°æ¥ä½¿ç”¨ç‰¹æ®Šæ–¹æ³•æ˜¯æœ€å¥½çš„é€‰æ‹©\næ¨¡æ‹Ÿæ•°å€¼ç±»å‹ å®ç°ä¸€ä¸ªäºŒç»´å‘é‡ï¼ˆVectorï¼‰ç±»\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 from math import hypot class Vector: def __init__(self, x=0, y=0): self.x = x self.y = y def __repr__(self): return 'Vector(%r, %r)' % (self.x, self.y) def __abs__(self): return hypot(self.x, self.y) def __bool__(self): return bool(abs(self)) def __add__(self, other): x = self.x + other.x y = self.y + other.y return Vector(x, y) def __mul__(self, scalar): return Vector(self.x * scalar, self.y * scalar) # ä½¿ç”¨ + è¿ç®—ç¬¦ v1 = Vector(2, 4) v2 = Vector(2, 1) v1 + v2 # è°ƒç”¨ abs å†…ç½®å‡½æ•° v = Vector(3, 4) abs(v) # ä½¿ç”¨ * è¿ç®—ç¬¦ v * 3 Vector ç±»ä¸­ 6 ä¸ªæ–¹æ³•ï¼ˆé™¤ __init__ å¤–ï¼‰å¹¶ä¸ä¼šåœ¨ç±»è‡ªèº«çš„ä»£ç ä¸­è°ƒç”¨ã€‚ä¸€èˆ¬åªæœ‰è§£é‡Šå™¨ä¼šé¢‘ç¹è°ƒç”¨è¿™äº›æ–¹æ³•\nå­—ç¬¦ä¸²çš„è¡¨ç¤ºå½¢å¼ å†…ç½®å‡½æ•° reprï¼Œ é€šè¿‡ __repr__ ç‰¹æ®Šæ–¹æ³•æ¥å¾—åˆ°ä¸€ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚\nç®—æ•°è¿ç®—ç¬¦ é€šè¿‡ __add__, __mul__ï¼Œ å‘é‡ç±»èƒ½å¤Ÿæ“ä½œ + å’Œ * ä¸¤ä¸ªç®—æ•°è¿ç®—ç¬¦ã€‚\nè¿ç®—ç¬¦æ“ä½œå¯¹è±¡ä¸å‘ç”Ÿæ”¹å˜ï¼Œè¿”å›ä¸€ä¸ªäº§ç”Ÿçš„æ–°å€¼\nè‡ªå®šä¹‰çš„å¸ƒå°”å€¼ ä»»ä½•å¯¹è±¡å¯ç”¨äºéœ€è¦å¸ƒå°”å€¼çš„ä¸Šä¸‹æ–‡ä¸­ï¼ˆif, while è¯­å¥ï¼Œ and, or, not è¿ç®—ç¬¦ï¼‰ Python è°ƒç”¨ bool(x) åˆ¤å®šä¸€ä¸ªå€¼ xï¼Œbool(x) åªèƒ½è¿”å› True æˆ–è€… False å¦‚æœç±»æ²¡æœ‰å®ç° __bool__ï¼Œåˆ™è°ƒç”¨ __len__ï¼Œ è‹¥è¿”å› 0ï¼Œåˆ™ bool è¿”å› False ç‰¹æ®Šæ–¹æ³•ä¸€è§ˆ Reference\nä¸ºä½• len ä¸æ˜¯æ™®é€šæ–¹æ³• â€œå®ç”¨èƒœäºçº¯ç²¹â€œ The Zen of Python\nä¸ºäº†è®© Python è‡ªå¸¦çš„æ•°æ®ç»“æ„èµ°åé—¨, CPython ä¼šç›´æ¥ä»ç»“æ„ä½“è¯»å–å¯¹è±¡çš„é•¿åº¦,è€Œä¸ä¼šè°ƒç”¨æ–¹æ³•. è¿™ç§å¤„ç†æ–¹å¼åœ¨ä¿æŒå†…ç½®ç±»å‹çš„æ•ˆç‡å’Œè¯­è¨€ä¸€è‡´æ€§ä¿æŒäº†ä¸€ä¸ªå¹³è¡¡.\nå°ç»“ é€šè¿‡å®ç°ç‰¹æ®Šæ–¹æ³•ï¼Œè‡ªå®šä¹‰æ•°æ®ç±»å‹å¯ä»¥åƒå†…ç½®ç±»å‹ä¸€æ ·å¤„ç† åˆç†çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼æ˜¯Pythonå¯¹è±¡çš„åŸºæœ¬è¦æ±‚ã€‚__repr__, __str__ åºåˆ—ç±»å‹çš„æ¨¡æ‹Ÿæ˜¯ç‰¹æ®Šæ–¹æ³•æœ€å¸¸ç”¨çš„åœ°æ–¹ ","description":"","tags":["python"],"title":"ã€Šæµç•…çš„Pythonã€‹æ•°æ®ç±»å‹","uri":"/blog/posts/Python/Fluent-Python/fluent-python-data-types/"},{"categories":["Linux"],"content":"åˆ—ä¸¾ä¸€äº›å¥½ç”¨çš„å‘½ä»¤è¡Œå·¥å…· åˆ—ä¸¾ä½ å¯èƒ½æ²¡æ³¨æ„è¿‡çš„å¥½ç”¨çš„ Linux å‘½ä»¤è¡Œå‘½ä»¤\nç°åœ¨åšç½‘ç«™åšç§»åŠ¨åº”ç”¨æœ€è®²ç©¶çš„å°±æ˜¯æ¨å¹¿äº†ï¼Œæ¨å¹¿åšçš„å¥½é‚£å°±æˆåŠŸäº†ä¸€å¤§åŠï¼Œç›¸å¯¹çš„æ²¡æ›å…‰äº§å“å†å¥½ä¹Ÿå¾ˆéš¾åšä¸‹å»ã€‚å°±è¿™ä¸ªè§’åº¦è€Œè¨€ç»å¤§å¤šæ•° Linux å‘½ä»¤è¡Œçš„æ¨å¹¿ç®€ç›´æ˜¯çƒ‚é€äº†ã€‚ç¹å¤š Linux æœ‰ç”¨æäº†çš„å‘½ä»¤è¡Œå·¥å…·å°±é™é™çš„èººåœ¨ä½ å‘è¡Œç‰ˆé»˜è®¤å®‰è£…çš„åŒ…è£¹é‡Œï¼Œå¾ˆå¤šæ—¶å€™åªæœ‰å½“ä½ ç¢°åˆ°ä»€ä¹ˆé—®é¢˜çš„æ—¶å€™ç½‘ä¸Šæœä¸€åœˆæ‰èƒ½çŸ¥é“ã€‚æ›´è›‹ç–¼çš„æ˜¯è¿™é‡Œé¢å¾ˆå¤šä¸œè¥¿ä½ ä¸€æ—¦çŸ¥é“äº†å°±ä¼šæƒ³æˆ‘é åŸæ¥æ²¡è¿™ä¸ªåˆ°åº•æ˜¯æ€ä¹ˆè¿‡çš„ä¸‹å»ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä¼šåˆ—å‡ºä¸€äº›æˆ‘ç”¨è¿‡çš„ä¸€äº›ï¼Œå¤§éƒ¨åˆ†å‘è¡Œç‰ˆé»˜è®¤å°±æœ‰ï¼Œæˆ–è€…èƒ½ç”¨åŒ…è£¹ç®¡ç†å·¥å…·è½»æ¾è·å–çš„ä¸œè¥¿ã€‚\nè¿™ç¯‡æ–‡ç« ä»…è®¨è®º Linux ç¯å¢ƒä¸‹çš„ä¸œè¥¿ï¼Œå¾ˆæ˜¾ç„¶å¯¹ MacOS ä¹Ÿé€‚ç”¨ã€‚å…¶å®å¾ˆå¤šä¸œè¥¿è™½ç„¶æœ‰ Windows ä¹Ÿå¯ä»¥æ‰¾çš„åˆ°ä½†é…ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œè¿™é‡Œä¸å†ä»”ç»†è®²ã€‚å¾ˆå¤šä¸œè¥¿åƒ Linux è€é¸Ÿçœ‹èµ·æ¥ä¼šè§‰å¾—å“ˆå“ˆå“ˆå®åœ¨æ˜¯å¤ªåŸºç¡€ã€‚ä½†æ˜¯åƒ cd, ls, mkdir è¿™äº›å¤ªåŸºç¡€çš„å†™åœ¨è¿™é‡Œåˆæ˜¾å¾—å¤ªä¸šä½™ï¼Œæ‰€ä»¥å¾ˆå¤šååˆ†å¸¸ç”¨çš„å‘½ä»¤è¿™è¾¹æˆ‘ä¹Ÿè·³è¿‡äº†ã€‚åƒ git è¿™ç§é‡é‡çº§çš„å·¥å…·ï¼Œå’Œ sed, awk è¿™äº›èƒ½å•ç‹¬å‡ºä¹¦çš„ä¸œè¥¿æˆ‘è§‰å¾—æˆ‘ä¹Ÿè®²ä¸æ¸…æ¥šï¼Œæ‰€ä»¥è¿™è¾¹éƒ½æ˜¯åŠŸèƒ½ç®€å•çš„å°ä¸œè¥¿ã€‚ä¸è¿‡è¿™äº›å°é—®é¢˜å°±ç®—äº†å§...\nå¦‚æœä½ æ—¶é—´æ¯”è¾ƒå……è£• é‚£ä¹ˆä¸å¦‚çœ‹çœ‹è¿™æœ¬ä¹¦å§: \u003cLinux å‘½ä»¤è¡Œä½¿ç”¨\u003eã€‚ä¹¦çš„å†…å®¹å°±è·Ÿæ ‡é¢˜ä¸€æ ·ï¼Œæ·±å…¥æµ…å‡ºçš„ä»‹ç»äº†æ‰€è°“ \"Linux å‘½ä»¤è¡Œ\" çš„æ–¹æ–¹é¢é¢ï¼Œæœ¬æ–‡å¾ˆå¤šå†…å®¹ä¹Ÿæ˜¯ä»ä¹¦é‡Œçœ‹åˆ°çš„ã€‚ç½‘ç«™ä¸Šæœ‰ PDF åˆæ³•å…è´¹ä¸‹è½½ï¼Œä¹¦å†™çš„å¾ˆå¥½å¯ä»¥å¾ˆéšæ„çš„çœ‹ä¸ä¼šè§‰å¾—å‹åŠ›å¤ªå¤§ã€‚æœ€ä¸»è¦çš„ï¼Œå¦‚æœä½ æ˜¯åˆšåˆšæ¥è§¦ Linux é‚£ä¹ˆè¿™ä¸ªè¯´ä¸å®šæ˜¯æœ€å¥½çš„ä¸Šæ‰‹æ•™ç¨‹ï¼Œæˆ‘ååˆ†åæ‚”åŸæ¥ä¸çŸ¥é“è¿™ä¹ˆä¹¦ã€‚è¿™ä¹ˆè¯´èµ·æ¥å¦å¤–ä¸€æœ¬ Linux å…¥é—¨å¤§å¸ˆçº§æ•™ç¨‹åº”è¯¥æ˜¯é¸Ÿå“¥ç§æˆ¿èœï¼Œè¿™ä¸ªå®åœ¨æ˜¯å¤ªå‡ºåä»¥è‡³äºæˆ‘è§‰å¾—æ²¡ä»€ä¹ˆå¯ä»¥è¯´çš„ã€‚\nå¦‚æœä½ æ²¡ä»€ä¹ˆç©ºçš„è¯ é‚£ä¸‹é¢å°±ä»¥éšæœºçš„é¡ºåºåˆ—å‡ºä¸€äº›æˆ‘è§‰å¾—éå¸¸æ£’çš„å‘½ä»¤è¡Œå·¥å…·ã€‚è¿™é‡Œä¸è¯¦ç»†ä»‹ç»å„ç§å‚æ•°ï¼Œä½ åº”è¯¥åšçš„æ˜¯ç”¨ man xxx æ¥æŸ¥çœ‹æ–‡æ¡£ã€‚å¦‚æœè¿™äº›ç¨‹åºåœ¨ä½ çš„å‘è¡Œç‰ˆé‡Œæ²¡æœ‰å®‰è£…ï¼Œé‚£ä¹ˆè¯·æ‰‹åŠ¨æœä¸€ä¸‹ã€‚Mac ç”¨æˆ·çš„è¯åœ¨ homebrew é‡Œå¯ä»¥åº”è¯¥éƒ½èƒ½æ‰¾åˆ°ã€‚\ntmux è™½ç„¶è¯´é¡ºåºå¾ˆéšæœºä½†è¿™ä¸€æ¡ä¸€å®šå¾—æ’åœ¨ç¬¬ä¸€ä¸ªã€‚å¾ˆå¤šäººç”¨ Linux çš„çŠ¶æ€éƒ½æ˜¯è‡ªå·±çš„æœºå™¨æ˜¯ Windowsï¼Œç”¨ putty è¿åˆ°ä¸€ä¸ªå“ªé‡Œçš„ Linux æœåŠ¡å™¨è¿›è¡Œå·¥ä½œã€‚è¿™æ ·çš„è¯æ¯æ¬¡æ–­å¼€çš„æ—¶å€™ä½ è¿è¡Œçš„ç¨‹åºéƒ½æ˜¯ä¼šè¢«æ€æ‰çš„ã€‚ä½ å¯èƒ½ä¼šå¸Œæœ›é€€å‡ºçš„æ—¶å€™èƒ½æŠŠæ‰“å¼€çš„ç¨‹åºä¿æŒåœ¨é‚£é‡Œï¼Œä¸‹æ¬¡ç”¨è¿æ¥çš„æ—¶å€™åˆèƒ½è‡ªåŠ¨åˆ°ä¹‹å‰çš„å·¥ä½œçŠ¶æ€ã€‚tmux å°±æ˜¯è¿™ä¸ªé—®é¢˜çš„ç»ˆæè§£å†³æ–¹æ¡ˆã€‚å®ƒä»¬ä¸€æ–¹é¢çš„åŠŸèƒ½æ˜¯èƒ½åœ¨ä¸€ä¸ª Terminal é‡Œåˆ›å»ºå¤šä¸ªâ€œçª—å£â€ï¼Œå¦ä¸€æ–¹é¢å¦‚æœä½ å…³é—­è¿æ¥æˆ–è€…æ„å¤–æ‰çº¿ï¼Œå®ƒä»¬é»˜è®¤ä¹Ÿä¸ä¼šå…³æ‰ï¼Œä¸‹æ¬¡è¿ä¸Šå»å¯ä»¥ç”¨ tmux attach æ¥æ¢å¤ä½ ä¹‹å‰çš„å·¥ä½œçŠ¶æ€ã€‚\ntree ls å¯èƒ½æ˜¯ä½ æœ€å¸¸ç”¨çš„å‘½ä»¤ä¹‹ä¸€ã€‚tree å¯ä»¥é€’å½’çš„åˆ—å‡ºç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ï¼Œå¹¶ä»¥æ ‘çŠ¶å½¢å¼å±•ç°ï¼š\nå¯¹åº”çš„ä¹Ÿæœ‰ pstree å¯ä»¥ä»¥è¿™æ ·çš„æ–¹å¼æ¥æ˜¾ç¤ºè¿›ç¨‹æ ‘ã€‚\nack æˆ‘è®°å¾—æˆ‘æ›¾ç»åœ¨é¢è¯•çš„æ—¶å€™è¢«é—®åˆ°è¿‡â€œè¯·å†™å¦‚ä½•è°ƒç”¨ grep æ¥åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶é‡Œï¼Œå«æœ‰æŸä¸ªå­—ç¬¦ä¸²çš„è¡Œâ€ã€‚è¿™ä¸ªé—®é¢˜æˆ‘çš„å›ç­”æ˜¯ â€œç”¨ ack å°±å¯ä»¥äº†â€ã€‚ack çš„å®˜ç½‘åŸŸåå°±å« betterthangrep.comã€‚ç”±äºåœ¨å½“å‰ç›®å½•ä¸‹è½½æ‰€æœ‰æ–‡ä»¶é‡ŒæŸ¥æ‰¾æŸä¸ªå­—ä¸²ç¬¦æ˜¯å¦‚æ­¤å¸¸è§çš„ä¸€ä¸ªæ“ä½œï¼Œæ‰§è¡Œ ack foo å°±å¯ä»¥åœ¨å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶é‡ŒæŸ¥æ‰¾ fooã€‚ack é»˜è®¤ä¼šè·³è¿‡å¾ˆå¤šæ²¡ç”¨çš„ç›®å½•å’Œæ–‡ä»¶ï¼Œè®©æŸ¥æ‰¾æ›´å¿«ï¼Œè¾“å‡ºç»“æœæ›´å‡†ç¡®ã€‚å¦å¤–åƒé»˜è®¤å¼€å¯çš„å½©è‰²æ˜¾ç¤ºä¹Ÿè®©äººç”¨èµ·æ¥å¾ˆèˆ’ç•…ã€‚\nack ç›®å‰å¤§éƒ¨åˆ†å‘è¡Œç‰ˆä¸­æ²¡æœ‰ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Ubuntu çš„è¯å…¶åŒ…è£¹åå­—æ˜¯ ack-grepï¼Œæ‰§è¡Œæ–‡ä»¶çš„åå­—ä¹Ÿä¸€æ ·ã€‚å…·ä½“å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æ–‡æ¡£ã€‚\nrsync æ¯”å¦‚è¯´ä½ æœ¬åœ°æœ‰ä¸€å°ç”µè„‘ï¼Œè¿œç¨‹æœ‰ä¸€å°æœåŠ¡å™¨ã€‚ä½ æƒ³æŠŠä½ çš„ä¸€ä¸ªæ–‡ä»¶å¤¹å…¨éƒ¨æ‹·è´åˆ°å¦å¤–ä¸€è¾¹çš„æŸä¸ªåœ°æ–¹å»ã€‚ä½ è¿™ä¸ªæ–‡ä»¶å¤¹ç»å¸¸ä¹Ÿè¦æ›´æ–°ï¼Œå¸Œæœ›é€šè¿‡æŸç§æ–¹å¼æŠŠæ›´æ–°çš„éƒ¨åˆ†èƒ½è¿…é€ŸåŒæ­¥è¿‡å»ã€‚è¿™åº”è¯¥æ€ä¹ˆåšï¼Ÿä¸çŸ¥é“ rsync çš„è¯ä½ å¯èƒ½ä¼šæƒ³ç”¨ gitï¼Œæ­å»ºä¸€ä¸ª ftpï¼Œæˆ–è€…ç”¨ scp æˆ–è€…åˆ«çš„ã€‚ä½†äº‹å®ä¸Š rsync æ‰æ˜¯çœŸæ­£çš„ä¸ºç²¾ç¡®çš„è§£å†³è¿™ä¸ªé—®é¢˜è€Œç”Ÿçš„è½¯ä»¶ã€‚rsync æœ€æ£’çš„åœ°æ–¹å°±æ˜¯å·®é‡æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯åªæŠŠå¦å¤–ä¸€è¾¹ç¼ºå°‘çš„ä¸œè¥¿ä¼ è¿‡å»ï¼Œè€Œä¸”ä½ ä¸éœ€è¦ä»»ä½•é¢å¤–é…ç½®ï¼Œé€Ÿåº¦å¿«çš„é£èµ·ã€‚ä¸€ä¸ªä¾‹å­ï¼š\nrsync -arvuzp --chmod=g+rx ./built/ me@example.com:/var/www/site\n1 aspell ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ä½ æ€»æœ‰ä¸€å¤©ä¼šè¦å†™è‹±æ–‡æ–‡æ¡£ã€‚æˆ‘ç­‰æ¯è¯­ä¸æ˜¯è‹±æ–‡çš„å‡ºç°æ‹¼å†™é”™è¯¯å®åœ¨æ˜¯å¤ªæ­£å¸¸äº†ã€‚å¦‚æœä½ ç”¨ Word çš„è¯ä¼šæœ‰ä¸‹åˆ’çº¿æç¤ºä½ ï¼Œä½†å¦‚æœä½ æ˜¯åœ¨ä»£ç é‡Œå†™æ³¨é‡Šæˆ–è€…å† Linux ä¸‹å†™ markdown çš„è¯å¥½åƒå°±æ²¡ä»€ä¹ˆåŠæ³•ã€‚äº‹å®ä¸Šè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå·²ç»è¢«è§£å†³çš„é—®é¢˜ï¼Œaspell æ­£æ˜¯æ¥åšè¿™ä¸ªçš„ã€‚aspell å¯ä»¥å¯¹ä»»ä½•çº¯æ–‡æœ¬è¿›è¡Œæ‹¼å†™æ£€æŸ¥ï¼Œä½œä¸ºé¢å‘ç¨‹åºå‘˜çš„å·¥å…·å®ƒå¯ä»¥ä¾¦æµ‹æ–‡ä»¶ç±»å‹ï¼Œæ¯”å¦‚å¯¹ C++ ç¨‹åºå®ƒå°±åªæ£€æŸ¥æ³¨é‡Šé‡Œçš„å•è¯ã€‚\ntee æœ‰æ—¶å€™æŸäº›å‘½ä»¤è¿è¡Œçš„ç»“æœä¼šå¾ˆé•¿ï¼Œä½ å¯èƒ½ä¼šç”¨ less æ¥ä¸Šä¸‹çœ‹ã€‚å†æˆ–è€…ä½ å¯èƒ½ä¼šç”¨ \u003e æ¥é‡å®šå‘åˆ°æ–‡ä»¶é‡Œã€‚ä½†æŸäº›æ—¶å€™ç¨‹åºæœ‰å¯èƒ½éœ€è¦ä½ è¾“å…¥ y æ¥ç¡®è®¤ï¼Œæˆ–è€…æŸäº›ç¨‹åºè¿è¡Œçš„æ—¶é—´å¾ˆé•¿ï¼Œä»…ä»…é‡å®šå‘çš„è¯åˆä¸å¤ªç¡®å®šæ˜¯ä¸æ˜¯å®ƒåœ¨æ­£å¸¸è¿è¡Œã€‚tee å°±èƒ½åšåˆ°åˆè¾“å‡ºåˆ°å±å¹•ä¸Šï¼ŒåˆåŒæ—¶é‡å®šå‘åˆ°æ–‡ä»¶ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š\n$ echo waht | tee out.txt\n1 waht ä¼šè¢«è¾“å‡ºåˆ°å±å¹•ä¸Šï¼ŒåŒæ—¶ä¹Ÿä¼šè¢«å†™åˆ° out.txt æ–‡ä»¶é‡Œã€‚å¦å¤– tee çš„æ„æ€å…¶å®æ˜¯ Tï¼ŒæŠŠè¾“å…¥è¾“å‡ºä¸­é—´æ‹‰äº†åˆå¤šæ‰¯å‡ºäº†ä¸€æ¡ï¼Œå¯è°“æ˜¯ç›¸å½“å½¢è±¡ã€‚\nå€¼å¾—ä¸€æçš„æ˜¯ vim ä¹Ÿå¯ä»¥ç”¨åœ¨ pipe é‡Œï¼Œä¾‹å­å¦‚ä¸‹ï¼š\n$ echo waht | vim -\n1 \u003cctrl+r\u003e ä½ è‚¯å®šçŸ¥é“ç”¨é”®ç›˜ä¸Šä¸‹æ–¹å‘é”®å¯ä»¥æ¥å›æ‰¾ä½ çš„å†å²ï¼Œé‚£ä¹ˆæ¯”å¦‚æœ‰ä¸€ä¸ªå¾ˆä¹…ä¹‹å‰æ‰“è¿‡çš„å‘½ä»¤ä½ å¯èƒ½éœ€è¦çŒ›æŒ‰ä¸Šæ‰èƒ½æ‰¾åˆ°ã€‚å…¶å®è¿™æ—¶å€™åªè¦è¾“å…¥ä¸€éƒ¨åˆ†ç„¶åæŒ‰ \u003cctrl+r\u003e bash å°±ä¼šå¸®ä½ å¾€å›æœç´¢ã€‚è¿ç»­æŒ‰ \u003cctrl+r\u003e å¯ä»¥æŒ‰é¡ºåºå¾€å‰æœã€‚(æˆ–è€…ç›´æ¥æŒ‰ \u003cctrl+r\u003e å†è¿›è¡Œè¾“å…¥)ã€‚æ¥ç€ä¸Šé¢ä¸€ä¸ªçš„ä¾‹å­ï¼Œè¾“å…¥ echo åæŒ‰ \u003cctrl+r\u003e æ•ˆæœå¦‚ä¸‹ï¼š\n(reverse-i-search)`echo': echo waht | vim -\n1 æœ‰å¾€å‰æœç´¢é‚£ä¹ˆä¸€èˆ¬å°±æœ‰å¾€åæœç´¢ã€‚å¯æƒœçš„æ˜¯å¾€åæœç´¢çš„å¿«æ·é”®æ˜¯ \u003cctrl+s\u003eï¼Œå¦‚æœä½ è¯•ç€æŒ‰ä¸€ä¸‹çš„å°±ä¼šå‘ç°...å¥½åƒæœºå™¨æ²¡ååº”äº†ã€‚è¿™ä¸ªæ˜¯å› ä¸º \u003cctrl+s\u003e å¤§éƒ¨åˆ†æƒ…å†µä¸‹é»˜è®¤æ˜¯ XOFFï¼Œä»£è¡¨æš‚åœæ¥æ”¶è¾“å…¥ã€‚æŒ‰ \u003cctrl+q\u003e å°±èƒ½æ¢å¤ã€‚å½“ç„¶ä½ å¯ä»¥æŠŠå‘å‰æœç´¢ç»‘å®šåˆ°åˆ«çš„é”®ä¸Šï¼Œè¯·è‡ªè¡Œæœç´¢ã€‚\ncloc è™½è¯´ä»£ç è¡Œæ•°ä¸èƒ½è¯´æ˜ä»»ä½•é—®é¢˜ï¼Œä½†æœ‰æ—¶å€™ä¸çŸ¥ä¸ºä»€å°±æ˜¯æƒ³çŸ¥é“ã€‚cloc èƒ½ç²¾ç¡®çš„è®¡ç®—ä»£ç è¡Œæ•°ï¼ŒæŠŠæ³¨é‡Šå’Œç©ºæ ¼éƒ½åŒºåˆ†å¼€ã€‚å¦‚æœä½ æ˜¯ä¸€åä¼ è¯´ä¸­çš„é¡¹ç›®ç»ç†çš„è¯ï¼Œä»ä»Šå¤©èµ·å¼€å§‹ç”¨ cloc ç»™ä½ æ‰‹ä¸‹çš„ç å†œç®—å·¥èµ„å§ï¼ä¸‹é™„æˆªå±ï¼š\n$ cloc /usr/include/\n9628 text files.\n9308 unique files.\n434 files ignored.\nT=39.0 s (227.6 files/s, 39948.2 lines/s)\n------------------------------------------------- Language files blank comment code\n------------------------------------------------- C/C++ Header 8875 217366 287013 1053368\nTeamcenter def 1 48 0 186\n------------------------------------------------- SUM: 8876 217414 287013 1053554\n------------------------------------------------- 1 2 3 4 5 6 7 8 9 10 11 12 13 14 printenv ç”¨ set å¯ä»¥æŸ¥çœ‹æ‰€æœ‰çš„ Shell å˜é‡è¿˜åŒ…æ‹¬ Shell å‡½æ•°ï¼Œä½†æ˜¯å…¶ä¸­æœ‰ä¸€äº›æ˜¯ä»…ä»…åœ¨å½“å‰ shell é‡Œå…¶ä½œç”¨çš„ã€‚è€Œå¾€å¾€ä½ éœ€è¦æ‰¾çš„æ˜¯é€šè¿‡ export æ¥å®šä¹‰çš„ç¯å¢ƒå˜é‡ã€‚printenv å°±æ˜¯ç”¨æ¥åšè¿™ä¸ªçš„ã€‚\nset -o vi bash æˆ–è€…å¯èƒ½ç»å¤§å¤šæ•°å¸¸è§ shell å…¶å®éƒ½æ˜¯æ”¯æŒç”¨ vi çš„æ–¹å¼è¿›è¡Œå‘½ä»¤è¡Œç¼–è¾‘çš„ï¼Œæ¯”å¦‚è®¾ç½®äº† set -o vi åä½ å°±å¯ä»¥ç”¨ç†Ÿæ‚‰çš„ hjkl æ¥ç§»åŠ¨ï¼Œç”¨ w, b æ¥è·³è¿‡å•è¯ç­‰ç­‰ã€‚\nåŒæ ·çš„å¦‚æœä½ è®¾ç½®äº† EDITOR ç¯å¢ƒå˜é‡çš„è¯ï¼Œè¾“å…¥ fc å°±å¯ä»¥æŠŠä¹‹å‰è¾“å…¥çš„å‘½ä»¤è¡Œæ”¾åˆ°ç¼–è¾‘å™¨é‡Œæ¥ç¼–è¾‘ï¼Œåªè¦ä¿å­˜äº†çš„è¯å°±ä¼šæ‰§è¡Œã€‚ç›¸åçš„æ”¾å¼ƒä¿å­˜å°±ç­‰äºæ˜¯æ”¾å¼ƒã€‚\nfind æˆ‘æŠŠä¸Šé¢è¯´åˆ°çš„é‚£æœ¬ä¹¦ä»”ç»†çœ‹è¿‡ä»¥åï¼Œæœ€å¤§çš„æ”¶è·ä¹‹ä¸€å°±æ˜¯ç»ˆäºå­¦ä¼šäº†ç”¨ findã€‚è¿™ä¸ªç°åœ¨å˜æˆäº†æˆ‘å‡ ä¹æ¯å¤©éƒ½åœ¨ç”¨çš„ä¸€ä¸ªå‘½ä»¤ã€‚æ¯”å¦‚è¯´æˆ‘è¦æŠŠç›®å½•ä¸‹æ‰€æœ‰çš„ png æ–‡ä»¶åŠ å…¥åˆ°è¿™æ¬¡çš„ git commit é‡Œé¢ï¼Œæˆ‘å¯ä»¥ç”¨:\nfind . -name '*.png' -exec git add {} ';'\n1 å¦‚æœä½ ç†Ÿæ‚‰ find çš„è¯ä½ ä¼šçŸ¥é“æœ€åçš„ ; å¯ä»¥æ¢ä¸º + ä¼šæ›´å¥½ï¼Œä½†ç”¨å®ƒå°±æ˜¯æœ‰ç›®çš„çš„ã€‚è¿™ä¸ªå‘½ä»¤è™½ç„¶çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†é‡Œé¢çš„å•å¼•å·çœç•¥æˆ–è€…æ¢æˆåŒå¼•å·å‘½ä»¤éƒ½æ˜¯ä¼šå¤±è´¥çš„ã€‚è¿™äº›ç‰µæ¶‰åˆ° \"shell variable expansion\" å’Œå¼•å·çš„ escape è§„åˆ™ï¼Œè™½ç„¶æ„Ÿè§‰å¾ˆæ¼ç«ä½†å…¶å®è¿™äº›åªæœ‰å‡ ä¸ªç®€å•çš„è§„åˆ™ï¼Œè€Œä¸”ä¸€è‡´æ€§éå¸¸å¥½ã€‚æ‰€ä»¥åªè¦ä½ è‚¯èŠ±ç‚¹æ—¶é—´æŠŠç›¸å…³ä¸œè¥¿å¼„æ¸…æ¥šï¼Œè¿™ç§ç®€å•çš„é—®é¢˜å°±å¯ä»¥è½»æ¾æå®šã€‚\ntype å¦‚æœ foo æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œé‡Œå¯ä»¥ç›´æ¥è¿è¡Œçš„ç¨‹åºçš„è¯ï¼Œä½ åº”è¯¥çŸ¥é“ç”¨ which foo å¯ä»¥æ‰¾åˆ° foo çš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„åœ¨é‚£é‡Œã€‚ä½†åœ¨å‘½ä»¤è¡Œé‡Œå¯ä»¥æ‰§è¡Œçš„å‘½ä»¤å¹¶ä¸ä¸€å®šéƒ½å¯¹åº”åˆ°æŸä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶ï¼Œå®ƒå¯ä»¥æ˜¯ alias, shell è‡ªå¸¦çš„å‡½æ•°å’Œç”¨æˆ·è‡ªå·±çš„å‡½æ•°ç­‰ç­‰ã€‚æ‰€ä»¥æœ‰æ—¶å€™ç”¨ which æ‰¾åˆ°ä¸åˆ°ä¸œè¥¿çš„æ—¶å€™ä¼šè®©äººå¾ˆç–‘æƒ‘ã€‚å…¶å®ä½ å¯ä»¥ç”¨ type foo çœ‹çœ‹ foo åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹çš„ã€‚\nhelp ä¸Šé¢æåˆ°äº† \"builtin command\" ä¹Ÿå°±æ˜¯å†…ç½®å‘½ä»¤ï¼Œå°±æ˜¯ç”± shell æä¾›çš„ä¸€äº›åŸºæœ¬çš„æˆ–è€…æ— æ³•ç”±å¤–éƒ¨ç¨‹åºåšåˆ°çš„å‘½ä»¤ã€‚å¹³å¸¸ä½ å¯ä»¥ç”¨ man æ¥æŸ¥çœ‹æ–‡æ¡£ï¼Œä½†æ˜¯å¯¹äºå†…ç½®å‘½ä»¤ man ä¼šè·³åˆ° shell è‡ªå·±çš„ manpageï¼Œåœ¨æŸäº›ç³»ç»Ÿé‡Œé‚£å°±æ˜¯å·¨å¤§çš„ä¸€é¡µä½ è¦å†é‡Œé¢æ‰¾åˆ°ä½ æƒ³çœ‹çš„ä¸œè¥¿ï¼Œæœ‰äº›ç³»ç»Ÿé‡Œå¹²è„†å°±æ²¡æœ‰ç›¸å…³çš„ä¿¡æ¯ã€‚è¿™ç§æ—¶å€™ç”¨ help è¿™ä¸ªå†…ç½®å‘½ä»¤å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šæ¯”å¦‚è¦æŸ¥çœ‹ set çš„æ¥å—çš„é€‰é¡¹ï¼Œå¯ä»¥ç”¨ help set æ¥è½»æ¾æ‰¾åˆ°ã€‚\nenv ä½ åº”è¯¥çŸ¥é“åœ¨ #! (shebang) åœ¨è„šæœ¬ç¬¬ä¸€è¡Œçš„ä½œç”¨æ˜¯æŒ‡å®šå…¶ 'runtime'ã€‚æ¯”å¦‚è¯´ä½ æƒ³è¦å†™ä¸€ä¸ª Python çš„è„šæœ¬ï¼Œä½†å…¶å®ä¸å¤ªåœ¨æ„å…¶ç‰ˆæœ¬ï¼Œæˆ–è€…ä¸ç¡®å®šå…¶å¯æ‰§è¡Œæ–‡ä»¶åœ¨ä¸åŒçš„æœºå™¨ä¸Šåˆ°åº•åœ¨å“ªé‡Œã€‚é‚£ä¹ˆ env åœ¨è¿™é‡Œå°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ã€‚å¯ä»¥å†™æˆ #!/usr/bin/env pythonï¼Œè¿™æ ·æ‰§è¡Œçš„æ—¶å€™å°±ä¼šç”¨å½“å‰ PATH ä¸­æ‰¾åˆ°çš„ pythonã€‚å¦ä¸€æ–¹é¢è¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªç»™ä½ ä¸€ä¸ªåœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹ï¼Œé‡æ–°é€‰æ‹© 'runtime' çš„æœºä¼šã€‚\nfile å¦‚æœä½ æƒ³çŸ¥é“æŸä¸ªè·¯å¾„ä¸Šçš„æ–‡ä»¶åˆ°åº•æ˜¯ä»€ä¹ˆç±»å‹çš„ï¼Œé‚£ä¹ˆç”¨ file æ˜¯å†åˆé€‚ä¸è¿‡çš„äº†ã€‚å®ƒèƒ½å¯¹ä»»ä½•ä¸œè¥¿éƒ½ç»™å‡ºä¸€ä¸ªæœ‰æ„ä¹‰çš„è§£é‡Šï¼Œå¯¹äºäºŒè¿›åˆ¶æ–‡ä»¶è¿˜ä¼šåˆ—å‡ºå¾ˆå¤šç›¸å…³çš„é‡è¦ä¿¡æ¯ã€‚\nstrings â€œæˆ‘æŠŠæˆ‘çš„ç§˜å¯†ï¼Œæ”¾åœ¨äº†è¿™ä¸ªç”¨ C++ ç¼–å†™çš„ç¨‹åºé‡Œé¢ã€‚è¿è¡Œå®ƒè¾“å…¥æ­£ç¡®çš„å¯†ç æ‰èƒ½çœ‹åˆ°â€ã€‚å…¶å®ä¸‡ä¸€é‡åˆ°è¿™ç§æƒ…å†µä½ åªè¦è·‘ strings program-written-in-cxx åæœ‰å…«ä¹ä½ å°±èƒ½çœ‹åˆ°äº†ã€‚å®ƒèƒ½æ¯”è¾ƒå‡†ç¡®çš„åˆ—å‡ºäºŒè¿›åˆ¶æ–‡ä»¶é‡ŒåŒ…å«çš„ C é£æ ¼çš„å­—ç¬¦ä¸²ã€‚çœ‹èµ·æ¥æ²¡ä»€ä¹ˆæ„ä¹‰ä½†æ˜¯å…¶å®ä½œç”¨å®Œå…¨è¦é ä½ å‘æŒ¥ï¼Œæ¯”å¦‚è¦çŸ¥é“æŸä¸ªç¨‹åºæ˜¯å“ªä¸ªç‰ˆæœ¬ GCC ç¼–è¯‘å‡ºæ¥çš„ç”¨ strings å¯èƒ½æœ‰ç»“æœã€‚\nod å…¨ç¨‹åº”è¯¥æ˜¯ \"object dump\"ï¼Œå¯ä»¥å°†æ–‡ä»¶æŒ‰å…«è¿›åˆ¶ï¼Œåå…­è¿›åˆ¶æˆ–è€…å…¶ä»–æ–¹å¼æ˜¾ç¤ºå‡ºæ¥ã€‚æˆ‘è§‰å¾—å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿™å¤§å®¶éƒ½åœ¨ç”¨ od -cï¼Œå°†æ–‡ä»¶æŒ‰ ASCII ç  dump å‡ºæ¥ã€‚ä¸€ä¸ªç”¨ä¾‹æ˜¯ç”¨æ¥çœ‹æ–‡ä»¶çš„ line ending åˆ°åº•æ˜¯æ€æ ·çš„ã€‚æ¯”å¦‚æ‰§è¡Œ od -c foo.txt æ˜¾ç¤ºå¦‚ä¸‹ç»“æœï¼š\n$ od -c foo.txt\n0000000 h e l l o \\t w o r l d \\r \\n y e a\n0000020 h\n0000021 1 2 3 4 å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ° \\t æ˜¯ tab å­—ç¬¦ï¼Œ \\r\\n æ˜¯ Windows é£æ ¼çš„æ¢è¡Œç¬¦ã€‚\næœ€å æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œåªæ˜¯å¦‚æœåé¢è¿˜ç¢°åˆ°å¥½ç”¨çš„å‘½ä»¤è¡Œå·¥å…·æˆ‘ä¼šå†æ·»åŠ åœ¨è¿™é‡Œã€‚\n","description":"","tags":["command-line"],"title":"åˆ—ä¸¾ä¸€äº›å¥½ç”¨çš„å‘½ä»¤è¡Œå·¥å…·","uri":"/blog/posts/Linux/%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/"},{"categories":["Linux"],"content":"å‘½ä»¤è¡Œçš„è‰ºæœ¯ ç†Ÿç»ƒä½¿ç”¨å‘½ä»¤è¡Œæ˜¯ä¸€ç§å¸¸å¸¸è¢«å¿½è§†ï¼Œæˆ–è¢«è®¤ä¸ºéš¾ä»¥æŒæ¡çš„æŠ€èƒ½ï¼Œä½†å®é™…ä¸Šï¼Œå®ƒä¼šæé«˜ä½ ä½œä¸ºå·¥ç¨‹å¸ˆçš„çµæ´»æ€§ä»¥åŠç”Ÿäº§åŠ›ã€‚æœ¬æ–‡æ˜¯ä¸€ä»½æˆ‘åœ¨ Linux ä¸Šå·¥ä½œæ—¶ï¼Œå‘ç°çš„ä¸€äº›å‘½ä»¤è¡Œä½¿ç”¨æŠ€å·§çš„æ‘˜è¦ã€‚æœ‰äº›æŠ€å·§éå¸¸åŸºç¡€ï¼Œè€Œå¦ä¸€äº›åˆ™ç›¸å½“å¤æ‚ï¼Œç”šè‡³æ™¦æ¶©éš¾æ‡‚ã€‚è¿™ç¯‡æ–‡ç« å¹¶ä¸é•¿ï¼Œä½†å½“ä½ èƒ½å¤Ÿç†Ÿç»ƒæŒæ¡è¿™é‡Œåˆ—å‡ºçš„æ‰€æœ‰æŠ€å·§æ—¶ï¼Œä½ å°±å­¦ä¼šäº†å¾ˆå¤šå…³äºå‘½ä»¤è¡Œçš„ä¸œè¥¿äº†ã€‚\nå‰è¨€ åŸºç¡€ æ—¥å¸¸ä½¿ç”¨ æ–‡ä»¶åŠæ•°æ®å¤„ç† ç³»ç»Ÿè°ƒè¯• å•è¡Œè„šæœ¬ å†·é—¨ä½†æœ‰ç”¨ ä»…é™ OS X ç³»ç»Ÿ ä»…é™ Windows ç³»ç»Ÿ æ›´å¤šèµ„æº å…è´£å£°æ˜ è¿™ç¯‡æ–‡ç« æ˜¯è®¸å¤šä½œè€…å’Œè¯‘è€…å…±åŒçš„æˆæœã€‚ è¿™é‡Œçš„éƒ¨åˆ†å†…å®¹ é¦–æ¬¡ å‡ºç° äº Quoraï¼Œ ä½†å·²ç»è¿ç§»åˆ°äº† Githubï¼Œå¹¶ç”±ä¼—å¤šé«˜æ‰‹åšå‡ºäº†è®¸å¤šæ”¹è¿›ã€‚ å¦‚æœä½ åœ¨æœ¬æ–‡ä¸­å‘ç°äº†é”™è¯¯æˆ–è€…å­˜åœ¨å¯ä»¥æ”¹å–„çš„åœ°æ–¹ï¼Œè¯·[è´¡çŒ®ä½ çš„ä¸€ä»½åŠ›é‡]\nå‰è¨€ æ¶µç›–èŒƒå›´ï¼š\nè¿™ç¯‡æ–‡ç« ä¸ä»…èƒ½å¸®åŠ©åˆšæ¥è§¦å‘½ä»¤è¡Œçš„æ–°æ‰‹ï¼Œè€Œä¸”å¯¹å…·æœ‰ç»éªŒçš„äººä¹Ÿå¤§æœ‰è£¨ç›Šã€‚æœ¬æ–‡è‡´åŠ›äºåšåˆ°è¦†ç›–é¢å¹¿ï¼ˆæ¶‰åŠæ‰€æœ‰é‡è¦çš„å†…å®¹ï¼‰ï¼Œå…·ä½“ï¼ˆç»™å‡ºå…·ä½“çš„æœ€å¸¸ç”¨çš„ä¾‹å­ï¼‰ï¼Œä»¥åŠç®€æ´ï¼ˆé¿å…å†—ä½™çš„å†…å®¹ï¼Œæˆ–æ˜¯å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹è½»æ¾æŸ¥åˆ°çš„ç»†ææœ«èŠ‚ï¼‰ã€‚åœ¨ç‰¹å®šåº”ç”¨åœºæ™¯ä¸‹ï¼Œæœ¬æ–‡çš„å†…å®¹å±äºåŸºæœ¬åŠŸæˆ–è€…èƒ½å¸®åŠ©æ‚¨èŠ‚çº¦å¤§é‡çš„æ—¶é—´ã€‚ æœ¬æ–‡ä¸»è¦ä¸º Linux æ‰€å†™ï¼Œä½†åœ¨ä»…é™ OS X ç³»ç»Ÿç« èŠ‚å’Œä»…é™ Windows ç³»ç»Ÿç« èŠ‚ä¸­ä¹ŸåŒ…å«æœ‰å¯¹åº”æ“ä½œç³»ç»Ÿçš„å†…å®¹ã€‚é™¤å»è¿™ä¸¤ä¸ªç« èŠ‚å¤–ï¼Œå…¶å®ƒçš„å†…å®¹å¤§éƒ¨åˆ†å‡å¯åœ¨å…¶ä»–ç±» Unix ç³»ç»Ÿæˆ– OS Xï¼Œç”šè‡³ Cygwin ä¸­å¾—åˆ°åº”ç”¨ã€‚ æœ¬æ–‡ä¸»è¦å…³æ³¨äºäº¤äº’å¼ Bashï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šæŠ€å·§å¯ä»¥åº”ç”¨äºå…¶ä»– shell å’Œ Bash è„šæœ¬å½“ä¸­ã€‚ é™¤å»â€œæ ‡å‡†çš„â€Unix å‘½ä»¤ï¼Œæœ¬æ–‡è¿˜åŒ…æ‹¬äº†ä¸€äº›ä¾èµ–äºç‰¹å®šè½¯ä»¶åŒ…çš„å‘½ä»¤ï¼ˆå‰ææ˜¯å®ƒä»¬å…·æœ‰è¶³å¤Ÿçš„ä»·å€¼ï¼‰ã€‚ æ³¨æ„äº‹é¡¹ï¼š\nä¸ºäº†èƒ½åœ¨ä¸€é¡µå†…å±•ç¤ºå°½é‡å¤šçš„ä¸œè¥¿ï¼Œä¸€äº›å…·ä½“çš„ä¿¡æ¯å¯ä»¥åœ¨å¼•ç”¨çš„é¡µé¢ä¸­æ‰¾åˆ°ã€‚æˆ‘ä»¬ç›¸ä¿¡æœºæ™ºçš„ä½ çŸ¥é“å¦‚ä½•ä½¿ç”¨ Google æˆ–è€…å…¶ä»–æœç´¢å¼•æ“æ¥æŸ¥é˜…åˆ°æ›´å¤šçš„è¯¦ç»†ä¿¡æ¯ã€‚æ–‡ä¸­éƒ¨åˆ†å‘½ä»¤éœ€è¦æ‚¨ä½¿ç”¨ apt-getï¼Œyumï¼Œdnfï¼Œpacmanï¼Œ pip æˆ– brewï¼ˆä»¥åŠå…¶å®ƒåˆé€‚çš„åŒ…ç®¡ç†å™¨ï¼‰æ¥å®‰è£…ä¾èµ–çš„ç¨‹åºã€‚ é‡åˆ°é—®é¢˜çš„è¯ï¼Œè¯·å°è¯•ä½¿ç”¨ Explainshell å»è·å–ç›¸å…³å‘½ä»¤ã€å‚æ•°ã€ç®¡é“ç­‰å†…å®¹çš„è§£é‡Šã€‚ åŸºç¡€ å­¦ä¹  Bash çš„åŸºç¡€çŸ¥è¯†ã€‚å…·ä½“åœ°ï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ man bash å¹¶è‡³å°‘å…¨æ–‡æµè§ˆä¸€é; å®ƒç†è§£èµ·æ¥å¾ˆç®€å•å¹¶ä¸”ä¸å†—é•¿ã€‚å…¶ä»–çš„ shell å¯èƒ½å¾ˆå¥½ç”¨ï¼Œä½† Bash çš„åŠŸèƒ½å·²ç»è¶³å¤Ÿå¼ºå¤§å¹¶ä¸”åˆ°å‡ ä¹æ€»æ˜¯å¯ç”¨çš„ï¼ˆ å¦‚æœä½ åªå­¦ä¹  zshï¼Œfish æˆ–å…¶ä»–çš„ shell çš„è¯ï¼Œåœ¨ä½ è‡ªå·±çš„è®¾å¤‡ä¸Šä¼šæ˜¾å¾—å¾ˆæ–¹ä¾¿ï¼Œä½†è¿‡åº¦ä¾èµ–è¿™äº›åŠŸèƒ½ä¼šç»™æ‚¨å¸¦æ¥ä¸ä¾¿ï¼Œä¾‹å¦‚å½“ä½ éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šå·¥ä½œæ—¶ï¼‰ã€‚\nç†Ÿæ‚‰è‡³å°‘ä¸€ä¸ªåŸºäºæ–‡æœ¬çš„ç¼–è¾‘å™¨ã€‚é€šå¸¸è€Œè¨€ Vim ï¼ˆviï¼‰ ä¼šæ˜¯ä½ æœ€å¥½çš„é€‰æ‹©ï¼Œæ¯•ç«Ÿåœ¨ç»ˆç«¯ä¸­ç¼–è¾‘æ–‡æœ¬æ—¶ Vim æ˜¯æœ€å¥½ç”¨çš„å·¥å…·ï¼ˆç”šè‡³å¤§éƒ¨åˆ†æƒ…å†µä¸‹ Vim è¦æ¯” Emacsã€å¤§å‹ IDE æˆ–æ˜¯ç‚«é…·çš„ç¼–è¾‘å™¨æ›´å¥½ç”¨ï¼‰ã€‚\nå­¦ä¼šå¦‚ä½•ä½¿ç”¨ man å‘½ä»¤å»é˜…è¯»æ–‡æ¡£ã€‚å­¦ä¼šä½¿ç”¨ apropos å»æŸ¥æ‰¾æ–‡æ¡£ã€‚çŸ¥é“æœ‰äº›å‘½ä»¤å¹¶ä¸å¯¹åº”å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œæ˜¯åœ¨ Bash å†…ç½®å¥½çš„ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ help å’Œ help -d å‘½ä»¤è·å–å¸®åŠ©ä¿¡æ¯ã€‚ä½ å¯ä»¥ç”¨ type å‘½ä»¤ æ¥åˆ¤æ–­è¿™ä¸ªå‘½ä»¤åˆ°åº•æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ã€shell å†…ç½®å‘½ä»¤è¿˜æ˜¯åˆ«åã€‚\nå­¦ä¼šä½¿ç”¨ \u003e å’Œ \u003c æ¥é‡å®šå‘è¾“å‡ºå’Œè¾“å…¥ï¼Œå­¦ä¼šä½¿ç”¨ | æ¥é‡å®šå‘ç®¡é“ã€‚æ˜ç™½ \u003e ä¼šè¦†ç›–äº†è¾“å‡ºæ–‡ä»¶è€Œ \u003e\u003e æ˜¯åœ¨æ–‡ä»¶æœ«æ·»åŠ ã€‚äº†è§£æ ‡å‡†è¾“å‡º stdout å’Œæ ‡å‡†é”™è¯¯ stderrã€‚\nå­¦ä¼šä½¿ç”¨é€šé…ç¬¦ * ï¼ˆæˆ–è®¸å†ç®—ä¸Š ? å’Œ [...]ï¼‰ å’Œå¼•ç”¨ä»¥åŠå¼•ç”¨ä¸­ ' å’Œ \" çš„åŒºåˆ«ï¼ˆåæ–‡ä¸­æœ‰ä¸€äº›å…·ä½“çš„ä¾‹å­ï¼‰ã€‚\nç†Ÿæ‚‰ Bash ä¸­çš„ä»»åŠ¡ç®¡ç†å·¥å…·ï¼š\u0026ï¼Œctrl-zï¼Œctrl-cï¼Œjobsï¼Œfgï¼Œbgï¼Œkill ç­‰ã€‚\nå­¦ä¼šä½¿ç”¨ ssh è¿›è¡Œè¿œç¨‹å‘½ä»¤è¡Œç™»å½•ï¼Œæœ€å¥½çŸ¥é“å¦‚ä½•ä½¿ç”¨ ssh-agentï¼Œssh-add ç­‰å‘½ä»¤æ¥å®ç°åŸºç¡€çš„æ— å¯†ç è®¤è¯ç™»å½•ã€‚\nå­¦ä¼šåŸºæœ¬çš„æ–‡ä»¶ç®¡ç†å·¥å…·ï¼šls å’Œ ls -l ï¼ˆäº†è§£ ls -l ä¸­æ¯ä¸€åˆ—ä»£è¡¨çš„æ„ä¹‰ï¼‰ï¼Œlessï¼Œheadï¼Œtail å’Œ tail -f ï¼ˆç”šè‡³ less +Fï¼‰ï¼Œln å’Œ ln -s ï¼ˆäº†è§£ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„åŒºåˆ«ï¼‰ï¼Œchownï¼Œchmodï¼Œdu ï¼ˆç¡¬ç›˜ä½¿ç”¨æƒ…å†µæ¦‚è¿°ï¼šdu -hs *ï¼‰ã€‚ å…³äºæ–‡ä»¶ç³»ç»Ÿçš„ç®¡ç†ï¼Œå­¦ä¹  dfï¼Œmountï¼Œfdiskï¼Œmkfsï¼Œlsblkã€‚çŸ¥é“ inode æ˜¯ä»€ä¹ˆï¼ˆä¸ ls -i å’Œ df -i ç­‰å‘½ä»¤ç›¸å…³ï¼‰ã€‚\nå­¦ä¹ åŸºæœ¬çš„ç½‘ç»œç®¡ç†å·¥å…·ï¼šip æˆ– ifconfigï¼Œdigã€‚\nå­¦ä¹ å¹¶ä½¿ç”¨ä¸€ç§ç‰ˆæœ¬æ§åˆ¶ç®¡ç†ç³»ç»Ÿï¼Œä¾‹å¦‚ gitã€‚\nç†Ÿæ‚‰æ­£åˆ™è¡¨è¾¾å¼ï¼Œå­¦ä¼šä½¿ç”¨ grepï¼egrepï¼Œå®ƒä»¬çš„å‚æ•°ä¸­ -iï¼Œ-oï¼Œ-vï¼Œ-Aï¼Œ-B å’Œ -C è¿™äº›æ˜¯å¾ˆå¸¸ç”¨å¹¶å€¼å¾—è®¤çœŸå­¦ä¹ çš„ã€‚\nå­¦ä¼šä½¿ç”¨ apt-getï¼Œyumï¼Œdnf æˆ– pacman ï¼ˆå…·ä½“ä½¿ç”¨å“ªä¸ªå–å†³äºä½ ä½¿ç”¨çš„ Linux å‘è¡Œç‰ˆï¼‰æ¥æŸ¥æ‰¾å’Œå®‰è£…è½¯ä»¶åŒ…ã€‚å¹¶ç¡®ä¿ä½ çš„ç¯å¢ƒä¸­æœ‰ pip æ¥å®‰è£…åŸºäº Python çš„å‘½ä»¤è¡Œå·¥å…· ï¼ˆæ¥ä¸‹æ¥æåˆ°çš„éƒ¨åˆ†ç¨‹åºä½¿ç”¨ pip æ¥å®‰è£…ä¼šå¾ˆæ–¹ä¾¿ï¼‰ã€‚\næ—¥å¸¸ä½¿ç”¨ åœ¨ Bash ä¸­ï¼Œå¯ä»¥é€šè¿‡æŒ‰ Tab é”®å®ç°è‡ªåŠ¨è¡¥å…¨å‚æ•°ï¼Œä½¿ç”¨ ctrl-r æœç´¢å‘½ä»¤è¡Œå†å²è®°å½•ï¼ˆæŒ‰ä¸‹æŒ‰é”®ä¹‹åï¼Œè¾“å…¥å…³é”®å­—ä¾¿å¯ä»¥æœç´¢ï¼Œé‡å¤æŒ‰ä¸‹ ctrl-r ä¼šå‘åæŸ¥æ‰¾åŒ¹é…é¡¹ï¼ŒæŒ‰ä¸‹ Enter é”®ä¼šæ‰§è¡Œå½“å‰åŒ¹é…çš„å‘½ä»¤ï¼Œè€ŒæŒ‰ä¸‹å³æ–¹å‘é”®ä¼šå°†åŒ¹é…é¡¹æ”¾å…¥å½“å‰è¡Œä¸­ï¼Œä¸ä¼šç›´æ¥æ‰§è¡Œï¼Œä»¥ä¾¿åšå‡ºä¿®æ”¹ï¼‰ã€‚\nåœ¨ Bash ä¸­ï¼Œå¯ä»¥æŒ‰ä¸‹ ctrl-w åˆ é™¤ä½ é”®å…¥çš„æœ€åä¸€ä¸ªå•è¯ï¼Œctrl-u å¯ä»¥åˆ é™¤è¡Œå†…å…‰æ ‡æ‰€åœ¨ä½ç½®ä¹‹å‰çš„å†…å®¹ï¼Œalt-b å’Œ alt-f å¯ä»¥ä»¥å•è¯ä¸ºå•ä½ç§»åŠ¨å…‰æ ‡ï¼Œctrl-a å¯ä»¥å°†å…‰æ ‡ç§»è‡³è¡Œé¦–ï¼Œctrl-e å¯ä»¥å°†å…‰æ ‡ç§»è‡³è¡Œå°¾ï¼Œctrl-k å¯ä»¥åˆ é™¤å…‰æ ‡è‡³è¡Œå°¾çš„æ‰€æœ‰å†…å®¹ï¼Œctrl-l å¯ä»¥æ¸…å±ã€‚é”®å…¥ man readline å¯ä»¥æŸ¥çœ‹ Bash ä¸­çš„é»˜è®¤å¿«æ·é”®ã€‚å†…å®¹æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ alt-. å¾ªç¯åœ°ç§»å‘å‰ä¸€ä¸ªå‚æ•°ï¼Œè€Œ alt-* å¯ä»¥å±•å¼€é€šé…ç¬¦ã€‚\nä½ å–œæ¬¢çš„è¯ï¼Œå¯ä»¥æ‰§è¡Œ set -o vi æ¥ä½¿ç”¨ vi é£æ ¼çš„å¿«æ·é”®ï¼Œè€Œæ‰§è¡Œ set -o emacs å¯ä»¥æŠŠå®ƒæ”¹å›æ¥ã€‚\nä¸ºäº†ä¾¿äºç¼–è¾‘é•¿å‘½ä»¤ï¼Œåœ¨è®¾ç½®ä½ çš„é»˜è®¤ç¼–è¾‘å™¨åï¼ˆä¾‹å¦‚ export EDITOR=vimï¼‰ï¼Œctrl-x ctrl-e ä¼šæ‰“å¼€ä¸€ä¸ªç¼–è¾‘å™¨æ¥ç¼–è¾‘å½“å‰è¾“å…¥çš„å‘½ä»¤ã€‚åœ¨ vi é£æ ¼ä¸‹å¿«æ·é”®åˆ™æ˜¯ escape-vã€‚\né”®å…¥ history æŸ¥çœ‹å‘½ä»¤è¡Œå†å²è®°å½•ï¼Œå†ç”¨ !nï¼ˆn æ˜¯å‘½ä»¤ç¼–å·ï¼‰å°±å¯ä»¥å†æ¬¡æ‰§è¡Œã€‚å…¶ä¸­æœ‰è®¸å¤šç¼©å†™ï¼Œæœ€æœ‰ç”¨çš„å¤§æ¦‚å°±æ˜¯ !$ï¼Œ å®ƒç”¨äºæŒ‡ä»£ä¸Šæ¬¡é”®å…¥çš„å‚æ•°ï¼Œè€Œ !! å¯ä»¥æŒ‡ä»£ä¸Šæ¬¡é”®å…¥çš„å‘½ä»¤äº†ï¼ˆå‚è€ƒ man é¡µé¢ä¸­çš„â€œHISTORY EXPANSIONâ€ï¼‰ã€‚ä¸è¿‡è¿™äº›åŠŸèƒ½ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡å¿«æ·é”® ctrl-r å’Œ alt-. æ¥å®ç°ã€‚\ncd å‘½ä»¤å¯ä»¥åˆ‡æ¢å·¥ä½œè·¯å¾„ï¼Œè¾“å…¥ cd ~ å¯ä»¥è¿›å…¥ home ç›®å½•ã€‚è¦è®¿é—®ä½ çš„ home ç›®å½•ä¸­çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨å‰ç¼€ ~ï¼ˆä¾‹å¦‚ ~/.bashrcï¼‰ã€‚åœ¨ sh è„šæœ¬é‡Œåˆ™ç”¨ç¯å¢ƒå˜é‡ $HOME æŒ‡ä»£ home ç›®å½•çš„è·¯å¾„ã€‚\nå›åˆ°å‰ä¸€ä¸ªå·¥ä½œè·¯å¾„ï¼šcd -ã€‚\nå¦‚æœä½ è¾“å…¥å‘½ä»¤çš„æ—¶å€™ä¸­é€”æ”¹äº†ä¸»æ„ï¼ŒæŒ‰ä¸‹ alt-# åœ¨è¡Œé¦–æ·»åŠ  # æŠŠå®ƒå½“åšæ³¨é‡Šå†æŒ‰ä¸‹å›è½¦æ‰§è¡Œï¼ˆæˆ–è€…ä¾æ¬¡æŒ‰ä¸‹ ctrl-aï¼Œ #ï¼Œ enterï¼‰ã€‚è¿™æ ·åšçš„è¯ï¼Œä¹‹åå€ŸåŠ©å‘½ä»¤è¡Œå†å²è®°å½•ï¼Œä½ å¯ä»¥å¾ˆæ–¹ä¾¿æ¢å¤ä½ åˆšæ‰è¾“å…¥åˆ°ä¸€åŠçš„å‘½ä»¤ã€‚\nä½¿ç”¨ xargs ï¼ˆ æˆ– parallelï¼‰ã€‚ä»–ä»¬éå¸¸ç»™åŠ›ã€‚æ³¨æ„åˆ°ä½ å¯ä»¥æ§åˆ¶æ¯è¡Œå‚æ•°ä¸ªæ•°ï¼ˆ-Lï¼‰å’Œæœ€å¤§å¹¶è¡Œæ•°ï¼ˆ-Pï¼‰ã€‚å¦‚æœä½ ä¸ç¡®å®šå®ƒä»¬æ˜¯å¦ä¼šæŒ‰ä½ æƒ³çš„é‚£æ ·å·¥ä½œï¼Œå…ˆä½¿ç”¨ xargs echo æŸ¥çœ‹ä¸€ä¸‹ã€‚æ­¤å¤–ï¼Œä½¿ç”¨ -I{} ä¼šå¾ˆæ–¹ä¾¿ã€‚ä¾‹å¦‚ï¼š\n1 2 find . -name '*.py' | xargs grep some_function cat hosts | xargs -I{} ssh root@{} hostname pstree -p ä»¥ä¸€ç§ä¼˜é›…çš„æ–¹å¼å±•ç¤ºè¿›ç¨‹æ ‘ã€‚\nä½¿ç”¨ pgrep å’Œ pkill æ ¹æ®åå­—æŸ¥æ‰¾è¿›ç¨‹æˆ–å‘é€ä¿¡å·ï¼ˆ-f å‚æ•°é€šå¸¸æœ‰ç”¨ï¼‰ã€‚\näº†è§£ä½ å¯ä»¥å‘å¾€è¿›ç¨‹çš„ä¿¡å·çš„ç§ç±»ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨ kill -STOP [pid] åœæ­¢ä¸€ä¸ªè¿›ç¨‹ã€‚ä½¿ç”¨ man 7 signal æŸ¥çœ‹è¯¦ç»†åˆ—è¡¨ã€‚\nä½¿ç”¨ nohup æˆ– disown ä½¿ä¸€ä¸ªåå°è¿›ç¨‹æŒç»­è¿è¡Œã€‚\nä½¿ç”¨ netstat -lntp æˆ– ss -plat æ£€æŸ¥å“ªäº›è¿›ç¨‹åœ¨ç›‘å¬ç«¯å£ï¼ˆé»˜è®¤æ˜¯æ£€æŸ¥ TCP ç«¯å£; æ·»åŠ å‚æ•° -u åˆ™æ£€æŸ¥ UDP ç«¯å£ï¼‰æˆ–è€… lsof -iTCP -sTCP:LISTEN -P -n (è¿™ä¹Ÿå¯ä»¥åœ¨ OS X ä¸Šè¿è¡Œ)ã€‚\nlsof æ¥æŸ¥çœ‹å¼€å¯çš„å¥—æ¥å­—å’Œæ–‡ä»¶ã€‚\nä½¿ç”¨ uptime æˆ– w æ¥æŸ¥çœ‹ç³»ç»Ÿå·²ç»è¿è¡Œå¤šé•¿æ—¶é—´ã€‚\nä½¿ç”¨ alias æ¥åˆ›å»ºå¸¸ç”¨å‘½ä»¤çš„å¿«æ·å½¢å¼ã€‚ä¾‹å¦‚ï¼šalias ll='ls -latr' åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‘½ä»¤åˆ«å llã€‚\nå¯ä»¥æŠŠåˆ«åã€shell é€‰é¡¹å’Œå¸¸ç”¨å‡½æ•°ä¿å­˜åœ¨ ~/.bashrcï¼Œå…·ä½“çœ‹ä¸‹è¿™ç¯‡æ–‡ç« ã€‚è¿™æ ·åšçš„è¯ä½ å°±å¯ä»¥åœ¨æ‰€æœ‰ shell ä¼šè¯ä¸­ä½¿ç”¨ä½ çš„è®¾å®šã€‚\næŠŠç¯å¢ƒå˜é‡çš„è®¾å®šä»¥åŠç™»é™†æ—¶è¦æ‰§è¡Œçš„å‘½ä»¤ä¿å­˜åœ¨ ~/.bash_profileã€‚è€Œå¯¹äºä»å›¾å½¢ç•Œé¢å¯åŠ¨çš„ shell å’Œ cron å¯åŠ¨çš„ shellï¼Œåˆ™éœ€è¦å•ç‹¬é…ç½®æ–‡ä»¶ã€‚\nè¦æƒ³åœ¨å‡ å°ç”µè„‘ä¸­åŒæ­¥ä½ çš„é…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚ .bashrc å’Œ .bash_profileï¼‰ï¼Œå¯ä»¥å€ŸåŠ© Gitã€‚\nå½“å˜é‡å’Œæ–‡ä»¶åä¸­åŒ…å«ç©ºæ ¼çš„æ—¶å€™è¦æ ¼å¤–å°å¿ƒã€‚Bash å˜é‡è¦ç”¨å¼•å·æ‹¬èµ·æ¥ï¼Œæ¯”å¦‚ \"$FOO\"ã€‚å°½é‡ä½¿ç”¨ -0 æˆ– -print0 é€‰é¡¹ä»¥ä¾¿ç”¨ NULL æ¥åˆ†éš”æ–‡ä»¶åï¼Œä¾‹å¦‚ locate -0 pattern | xargs -0 ls -al æˆ– find / -print0 -type d | xargs -0 ls -alã€‚å¦‚æœ for å¾ªç¯ä¸­å¾ªç¯è®¿é—®çš„æ–‡ä»¶åå«æœ‰ç©ºå­—ç¬¦ï¼ˆç©ºæ ¼ã€tab ç­‰å­—ç¬¦ï¼‰ï¼Œåªéœ€ç”¨ IFS=$'\\n' æŠŠå†…éƒ¨å­—æ®µåˆ†éš”ç¬¦è®¾ä¸ºæ¢è¡Œç¬¦ã€‚\nåœ¨ Bash è„šæœ¬ä¸­ï¼Œä½¿ç”¨ set -x å»è°ƒè¯•è¾“å‡ºï¼ˆæˆ–è€…ä½¿ç”¨å®ƒçš„å˜ä½“ set -vï¼Œå®ƒä¼šè®°å½•åŸå§‹è¾“å…¥ï¼ŒåŒ…æ‹¬å¤šä½™çš„å‚æ•°å’Œæ³¨é‡Šï¼‰ã€‚å°½å¯èƒ½åœ°ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼ï¼šä½¿ç”¨ set -e ä»¤è„šæœ¬åœ¨å‘ç”Ÿé”™è¯¯æ—¶é€€å‡ºè€Œä¸æ˜¯ç»§ç»­è¿è¡Œï¼›ä½¿ç”¨ set -u æ¥æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†æœªèµ‹å€¼çš„å˜é‡ï¼›è¯•è¯• set -o pipefailï¼Œå®ƒå¯ä»¥ç›‘æµ‹ç®¡é“ä¸­çš„é”™è¯¯ã€‚å½“ç‰µæ‰¯åˆ°å¾ˆå¤šè„šæœ¬æ—¶ï¼Œä½¿ç”¨ trap æ¥æ£€æµ‹ ERR å’Œ EXITã€‚ä¸€ä¸ªå¥½çš„ä¹ æƒ¯æ˜¯åœ¨è„šæœ¬æ–‡ä»¶å¼€å¤´è¿™æ ·å†™ï¼Œè¿™ä¼šä½¿å®ƒèƒ½å¤Ÿæ£€æµ‹ä¸€äº›é”™è¯¯ï¼Œå¹¶åœ¨é”™è¯¯å‘ç”Ÿæ—¶ä¸­æ–­ç¨‹åºå¹¶è¾“å‡ºä¿¡æ¯ï¼š\n1 2 set -euo pipefail trap \"echo 'error: Script failed: see failed command above'\" ERR åœ¨ Bash è„šæœ¬ä¸­ï¼Œå­ shellï¼ˆä½¿ç”¨æ‹¬å· (...)ï¼‰æ˜¯ä¸€ç§ç»„ç»‡å‚æ•°çš„ä¾¿æ·æ–¹å¼ã€‚ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯ä¸´æ—¶åœ°ç§»åŠ¨å·¥ä½œè·¯å¾„ï¼Œä»£ç å¦‚ä¸‹ï¼š 1 2 3 # do something in current dir (cd /some/other/dir \u0026\u0026 other-command) # continue in original dir åœ¨ Bash ä¸­ï¼Œå˜é‡æœ‰è®¸å¤šçš„æ‰©å±•æ–¹å¼ã€‚${name:?error message} ç”¨äºæ£€æŸ¥å˜é‡æ˜¯å¦å­˜åœ¨ã€‚æ­¤å¤–ï¼Œå½“ Bash è„šæœ¬åªéœ€è¦ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™æ ·çš„ä»£ç  input_file=${1:?usage: $0 input_file}ã€‚åœ¨å˜é‡ä¸ºç©ºæ—¶ä½¿ç”¨é»˜è®¤å€¼ï¼š${name:-default}ã€‚å¦‚æœä½ è¦åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­å†åŠ ä¸€ä¸ªï¼ˆå¯é€‰çš„ï¼‰å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼è¿™æ ·çš„ä»£ç  output_file=${2:-logfile}ï¼Œå¦‚æœçœç•¥äº† $2ï¼Œå®ƒçš„å€¼å°±ä¸ºç©ºï¼Œäºæ˜¯ output_file å°±ä¼šè¢«è®¾ä¸º logfileã€‚æ•°å­¦è¡¨è¾¾å¼ï¼ši=$(( (i + 1) % 5 ))ã€‚åºåˆ—ï¼š{1..10}ã€‚æˆªæ–­å­—ç¬¦ä¸²ï¼š${var%suffix} å’Œ ${var#prefix}ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ var=foo.pdfï¼Œé‚£ä¹ˆ echo ${var%.pdf}.txt å°†è¾“å‡º foo.txtã€‚\nä½¿ç”¨æ‹¬å·æ‰©å±•ï¼ˆ{...}ï¼‰æ¥å‡å°‘è¾“å…¥ç›¸ä¼¼æ–‡æœ¬ï¼Œå¹¶è‡ªåŠ¨åŒ–æ–‡æœ¬ç»„åˆã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ mv foo.{txt,pdf} some-dirï¼ˆåŒæ—¶ç§»åŠ¨ä¸¤ä¸ªæ–‡ä»¶ï¼‰ï¼Œcp somefile{,.bak}ï¼ˆä¼šè¢«æ‰©å±•æˆ cp somefile somefile.bakï¼‰æˆ–è€… mkdir -p test-{a,b,c}/subtest-{1,2,3}ï¼ˆä¼šè¢«æ‰©å±•æˆæ‰€æœ‰å¯èƒ½çš„ç»„åˆï¼Œå¹¶åˆ›å»ºä¸€ä¸ªç›®å½•æ ‘ï¼‰ã€‚\né€šè¿‡ä½¿ç”¨ \u003c(some command) å¯ä»¥å°†è¾“å‡ºè§†ä¸ºæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå¯¹æ¯”æœ¬åœ°æ–‡ä»¶ /etc/hosts å’Œä¸€ä¸ªè¿œç¨‹æ–‡ä»¶ï¼š\n1 diff /etc/hosts \u003c(ssh somehost cat /etc/hosts) ç¼–å†™è„šæœ¬æ—¶ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦æŠŠä»£ç éƒ½æ”¾åœ¨å¤§æ‹¬å·é‡Œã€‚ç¼ºå°‘å³æ‹¬å·çš„è¯ï¼Œä»£ç å°±ä¼šå› ä¸ºè¯­æ³•é”™è¯¯è€Œæ— æ³•æ‰§è¡Œã€‚å¦‚æœä½ çš„è„šæœ¬æ˜¯è¦æ”¾åœ¨ç½‘ä¸Šåˆ†äº«ä¾›ä»–äººä½¿ç”¨çš„ï¼Œè¿™æ ·çš„å†™æ³•å°±ä½“ç°å‡ºå®ƒçš„å¥½å¤„äº†ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥é˜²æ­¢ä¸‹è½½ä¸å®Œå…¨ä»£ç è¢«æ‰§è¡Œã€‚ 1 2 3 { # åœ¨è¿™é‡Œå†™ä»£ç  } äº†è§£ Bash ä¸­çš„â€œhere documentsâ€ï¼Œä¾‹å¦‚ cat \u003c\u003cEOF ...ã€‚\nåœ¨ Bash ä¸­ï¼ŒåŒæ—¶é‡å®šå‘æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ï¼šsome-command \u003elogfile 2\u003e\u00261 æˆ–è€… some-command \u0026\u003elogfileã€‚é€šå¸¸ï¼Œä¸ºäº†ä¿è¯å‘½ä»¤ä¸ä¼šåœ¨æ ‡å‡†è¾“å…¥é‡Œæ®‹ç•™ä¸€ä¸ªæœªå…³é—­çš„æ–‡ä»¶å¥æŸ„æ†ç»‘åœ¨ä½ å½“å‰æ‰€åœ¨çš„ç»ˆç«¯ä¸Šï¼Œåœ¨å‘½ä»¤åæ·»åŠ  \u003c/dev/null æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚\nä½¿ç”¨ man ascii æŸ¥çœ‹å…·æœ‰åå…­è¿›åˆ¶å’Œåè¿›åˆ¶å€¼çš„ASCIIè¡¨ã€‚man unicodeï¼Œman utf-8ï¼Œä»¥åŠ man latin1 æœ‰åŠ©äºä½ å»äº†è§£é€šç”¨çš„ç¼–ç ä¿¡æ¯ã€‚\nä½¿ç”¨ screen æˆ– tmux æ¥ä½¿ç”¨å¤šä»½å±å¹•ï¼Œå½“ä½ åœ¨ä½¿ç”¨ ssh æ—¶ï¼ˆä¿å­˜ session ä¿¡æ¯ï¼‰å°†å°¤ä¸ºæœ‰ç”¨ã€‚è€Œ byobu å¯ä»¥ä¸ºå®ƒä»¬æä¾›æ›´å¤šçš„ä¿¡æ¯å’Œæ˜“ç”¨çš„ç®¡ç†å·¥å…·ã€‚å¦ä¸€ä¸ªè½»é‡çº§çš„ session æŒä¹…åŒ–è§£å†³æ–¹æ¡ˆæ˜¯ dtachã€‚\nssh ä¸­ï¼Œäº†è§£å¦‚ä½•ä½¿ç”¨ -L æˆ– -Dï¼ˆå¶å°”éœ€è¦ç”¨ -Rï¼‰å¼€å¯éš§é“æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œæ¯”å¦‚å½“ä½ éœ€è¦ä»ä¸€å°è¿œç¨‹æœåŠ¡å™¨ä¸Šè®¿é—® web é¡µé¢ã€‚\nå¯¹ ssh è®¾ç½®åšä¸€äº›å°ä¼˜åŒ–å¯èƒ½æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä¾‹å¦‚è¿™ä¸ª ~/.ssh/config æ–‡ä»¶åŒ…å«äº†é˜²æ­¢ç‰¹å®šç½‘ç»œç¯å¢ƒä¸‹è¿æ¥æ–­å¼€ã€å‹ç¼©æ•°æ®ã€å¤šé€šé“ç­‰é€‰é¡¹ï¼š\nTCPKeepAlive=yes ServerAliveInterval=15 ServerAliveCountMax=6 Compression=yes ControlMaster auto ControlPath /tmp/%r@%h:%p ControlPersist yes ä¸€äº›å…¶ä»–çš„å…³äº ssh çš„é€‰é¡¹æ˜¯ä¸å®‰å…¨ç›¸å…³çš„ï¼Œåº”å½“å°å¿ƒç¿¼ç¿¼çš„ä½¿ç”¨ã€‚ä¾‹å¦‚ä½ åº”å½“åªèƒ½åœ¨å¯ä¿¡ä»»çš„ç½‘ç»œä¸­å¯ç”¨ StrictHostKeyChecking=noï¼ŒForwardAgent=yesã€‚\nè€ƒè™‘ä½¿ç”¨ mosh ä½œä¸º ssh çš„æ›¿ä»£å“ï¼Œå®ƒä½¿ç”¨ UDP åè®®ã€‚å®ƒå¯ä»¥é¿å…è¿æ¥è¢«ä¸­æ–­å¹¶ä¸”å¯¹å¸¦å®½éœ€æ±‚æ›´å°ï¼Œä½†å®ƒéœ€è¦åœ¨æœåŠ¡ç«¯åšç›¸åº”çš„é…ç½®ã€‚\nè·å–å…«è¿›åˆ¶å½¢å¼çš„æ–‡ä»¶è®¿é—®æƒé™ï¼ˆä¿®æ”¹ç³»ç»Ÿè®¾ç½®æ—¶é€šå¸¸éœ€è¦ï¼Œä½† ls çš„åŠŸèƒ½ä¸é‚£ä¹ˆå¥½ç”¨å¹¶ä¸”é€šå¸¸ä¼šæç ¸ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼å¦‚ä¸‹çš„ä»£ç ï¼š\n1 stat -c '%A %a %n' /etc/timezone ä½¿ç”¨ percol æˆ–è€… fzf å¯ä»¥äº¤äº’å¼åœ°ä»å¦ä¸€ä¸ªå‘½ä»¤è¾“å‡ºä¸­é€‰å–å€¼ã€‚\nä½¿ç”¨ fppï¼ˆPathPickerï¼‰å¯ä»¥ä¸åŸºäºå¦ä¸€ä¸ªå‘½ä»¤(ä¾‹å¦‚ gitï¼‰è¾“å‡ºçš„æ–‡ä»¶äº¤äº’ã€‚\nå°† web æœåŠ¡å™¨ä¸Šå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶ï¼ˆä»¥åŠå­ç›®å½•ï¼‰æš´éœ²ç»™ä½ æ‰€å¤„ç½‘ç»œçš„æ‰€æœ‰ç”¨æˆ·ï¼Œä½¿ç”¨ï¼š python -m SimpleHTTPServer 7777 ï¼ˆä½¿ç”¨ç«¯å£ 7777 å’Œ Python 2ï¼‰æˆ–python -m http.server 7777 ï¼ˆä½¿ç”¨ç«¯å£ 7777 å’Œ Python 3ï¼‰ã€‚\nä»¥å…¶ä»–ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼Œä½¿ç”¨ sudoã€‚é»˜è®¤ä»¥ root ç”¨æˆ·çš„èº«ä»½æ‰§è¡Œï¼›ä½¿ç”¨ -u æ¥æŒ‡å®šå…¶ä»–ç”¨æˆ·ã€‚ä½¿ç”¨ -i æ¥ä»¥è¯¥ç”¨æˆ·ç™»å½•ï¼ˆéœ€è¦è¾“å…¥_ä½ è‡ªå·±çš„_å¯†ç ï¼‰ã€‚\nå°† shell åˆ‡æ¢ä¸ºå…¶ä»–ç”¨æˆ·ï¼Œä½¿ç”¨ su username æˆ–è€… sudo - usernameã€‚åŠ å…¥ - ä¼šä½¿å¾—åˆ‡æ¢åçš„ç¯å¢ƒä¸ä½¿ç”¨è¯¥ç”¨æˆ·ç™»å½•åçš„ç¯å¢ƒç›¸åŒã€‚çœç•¥ç”¨æˆ·ååˆ™é»˜è®¤ä¸º rootã€‚åˆ‡æ¢åˆ°å“ªä¸ªç”¨æˆ·ï¼Œå°±éœ€è¦è¾“å…¥_å“ªä¸ªç”¨æˆ·çš„_å¯†ç ã€‚\näº†è§£å‘½ä»¤è¡Œçš„ 128K é™åˆ¶ã€‚ä½¿ç”¨é€šé…ç¬¦åŒ¹é…å¤§é‡æ–‡ä»¶åæ—¶ï¼Œå¸¸ä¼šé‡åˆ°â€œArgument list too longâ€çš„é”™è¯¯ä¿¡æ¯ã€‚ï¼ˆè¿™ç§æƒ…å†µä¸‹æ¢ç”¨ find æˆ– xargs é€šå¸¸å¯ä»¥è§£å†³ã€‚ï¼‰\nå½“ä½ éœ€è¦ä¸€ä¸ªåŸºæœ¬çš„è®¡ç®—å™¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ python è§£é‡Šå™¨ï¼ˆå½“ç„¶ä½ è¦ç”¨ python çš„æ—¶å€™ä¹Ÿæ˜¯è¿™æ ·ï¼‰ã€‚ä¾‹å¦‚ï¼š\n\u003e\u003e\u003e 2+3 5 æ–‡ä»¶åŠæ•°æ®å¤„ç† åœ¨å½“å‰ç›®å½•ä¸‹é€šè¿‡æ–‡ä»¶åæŸ¥æ‰¾ä¸€ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨ç±»ä¼¼äºè¿™æ ·çš„å‘½ä»¤ï¼šfind . -iname '*something*'ã€‚åœ¨æ‰€æœ‰è·¯å¾„ä¸‹é€šè¿‡æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶ï¼Œä½¿ç”¨ locate something ï¼ˆä½†æ³¨æ„åˆ° updatedb å¯èƒ½æ²¡æœ‰å¯¹æœ€è¿‘æ–°å»ºçš„æ–‡ä»¶å»ºç«‹ç´¢å¼•ï¼Œæ‰€ä»¥ä½ å¯èƒ½æ— æ³•å®šä½åˆ°è¿™äº›æœªè¢«ç´¢å¼•çš„æ–‡ä»¶ï¼‰ã€‚\nä½¿ç”¨ ag åœ¨æºä»£ç æˆ–æ•°æ®æ–‡ä»¶é‡Œæ£€ç´¢ï¼ˆgrep -r åŒæ ·å¯ä»¥åšåˆ°ï¼Œä½†ç›¸æ¯”ä¹‹ä¸‹ ag æ›´åŠ å…ˆè¿›ï¼‰ã€‚\nå°† HTML è½¬ä¸ºæ–‡æœ¬ï¼šlynx -dump -stdinã€‚\nMarkdownï¼ŒHTMLï¼Œä»¥åŠæ‰€æœ‰æ–‡æ¡£æ ¼å¼ä¹‹é—´çš„è½¬æ¢ï¼Œè¯•è¯• pandocã€‚\nå½“ä½ è¦å¤„ç†æ£˜æ‰‹çš„ XML æ—¶å€™ï¼Œxmlstarlet ç®—æ˜¯ä¸Šå¤æ—¶ä»£æµä¼ ä¸‹æ¥çš„ç¥å™¨ã€‚\nä½¿ç”¨ jq å¤„ç† JSONã€‚\nä½¿ç”¨ shyaml å¤„ç† YAMLã€‚\nè¦å¤„ç† Excel æˆ– CSV æ–‡ä»¶çš„è¯ï¼Œcsvkit æä¾›äº† in2csvï¼Œcsvcutï¼Œcsvjoinï¼Œcsvgrep ç­‰æ–¹ä¾¿æ˜“ç”¨çš„å·¥å…·ã€‚\nå½“ä½ è¦å¤„ç† Amazon S3 ç›¸å…³çš„å·¥ä½œçš„æ—¶å€™ï¼Œs3cmd æ˜¯ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„å·¥å…·è€Œ s4cmd çš„æ•ˆç‡æ›´é«˜ã€‚Amazon å®˜æ–¹æä¾›çš„ aws ä»¥åŠ saws æ˜¯å…¶ä»– AWS ç›¸å…³å·¥ä½œçš„åŸºç¡€ï¼Œå€¼å¾—å­¦ä¹ ã€‚\näº†è§£å¦‚ä½•ä½¿ç”¨ sort å’Œ uniqï¼ŒåŒ…æ‹¬ uniq çš„ -u å‚æ•°å’Œ -d å‚æ•°ï¼Œå…·ä½“å†…å®¹åœ¨åæ–‡å•è¡Œè„šæœ¬èŠ‚ä¸­ã€‚å¦å¤–å¯ä»¥äº†è§£ä¸€ä¸‹ commã€‚\näº†è§£å¦‚ä½•ä½¿ç”¨ cutï¼Œpaste å’Œ join æ¥æ›´æ”¹æ–‡ä»¶ã€‚å¾ˆå¤šäººéƒ½ä¼šä½¿ç”¨ cutï¼Œä½†é—å¿˜äº† joinã€‚\näº†è§£å¦‚ä½•è¿ç”¨ wc å»è®¡ç®—æ–°è¡Œæ•°ï¼ˆ-lï¼‰ï¼Œå­—ç¬¦æ•°ï¼ˆ-mï¼‰ï¼Œå•è¯æ•°ï¼ˆ-wï¼‰ä»¥åŠå­—èŠ‚æ•°ï¼ˆ-cï¼‰ã€‚\näº†è§£å¦‚ä½•ä½¿ç”¨ tee å°†æ ‡å‡†è¾“å…¥å¤åˆ¶åˆ°æ–‡ä»¶ç”šè‡³æ ‡å‡†è¾“å‡ºï¼Œä¾‹å¦‚ ls -al | tee file.txtã€‚\nè¦è¿›è¡Œä¸€äº›å¤æ‚çš„è®¡ç®—ï¼Œæ¯”å¦‚åˆ†ç»„ã€é€†åºå’Œä¸€äº›å…¶ä»–çš„ç»Ÿè®¡åˆ†æï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ datamashã€‚\næ³¨æ„åˆ°è¯­è¨€è®¾ç½®ï¼ˆä¸­æ–‡æˆ–è‹±æ–‡ç­‰ï¼‰å¯¹è®¸å¤šå‘½ä»¤è¡Œå·¥å…·æœ‰ä¸€äº›å¾®å¦™çš„å½±å“ï¼Œæ¯”å¦‚æ’åºçš„é¡ºåºå’Œæ€§èƒ½ã€‚å¤§å¤šæ•° Linux çš„å®‰è£…è¿‡ç¨‹ä¼šå°† LANG æˆ–å…¶ä»–æœ‰å…³çš„å˜é‡è®¾ç½®ä¸ºç¬¦åˆæœ¬åœ°çš„è®¾ç½®ã€‚è¦æ„è¯†åˆ°å½“ä½ æ”¹å˜è¯­è¨€è®¾ç½®æ—¶ï¼Œæ’åºçš„ç»“æœå¯èƒ½ä¼šæ”¹å˜ã€‚æ˜ç™½å›½é™…åŒ–å¯èƒ½ä¼šä½¿ sort æˆ–å…¶ä»–å‘½ä»¤è¿è¡Œæ•ˆç‡ä¸‹é™è®¸å¤šå€ã€‚æŸäº›æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚é›†åˆè¿ç®—ï¼‰ä½ å¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨ export LC_ALL=C æ¥å¿½ç•¥æ‰å›½é™…åŒ–å¹¶æŒ‰ç…§å­—èŠ‚æ¥åˆ¤æ–­é¡ºåºã€‚\nä½ å¯ä»¥å•ç‹¬æŒ‡å®šæŸä¸€æ¡å‘½ä»¤çš„ç¯å¢ƒï¼Œåªéœ€åœ¨è°ƒç”¨æ—¶æŠŠç¯å¢ƒå˜é‡è®¾å®šæ”¾åœ¨å‘½ä»¤çš„å‰é¢ï¼Œä¾‹å¦‚ TZ=Pacific/Fiji date å¯ä»¥è·å–æ–æµçš„æ—¶é—´ã€‚\näº†è§£å¦‚ä½•ä½¿ç”¨ awk å’Œ sed æ¥è¿›è¡Œç®€å•çš„æ•°æ®å¤„ç†ã€‚ å‚é˜… One-liners è·å–ç¤ºä¾‹ã€‚\næ›¿æ¢ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­å‡ºç°çš„å­—ç¬¦ä¸²ï¼š\n1 perl -pi.bak -e 's/old-string/new-string/g' my-files-*.txt ä½¿ç”¨ repren æ¥æ‰¹é‡é‡å‘½åæ–‡ä»¶ï¼Œæˆ–æ˜¯åœ¨å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢æ›¿æ¢å†…å®¹ã€‚ï¼ˆæœ‰äº›æ—¶å€™ rename å‘½ä»¤ä¹Ÿå¯ä»¥æ‰¹é‡é‡å‘½åï¼Œä½†è¦æ³¨æ„ï¼Œå®ƒåœ¨ä¸åŒ Linux å‘è¡Œç‰ˆä¸­çš„åŠŸèƒ½å¹¶ä¸å®Œå…¨ä¸€æ ·ã€‚ï¼‰ 1 2 3 4 5 6 # å°†æ–‡ä»¶ã€ç›®å½•å’Œå†…å®¹å…¨éƒ¨é‡å‘½å foo -\u003e bar: repren --full --preserve-case --from foo --to bar . # è¿˜åŸæ‰€æœ‰å¤‡ä»½æ–‡ä»¶ whatever.bak -\u003e whatever: repren --renames --from '(.*)\\.bak' --to '\\1' *.bak # ç”¨ rename å®ç°ä¸Šè¿°åŠŸèƒ½ï¼ˆè‹¥å¯ç”¨ï¼‰: rename 's/\\.bak$//' *.bak æ ¹æ® man é¡µé¢çš„æè¿°ï¼Œrsync æ˜¯ä¸€ä¸ªå¿«é€Ÿä¸”éå¸¸çµæ´»çš„æ–‡ä»¶å¤åˆ¶å·¥å…·ã€‚å®ƒé—»åäºè®¾å¤‡ä¹‹é—´çš„æ–‡ä»¶åŒæ­¥ï¼Œä½†å…¶å®å®ƒåœ¨æœ¬åœ°æƒ…å†µä¸‹ä¹ŸåŒæ ·æœ‰ç”¨ã€‚åœ¨å®‰å…¨è®¾ç½®å…è®¸ä¸‹ï¼Œç”¨ rsync ä»£æ›¿ scp å¯ä»¥å®ç°æ–‡ä»¶ç»­ä¼ ï¼Œè€Œä¸ç”¨é‡æ–°ä»å¤´å¼€å§‹ã€‚å®ƒåŒæ—¶ä¹Ÿæ˜¯åˆ é™¤å¤§é‡æ–‡ä»¶çš„æœ€å¿«æ–¹æ³•ä¹‹ä¸€ï¼š 1 mkdir empty \u0026\u0026 rsync -r --delete empty/ some-dir \u0026\u0026 rmdir some-dir è‹¥è¦åœ¨å¤åˆ¶æ–‡ä»¶æ—¶è·å–å½“å‰è¿›åº¦ï¼Œå¯ä½¿ç”¨ pvï¼Œpycpï¼Œprogressï¼Œrsync --progressã€‚è‹¥æ‰€æ‰§è¡Œçš„å¤åˆ¶ä¸ºblockå—æ‹·è´ï¼Œå¯ä»¥ä½¿ç”¨ dd status=progressã€‚\nä½¿ç”¨ shuf å¯ä»¥ä»¥è¡Œä¸ºå•ä½æ¥æ‰“ä¹±æ–‡ä»¶çš„å†…å®¹æˆ–ä»ä¸€ä¸ªæ–‡ä»¶ä¸­éšæœºé€‰å–å¤šè¡Œã€‚\näº†è§£ sort çš„å‚æ•°ã€‚æ˜¾ç¤ºæ•°å­—æ—¶ï¼Œä½¿ç”¨ -n æˆ–è€… -h æ¥æ˜¾ç¤ºæ›´æ˜“è¯»çš„æ•°ï¼ˆä¾‹å¦‚ du -h çš„è¾“å‡ºï¼‰ã€‚æ˜ç™½æ’åºæ—¶å…³é”®å­—çš„å·¥ä½œåŸç†ï¼ˆ-t å’Œ -kï¼‰ã€‚ä¾‹å¦‚ï¼Œæ³¨æ„åˆ°ä½ éœ€è¦ -k1ï¼Œ1 æ¥ä»…æŒ‰ç¬¬ä¸€ä¸ªåŸŸæ¥æ’åºï¼Œè€Œ -k1 æ„å‘³ç€æŒ‰æ•´è¡Œæ’åºã€‚ç¨³å®šæ’åºï¼ˆsort -sï¼‰åœ¨æŸäº›æƒ…å†µä¸‹å¾ˆæœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œä»¥ç¬¬äºŒä¸ªåŸŸä¸ºä¸»å…³é”®å­—ï¼Œç¬¬ä¸€ä¸ªåŸŸä¸ºæ¬¡å…³é”®å­—è¿›è¡Œæ’åºï¼Œä½ å¯ä»¥ä½¿ç”¨ sort -k1ï¼Œ1 | sort -s -k2ï¼Œ2ã€‚\nå¦‚æœä½ æƒ³åœ¨ Bash å‘½ä»¤è¡Œä¸­å†™ tab åˆ¶è¡¨ç¬¦ï¼ŒæŒ‰ä¸‹ ctrl-v [Tab] æˆ–é”®å…¥ $'\\t' ï¼ˆåè€…å¯èƒ½æ›´å¥½ï¼Œå› ä¸ºä½ å¯ä»¥å¤åˆ¶ç²˜è´´å®ƒï¼‰ã€‚\næ ‡å‡†çš„æºä»£ç å¯¹æ¯”åŠåˆå¹¶å·¥å…·æ˜¯ diff å’Œ patchã€‚ä½¿ç”¨ diffstat æŸ¥çœ‹å˜æ›´æ€»è§ˆæ•°æ®ã€‚æ³¨æ„åˆ° diff -r å¯¹æ•´ä¸ªæ–‡ä»¶å¤¹æœ‰æ•ˆã€‚ä½¿ç”¨ diff -r tree1 tree2 | diffstat æŸ¥çœ‹å˜æ›´çš„ç»Ÿè®¡æ•°æ®ã€‚vimdiff ç”¨äºæ¯”å¯¹å¹¶ç¼–è¾‘æ–‡ä»¶ã€‚\nå¯¹äºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½¿ç”¨ hdï¼Œhexdump æˆ–è€… xxd ä½¿å…¶ä»¥åå…­è¿›åˆ¶æ˜¾ç¤ºï¼Œä½¿ç”¨ bviï¼Œhexedit æˆ–è€… biew æ¥è¿›è¡ŒäºŒè¿›åˆ¶ç¼–è¾‘ã€‚\nåŒæ ·å¯¹äºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œstringsï¼ˆåŒ…æ‹¬ grep ç­‰å·¥å…·ï¼‰å¯ä»¥å¸®åŠ©åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾ç‰¹å®šæ¯”ç‰¹ã€‚\nåˆ¶ä½œäºŒè¿›åˆ¶å·®åˆ†æ–‡ä»¶ï¼ˆDelta å‹ç¼©ï¼‰ï¼Œä½¿ç”¨ xdelta3ã€‚\nä½¿ç”¨ iconv æ›´æ”¹æ–‡æœ¬ç¼–ç ã€‚éœ€è¦æ›´é«˜çº§çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨ uconvï¼Œå®ƒæ”¯æŒä¸€äº›é«˜çº§çš„ Unicode åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œè¿™æ¡å‘½ä»¤ç§»é™¤äº†æ‰€æœ‰é‡éŸ³ç¬¦å·ï¼š\n1 uconv -f utf-8 -t utf-8 -x '::Any-Lower; ::Any-NFD; [:Nonspacing Mark:] \u003e; ::Any-NFC; ' \u003c input.txt \u003e output.txt æ‹†åˆ†æ–‡ä»¶å¯ä»¥ä½¿ç”¨ splitï¼ˆæŒ‰å¤§å°æ‹†åˆ†ï¼‰å’Œ csplitï¼ˆæŒ‰æ¨¡å¼æ‹†åˆ†ï¼‰ã€‚\næ“ä½œæ—¥æœŸå’Œæ—¶é—´è¡¨è¾¾å¼ï¼Œå¯ä»¥ç”¨ dateutils ä¸­çš„ dateaddã€datediffã€strptime ç­‰å·¥å…·ã€‚\nä½¿ç”¨ zlessã€zmoreã€zcat å’Œ zgrep å¯¹å‹ç¼©è¿‡çš„æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚\næ–‡ä»¶å±æ€§å¯ä»¥é€šè¿‡ chattr è¿›è¡Œè®¾ç½®ï¼Œå®ƒæ¯”æ–‡ä»¶æƒé™æ›´åŠ åº•å±‚ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†ä¿æŠ¤æ–‡ä»¶ä¸è¢«æ„å¤–åˆ é™¤ï¼Œå¯ä»¥ä½¿ç”¨ä¸å¯ä¿®æ”¹æ ‡è®°ï¼šsudo chattr +i /critical/directory/or/file\nä½¿ç”¨ getfacl å’Œ setfacl ä»¥ä¿å­˜å’Œæ¢å¤æ–‡ä»¶æƒé™ã€‚ä¾‹å¦‚ï¼š\n1 2 getfacl -R /some/path \u003e permissions.txt setfacl --restore=permissions.txt ä¸ºäº†é«˜æ•ˆåœ°åˆ›å»ºç©ºæ–‡ä»¶ï¼Œè¯·ä½¿ç”¨ truncateï¼ˆåˆ›å»ºç¨€ç–æ–‡ä»¶ï¼‰ï¼Œfallocateï¼ˆç”¨äº ext4ï¼Œxfsï¼Œbtrf å’Œ ocfs2 æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œxfs_mkfileï¼ˆé€‚ç”¨äºå‡ ä¹æ‰€æœ‰çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…å«åœ¨ xfsprogs åŒ…ä¸­ï¼‰ï¼Œmkfileï¼ˆç”¨äºç±» Unix æ“ä½œç³»ç»Ÿï¼Œæ¯”å¦‚ Solaris å’Œ Mac OSï¼‰ã€‚ ç³»ç»Ÿè°ƒè¯• curl å’Œ curl -I å¯ä»¥è¢«è½»æ¾åœ°åº”ç”¨äº web è°ƒè¯•ä¸­ï¼Œå®ƒä»¬çš„å¥½å…„å¼Ÿ wget ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥è¯•è¯•æ›´æ½®çš„ httpieã€‚\nè·å– CPU å’Œç¡¬ç›˜çš„ä½¿ç”¨çŠ¶æ€ï¼Œé€šå¸¸ä½¿ç”¨ä½¿ç”¨ topï¼ˆhtop æ›´ä½³ï¼‰ï¼Œiostat å’Œ iotopã€‚è€Œ iostat -mxz 15 å¯ä»¥è®©ä½ è·æ‚‰ CPU å’Œæ¯ä¸ªç¡¬ç›˜åˆ†åŒºçš„åŸºæœ¬ä¿¡æ¯å’Œæ€§èƒ½è¡¨ç°ã€‚\nä½¿ç”¨ netstat å’Œ ss æŸ¥çœ‹ç½‘ç»œè¿æ¥çš„ç»†èŠ‚ã€‚\ndstat åœ¨ä½ æƒ³è¦å¯¹ç³»ç»Ÿçš„ç°çŠ¶æœ‰ä¸€ä¸ªç²—ç•¥çš„è®¤è¯†æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ç„¶è€Œè‹¥è¦å¯¹ç³»ç»Ÿæœ‰ä¸€ä¸ªæ·±åº¦çš„æ€»ä½“è®¤è¯†ï¼Œä½¿ç”¨ glancesï¼Œå®ƒä¼šåœ¨ä¸€ä¸ªç»ˆç«¯çª—å£ä¸­å‘ä½ æä¾›ä¸€äº›ç³»ç»Ÿçº§çš„æ•°æ®ã€‚\nè‹¥è¦äº†è§£å†…å­˜çŠ¶æ€ï¼Œè¿è¡Œå¹¶ç†è§£ free å’Œ vmstat çš„è¾“å‡ºã€‚å€¼å¾—ç•™æ„çš„æ˜¯â€œcachedâ€çš„å€¼ï¼Œå®ƒæŒ‡çš„æ˜¯ Linux å†…æ ¸ç”¨æ¥ä½œä¸ºæ–‡ä»¶ç¼“å­˜çš„å†…å­˜å¤§å°ï¼Œè€Œä¸ç©ºé—²å†…å­˜æ— å…³ã€‚\nJava ç³»ç»Ÿè°ƒè¯•åˆ™æ˜¯ä¸€ä»¶æˆªç„¶ä¸åŒçš„äº‹ï¼Œä¸€ä¸ªå¯ä»¥ç”¨äº Oracle çš„ JVM æˆ–å…¶ä»– JVM ä¸Šçš„è°ƒè¯•çš„æŠ€å·§æ˜¯ä½ å¯ä»¥è¿è¡Œ kill -3 \u003cpid\u003e åŒæ—¶ä¸€ä¸ªå®Œæ•´çš„æ ˆè½¨è¿¹å’Œå †æ¦‚è¿°ï¼ˆåŒ…æ‹¬ GC çš„ç»†èŠ‚ï¼‰ä¼šè¢«ä¿å­˜åˆ°æ ‡å‡†é”™è¯¯æˆ–æ˜¯æ—¥å¿—æ–‡ä»¶ã€‚JDK ä¸­çš„ jpsï¼Œjstatï¼Œjstackï¼Œjmap å¾ˆæœ‰ç”¨ã€‚SJK tools æ›´é«˜çº§ã€‚\nä½¿ç”¨ mtr å»è·Ÿè¸ªè·¯ç”±ï¼Œç”¨äºç¡®å®šç½‘ç»œé—®é¢˜ã€‚\nç”¨ ncdu æ¥æŸ¥çœ‹ç£ç›˜ä½¿ç”¨æƒ…å†µï¼Œå®ƒæ¯”å¯»å¸¸çš„å‘½ä»¤ï¼Œå¦‚ du -sh *ï¼Œæ›´èŠ‚çœæ—¶é—´ã€‚\næŸ¥æ‰¾æ­£åœ¨ä½¿ç”¨å¸¦å®½çš„å¥—æ¥å­—è¿æ¥æˆ–è¿›ç¨‹ï¼Œä½¿ç”¨ iftop æˆ– nethogsã€‚\nab å·¥å…·ï¼ˆApache ä¸­è‡ªå¸¦ï¼‰å¯ä»¥ç®€å•ç²—æš´åœ°æ£€æŸ¥ web æœåŠ¡å™¨çš„æ€§èƒ½ã€‚å¯¹äºæ›´å¤æ‚çš„è´Ÿè½½æµ‹è¯•ï¼Œä½¿ç”¨ siegeã€‚\nwiresharkï¼Œtshark å’Œ ngrep å¯ç”¨äºå¤æ‚çš„ç½‘ç»œè°ƒè¯•ã€‚\näº†è§£ strace å’Œ ltraceã€‚è¿™ä¿©å·¥å…·åœ¨ä½ çš„ç¨‹åºè¿è¡Œå¤±è´¥ã€æŒ‚èµ·ç”šè‡³å´©æºƒï¼Œè€Œä½ å´ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ–ä½ æƒ³å¯¹æ€§èƒ½æœ‰ä¸ªæ€»ä½“çš„è®¤è¯†çš„æ—¶å€™æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚æ³¨æ„ profile å‚æ•°ï¼ˆ-cï¼‰å’Œé™„åŠ åˆ°ä¸€ä¸ªè¿è¡Œçš„è¿›ç¨‹å‚æ•° ï¼ˆ-pï¼‰ã€‚\näº†è§£ä½¿ç”¨ ldd æ¥æ£€æŸ¥å…±äº«åº“ã€‚ä½†æ˜¯æ°¸è¿œä¸è¦åœ¨ä¸ä¿¡ä»»çš„æ–‡ä»¶ä¸Šè¿è¡Œã€‚\näº†è§£å¦‚ä½•è¿ç”¨ gdb è¿æ¥åˆ°ä¸€ä¸ªè¿è¡Œç€çš„è¿›ç¨‹å¹¶è·å–å®ƒçš„å †æ ˆè½¨è¿¹ã€‚\nå­¦ä¼šä½¿ç”¨ /procã€‚å®ƒåœ¨è°ƒè¯•æ­£åœ¨å‡ºç°çš„é—®é¢˜çš„æ—¶å€™æœ‰æ—¶ä¼šæ•ˆæœæƒŠäººã€‚æ¯”å¦‚ï¼š/proc/cpuinfoï¼Œ/proc/meminfoï¼Œ/proc/cmdlineï¼Œ/proc/xxx/cwdï¼Œ/proc/xxx/exeï¼Œ/proc/xxx/fd/ï¼Œ/proc/xxx/smapsï¼ˆè¿™é‡Œçš„ xxx è¡¨ç¤ºè¿›ç¨‹çš„ id æˆ– pidï¼‰ã€‚\nå½“è°ƒè¯•ä¸€äº›ä¹‹å‰å‡ºç°çš„é—®é¢˜çš„æ—¶å€™ï¼Œsar éå¸¸æœ‰ç”¨ã€‚å®ƒå±•ç¤ºäº† cpuã€å†…å­˜ä»¥åŠç½‘ç»œç­‰çš„å†å²æ•°æ®ã€‚\nå…³äºæ›´æ·±å±‚æ¬¡çš„ç³»ç»Ÿåˆ†æä»¥åŠæ€§èƒ½åˆ†æï¼Œçœ‹çœ‹ stapï¼ˆSystemTapï¼‰ï¼Œperfï¼Œä»¥åŠsysdigã€‚\næŸ¥çœ‹ä½ å½“å‰ä½¿ç”¨çš„ç³»ç»Ÿï¼Œä½¿ç”¨ unameï¼Œuname -aï¼ˆUnixï¼kernel ä¿¡æ¯ï¼‰æˆ–è€… lsb_release -aï¼ˆLinux å‘è¡Œç‰ˆä¿¡æ¯ï¼‰ã€‚\næ— è®ºä»€ä¹ˆä¸œè¥¿å·¥ä½œå¾—å¾ˆæ¬¢ä¹ï¼ˆå¯èƒ½æ˜¯ç¡¬ä»¶æˆ–é©±åŠ¨é—®é¢˜ï¼‰æ—¶å¯ä»¥è¯•è¯• dmesgã€‚\nå¦‚æœä½ åˆ é™¤äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†é€šè¿‡ du å‘ç°æ²¡æœ‰é‡Šæ”¾é¢„æœŸçš„ç£ç›˜ç©ºé—´ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦è¢«è¿›ç¨‹å ç”¨ï¼š lsof | grep deleted | grep \"filename-of-my-big-file\"\nå•è¡Œè„šæœ¬ ä¸€äº›å‘½ä»¤ç»„åˆçš„ä¾‹å­ï¼š\nå½“ä½ éœ€è¦å¯¹æ–‡æœ¬æ–‡ä»¶åšé›†åˆäº¤ã€å¹¶ã€å·®è¿ç®—æ—¶ï¼Œsort å’Œ uniq ä¼šæ˜¯ä½ çš„å¥½å¸®æ‰‹ã€‚å…·ä½“ä¾‹å­è¯·å‚ç…§ä»£ç åé¢çš„ï¼Œæ­¤å¤„å‡è®¾ a ä¸ b æ˜¯ä¸¤å†…å®¹ä¸åŒçš„æ–‡ä»¶ã€‚è¿™ç§æ–¹å¼æ•ˆç‡å¾ˆé«˜ï¼Œå¹¶ä¸”åœ¨å°æ–‡ä»¶å’Œä¸Š G çš„æ–‡ä»¶ä¸Šéƒ½èƒ½è¿ç”¨ï¼ˆæ³¨æ„å°½ç®¡åœ¨ /tmp åœ¨ä¸€ä¸ªå°çš„æ ¹åˆ†åŒºä¸Šæ—¶ä½ å¯èƒ½éœ€è¦ -T å‚æ•°ï¼Œä½†æ˜¯å®é™…ä¸Š sort å¹¶ä¸è¢«å†…å­˜å¤§å°çº¦æŸï¼‰ï¼Œå‚é˜…å‰æ–‡ä¸­å…³äº LC_ALL å’Œ sort çš„ -u å‚æ•°çš„éƒ¨åˆ†ã€‚ 1 2 3 sort a b | uniq \u003e c # c æ˜¯ a å¹¶ b sort a b | uniq -d \u003e c # c æ˜¯ a äº¤ b sort a b b | uniq -u \u003e c # c æ˜¯ a - b ä½¿ç”¨ grep . *ï¼ˆæ¯è¡Œéƒ½ä¼šé™„ä¸Šæ–‡ä»¶åï¼‰æˆ–è€… head -100 *ï¼ˆæ¯ä¸ªæ–‡ä»¶æœ‰ä¸€ä¸ªæ ‡é¢˜ï¼‰æ¥é˜…è¯»æ£€æŸ¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å†…å®¹ã€‚è¿™åœ¨æ£€æŸ¥ä¸€ä¸ªå……æ»¡é…ç½®æ–‡ä»¶çš„ç›®å½•ï¼ˆå¦‚ /sysã€/procã€/etcï¼‰æ—¶ç‰¹åˆ«å¥½ç”¨ã€‚\nè®¡ç®—æ–‡æœ¬æ–‡ä»¶ç¬¬ä¸‰åˆ—ä¸­æ‰€æœ‰æ•°çš„å’Œï¼ˆå¯èƒ½æ¯”åŒç­‰ä½œç”¨çš„ Python ä»£ç å¿«ä¸‰å€ä¸”ä»£ç é‡å°‘ä¸‰å€ï¼‰ï¼š\n1 awk '{ x += $3 } END { print x }' myfile å¦‚æœä½ æƒ³åœ¨æ–‡ä»¶æ ‘ä¸ŠæŸ¥çœ‹å¤§å°/æ—¥æœŸï¼Œè¿™å¯èƒ½çœ‹èµ·æ¥åƒé€’å½’ç‰ˆçš„ ls -l ä½†æ¯” ls -lR æ›´æ˜“äºç†è§£ï¼š 1 find . -type f -ls å‡è®¾ä½ æœ‰ä¸€ä¸ªç±»ä¼¼äº web æœåŠ¡å™¨æ—¥å¿—æ–‡ä»¶çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸€ä¸ªç¡®å®šçš„å€¼åªä¼šå‡ºç°åœ¨æŸäº›è¡Œä¸Šï¼Œå‡è®¾ä¸€ä¸ª acct_id å‚æ•°åœ¨ URI ä¸­ã€‚å¦‚æœä½ æƒ³è®¡ç®—å‡ºæ¯ä¸ª acct_id å€¼æœ‰å¤šå°‘æ¬¡è¯·æ±‚ï¼Œä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š 1 egrep -o 'acct_id=[0-9]+' access.log | cut -d= -f2 | sort | uniq -c | sort -rn è¦æŒç»­ç›‘æµ‹æ–‡ä»¶æ”¹åŠ¨ï¼Œå¯ä»¥ä½¿ç”¨ watchï¼Œä¾‹å¦‚æ£€æŸ¥æŸä¸ªæ–‡ä»¶å¤¹ä¸­æ–‡ä»¶çš„æ”¹å˜ï¼Œå¯ä»¥ç”¨ watch -d -n 2 'ls -rtlh | tail'ï¼›æˆ–è€…åœ¨æ’æŸ¥ WiFi è®¾ç½®æ•…éšœæ—¶è¦ç›‘æµ‹ç½‘ç»œè®¾ç½®çš„æ›´æ”¹ï¼Œå¯ä»¥ç”¨ watch -d -n 2 ifconfigã€‚\nè¿è¡Œè¿™ä¸ªå‡½æ•°ä»è¿™ç¯‡æ–‡æ¡£ä¸­éšæœºè·å–ä¸€æ¡æŠ€å·§ï¼ˆè§£æ Markdown æ–‡ä»¶å¹¶æŠ½å–é¡¹ç›®ï¼‰ï¼š\n1 2 3 4 5 6 7 8 function taocl() { curl -s https://raw.githubusercontent.com/jlevy/the-art-of-command-line/master/README-zh.md| pandoc -f markdown -t html | iconv -f 'utf-8' -t 'unicode' | xmlstarlet fo --html --dropdtd | xmlstarlet sel -t -v \"(html/body/ul/li[count(p)\u003e0])[$RANDOM mod last()+1]\" | xmlstarlet unesc | fmt -80 } å†·é—¨ä½†æœ‰ç”¨ exprï¼šè®¡ç®—è¡¨è¾¾å¼æˆ–æ­£åˆ™åŒ¹é…\nm4ï¼šç®€å•çš„å®å¤„ç†å™¨\nyesï¼šå¤šæ¬¡æ‰“å°å­—ç¬¦ä¸²\ncalï¼šæ¼‚äº®çš„æ—¥å†\nenvï¼šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼ˆè„šæœ¬æ–‡ä»¶ä¸­å¾ˆæœ‰ç”¨ï¼‰\nprintenvï¼šæ‰“å°ç¯å¢ƒå˜é‡ï¼ˆè°ƒè¯•æ—¶æˆ–åœ¨å†™è„šæœ¬æ–‡ä»¶æ—¶å¾ˆæœ‰ç”¨ï¼‰\nlookï¼šæŸ¥æ‰¾ä»¥ç‰¹å®šå­—ç¬¦ä¸²å¼€å¤´çš„å•è¯æˆ–è¡Œ\ncutï¼Œpaste å’Œ joinï¼šæ•°æ®ä¿®æ”¹\nfmtï¼šæ ¼å¼åŒ–æ–‡æœ¬æ®µè½\nprï¼šå°†æ–‡æœ¬æ ¼å¼åŒ–æˆé¡µï¼åˆ—å½¢å¼\nfoldï¼šåŒ…è£¹æ–‡æœ¬ä¸­çš„å‡ è¡Œ\ncolumnï¼šå°†æ–‡æœ¬æ ¼å¼åŒ–æˆå¤šä¸ªå¯¹é½ã€å®šå®½çš„åˆ—æˆ–è¡¨æ ¼\nexpand å’Œ unexpandï¼šåˆ¶è¡¨ç¬¦ä¸ç©ºæ ¼ä¹‹é—´è½¬æ¢\nnlï¼šæ·»åŠ è¡Œå·\nseqï¼šæ‰“å°æ•°å­—\nbcï¼šè®¡ç®—å™¨\nfactorï¼šåˆ†è§£å› æ•°\ngpgï¼šåŠ å¯†å¹¶ç­¾åæ–‡ä»¶\ntoeï¼šterminfo å…¥å£åˆ—è¡¨\nncï¼šç½‘ç»œè°ƒè¯•åŠæ•°æ®ä¼ è¾“\nsocatï¼šå¥—æ¥å­—ä»£ç†ï¼Œä¸ netcat ç±»ä¼¼\nslurmï¼šç½‘ç»œæµé‡å¯è§†åŒ–\nddï¼šæ–‡ä»¶æˆ–è®¾å¤‡é—´ä¼ è¾“æ•°æ®\nfileï¼šç¡®å®šæ–‡ä»¶ç±»å‹\ntreeï¼šä»¥æ ‘çš„å½¢å¼æ˜¾ç¤ºè·¯å¾„å’Œæ–‡ä»¶ï¼Œç±»ä¼¼äºé€’å½’çš„ ls\nstatï¼šæ–‡ä»¶ä¿¡æ¯\ntimeï¼šæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶è®¡ç®—æ‰§è¡Œæ—¶é—´\ntimeoutï¼šåœ¨æŒ‡å®šæ—¶é•¿èŒƒå›´å†…æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶åœ¨è§„å®šæ—¶é—´ç»“æŸååœæ­¢è¿›ç¨‹\nlockfileï¼šä½¿æ–‡ä»¶åªèƒ½é€šè¿‡ rm -f ç§»é™¤\nlogrotateï¼š åˆ‡æ¢ã€å‹ç¼©ä»¥åŠå‘é€æ—¥å¿—æ–‡ä»¶\nwatchï¼šé‡å¤è¿è¡ŒåŒä¸€ä¸ªå‘½ä»¤ï¼Œå±•ç¤ºç»“æœå¹¶ï¼æˆ–é«˜äº®æœ‰æ›´æ”¹çš„éƒ¨åˆ†\nwhen-changedï¼šå½“æ£€æµ‹åˆ°æ–‡ä»¶æ›´æ”¹æ—¶æ‰§è¡ŒæŒ‡å®šå‘½ä»¤ã€‚å‚é˜… inotifywait å’Œ entrã€‚\ntacï¼šåå‘è¾“å‡ºæ–‡ä»¶\nshufï¼šæ–‡ä»¶ä¸­éšæœºé€‰å–å‡ è¡Œ\ncommï¼šä¸€è¡Œä¸€è¡Œçš„æ¯”è¾ƒæ’åºè¿‡çš„æ–‡ä»¶\nstringsï¼šä»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŠ½å–æ–‡æœ¬\ntrï¼šè½¬æ¢å­—æ¯\niconv æˆ– uconvï¼šæ–‡æœ¬ç¼–ç è½¬æ¢\nsplit å’Œ csplitï¼šåˆ†å‰²æ–‡ä»¶\nspongeï¼šåœ¨å†™å…¥å‰è¯»å–æ‰€æœ‰è¾“å…¥ï¼Œåœ¨è¯»å–æ–‡ä»¶åå†å‘åŒä¸€æ–‡ä»¶å†™å…¥æ—¶æ¯”è¾ƒæœ‰ç”¨ï¼Œä¾‹å¦‚ grep -v something some-file | sponge some-file\nunitsï¼šå°†ä¸€ç§è®¡é‡å•ä½è½¬æ¢ä¸ºå¦ä¸€ç§ç­‰æ•ˆçš„è®¡é‡å•ä½ï¼ˆå‚é˜… /usr/share/units/definitions.unitsï¼‰\napgï¼šéšæœºç”Ÿæˆå¯†ç \nxzï¼šé«˜æ¯”ä¾‹çš„æ–‡ä»¶å‹ç¼©\nlddï¼šåŠ¨æ€åº“ä¿¡æ¯\nnmï¼šæå– obj æ–‡ä»¶ä¸­çš„ç¬¦å·\nab æˆ– wrkï¼šweb æœåŠ¡å™¨æ€§èƒ½åˆ†æ\nstraceï¼šè°ƒè¯•ç³»ç»Ÿè°ƒç”¨\nmtrï¼šæ›´å¥½çš„ç½‘ç»œè°ƒè¯•è·Ÿè¸ªå·¥å…·\ncsshï¼šå¯è§†åŒ–çš„å¹¶å‘ shell\nrsyncï¼šé€šè¿‡ ssh æˆ–æœ¬åœ°æ–‡ä»¶ç³»ç»ŸåŒæ­¥æ–‡ä»¶å’Œæ–‡ä»¶å¤¹\nwireshark å’Œ tsharkï¼šæŠ“åŒ…å’Œç½‘ç»œè°ƒè¯•å·¥å…·\nngrepï¼šç½‘ç»œå±‚çš„ grep\nhost å’Œ digï¼šDNS æŸ¥æ‰¾\nlsofï¼šåˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶çš„å·¥å…·ä»¥åŠæŸ¥çœ‹ç«¯å£ä¿¡æ¯\ndstatï¼šç³»ç»ŸçŠ¶æ€æŸ¥çœ‹\nglancesï¼šé«˜å±‚æ¬¡çš„å¤šå­ç³»ç»Ÿæ€»è§ˆ\niostatï¼šç¡¬ç›˜ä½¿ç”¨çŠ¶æ€\nmpstatï¼š CPU ä½¿ç”¨çŠ¶æ€\nvmstatï¼š å†…å­˜ä½¿ç”¨çŠ¶æ€\nhtopï¼štop çš„åŠ å¼ºç‰ˆ\nlastï¼šç™»å…¥è®°å½•\nwï¼šæŸ¥çœ‹å¤„äºç™»å½•çŠ¶æ€çš„ç”¨æˆ·\nidï¼šç”¨æˆ·/ç»„ ID ä¿¡æ¯\nsarï¼šç³»ç»Ÿå†å²æ•°æ®\niftop æˆ– nethogsï¼šå¥—æ¥å­—åŠè¿›ç¨‹çš„ç½‘ç»œåˆ©ç”¨æƒ…å†µ\nssï¼šå¥—æ¥å­—æ•°æ®\ndmesgï¼šå¼•å¯¼åŠç³»ç»Ÿé”™è¯¯ä¿¡æ¯\nsysctlï¼š åœ¨å†…æ ¸è¿è¡Œæ—¶åŠ¨æ€åœ°æŸ¥çœ‹å’Œä¿®æ”¹å†…æ ¸çš„è¿è¡Œå‚æ•°\nhdparmï¼šSATA/ATA ç£ç›˜æ›´æ”¹åŠæ€§èƒ½åˆ†æ\nlsblkï¼šåˆ—å‡ºå—è®¾å¤‡ä¿¡æ¯ï¼šä»¥æ ‘å½¢å±•ç¤ºä½ çš„ç£ç›˜ä»¥åŠç£ç›˜åˆ†åŒºä¿¡æ¯\nlshwï¼Œlscpuï¼Œlspciï¼Œlsusb å’Œ dmidecodeï¼šæŸ¥çœ‹ç¡¬ä»¶ä¿¡æ¯ï¼ŒåŒ…æ‹¬ CPUã€BIOSã€RAIDã€æ˜¾å¡ã€USBè®¾å¤‡ç­‰\nlsmod å’Œ modinfoï¼šåˆ—å‡ºå†…æ ¸æ¨¡å—ï¼Œå¹¶æ˜¾ç¤ºå…¶ç»†èŠ‚\nfortuneï¼Œddate å’Œ slï¼šé¢ï¼Œè¿™ä¸»è¦å–å†³äºä½ æ˜¯å¦è®¤ä¸ºè’¸æ±½ç«è½¦å’Œè«åå…¶å¦™çš„åäººåè¨€æ˜¯å¦â€œæœ‰ç”¨â€\nä»…é™ OS X ç³»ç»Ÿ ä»¥ä¸‹æ˜¯ä»…é™äº OS X ç³»ç»Ÿçš„æŠ€å·§ã€‚\nç”¨ brew ï¼ˆHomebrewï¼‰æˆ–è€… port ï¼ˆMacPortsï¼‰è¿›è¡ŒåŒ…ç®¡ç†ã€‚è¿™äº›å¯ä»¥ç”¨æ¥åœ¨ OS X ç³»ç»Ÿä¸Šå®‰è£…ä»¥ä¸Šçš„å¤§å¤šæ•°å‘½ä»¤ã€‚\nç”¨ pbcopy å¤åˆ¶ä»»ä½•å‘½ä»¤çš„è¾“å‡ºåˆ°æ¡Œé¢åº”ç”¨ï¼Œç”¨ pbpaste ç²˜è´´è¾“å…¥ã€‚\nè‹¥è¦åœ¨ OS X ç»ˆç«¯ä¸­å°† Option é”®è§†ä¸º alt é”®ï¼ˆä¾‹å¦‚åœ¨ä¸Šé¢ä»‹ç»çš„ alt-bã€alt-f ç­‰å‘½ä»¤ä¸­ç”¨åˆ°ï¼‰ï¼Œæ‰“å¼€ åå¥½è®¾ç½® -\u003e æè¿°æ–‡ä»¶ -\u003e é”®ç›˜ å¹¶å‹¾é€‰â€œä½¿ç”¨ Option é”®ä½œä¸º Meta é”®â€ã€‚\nç”¨ open æˆ–è€… open -a /Applications/Whatever.app ä½¿ç”¨æ¡Œé¢åº”ç”¨æ‰“å¼€æ–‡ä»¶ã€‚\nSpotlightï¼šç”¨ mdfind æœç´¢æ–‡ä»¶ï¼Œç”¨ mdls åˆ—å‡ºå…ƒæ•°æ®ï¼ˆä¾‹å¦‚ç…§ç‰‡çš„ EXIF ä¿¡æ¯ï¼‰ã€‚\næ³¨æ„ OS X ç³»ç»Ÿæ˜¯åŸºäº BSD UNIX çš„ï¼Œè®¸å¤šå‘½ä»¤ï¼ˆä¾‹å¦‚ psï¼Œlsï¼Œtailï¼Œawkï¼Œsedï¼‰éƒ½å’Œ Linux ä¸­æœ‰å¾®å¦™çš„ä¸åŒï¼ˆ Linux å¾ˆå¤§ç¨‹åº¦ä¸Šå—åˆ°äº† System V-style Unix å’Œ GNU å·¥å…·å½±å“ï¼‰ã€‚ä½ å¯ä»¥é€šè¿‡æ ‡é¢˜ä¸º \"BSD General Commands Manual\" çš„ man é¡µé¢å‘ç°è¿™äº›ä¸åŒã€‚åœ¨æœ‰äº›æƒ…å†µä¸‹ GNU ç‰ˆæœ¬çš„å‘½ä»¤ä¹Ÿå¯èƒ½è¢«å®‰è£…ï¼ˆä¾‹å¦‚ gawk å’Œ gsed å¯¹åº” GNU ä¸­çš„ awk å’Œ sed ï¼‰ã€‚å¦‚æœè¦å†™è·¨å¹³å°çš„ Bash è„šæœ¬ï¼Œé¿å…ä½¿ç”¨è¿™äº›å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œè€ƒè™‘ Python æˆ–è€… perl ï¼‰æˆ–è€…ç»è¿‡ä»”ç»†çš„æµ‹è¯•ã€‚\nç”¨ sw_vers è·å– OS X çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚\nä»…é™ Windows ç³»ç»Ÿ ä»¥ä¸‹æ˜¯ä»…é™äº Windows ç³»ç»Ÿçš„æŠ€å·§ã€‚\nåœ¨ Winodws ä¸‹è·å– Unix å·¥å…· å¯ä»¥å®‰è£… Cygwin å…è®¸ä½ åœ¨ Microsoft Windows ä¸­ä½“éªŒ Unix shell çš„å¨åŠ›ã€‚è¿™æ ·çš„è¯ï¼Œæœ¬æ–‡ä¸­ä»‹ç»çš„å¤§å¤šæ•°å†…å®¹éƒ½å°†é€‚ç”¨ã€‚\nåœ¨ Windows 10 ä¸Šï¼Œä½ å¯ä»¥ä½¿ç”¨ Bash on Ubuntu on Windowsï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç†Ÿæ‚‰çš„ Bash ç¯å¢ƒï¼ŒåŒ…å«äº†ä¸å°‘ Unix å‘½ä»¤è¡Œå·¥å…·ã€‚å¥½å¤„æ˜¯å®ƒå…è®¸ Linux ä¸Šç¼–å†™çš„ç¨‹åºåœ¨ Windows ä¸Šè¿è¡Œï¼Œè€Œå¦ä¸€æ–¹é¢ï¼ŒWindows ä¸Šç¼–å†™çš„ç¨‹åºå´æ— æ³•åœ¨ Bash å‘½ä»¤è¡Œä¸­è¿è¡Œã€‚\nå¦‚æœä½ åœ¨ Windows ä¸Šä¸»è¦æƒ³ç”¨ GNU å¼€å‘è€…å·¥å…·ï¼ˆä¾‹å¦‚ GCCï¼‰ï¼Œå¯ä»¥è€ƒè™‘ MinGW ä»¥åŠå®ƒçš„ MSYS åŒ…ï¼Œè¿™ä¸ªåŒ…æä¾›äº†ä¾‹å¦‚ bashï¼Œgawkï¼Œmake å’Œ grep çš„å·¥å…·ã€‚MSYS å¹¶ä¸åŒ…å«æ‰€æœ‰å¯ä»¥ä¸ Cygwin åª²ç¾çš„ç‰¹æ€§ã€‚å½“åˆ¶ä½œ Unix å·¥å…·çš„åŸç”Ÿ Windows ç«¯å£æ—¶ MinGW å°†ç‰¹åˆ«åœ°æœ‰ç”¨ã€‚\nå¦ä¸€ä¸ªåœ¨ Windows ä¸‹å®ç°æ¥è¿‘ Unix ç¯å¢ƒå¤–è§‚æ•ˆæœçš„é€‰é¡¹æ˜¯ Cashã€‚æ³¨æ„åœ¨æ­¤ç¯å¢ƒä¸‹åªæœ‰å¾ˆå°‘çš„ Unix å‘½ä»¤å’Œå‘½ä»¤è¡Œå¯ç”¨ã€‚\nå®ç”¨ Windows å‘½ä»¤è¡Œå·¥å…· å¯ä»¥ä½¿ç”¨ wmic åœ¨å‘½ä»¤è¡Œç¯å¢ƒä¸‹ç»™å¤§éƒ¨åˆ† Windows ç³»ç»Ÿç®¡ç†ä»»åŠ¡ç¼–å†™è„šæœ¬ä»¥åŠæ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚\nWindows å®ç”¨çš„åŸç”Ÿå‘½ä»¤è¡Œç½‘ç»œå·¥å…·åŒ…æ‹¬ pingï¼Œipconfigï¼Œtracertï¼Œå’Œ netstatã€‚\nå¯ä»¥ä½¿ç”¨ Rundll32 å‘½ä»¤æ¥å®ç°è®¸å¤šæœ‰ç”¨çš„ Windows ä»»åŠ¡ ã€‚\nCygwin æŠ€å·§ é€šè¿‡ Cygwin çš„åŒ…ç®¡ç†å™¨æ¥å®‰è£…é¢å¤–çš„ Unix ç¨‹åºã€‚\nä½¿ç”¨ mintty ä½œä¸ºä½ çš„å‘½ä»¤è¡Œçª—å£ã€‚\nè¦è®¿é—® Windows å‰ªè´´æ¿ï¼Œå¯ä»¥é€šè¿‡ /dev/clipboardã€‚\nè¿è¡Œ cygstart ä»¥é€šè¿‡é»˜è®¤ç¨‹åºæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ã€‚\nè¦è®¿é—® Windows æ³¨å†Œè¡¨ï¼Œå¯ä»¥ä½¿ç”¨ regtoolã€‚\næ³¨æ„ Windows é©±åŠ¨å™¨è·¯å¾„ C:\\ åœ¨ Cygwin ä¸­ç”¨ /cygdrive/c ä»£è¡¨ï¼Œè€Œ Cygwin çš„ / ä»£è¡¨ Windows ä¸­çš„ C:\\cygwinã€‚è¦è½¬æ¢ Cygwin å’Œ Windows é£æ ¼çš„è·¯å¾„å¯ä»¥ç”¨ cygpathã€‚è¿™åœ¨éœ€è¦è°ƒç”¨ Windows ç¨‹åºçš„è„šæœ¬é‡Œå¾ˆæœ‰ç”¨ã€‚\nå­¦ä¼šä½¿ç”¨ wmicï¼Œä½ å°±å¯ä»¥ä»å‘½ä»¤è¡Œæ‰§è¡Œå¤§å¤šæ•° Windows ç³»ç»Ÿç®¡ç†ä»»åŠ¡ï¼Œå¹¶ç¼–æˆè„šæœ¬ã€‚\nè¦åœ¨ Windows ä¸‹è·å¾— Unix çš„ç•Œé¢å’Œä½“éªŒï¼Œå¦ä¸€ä¸ªåŠæ³•æ˜¯ä½¿ç”¨ Cashã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªç¯å¢ƒæ”¯æŒçš„ Unix å‘½ä»¤å’Œå‘½ä»¤è¡Œå‚æ•°éå¸¸å°‘ã€‚\nè¦åœ¨ Windows ä¸Šè·å– GNU å¼€å‘è€…å·¥å…·ï¼ˆæ¯”å¦‚ GCCï¼‰çš„å¦ä¸€ä¸ªåŠæ³•æ˜¯ä½¿ç”¨ MinGW ä»¥åŠå®ƒçš„ MSYS è½¯ä»¶åŒ…ï¼Œè¯¥è½¯ä»¶åŒ…æä¾›äº† bashã€gawkã€makeã€grep ç­‰å·¥å…·ã€‚ç„¶è€Œ MSYS æä¾›çš„åŠŸèƒ½æ²¡æœ‰ Cygwin å®Œå–„ã€‚MinGW åœ¨åˆ›å»º Unix å·¥å…·çš„ Windows åŸç”Ÿç§»æ¤æ–¹é¢éå¸¸æœ‰ç”¨ã€‚\næ›´å¤šèµ„æº awesome-shellï¼šä¸€ä»½ç²¾å¿ƒç»„ç»‡çš„å‘½ä»¤è¡Œå·¥å…·åŠèµ„æºçš„åˆ—è¡¨ã€‚ awesome-osx-command-lineï¼šä¸€ä»½é’ˆå¯¹ OS X å‘½ä»¤è¡Œçš„æ›´æ·±å…¥çš„æŒ‡å—ã€‚ Strict modeï¼šä¸ºäº†ç¼–å†™æ›´å¥½çš„è„šæœ¬æ–‡ä»¶ã€‚ shellcheckï¼šä¸€ä¸ªé™æ€ shell è„šæœ¬åˆ†æå·¥å…·ï¼Œæœ¬è´¨ä¸Šæ˜¯ bashï¼shï¼zsh çš„ lintã€‚ Filenames and Pathnames in Shellï¼šæœ‰å…³å¦‚ä½•åœ¨ shell è„šæœ¬é‡Œæ­£ç¡®å¤„ç†æ–‡ä»¶åçš„ç»†ææœ«èŠ‚ã€‚ Data Science at the Command Lineï¼šç”¨äºæ•°æ®ç§‘å­¦çš„ä¸€äº›å‘½ä»¤å’Œå·¥å…·ï¼Œæ‘˜è‡ªåŒåä¹¦ç±ã€‚ å…è´£å£°æ˜ é™¤å»ç‰¹åˆ«å°çš„å·¥ä½œï¼Œä½ ç¼–å†™çš„ä»£ç åº”å½“æ–¹ä¾¿ä»–äººé˜…è¯»ã€‚èƒ½åŠ›å¾€å¾€ä¼´éšç€è´£ä»»ï¼Œä½  æœ‰èƒ½åŠ› åœ¨ Bash ä¸­ç©ä¸€äº›å¥‡æŠ€æ·«å·§å¹¶ä¸æ„å‘³ç€ä½ åº”è¯¥å»åšï¼;)\næˆæƒæ¡æ¬¾ æœ¬æ–‡ä½¿ç”¨æˆæƒåè®® Creative Commons Attribution-ShareAlike 4.0 International Licenseã€‚\n","description":"","tags":["command-line"],"title":"å‘½ä»¤è¡Œçš„è‰ºæœ¯","uri":"/blog/posts/Linux/%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%9A%84%E8%89%BA%E6%9C%AF/"},{"categories":null,"content":"HTTP çŠ¶æ€ç åˆ†ç±»åŠè§£é‡Š HTTP åè®®ä¸­çŠ¶æ€ç ç¹å¤šï¼Œæœ¬æ–‡ä»‹ç» HPPT/1.1 åè®®ä¸­å„ç§çŠ¶æ€ç \nHypertext Transfer Protocol -- HTTP/1.1\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 Status-Code = \"100\" ; Section 10.1.1: Continue | \"101\" ; Section 10.1.2: Switching Protocols | \"200\" ; Section 10.2.1: OK | \"201\" ; Section 10.2.2: Created | \"202\" ; Section 10.2.3: Accepted | \"203\" ; Section 10.2.4: Non-Authoritative Information | \"204\" ; Section 10.2.5: No Content | \"205\" ; Section 10.2.6: Reset Content | \"206\" ; Section 10.2.7: Partial Content | \"300\" ; Section 10.3.1: Multiple Choices | \"301\" ; Section 10.3.2: Moved Permanently | \"302\" ; Section 10.3.3: Found | \"303\" ; Section 10.3.4: See Other | \"304\" ; Section 10.3.5: Not Modified | \"305\" ; Section 10.3.6: Use Proxy | \"307\" ; Section 10.3.8: Temporary Redirect | \"400\" ; Section 10.4.1: Bad Request | \"401\" ; Section 10.4.2: Unauthorized | \"402\" ; Section 10.4.3: Payment Required | \"403\" ; Section 10.4.4: Forbidden | \"404\" ; Section 10.4.5: Not Found | \"405\" ; Section 10.4.6: Method Not Allowed | \"406\" ; Section 10.4.7: Not Acceptable | \"407\" ; Section 10.4.8: Proxy Authentication Required | \"408\" ; Section 10.4.9: Request Time-out | \"409\" ; Section 10.4.10: Conflict | \"410\" ; Section 10.4.11: Gone | \"411\" ; Section 10.4.12: Length Required | \"412\" ; Section 10.4.13: Precondition Failed | \"413\" ; Section 10.4.14: Request Entity Too Large | \"414\" ; Section 10.4.15: Request-URI Too Large | \"415\" ; Section 10.4.16: Unsupported Media Type | \"416\" ; Section 10.4.17: Requested range not satisfiable | \"417\" ; Section 10.4.18: Expectation Failed | \"500\" ; Section 10.5.1: Internal Server Error | \"501\" ; Section 10.5.2: Not Implemented | \"502\" ; Section 10.5.3: Bad Gateway | \"503\" ; Section 10.5.4: Service Unavailable | \"504\" ; Section 10.5.5: Gateway Time-out | \"505\" ; Section 10.5.6: HTTP Version not supported | extension-code çŠ¶æ€ç åˆ†ç±» è¿™äº›çŠ¶æ€ç è¢«åˆ†ä¸ºäº”å¤§ç±»ï¼š\n100-199 ç”¨äºæŒ‡å®šå®¢æˆ·ç«¯åº”ç›¸åº”çš„æŸäº›åŠ¨ä½œã€‚\n200-299 ç”¨äºè¡¨ç¤ºè¯·æ±‚æˆåŠŸã€‚\n300-399 ç”¨äºå·²ç»ç§»åŠ¨çš„æ–‡ä»¶å¹¶ä¸”å¸¸è¢«åŒ…å«åœ¨å®šä½å¤´ä¿¡æ¯ä¸­æŒ‡å®šæ–°çš„åœ°å€ä¿¡æ¯ã€‚\n400-499 ç”¨äºæŒ‡å‡ºå®¢æˆ·ç«¯çš„é”™è¯¯ã€‚\n500-599 ç”¨äºæ”¯æŒæœåŠ¡å™¨é”™è¯¯ã€‚\nHttpServletResponseä¸­çš„å¸¸é‡ä»£è¡¨å…³è”ä¸åŒæ ‡å‡†æ¶ˆæ¯çš„çŠ¶æ€ç ã€‚åœ¨servletç¨‹åºä¸­ï¼Œä½ ä¼šæ›´å¤šåœ°ç”¨åˆ°è¿™äº›å¸¸é‡çš„æ ‡è¯†æ¥ä½¿ç”¨çŠ¶æ€ç ã€‚ä¾‹å¦‚ï¼šä½ ä¸€èˆ¬ä¼šä½¿ç”¨response.setStatus(response.SC_NO_CONTENT)è€Œä¸æ˜¯ response.setStatus(204)ï¼Œå› ä¸ºåè€…ä¸æ˜“ç†è§£è€Œä¸”å®¹æ˜“å¯¼è‡´é”™è¯¯ã€‚ä½†æ˜¯ï¼Œä½ åº”å½“æ³¨æ„åˆ°æœåŠ¡å™¨å…è®¸å¯¹æ¶ˆæ¯è½»å¾®çš„æ”¹å˜ï¼Œè€Œå®¢æˆ·ç«¯åªæ³¨æ„çŠ¶æ€ç çš„æ•°å­—å€¼ã€‚æ‰€ä»¥æœåŠ¡å™¨å¯èƒ½åªè¿”å› HTTP/1.1 200 è€Œä¸æ˜¯ HTTP/1.1 200 OKã€‚\nçŠ¶æ€ç è¯¦è§£ 100 (Continue/ç»§ç»­)\nå¦‚æœæœåŠ¡å™¨æ”¶åˆ°å¤´ä¿¡æ¯ä¸­å¸¦æœ‰100-continueçš„è¯·æ±‚ï¼Œè¿™æ˜¯æŒ‡å®¢æˆ·ç«¯è¯¢é—®æ˜¯å¦å¯ä»¥åœ¨åç»­çš„è¯·æ±‚ä¸­å‘é€é™„ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ç”¨100(SC_CONTINUE)å…è®¸å®¢æˆ·ç«¯ç»§ç»­æˆ–ç”¨417 (Expectation Failed)å‘Šè¯‰å®¢æˆ·ç«¯ä¸åŒæ„æ¥å—é™„ä»¶ã€‚è¿™ä¸ªçŠ¶æ€ç æ˜¯ HTTP 1.1ä¸­æ–°åŠ å…¥çš„ã€‚\n101 (Switching Protocols/è½¬æ¢åè®®)\n101 (SC_SWITCHING_PROTOCOLS)çŠ¶æ€ç æ˜¯æŒ‡æœåŠ¡å™¨å°†æŒ‰ç…§å…¶ä¸Šçš„å¤´ä¿¡æ¯å˜ä¸ºä¸€ä¸ªä¸åŒçš„åè®®ã€‚è¿™æ˜¯ HTTP 1.1ä¸­æ–°åŠ å…¥çš„ã€‚\n200 (OK/æ­£å¸¸)\n200 (SC_OK)çš„æ„æ€æ˜¯ä¸€åˆ‡æ­£å¸¸ã€‚ä¸€èˆ¬ç”¨äºç›¸åº”GETå’ŒPOSTè¯·æ±‚ã€‚è¿™ä¸ªçŠ¶æ€ç å¯¹servletæ˜¯ç¼ºçœçš„ï¼›å¦‚æœæ²¡æœ‰è°ƒç”¨setStatusæ–¹æ³•çš„è¯ï¼Œå°±ä¼šå¾—åˆ°200ã€‚\n201 (Created/å·²åˆ›å»º)\n201 (SC_CREATED)è¡¨ç¤ºæœåŠ¡å™¨åœ¨è¯·æ±‚çš„å“åº”ä¸­å»ºç«‹äº†æ–°æ–‡æ¡£ï¼›åº”åœ¨å®šä½å¤´ä¿¡æ¯ä¸­ç»™å‡ºå®ƒçš„URLã€‚\n202 (Accepted/æ¥å—)\n202 (SC_ACCEPTED)å‘Šè¯‰å®¢æˆ·ç«¯è¯·æ±‚æ­£åœ¨è¢«æ‰§è¡Œï¼Œä½†è¿˜æ²¡æœ‰å¤„ç†å®Œã€‚\n203 (Non-Authoritative Information/éå®˜æ–¹ä¿¡æ¯)\nçŠ¶æ€ç 203 (SC_NON_AUTHORITATIVE_INFORMATION)æ˜¯è¡¨ç¤ºæ–‡æ¡£è¢«æ­£å¸¸çš„è¿”å›ï¼Œä½†æ˜¯ç”±äºæ­£åœ¨ä½¿ç”¨çš„æ˜¯æ–‡æ¡£å‰¯æœ¬æ‰€ä»¥æŸäº›å“åº”å¤´ä¿¡æ¯å¯èƒ½ä¸æ­£ç¡®ã€‚è¿™æ˜¯ HTTP 1.1ä¸­æ–°åŠ å…¥çš„ã€‚\n204 (No Content/æ— å†…å®¹)\nåœ¨å¹¶æ²¡æœ‰æ–°æ–‡æ¡£çš„æƒ…å†µä¸‹ï¼Œ204 (SC_NO_CONTENT)ç¡®ä¿æµè§ˆå™¨ç»§ç»­æ˜¾ç¤ºå…ˆå‰çš„æ–‡æ¡£ã€‚è¿™å„çŠ¶æ€ç å¯¹äºç”¨æˆ·å‘¨æœŸæ€§çš„é‡è½½æŸä¸€é¡µéå¸¸æœ‰ç”¨ï¼Œå¹¶ä¸”ä½ å¯ä»¥ç¡®å®šå…ˆå‰çš„é¡µé¢æ˜¯å¦å·²ç»æ›´æ–°ã€‚ä¾‹å¦‚ï¼ŒæŸä¸ªservletå¯èƒ½ä½œå¦‚ä¸‹æ“ä½œï¼š\n1 2 3 4 5 6 7 8 9 10 11 int pageVersion =Integer.parseInt(request.getParameter(\"pageVersion\")); if (pageVersion \u003e;= currentVersion) { response.setStatus(response.SC_NO_CONTENT); } else { â€‹ // Create regular page } ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•å¯¹é€šè¿‡åˆ·æ–°å“åº”å¤´ä¿¡æ¯æˆ–ç­‰ä»·çš„HTMLæ ‡è®°è‡ªåŠ¨é‡è½½çš„é¡µé¢èµ·ä½œç”¨ï¼Œå› ä¸ºå®ƒä¼šè¿”å›ä¸€ä¸ª204çŠ¶æ€ç åœæ­¢ä»¥åçš„é‡è½½ã€‚ä½†åŸºäºJavaScriptè„šæœ¬çš„è‡ªåŠ¨é‡è½½åœ¨è¿™ç§æƒ…å†µä¸‹ä»ç„¶éœ€è¦èƒ½å¤Ÿèµ·ä½œç”¨ã€‚å¯ä»¥é˜…è¯»æœ¬ä¹¦7.2 ( HTTP 1.1 Response Headers and Their Meaning/HTTP 1.1å“åº”å¤´ä¿¡æ¯ä»¥åŠä»–ä»¬çš„æ„ä¹‰)éƒ¨åˆ†çš„è¯¦ç»†è®¨è®ºã€‚\n205 (Reset Content/é‡ç½®å†…å®¹)\né‡ç½®å†…å®¹205 (SC_RESET_CONTENT)çš„æ„æ€æ˜¯è™½ç„¶æ²¡æœ‰æ–°æ–‡æ¡£ä½†æµè§ˆå™¨è¦é‡ç½®æ–‡æ¡£æ˜¾ç¤ºã€‚è¿™ä¸ªçŠ¶æ€ç ç”¨äºå¼ºè¿«æµè§ˆå™¨æ¸…é™¤è¡¨å•åŸŸã€‚è¿™æ˜¯ HTTP 1.1ä¸­æ–°åŠ å…¥çš„ã€‚\n206 (Partial Content/å±€éƒ¨å†…å®¹)\n206 (SC_PARTIAL_CONTENT)æ˜¯åœ¨æœåŠ¡å™¨å®Œæˆäº†ä¸€ä¸ªåŒ…å«Rangeå¤´ä¿¡æ¯çš„å±€éƒ¨è¯·æ±‚æ—¶è¢«å‘é€çš„ã€‚è¿™æ˜¯ HTTP 1.1ä¸­æ–°åŠ å…¥çš„ã€‚\n300 (Multiple Choices/å¤šé‡é€‰æ‹©)\n300 (SC_MULTIPLE_CHOICES)è¡¨ç¤ºè¢«è¯·æ±‚çš„æ–‡æ¡£å¯ä»¥åœ¨å¤šä¸ªåœ°æ–¹æ‰¾åˆ°ï¼Œå¹¶å°†åœ¨è¿”å›çš„æ–‡æ¡£ä¸­åˆ—å‡ºæ¥ã€‚å¦‚æœæœåŠ¡å™¨æœ‰é¦–é€‰è®¾ç½®ï¼Œé¦–é€‰é¡¹å°†ä¼šè¢«åˆ—äºå®šä½å“åº”å¤´ä¿¡æ¯ä¸­ã€‚\n301 (Moved Permanently)\n301 (SC_MOVED_PERMANENTLY)çŠ¶æ€æ˜¯æŒ‡æ‰€è¯·æ±‚çš„æ–‡æ¡£åœ¨åˆ«çš„åœ°æ–¹ï¼›æ–‡æ¡£æ–°çš„URLä¼šåœ¨å®šä½å“åº”å¤´ä¿¡æ¯ä¸­ç»™å‡ºã€‚æµè§ˆå™¨ä¼šè‡ªåŠ¨è¿æ¥åˆ°æ–°çš„URLã€‚\n302 (Found/æ‰¾åˆ°)\nä¸301æœ‰äº›ç±»ä¼¼ï¼Œåªæ˜¯å®šä½å¤´ä¿¡æ¯ä¸­æ‰€ç»™çš„URLåº”è¢«ç†è§£ä¸ºä¸´æ—¶äº¤æ¢åœ°å€è€Œä¸æ˜¯æ°¸ä¹…çš„ã€‚æ³¨æ„ï¼šåœ¨ HTTP 1.0ä¸­ï¼Œæ¶ˆæ¯æ˜¯ä¸´æ—¶ç§»åŠ¨(Moved Temporarily)çš„è€Œä¸æ˜¯è¢«æ‰¾åˆ°ï¼Œå› æ­¤HttpServletResponseä¸­çš„å¸¸é‡æ˜¯SC_MOVED_TEMPORARILYä¸æ˜¯æˆ‘ä»¬ä»¥ä¸ºçš„SC_FOUNDã€‚\nNotice ä»£è¡¨çŠ¶æ€ç 302çš„å¸¸é‡æ˜¯SC_MOVED_TEMPORARILYè€Œä¸æ˜¯SC_FOUNDã€‚\nçŠ¶æ€ç 302æ˜¯éå¸¸æœ‰ç”¨çš„å› ä¸ºæµè§ˆå™¨è‡ªåŠ¨è¿æ¥åœ¨å®šä¸ºå“åº”å¤´ä¿¡æ¯ä¸­ç»™å‡ºçš„æ–°URLã€‚è¿™éå¸¸æœ‰ç”¨ï¼Œè€Œä¸”ä¸ºæ­¤æœ‰ä¸€ä¸ªä¸“é—¨çš„æ–¹æ³•â€”â€”sendRedirectã€‚ä½¿ç”¨response.sendRedirect(url)æ¯”è°ƒç”¨response.setStatus(response.SC_MOVED_TEMPORARILY)å’Œresponse.setHeader(\"Location\", url)å¤šå‡ ä¸ªå¥½å¤„ã€‚é¦–å…ˆï¼Œresponse.sendRedirect(url)æ–¹æ³•æ˜æ˜¾è¦ç®€å•å’Œå®¹æ˜“ã€‚ç¬¬äºŒï¼Œservletè‡ªåŠ¨å»ºç«‹ä¸€é¡µä¿å­˜è¿™ä¸€è¿æ¥ä»¥æä¾›ç»™é‚£äº›ä¸èƒ½è‡ªåŠ¨è½¬å‘çš„æµè§ˆå™¨æ˜¾ç¤ºã€‚æœ€åï¼Œåœ¨servlet 2.2ç‰ˆæœ¬ï¼ˆJ2EEä¸­çš„ç‰ˆæœ¬ï¼‰ä¸­ï¼ŒsendRedirectèƒ½å¤Ÿå¤„ç†ç›¸å¯¹è·¯å¾„ï¼Œè‡ªåŠ¨è½¬æ¢ä¸ºç»å¯¹è·¯å¾„ã€‚ä½†æ˜¯ä½ åªèƒ½åœ¨2.1ç‰ˆæœ¬ä¸­ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚\nå¦‚æœä½ å°†ç”¨æˆ·è½¬å‘åˆ°ç«™ç‚¹çš„å¦ä¸€é¡µä¸­ï¼Œä½ è¦ç”¨ HttpServletResponse ä¸­çš„ encodeURL æ–¹æ³•ä¼ é€URLã€‚è¿™ä¹ˆåšå¯é¢„é˜²ä¸æ–­ä½¿ç”¨åŸºäºURLé‡å†™çš„ä¼šè¯è·Ÿè¸ªçš„æƒ…å†µã€‚URLé‡å†™æ˜¯ä¸€ç§åœ¨ä½ çš„ç½‘ç«™è·Ÿè¸ªä¸ä½¿ç”¨ cookies çš„ç”¨æˆ·çš„æ–¹æ³•ã€‚è¿™æ˜¯é€šè¿‡åœ¨æ¯ä¸€ä¸ªURLå°¾éƒ¨é™„åŠ è·¯å¾„ä¿¡æ¯å®ç°çš„ï¼Œä½†æ˜¯ servlet ä¼šè¯è·Ÿè¸ªAPIä¼šè‡ªåŠ¨çš„æ³¨æ„è¿™äº›ç»†èŠ‚ã€‚ä¼šè¯è·Ÿè¸ªåœ¨ç¬¬ä¹ç« è®¨è®ºï¼Œå¹¶ä¸”å…»æˆä½¿ç”¨ encodeURL çš„ä¹ æƒ¯ä¼šä½¿ä»¥åæ·»åŠ ä¼šè¯è·Ÿè¸ªçš„åŠŸèƒ½æ›´å®¹æ˜“å¾ˆå¤šã€‚\næ ¸å¿ƒæŠ€å·§\nå¦‚æœä½ å°†ç”¨æˆ·è½¬å‘åˆ°ä½ çš„ç«™ç‚¹çš„å…¶ä»–é¡µé¢ï¼Œç”¨ response.sendRedirect(response.encodeURL(url)) çš„æ–¹å¼äº‹å…ˆè®¡åˆ’å¥½ä¼šè¯è·Ÿè¸ª(session tracking)è¦æ¯”åªæ˜¯è°ƒç”¨ response.sendRedirect(url) å¥½çš„å¤šã€‚\nè¿™ä¸ªçŠ¶æ€ç æœ‰æ—¶å¯ä»¥ä¸301äº¤æ¢ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ é”™è¯¯çš„è®¿é—®äº†http://www.talentdigger.cn/home/link.php?url=aG9zdC9%2BdXNlcg%3D%3Dï¼ˆè·¯å¾„ä¿¡æ¯ä¸å®Œæ•´ï¼‰ï¼Œæœ‰äº›æœåŠ¡å™¨å°±ä¼šå›å¤301çŠ¶æ€ç è€Œæœ‰äº›åˆ™å›å¤302ã€‚ä»æŠ€æœ¯ä¸Šè¯´ï¼Œå¦‚æœæœ€åˆçš„è¯·æ±‚æ˜¯GETæµè§ˆå™¨åªæ˜¯è¢«å‡å®šè‡ªåŠ¨è½¬å‘ã€‚å¦‚æœæƒ³äº†è§£æ›´å¤šç»†èŠ‚ï¼Œè¯·çœ‹çŠ¶æ€ç 307çš„è®¨è®ºã€‚\n303 (See Other/å‚è§å…¶ä»–ä¿¡æ¯)\nè¿™ä¸ªçŠ¶æ€ç å’Œ 301ã€302 ç›¸ä¼¼ï¼Œåªæ˜¯å¦‚æœæœ€åˆçš„è¯·æ±‚æ˜¯ POSTï¼Œé‚£ä¹ˆæ–°æ–‡æ¡£ï¼ˆåœ¨å®šä½å¤´ä¿¡æ¯ä¸­ç»™å‡ºï¼‰è¯ç”¨ GET æ‰¾å›ã€‚è¿™ä¸ªçŠ¶æ€ç æ˜¯æ–°åŠ å…¥ HTTP 1.1ä¸­çš„ã€‚\n304 (Not Modified/ä¸ºä¿®æ­£)\nå½“å®¢æˆ·ç«¯æœ‰ä¸€ä¸ªç¼“å­˜çš„æ–‡æ¡£ï¼Œé€šè¿‡æä¾›ä¸€ä¸ª If-Modified-Since å¤´ä¿¡æ¯å¯æŒ‡å‡ºå®¢æˆ·ç«¯åªå¸Œæœ›æ–‡æ¡£åœ¨æŒ‡å®šæ—¥æœŸä¹‹åæœ‰æ‰€ä¿®æ”¹æ—¶æ‰ä¼šé‡è½½æ­¤æ–‡æ¡£ï¼Œç”¨è¿™ç§æ–¹å¼å¯ä»¥è¿›è¡Œæœ‰æ¡ä»¶çš„è¯·æ±‚ã€‚304 (SC_NOT_MODIFIED)æ˜¯æŒ‡ç¼“å†²çš„ç‰ˆæœ¬å·²ç»è¢«æ›´æ–°å¹¶ä¸”å®¢æˆ·ç«¯åº”åˆ·æ–°æ–‡æ¡£ã€‚å¦å¤–ï¼ŒæœåŠ¡å™¨å°†è¿”å›è¯·æ±‚çš„æ–‡æ¡£åŠçŠ¶æ€ç  200ã€‚servletä¸€èˆ¬æƒ…å†µä¸‹ä¸ä¼šç›´æ¥è®¾ç½®è¿™ä¸ªçŠ¶æ€ç ã€‚å®ƒä»¬ä¼šå®ç°getLastModifiedæ–¹æ³•å¹¶æ ¹æ®ä¿®æ­£æ—¥æœŸè®©é»˜è®¤æœåŠ¡æ–¹æ³•å¤„ç†æœ‰æ¡ä»¶çš„è¯·æ±‚ã€‚è¿™ä¸ªæ–¹æ³•çš„ä¾‹ç¨‹å·²åœ¨2.8éƒ¨åˆ†(An Example Using Servlet Initialization and Page Modification Dates/ä¸€ä¸ªä½¿ç”¨servletåˆå§‹åŒ–å’Œé¡µé¢ä¿®æ­£æ—¥æœŸçš„ä¾‹å­)ç»™å‡ºã€‚\n305 (Use Proxy/ä½¿ç”¨ä»£ç†)\n305 (SC_USE_PROXY)è¡¨ç¤ºæ‰€è¯·æ±‚çš„æ–‡æ¡£è¦é€šè¿‡å®šä½å¤´ä¿¡æ¯ä¸­çš„ä»£ç†æœåŠ¡å™¨è·å¾—ã€‚è¿™ä¸ªçŠ¶æ€ç æ˜¯æ–°åŠ å…¥ HTTP 1.1ä¸­çš„ã€‚\n307 (Temporary Redirect/ä¸´æ—¶é‡å®šå‘)\næµè§ˆå™¨å¤„ç†307çŠ¶æ€çš„è§„åˆ™ä¸302ç›¸åŒã€‚307çŠ¶æ€è¢«åŠ å…¥åˆ° HTTP 1.1ä¸­æ˜¯ç”±äºè®¸å¤šæµè§ˆå™¨åœ¨æ”¶åˆ°302å“åº”æ—¶å³ä½¿æ˜¯åŸå§‹æ¶ˆæ¯ä¸ºPOSTçš„æƒ…å†µä¸‹ä»ç„¶æ‰§è¡Œäº†é”™è¯¯çš„è½¬å‘ã€‚åªæœ‰åœ¨æ”¶åˆ°303å“åº”æ—¶æ‰å‡å®šæµè§ˆå™¨ä¼šåœ¨POSTè¯·æ±‚æ—¶é‡å®šå‘ã€‚æ·»åŠ è¿™ä¸ªæ–°çš„çŠ¶æ€ç çš„ç›®çš„å¾ˆæ˜ç¡®ï¼šåœ¨å“åº”ä¸º303æ—¶æŒ‰ç…§GETå’ŒPOSTè¯·æ±‚è½¬å‘ï¼›è€Œåœ¨307å“åº”æ—¶åˆ™æŒ‰ç…§GETè¯·æ±‚è½¬å‘è€Œä¸æ˜¯POSTè¯·æ±‚ã€‚æ³¨æ„ï¼šç”±äºæŸäº›åŸå› åœ¨HttpServletResponseä¸­è¿˜æ²¡æœ‰ä¸è¿™ä¸ªçŠ¶æ€å¯¹åº”çš„å¸¸é‡ã€‚è¯¥çŠ¶æ€ç æ˜¯æ–°åŠ å…¥HTTP 1.1ä¸­çš„ã€‚\næ³¨æ„\nåœ¨ HttpServletResponse ä¸­æ²¡æœ‰ SC_TEMPORARY_REDIRECT å¸¸é‡ï¼Œæ‰€ä»¥ä½ åªèƒ½æ˜¾ç¤ºçš„ä½¿ç”¨307çŠ¶æ€ç ã€‚\n400 (Bad Request/é”™è¯¯è¯·æ±‚)\n400 (SC_BAD_REQUEST)æŒ‡å‡ºå®¢æˆ·ç«¯è¯·æ±‚ä¸­çš„è¯­æ³•é”™è¯¯ã€‚\n401 (Unauthorized/æœªæˆæƒ)\n401 (SC_UNAUTHORIZED)è¡¨ç¤ºå®¢æˆ·ç«¯åœ¨æˆæƒå¤´ä¿¡æ¯ä¸­æ²¡æœ‰æœ‰æ•ˆçš„èº«ä»½ä¿¡æ¯æ—¶è®¿é—®å—åˆ°å¯†ç ä¿æŠ¤çš„é¡µé¢ã€‚è¿™ä¸ªå“åº”å¿…é¡»åŒ…å«ä¸€ä¸ªWWW-Authenticateçš„æˆæƒä¿¡æ¯å¤´ã€‚ä¾‹å¦‚ï¼Œåœ¨æœ¬ä¹¦4.5éƒ¨åˆ†ä¸­çš„â€œRestricting Access to Web Pages./é™åˆ¶è®¿é—®Webé¡µã€‚â€\n403 (Forbidden/ç¦æ­¢)\n403 (SC_FORBIDDEN)çš„æ„æ€æ˜¯é™¤éæ‹¥æœ‰æˆæƒå¦åˆ™æœåŠ¡å™¨æ‹’ç»æä¾›æ‰€è¯·æ±‚çš„èµ„æºã€‚è¿™ä¸ªçŠ¶æ€ç»å¸¸ä¼šç”±äºæœåŠ¡å™¨ä¸Šçš„æŸåæ–‡ä»¶æˆ–ç›®å½•è®¸å¯è€Œå¼•èµ·ã€‚\n404 (Not Found/æœªæ‰¾åˆ°)\n404 (SC_NOT_FOUND)çŠ¶æ€æ¯ä¸ªç½‘ç»œç¨‹åºå‘˜å¯èƒ½éƒ½é‡åˆ°è¿‡ï¼Œä»–å‘Šè¯‰å®¢æˆ·ç«¯æ‰€ç»™çš„åœ°å€æ— æ³•æ‰¾åˆ°ä»»ä½•èµ„æºã€‚å®ƒæ˜¯è¡¨ç¤ºâ€œæ²¡æœ‰æ‰€è®¿é—®é¡µé¢â€çš„æ ‡å‡†æ–¹å¼ã€‚è¿™ä¸ªçŠ¶æ€ç æ˜¯å¸¸ç”¨çš„å“åº”å¹¶ä¸”åœ¨HttpServletResponseç±»ä¸­æœ‰ä¸“é—¨çš„æ–¹æ³•å®ç°å®ƒï¼šsendError(\"message\")ã€‚ç›¸å¯¹äºsetStatusä½¿ç”¨sendErrorå¾—å¥½å¤„æ˜¯ï¼šæœåŠ¡å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªé”™è¯¯é¡µæ¥æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚ä½†æ˜¯ï¼ŒInternet Explorer 5æµè§ˆå™¨å´é»˜è®¤å¿½ç•¥ä½ å‘æŒ¥çš„é”™è¯¯é¡µé¢å¹¶æ˜¾ç¤ºå…¶è‡ªå®šä¹‰çš„é”™è¯¯æç¤ºé¡µé¢ï¼Œè™½ç„¶å¾®è½¯è¿™ä¹ˆåšè¿åäº† HTTP è§„èŒƒã€‚è¦å…³é—­æ­¤åŠŸèƒ½ï¼Œåœ¨å·¥å…·èœå•é‡Œï¼Œé€‰æ‹©Interneté€‰é¡¹ï¼Œè¿›å…¥é«˜çº§æ ‡ç­¾é¡µï¼Œå¹¶ç¡®è®¤â€œæ˜¾ç¤ºå‹å¥½çš„ HTTP é”™è¯¯ä¿¡æ¯â€é€‰é¡¹ï¼ˆåœ¨æˆ‘çš„æµè§ˆå™¨ä¸­æ˜¯å€’æ•°ç¬¬8å„é€‰é¡¹ï¼‰æ²¡æœ‰è¢«é€‰ã€‚ä½†æ˜¯å¾ˆå°‘æœ‰ç”¨æˆ·çŸ¥é“æ­¤é€‰é¡¹ï¼Œå› æ­¤è¿™ä¸ªç‰¹æ€§è¢«IE5éšè—äº†èµ·æ¥ä½¿ç”¨æˆ·æ— æ³•çœ‹åˆ°ä½ æ‰€è¿”å›ç»™ç”¨æˆ·çš„ä¿¡æ¯ã€‚è€Œå…¶ä»–ä¸»æµæµè§ˆå™¨åŠIE4éƒ½å®Œå…¨çš„æ˜¾ç¤ºæœåŠ¡å™¨ç”Ÿæˆçš„é”™è¯¯æç¤ºé¡µé¢ã€‚å¯ä»¥å‚è€ƒå›¾6-3åŠ6-4ä¸­çš„ä¾‹å­ã€‚\næ ¸å¿ƒè­¦å‘Š\né»˜è®¤æƒ…å†µä¸‹ï¼ŒIE5å¿½ç•¥æœåŠ¡ç«¯ç”Ÿæˆçš„é”™è¯¯æç¤ºé¡µé¢ã€‚\n405 (Method Not Allowed/æ–¹æ³•æœªå…è®¸)\n405 (SC_METHOD_NOT_ALLOWED)æŒ‡å‡ºè¯·æ±‚æ–¹æ³•(GET, POST, HEAD, PUT, DELETE, ç­‰)å¯¹æŸäº›ç‰¹å®šçš„èµ„æºä¸å…è®¸ä½¿ç”¨ã€‚è¯¥çŠ¶æ€ç æ˜¯æ–°åŠ å…¥ HTTP 1.1ä¸­çš„ã€‚\n406 (Not Acceptable/æ— æ³•è®¿é—®)\n406 (SC_NOT_ACCEPTABLE)è¡¨ç¤ºè¯·æ±‚èµ„æºçš„MIMEç±»å‹ä¸å®¢æˆ·ç«¯ä¸­Acceptå¤´ä¿¡æ¯ä¸­æŒ‡å®šçš„ç±»å‹ä¸ä¸€è‡´ã€‚è§æœ¬ä¹¦7.2éƒ¨åˆ†ä¸­çš„è¡¨7.1(HTTP 1.1 Response Headers and Their Meaning/HTTP 1.1å“åº”å¤´ä¿¡æ¯ä»¥åŠä»–ä»¬çš„æ„ä¹‰)ä¸­å¯¹MIMEç±»å‹çš„ä»‹ç»ã€‚406æ˜¯æ–°åŠ å…¥ HTTP 1.1ä¸­çš„ã€‚\n407 (Proxy Authentication Required/ä»£ç†æœåŠ¡å™¨è®¤è¯è¦æ±‚)\n407 (SC_PROXY_AUTHENTICATION_REQUIRED)ä¸401çŠ¶æ€æœ‰äº›ç›¸ä¼¼ï¼Œåªæ˜¯è¿™ä¸ªçŠ¶æ€ç”¨äºä»£ç†æœåŠ¡å™¨ã€‚è¯¥çŠ¶æ€æŒ‡å‡ºå®¢æˆ·ç«¯å¿…é¡»é€šè¿‡ä»£ç†æœåŠ¡å™¨çš„è®¤è¯ã€‚ä»£ç†æœåŠ¡å™¨è¿”å›ä¸€ä¸ªProxy-Authenticateå“åº”å¤´ä¿¡æ¯ç»™å®¢æˆ·ç«¯ï¼Œè¿™ä¼šå¼•èµ·å®¢æˆ·ç«¯ä½¿ç”¨å¸¦æœ‰Proxy-Authorizationè¯·æ±‚çš„å¤´ä¿¡æ¯é‡æ–°è¿æ¥ã€‚è¯¥çŠ¶æ€ç æ˜¯æ–°åŠ å…¥ HTTP 1.1ä¸­çš„ã€‚\n408 (Request Timeout/è¯·æ±‚è¶…æ—¶)\n408 (SC_REQUEST_TIMEOUT)æ˜¯æŒ‡æœåŠ¡ç«¯ç­‰å¾…å®¢æˆ·ç«¯å‘é€è¯·æ±‚çš„æ—¶é—´è¿‡é•¿ã€‚è¯¥çŠ¶æ€ç æ˜¯æ–°åŠ å…¥ HTTP 1.1ä¸­çš„ã€‚\n409 (Conflict/å†²çª)\nè¯¥çŠ¶æ€é€šå¸¸ä¸PUTè¯·æ±‚ä¸€åŒä½¿ç”¨ï¼Œ409 (SC_CONFLICT)çŠ¶æ€å¸¸è¢«ç”¨äºè¯•å›¾ä¸Šä¼ ç‰ˆæœ¬ä¸æ­£ç¡®çš„æ–‡ä»¶æ—¶ã€‚è¯¥çŠ¶æ€ç æ˜¯æ–°åŠ å…¥ HTTP 1.1ä¸­çš„ã€‚\n410 (Gone/å·²ç»ä¸å­˜åœ¨)\n410 (SC_GONE)å‘Šè¯‰å®¢æˆ·ç«¯æ‰€è¯·æ±‚çš„æ–‡æ¡£å·²ç»ä¸å­˜åœ¨å¹¶ä¸”æ²¡æœ‰æ›´æ–°çš„åœ°å€ã€‚410çŠ¶æ€ä¸åŒäº404ï¼Œ410æ˜¯åœ¨æŒ‡å¯¼æ–‡æ¡£å·²è¢«ç§»èµ°çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œè€Œ404åˆ™ç”¨äºæœªçŸ¥åŸå› çš„æ— æ³•è®¿é—®ã€‚è¯¥çŠ¶æ€ç æ˜¯æ–°åŠ å…¥ HTTP 1.1ä¸­çš„ã€‚\n411 (Length Required/éœ€è¦æ•°æ®é•¿åº¦)\n411 (SC_LENGTH_REQUIRED)è¡¨ç¤ºæœåŠ¡å™¨ä¸èƒ½å¤„ç†è¯·æ±‚ï¼ˆå‡è®¾ä¸ºå¸¦æœ‰é™„ä»¶çš„POSTè¯·æ±‚ï¼‰ï¼Œé™¤éå®¢æˆ·ç«¯å‘é€Content-Lengthå¤´ä¿¡æ¯æŒ‡å‡ºå‘é€ç»™æœåŠ¡å™¨çš„æ•°æ®çš„å¤§å°ã€‚è¯¥çŠ¶æ€æ˜¯æ–°åŠ å…¥ HTTP 1.1çš„ã€‚\n412 (Precondition Failed/å…ˆå†³æ¡ä»¶é”™è¯¯)\n412 (SC_PRECONDITION_FAILED)çŠ¶æ€æŒ‡å‡ºè¯·æ±‚å¤´ä¿¡æ¯ä¸­çš„æŸäº›å…ˆå†³æ¡ä»¶æ˜¯é”™è¯¯çš„ã€‚è¯¥çŠ¶æ€æ˜¯æ–°åŠ å…¥ HTTP 1.1çš„ã€‚\n413 (Request Entity Too Large/è¯·æ±‚å®ä½“è¿‡å¤§)\n413 (SC_REQUEST_ENTITY_TOO_LARGE)å‘Šè¯‰å®¢æˆ·ç«¯ç°åœ¨æ‰€è¯·æ±‚çš„æ–‡æ¡£æ¯”æœåŠ¡å™¨ç°åœ¨æƒ³è¦å¤„ç†çš„è¦å¤§ã€‚å¦‚æœæœåŠ¡å™¨è®¤ä¸ºèƒ½å¤Ÿè¿‡ä¸€æ®µæ—¶é—´å¤„ç†ï¼Œåˆ™ä¼šåŒ…å«ä¸€ä¸ªRetry-Afterçš„å“åº”å¤´ä¿¡æ¯ã€‚è¯¥çŠ¶æ€æ˜¯æ–°åŠ å…¥ HTTP 1.1çš„ã€‚\n414 (Request URI Too Long/è¯·æ±‚URIè¿‡é•¿)\n414 (SC_REQUEST_URI_TOO_LONG)çŠ¶æ€ç”¨äºåœ¨URIè¿‡é•¿çš„æƒ…å†µæ—¶ã€‚è¿™é‡Œæ‰€æŒ‡çš„â€œURIâ€æ˜¯æŒ‡URLä¸­ä¸»æœºã€åŸŸååŠç«¯å£å·ä¹‹åçš„å†…å®¹ã€‚ä¾‹å¦‚ï¼šåœ¨URL--http://www.y2k-disaster.com:8080/we/look/silly/now/ä¸­URIæ˜¯æŒ‡/we/look/silly/now/ã€‚è¯¥çŠ¶æ€æ˜¯æ–°åŠ å…¥ HTTP 1.1çš„ã€‚\n415 (Unsupported Media Type/ä¸æ”¯æŒçš„åª’ä½“æ ¼å¼)\n415 (SC_UNSUPPORTED_MEDIA_TYPE)æ„å‘³ç€è¯·æ±‚æ‰€å¸¦çš„é™„ä»¶çš„æ ¼å¼ç±»å‹æœåŠ¡å™¨ä¸çŸ¥é“å¦‚ä½•å¤„ç†ã€‚è¯¥çŠ¶æ€æ˜¯æ–°åŠ å…¥ HTTP 1.1çš„ã€‚\n416 (Requested Range Not Satisfiable/è¯·æ±‚èŒƒå›´æ— æ³•æ»¡è¶³)\n416è¡¨ç¤ºå®¢æˆ·ç«¯åŒ…å«äº†ä¸€ä¸ªæœåŠ¡å™¨æ— æ³•æ»¡è¶³çš„Rangeå¤´ä¿¡æ¯çš„è¯·æ±‚ã€‚è¯¥çŠ¶æ€æ˜¯æ–°åŠ å…¥ HTTP 1.1çš„ã€‚å¥‡æ€ªçš„æ˜¯ï¼Œåœ¨servlet 2.1ç‰ˆæœ¬APIçš„HttpServletResponseä¸­å¹¶æ²¡æœ‰ç›¸åº”çš„å¸¸é‡ä»£è¡¨è¯¥çŠ¶æ€ã€‚\næ³¨æ„\nåœ¨servlet 2.1çš„è§„èŒƒä¸­ï¼Œç±»HttpServletResponseå¹¶æ²¡æœ‰SC_REQUESTED_RANGE_NOT_SATISFIABLE è¿™æ ·çš„å¸¸é‡ï¼Œæ‰€ä»¥ä½ åªèƒ½ç›´æ¥ä½¿ç”¨416ã€‚åœ¨servlet 2.2ç‰ˆæœ¬ä¹‹åéƒ½åŒ…å«äº†æ­¤å¸¸é‡ã€‚\n417 (Expectation Failed/æœŸæœ›å¤±è´¥)\nå¦‚æœæœåŠ¡å™¨å¾—åˆ°ä¸€ä¸ªå¸¦æœ‰100-continueå€¼çš„Expectè¯·æ±‚å¤´ä¿¡æ¯ï¼Œè¿™æ˜¯æŒ‡å®¢æˆ·ç«¯æ­£åœ¨è¯¢é—®æ˜¯å¦å¯ä»¥åœ¨åé¢çš„è¯·æ±‚ä¸­å‘é€é™„ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¹Ÿä¼šç”¨è¯¥çŠ¶æ€(417)å‘Šè¯‰æµè§ˆå™¨æœåŠ¡å™¨ä¸æ¥æ”¶è¯¥é™„ä»¶æˆ–ç”¨100 (SC_CONTINUE)çŠ¶æ€å‘Šè¯‰å®¢æˆ·ç«¯å¯ä»¥ç»§ç»­å‘é€é™„ä»¶ã€‚è¯¥çŠ¶æ€æ˜¯æ–°åŠ å…¥ HTTP 1.1çš„ã€‚\n500 (Internal Server Error/å†…éƒ¨æœåŠ¡å™¨é”™è¯¯)\n500 (SC_INTERNAL_SERVER_ERROR) æ˜¯å¸¸ç”¨çš„â€œæœåŠ¡å™¨é”™è¯¯â€çŠ¶æ€ã€‚è¯¥çŠ¶æ€ç»å¸¸ç”±CGIç¨‹åºå¼•èµ·ä¹Ÿå¯èƒ½ï¼ˆä½†æ„¿ä¸ä¼šå¦‚æ­¤ï¼ï¼‰ç”±æ— æ³•æ­£å¸¸è¿è¡Œçš„æˆ–è¿”å›å¤´ä¿¡æ¯æ ¼å¼ä¸æ­£ç¡®çš„servletå¼•èµ·ã€‚\n501 (Not Implemented/æœªå®ç°)\n501 (SC_NOT_IMPLEMENTED)çŠ¶æ€å‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚ä¸­è¦æ±‚çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯æ‰§è¡Œäº†å¦‚PUTè¿™æ ·çš„æœåŠ¡å™¨å¹¶ä¸æ”¯æŒçš„å‘½ä»¤ã€‚\n502 (Bad Gateway/é”™è¯¯çš„ç½‘å…³)\n502 (SC_BAD_GATEWAY)è¢«ç”¨äºå……å½“ä»£ç†æˆ–ç½‘å…³çš„æœåŠ¡å™¨ï¼›è¯¥çŠ¶æ€æŒ‡å‡ºæ¥æ”¶æœåŠ¡å™¨æ¥æ”¶åˆ°è¿œç«¯æœåŠ¡å™¨çš„é”™è¯¯å“åº”ã€‚\n503 (Service Unavailable/æœåŠ¡æ— æ³•è·å¾—)\nçŠ¶æ€ç 503 (SC_SERVICE_UNAVAILABLE)è¡¨ç¤ºæœåŠ¡å™¨ç”±äºåœ¨ç»´æŠ¤æˆ–å·²ç»è¶…è½½è€Œæ— æ³•å“åº”ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸäº›çº¿ç¨‹æˆ–æ•°æ®åº“è¿æ¥æ± å·²ç»æ²¡æœ‰ç©ºé—²åˆ™servletä¼šè¿”å›è¿™ä¸ªå¤´ä¿¡æ¯ã€‚æœåŠ¡å™¨å¯æä¾›ä¸€ä¸ªRetry-Afterå¤´ä¿¡æ¯å‘Šè¯‰å®¢æˆ·ç«¯ä»€ä¹ˆæ—¶å€™å¯ä»¥åœ¨è¯•ä¸€æ¬¡ã€‚\n504 (Gateway Timeout/ç½‘å…³è¶…æ—¶)\nè¯¥çŠ¶æ€ä¹Ÿç”¨äºå……å½“ä»£ç†æˆ–ç½‘å…³çš„æœåŠ¡å™¨ï¼›å®ƒæŒ‡å‡ºæ¥æ”¶æœåŠ¡å™¨æ²¡æœ‰ä»è¿œç«¯æœåŠ¡å™¨å¾—åˆ°åŠæ—¶çš„å“åº”ã€‚è¯¥çŠ¶æ€æ˜¯æ–°åŠ å…¥ HTTP 1.1çš„ã€‚\n505 (HTTP Version Not Supported/ä¸æ”¯æŒçš„ HTTP ç‰ˆæœ¬)\n505 (SC_HTTP_VERSION_NOT_SUPPORTED)çŠ¶æ€ç æ˜¯è¯´æœåŠ¡å™¨å¹¶ä¸æ”¯æŒåœ¨è¯·æ±‚ä¸­æ‰€æ ‡æ˜ HTTP ç‰ˆæœ¬ã€‚è¯¥çŠ¶æ€æ˜¯æ–°åŠ å…¥ HTTP 1.1çš„ã€‚\n","description":"","tags":["http"],"title":"HTTP åè®®çŠ¶æ€ç åˆ†ç±»åŠè§£é‡Š","uri":"/blog/posts/classification-and-interpretation-of-http-protocol-status-codes/"},{"categories":null,"content":"å…¥é—¨ VSCode æ’ä»¶å¼€å‘ [toc]\næ ¸å¿ƒç»„ä»¶ Electron Monaco Editor Language Server Protocol Debug Adapter Protocol Electorn (formerly Atom Shell) åŸºäº Node.jsï¼ˆä½œä¸ºåç«¯ï¼‰å’Œ Chromiumï¼ˆä½œä¸ºå‰ç«¯)\nä½¿ç”¨ HTML, CSS å’Œ JavaScript å¼€å‘è·¨å¹³å°æ¡Œé¢GUIåº”ç”¨ç¨‹åº\nä½¿ç”¨è€…ï¼šAtom, Skype, GitHub Desktop, Slack, Microsoft Teams â€¦\nGithubä¼ é€é—¨\nMonaca Editor åŸºäºæµè§ˆå™¨çš„ä»£ç ç¼–è¾‘å™¨ï¼šIntelliSenseï¼Œä»£ç éªŒè¯ï¼Œè¯­æ³•é«˜äº®ï¼Œæ–‡ä»¶æ¯”è¾ƒ â€¦\næ”¯æŒä¸»æµæµè§ˆå™¨ï¼šIE 11, Edge, Chrome, Firefox, Safari å’Œ Opera\nä½¿ç”¨è€…ï¼šGitee Web IDE, Cloud Studio, Eclipse Che, Eclipse Theia, Azure DevOps (åŸä¸º Visual Studio Team Services), OneDrive, Edge Dev Tools\nGitHubä¼ é€é—¨\nLanguage Server Protocol (LSP) å®ƒæ˜¯ Editor/IDE ä¸è¯­è¨€æœåŠ¡å™¨ä¹‹é—´çš„ä¸€ç§åè®®ï¼Œå¯ä»¥è®©ä¸åŒçš„ Editor/IDE æ–¹ä¾¿åµŒå…¥å„ç§ç¨‹åºè¯­è¨€ï¼Œå…è®¸å¼€å‘äººå‘˜åœ¨æœ€å–œçˆ±çš„å·¥å…·ä¸­ä½¿ç”¨å„ç§è¯­è¨€æ¥æ’°å†™ç¨‹åºã€‚\næ”¯æŒ LSP çš„å¼€å‘å·¥å…·: Eclipse IDE, Eclipse Theia, Atom, Sublime Text, Emacs\nGitHubä¼ é€é—¨\nDebug Adapter Protocol (DAP) DAP ä¸ LSP çš„ç›®çš„ç±»ä¼¼ï¼ŒDAP æŠŠ Editor/IDE ä¸ ä¸åŒè¯­è¨€çš„ debugger è§£è€¦ï¼Œæå¤§åœ°æ–¹ä¾¿äº† Editor/IDE ä¸å…¶ä»– Debugger çš„é›†æˆã€‚\næ”¯æŒ DAP çš„å¼€å‘å·¥å…·: Eclipse IDE, Eclipse Theia, Emacs, Vim\nGitHubä¼ é€é—¨\næ’ä»¶å¼€å‘æµç¨‹ å¼€å‘ç¯å¢ƒ Visual Studio Code\nNode.js\nnpm -v æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ\nYeoman and VS Code Extension generator:\nnpm install -g yo generator-code\næ’ä»¶ç±»å‹ Themes\nSnippets\nFormatters\nLinters\nDebuggers\nProgramming Languages\nKeymaps\nSCM Provides\nExtensions Packs\nOthers\nå¦‚ä½•æ­å»ºå·¥ç¨‹ yo code é€‰æ‹©ä½ æ­å»ºé¡¹ç›®çš„ç±»å‹ æ˜¯å¦å¯¼å…¥ç›¸å…³èµ„æº é€‰æ‹©åå­— e.g. Color Thems e.g. Code Snippet VSCode ç•Œé¢åŠŸèƒ½æ‹“å±• Workbench Editor area Workbench Editor Area Codelens Decoration Gutter Hover Context Menu e.g. Translator Extension ","description":"","tags":["vscode"],"title":"VSCode æ’ä»¶å¼€å‘å…¥é—¨","uri":"/blog/posts/getting-started-with-vscode-plugin-development/"},{"categories":["Java"],"content":"ArrayListç®€ä»‹ ArrayList çš„åº•å±‚æ˜¯æ•°ç»„é˜Ÿåˆ—ï¼Œç›¸å½“äºåŠ¨æ€æ•°ç»„ã€‚ä¸ Java ä¸­çš„æ•°ç»„ç›¸æ¯”ï¼Œå®ƒçš„å®¹é‡èƒ½åŠ¨æ€å¢é•¿ã€‚åœ¨æ·»åŠ å¤§é‡å…ƒç´ å‰ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ ensureCapacity æ“ä½œæ¥å¢åŠ  ArrayList å®ä¾‹çš„å®¹é‡ã€‚è¿™å¯ä»¥å‡å°‘é€’å¢å¼å†åˆ†é…çš„æ•°é‡ã€‚ å®ƒç»§æ‰¿äº AbstractListï¼Œå®ç°äº† List, RandomAccess, Cloneable, java.io.Serializable è¿™äº›æ¥å£ã€‚ - ArrayList ç»§æ‰¿äº†AbstractListï¼Œå®ç°äº†Listã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„é˜Ÿåˆ—ï¼Œæä¾›äº†ç›¸å…³çš„æ·»åŠ ã€åˆ é™¤ã€ä¿®æ”¹ã€éå†ç­‰åŠŸèƒ½ã€‚ - ArrayList å®ç°äº†RandomAccess æ¥å£ã€‚ RandomAccess æ˜¯ä¸€ä¸ªæ ‡å¿—æ¥å£ï¼Œè¡¨æ˜å®ç°è¿™ä¸ªè¿™ä¸ªæ¥å£çš„ List é›†åˆæ˜¯æ”¯æŒå¿«é€Ÿéšæœºè®¿é—®çš„ã€‚åœ¨ ArrayList ä¸­ï¼Œæˆ‘ä»¬å³å¯ä»¥é€šè¿‡å…ƒç´ çš„åºå·å¿«é€Ÿè·å–å…ƒç´ å¯¹è±¡ï¼Œè¿™å°±æ˜¯å¿«é€Ÿéšæœºè®¿é—®ã€‚ - ArrayList å®ç°äº†Cloneable æ¥å£ã€‚å³è¦†ç›–äº†å‡½æ•° clone()ï¼Œèƒ½è¢«å…‹éš†ã€‚ - ArrayList å®ç°java.io.Serializable æ¥å£ã€‚è¿™æ„å‘³ç€ArrayListæ”¯æŒåºåˆ—åŒ–ï¼Œèƒ½é€šè¿‡åºåˆ—åŒ–å»ä¼ è¾“ã€‚\nå’Œ Vector ä¸åŒï¼Œ**ArrayList ä¸­çš„æ“ä½œä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼**æ‰€ä»¥ï¼Œå»ºè®®åœ¨å•çº¿ç¨‹ä¸­æ‰ä½¿ç”¨ ArrayListï¼Œè€Œåœ¨å¤šçº¿ç¨‹ä¸­å¯ä»¥é€‰æ‹© Vector æˆ–è€… CopyOnWriteArrayListã€‚ ArrayListæ ¸å¿ƒæºç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 package java.util; import java.util.function.Consumer; import java.util.function.Predicate; import java.util.function.UnaryOperator; public class ArrayList\u003cE\u003e extends AbstractList\u003cE\u003e implements List\u003cE\u003e, RandomAccess, Cloneable, java.io.Serializable { private static final long serialVersionUID = 8683452581122892189L; /** * é»˜è®¤åˆå§‹å®¹é‡å¤§å° */ private static final int DEFAULT_CAPACITY = 10; /** * ç©ºæ•°ç»„ï¼ˆç”¨äºç©ºå®ä¾‹ï¼‰ã€‚ */ private static final Object[] EMPTY_ELEMENTDATA = {}; //ç”¨äºé»˜è®¤å¤§å°ç©ºå®ä¾‹çš„å…±äº«ç©ºæ•°ç»„å®ä¾‹ã€‚ //æˆ‘ä»¬æŠŠå®ƒä»EMPTY_ELEMENTDATAæ•°ç»„ä¸­åŒºåˆ†å‡ºæ¥ï¼Œä»¥çŸ¥é“åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶å®¹é‡éœ€è¦å¢åŠ å¤šå°‘ã€‚ private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {}; /** * ä¿å­˜ArrayListæ•°æ®çš„æ•°ç»„ */ transient Object[] elementData; // non-private to simplify nested class access /** * ArrayList æ‰€åŒ…å«çš„å…ƒç´ ä¸ªæ•° */ private int size; /** * å¸¦åˆå§‹å®¹é‡å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ï¼ˆç”¨æˆ·è‡ªå·±æŒ‡å®šå®¹é‡ï¼‰ */ public ArrayList(int initialCapacity) { if (initialCapacity \u003e 0) { //åˆ›å»ºinitialCapacityå¤§å°çš„æ•°ç»„ this.elementData = new Object[initialCapacity]; } else if (initialCapacity == 0) { //åˆ›å»ºç©ºæ•°ç»„ this.elementData = EMPTY_ELEMENTDATA; } else { throw new IllegalArgumentException(\"Illegal Capacity: \"+ initialCapacity); } } /** *é»˜è®¤æ„é€ å‡½æ•°ï¼ŒDEFAULTCAPACITY_EMPTY_ELEMENTDATA ä¸º0.åˆå§‹åŒ–ä¸º10ï¼Œä¹Ÿå°±æ˜¯è¯´åˆå§‹å…¶å®æ˜¯ç©ºæ•°ç»„ å½“æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™æ•°ç»„å®¹é‡æ‰å˜æˆ10 */ public ArrayList() { this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA; } /** * æ„é€ ä¸€ä¸ªåŒ…å«æŒ‡å®šé›†åˆçš„å…ƒç´ çš„åˆ—è¡¨ï¼ŒæŒ‰ç…§å®ƒä»¬ç”±é›†åˆçš„è¿­ä»£å™¨è¿”å›çš„é¡ºåºã€‚ */ public ArrayList(Collection\u003c? extends E\u003e c) { // elementData = c.toArray(); //å¦‚æœæŒ‡å®šé›†åˆå…ƒç´ ä¸ªæ•°ä¸ä¸º0 if ((size = elementData.length) != 0) { // c.toArray å¯èƒ½è¿”å›çš„ä¸æ˜¯Objectç±»å‹çš„æ•°ç»„æ‰€ä»¥åŠ ä¸Šä¸‹é¢çš„è¯­å¥ç”¨äºåˆ¤æ–­ï¼Œ //è¿™é‡Œç”¨åˆ°äº†åå°„é‡Œé¢çš„getClass()æ–¹æ³• if (elementData.getClass() != Object[].class) elementData = Arrays.copyOf(elementData, size, Object[].class); } else { // ç”¨ç©ºæ•°ç»„ä»£æ›¿ this.elementData = EMPTY_ELEMENTDATA; } } /** * ä¿®æ”¹è¿™ä¸ªArrayListå®ä¾‹çš„å®¹é‡æ˜¯åˆ—è¡¨çš„å½“å‰å¤§å°ã€‚ åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨æ­¤æ“ä½œæ¥æœ€å°åŒ–ArrayListå®ä¾‹çš„å­˜å‚¨ã€‚ */ public void trimToSize() { modCount++; if (size \u003c elementData.length) { elementData = (size == 0) ? EMPTY_ELEMENTDATA : Arrays.copyOf(elementData, size); } } //ä¸‹é¢æ˜¯ArrayListçš„æ‰©å®¹æœºåˆ¶ //ArrayListçš„æ‰©å®¹æœºåˆ¶æé«˜äº†æ€§èƒ½ï¼Œå¦‚æœæ¯æ¬¡åªæ‰©å……ä¸€ä¸ªï¼Œ //é‚£ä¹ˆé¢‘ç¹çš„æ’å…¥ä¼šå¯¼è‡´é¢‘ç¹çš„æ‹·è´ï¼Œé™ä½æ€§èƒ½ï¼Œè€ŒArrayListçš„æ‰©å®¹æœºåˆ¶é¿å…äº†è¿™ç§æƒ…å†µã€‚ /** * å¦‚æœ‰å¿…è¦ï¼Œå¢åŠ æ­¤ArrayListå®ä¾‹çš„å®¹é‡ï¼Œä»¥ç¡®ä¿å®ƒè‡³å°‘èƒ½å®¹çº³å…ƒç´ çš„æ•°é‡ * @param minCapacity æ‰€éœ€çš„æœ€å°å®¹é‡ */ public void ensureCapacity(int minCapacity) { int minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA) // any size if not default element table ? 0 // larger than default for default empty table. It's already // supposed to be at default size. : DEFAULT_CAPACITY; if (minCapacity \u003e minExpand) { ensureExplicitCapacity(minCapacity); } } //å¾—åˆ°æœ€å°æ‰©å®¹é‡ private void ensureCapacityInternal(int minCapacity) { if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) { // è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼ minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity); } ensureExplicitCapacity(minCapacity); } //åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ private void ensureExplicitCapacity(int minCapacity) { modCount++; // overflow-conscious code if (minCapacity - elementData.length \u003e 0) //è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº† grow(minCapacity); } /** * è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å° */ private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8; /** * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚ */ private void grow(int minCapacity) { // oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡ int oldCapacity = elementData.length; //å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ //æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ int newCapacity = oldCapacity + (oldCapacity \u003e\u003e 1); //ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ if (newCapacity - minCapacity \u003c 0) newCapacity = minCapacity; //å†æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦è¶…å‡ºäº†ArrayListæ‰€å®šä¹‰çš„æœ€å¤§å®¹é‡ï¼Œ //è‹¥è¶…å‡ºäº†ï¼Œåˆ™è°ƒç”¨hugeCapacity()æ¥æ¯”è¾ƒminCapacityå’Œ MAX_ARRAY_SIZEï¼Œ //å¦‚æœminCapacityå¤§äºMAX_ARRAY_SIZEï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸ºInterger.MAX_VALUEï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZEã€‚ if (newCapacity - MAX_ARRAY_SIZE \u003e 0) newCapacity = hugeCapacity(minCapacity); // minCapacity is usually close to size, so this is a win: elementData = Arrays.copyOf(elementData, newCapacity); } //æ¯”è¾ƒminCapacityå’Œ MAX_ARRAY_SIZE private static int hugeCapacity(int minCapacity) { if (minCapacity \u003c 0) // overflow throw new OutOfMemoryError(); return (minCapacity \u003e MAX_ARRAY_SIZE) ? Integer.MAX_VALUE : MAX_ARRAY_SIZE; } /** *è¿”å›æ­¤åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°ã€‚ */ public int size() { return size; } /** * å¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«å…ƒç´ ï¼Œåˆ™è¿”å› true ã€‚ */ public boolean isEmpty() { //æ³¨æ„=å’Œ==çš„åŒºåˆ« return size == 0; } /** * å¦‚æœæ­¤åˆ—è¡¨åŒ…å«æŒ‡å®šçš„å…ƒç´ ï¼Œåˆ™è¿”å›true ã€‚ */ public boolean contains(Object o) { //indexOf()æ–¹æ³•ï¼šè¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ çš„é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«æ­¤å…ƒç´ ï¼Œåˆ™ä¸º-1 return indexOf(o) \u003e= 0; } /** *è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ çš„é¦–æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«æ­¤å…ƒç´ ï¼Œåˆ™ä¸º-1 */ public int indexOf(Object o) { if (o == null) { for (int i = 0; i \u003c size; i++) if (elementData[i]==null) return i; } else { for (int i = 0; i \u003c size; i++) //equals()æ–¹æ³•æ¯”è¾ƒ if (o.equals(elementData[i])) return i; } return -1; } /** * è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ çš„æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«å…ƒç´ ï¼Œåˆ™è¿”å›-1ã€‚. */ public int lastIndexOf(Object o) { if (o == null) { for (int i = size-1; i \u003e= 0; i--) if (elementData[i]==null) return i; } else { for (int i = size-1; i \u003e= 0; i--) if (o.equals(elementData[i])) return i; } return -1; } /** * è¿”å›æ­¤ArrayListå®ä¾‹çš„æµ…æ‹·è´ã€‚ ï¼ˆå…ƒç´ æœ¬èº«ä¸è¢«å¤åˆ¶ã€‚ï¼‰ */ public Object clone() { try { ArrayList\u003c?\u003e v = (ArrayList\u003c?\u003e) super.clone(); //Arrays.copyOfåŠŸèƒ½æ˜¯å®ç°æ•°ç»„çš„å¤åˆ¶ï¼Œè¿”å›å¤åˆ¶åçš„æ•°ç»„ã€‚å‚æ•°æ˜¯è¢«å¤åˆ¶çš„æ•°ç»„å’Œå¤åˆ¶çš„é•¿åº¦ v.elementData = Arrays.copyOf(elementData, size); v.modCount = 0; return v; } catch (CloneNotSupportedException e) { // è¿™ä¸åº”è¯¥å‘ç”Ÿï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯å¯ä»¥å…‹éš†çš„ throw new InternalError(e); } } /** *ä»¥æ­£ç¡®çš„é¡ºåºï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰è¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ã€‚ *è¿”å›çš„æ•°ç»„å°†æ˜¯â€œå®‰å…¨çš„â€ï¼Œå› ä¸ºè¯¥åˆ—è¡¨ä¸ä¿ç•™å¯¹å®ƒçš„å¼•ç”¨ã€‚ ï¼ˆæ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å¿…é¡»åˆ†é…ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼‰ã€‚ *å› æ­¤ï¼Œè°ƒç”¨è€…å¯ä»¥è‡ªç”±åœ°ä¿®æ”¹è¿”å›çš„æ•°ç»„ã€‚ æ­¤æ–¹æ³•å……å½“åŸºäºé˜µåˆ—å’ŒåŸºäºé›†åˆçš„APIä¹‹é—´çš„æ¡¥æ¢ã€‚ */ public Object[] toArray() { return Arrays.copyOf(elementData, size); } /** * ä»¥æ­£ç¡®çš„é¡ºåºè¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰; *è¿”å›çš„æ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹æ˜¯æŒ‡å®šæ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹ã€‚ å¦‚æœåˆ—è¡¨é€‚åˆæŒ‡å®šçš„æ•°ç»„ï¼Œåˆ™è¿”å›å…¶ä¸­ã€‚ *å¦åˆ™ï¼Œå°†ä¸ºæŒ‡å®šæ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹å’Œæ­¤åˆ—è¡¨çš„å¤§å°åˆ†é…ä¸€ä¸ªæ–°æ•°ç»„ã€‚ *å¦‚æœåˆ—è¡¨é€‚ç”¨äºæŒ‡å®šçš„æ•°ç»„ï¼Œå…¶ä½™ç©ºé—´ï¼ˆå³æ•°ç»„çš„åˆ—è¡¨æ•°é‡å¤šäºæ­¤å…ƒç´ ï¼‰ï¼Œåˆ™ç´§è·Ÿåœ¨é›†åˆç»“æŸåçš„æ•°ç»„ä¸­çš„å…ƒç´ è®¾ç½®ä¸ºnull ã€‚ *ï¼ˆè¿™ä»…åœ¨è°ƒç”¨è€…çŸ¥é“åˆ—è¡¨ä¸åŒ…å«ä»»ä½•ç©ºå…ƒç´ çš„æƒ…å†µä¸‹æ‰èƒ½ç¡®å®šåˆ—è¡¨çš„é•¿åº¦ã€‚ï¼‰ */ @SuppressWarnings(\"unchecked\") public \u003cT\u003e T[] toArray(T[] a) { if (a.length \u003c size) // æ–°å»ºä¸€ä¸ªè¿è¡Œæ—¶ç±»å‹çš„æ•°ç»„ï¼Œä½†æ˜¯ArrayListæ•°ç»„çš„å†…å®¹ return (T[]) Arrays.copyOf(elementData, size, a.getClass()); //è°ƒç”¨Systemæä¾›çš„arraycopy()æ–¹æ³•å®ç°æ•°ç»„ä¹‹é—´çš„å¤åˆ¶ System.arraycopy(elementData, 0, a, 0, size); if (a.length \u003e size) a[size] = null; return a; } // Positional Access Operations @SuppressWarnings(\"unchecked\") E elementData(int index) { return (E) elementData[index]; } /** * è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚ */ public E get(int index) { rangeCheck(index); return elementData(index); } /** * ç”¨æŒ‡å®šçš„å…ƒç´ æ›¿æ¢æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚ */ public E set(int index, E element) { //å¯¹indexè¿›è¡Œç•Œé™æ£€æŸ¥ rangeCheck(index); E oldValue = elementData(index); elementData[index] = element; //è¿”å›åŸæ¥åœ¨è¿™ä¸ªä½ç½®çš„å…ƒç´  return oldValue; } /** * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚ */ public boolean add(E e) { ensureCapacityInternal(size + 1); // Increments modCount!! //è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼ elementData[size++] = e; return true; } /** * åœ¨æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚ *å…ˆè°ƒç”¨ rangeCheckForAdd å¯¹indexè¿›è¡Œç•Œé™æ£€æŸ¥ï¼›ç„¶åè°ƒç”¨ ensureCapacityInternal æ–¹æ³•ä¿è¯capacityè¶³å¤Ÿå¤§ï¼› *å†å°†ä»indexå¼€å§‹ä¹‹åçš„æ‰€æœ‰æˆå‘˜åç§»ä¸€ä¸ªä½ç½®ï¼›å°†elementæ’å…¥indexä½ç½®ï¼›æœ€åsizeåŠ 1ã€‚ */ public void add(int index, E element) { rangeCheckForAdd(index); ensureCapacityInternal(size + 1); // Increments modCount!! //arraycopy()è¿™ä¸ªå®ç°æ•°ç»„ä¹‹é—´å¤åˆ¶çš„æ–¹æ³•ä¸€å®šè¦çœ‹ä¸€ä¸‹ï¼Œä¸‹é¢å°±ç”¨åˆ°äº†arraycopy()æ–¹æ³•å®ç°æ•°ç»„è‡ªå·±å¤åˆ¶è‡ªå·± System.arraycopy(elementData, index, elementData, index + 1, size - index); elementData[index] = element; size++; } /** * åˆ é™¤è¯¥åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚ å°†ä»»ä½•åç»­å…ƒç´ ç§»åŠ¨åˆ°å·¦ä¾§ï¼ˆä»å…¶ç´¢å¼•ä¸­å‡å»ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚ */ public E remove(int index) { rangeCheck(index); modCount++; E oldValue = elementData(index); int numMoved = size - index - 1; if (numMoved \u003e 0) System.arraycopy(elementData, index+1, elementData, index, numMoved); elementData[--size] = null; // clear to let GC do its work //ä»åˆ—è¡¨ä¸­åˆ é™¤çš„å…ƒç´  return oldValue; } /** * ä»åˆ—è¡¨ä¸­åˆ é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªå‡ºç°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚ å¦‚æœåˆ—è¡¨ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™å®ƒä¸ä¼šæ›´æ”¹ã€‚ *è¿”å›trueï¼Œå¦‚æœæ­¤åˆ—è¡¨åŒ…å«æŒ‡å®šçš„å…ƒç´  */ public boolean remove(Object o) { if (o == null) { for (int index = 0; index \u003c size; index++) if (elementData[index] == null) { fastRemove(index); return true; } } else { for (int index = 0; index \u003c size; index++) if (o.equals(elementData[index])) { fastRemove(index); return true; } } return false; } /* * Private remove method that skips bounds checking and does not * return the value removed. */ private void fastRemove(int index) { modCount++; int numMoved = size - index - 1; if (numMoved \u003e 0) System.arraycopy(elementData, index+1, elementData, index, numMoved); elementData[--size] = null; // clear to let GC do its work } /** * ä»åˆ—è¡¨ä¸­åˆ é™¤æ‰€æœ‰å…ƒç´ ã€‚ */ public void clear() { modCount++; // æŠŠæ•°ç»„ä¸­æ‰€æœ‰çš„å…ƒç´ çš„å€¼è®¾ä¸ºnull for (int i = 0; i \u003c size; i++) elementData[i] = null; size = 0; } /** * æŒ‰æŒ‡å®šé›†åˆçš„Iteratorè¿”å›çš„é¡ºåºå°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚ */ public boolean addAll(Collection\u003c? extends E\u003e c) { Object[] a = c.toArray(); int numNew = a.length; ensureCapacityInternal(size + numNew); // Increments modCount System.arraycopy(a, 0, elementData, size, numNew); size += numNew; return numNew != 0; } /** * å°†æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ æ’å…¥åˆ°æ­¤åˆ—è¡¨ä¸­ï¼Œä»æŒ‡å®šçš„ä½ç½®å¼€å§‹ã€‚ */ public boolean addAll(int index, Collection\u003c? extends E\u003e c) { rangeCheckForAdd(index); Object[] a = c.toArray(); int numNew = a.length; ensureCapacityInternal(size + numNew); // Increments modCount int numMoved = size - index; if (numMoved \u003e 0) System.arraycopy(elementData, index, elementData, index + numNew, numMoved); System.arraycopy(a, 0, elementData, index, numNew); size += numNew; return numNew != 0; } /** * ä»æ­¤åˆ—è¡¨ä¸­åˆ é™¤æ‰€æœ‰ç´¢å¼•ä¸ºfromIndex ï¼ˆå«ï¼‰å’ŒtoIndexä¹‹é—´çš„å…ƒç´ ã€‚ *å°†ä»»ä½•åç»­å…ƒç´ ç§»åŠ¨åˆ°å·¦ä¾§ï¼ˆå‡å°‘å…¶ç´¢å¼•ï¼‰ã€‚ */ protected void removeRange(int fromIndex, int toIndex) { modCount++; int numMoved = size - toIndex; System.arraycopy(elementData, toIndex, elementData, fromIndex, numMoved); // clear to let GC do its work int newSize = size - (toIndex-fromIndex); for (int i = newSize; i \u003c size; i++) { elementData[i] = null; } size = newSize; } /** * æ£€æŸ¥ç»™å®šçš„ç´¢å¼•æ˜¯å¦åœ¨èŒƒå›´å†…ã€‚ */ private void rangeCheck(int index) { if (index \u003e= size) throw new IndexOutOfBoundsException(outOfBoundsMsg(index)); } /** * addå’ŒaddAllä½¿ç”¨çš„rangeCheckçš„ä¸€ä¸ªç‰ˆæœ¬ */ private void rangeCheckForAdd(int index) { if (index \u003e size || index \u003c 0) throw new IndexOutOfBoundsException(outOfBoundsMsg(index)); } /** * è¿”å›IndexOutOfBoundsExceptionç»†èŠ‚ä¿¡æ¯ */ private String outOfBoundsMsg(int index) { return \"Index: \"+index+\", Size: \"+size; } /** * ä»æ­¤åˆ—è¡¨ä¸­åˆ é™¤æŒ‡å®šé›†åˆä¸­åŒ…å«çš„æ‰€æœ‰å…ƒç´ ã€‚ */ public boolean removeAll(Collection\u003c?\u003e c) { Objects.requireNonNull(c); //å¦‚æœæ­¤åˆ—è¡¨è¢«ä¿®æ”¹åˆ™è¿”å›true return batchRemove(c, false); } /** * ä»…ä¿ç•™æ­¤åˆ—è¡¨ä¸­åŒ…å«åœ¨æŒ‡å®šé›†åˆä¸­çš„å…ƒç´ ã€‚ *æ¢å¥è¯è¯´ï¼Œä»æ­¤åˆ—è¡¨ä¸­åˆ é™¤å…¶ä¸­ä¸åŒ…å«åœ¨æŒ‡å®šé›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚ */ public boolean retainAll(Collection\u003c?\u003e c) { Objects.requireNonNull(c); return batchRemove(c, true); } /** * ä»åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®å¼€å§‹ï¼Œè¿”å›åˆ—è¡¨ä¸­çš„å…ƒç´ ï¼ˆæŒ‰æ­£ç¡®é¡ºåºï¼‰çš„åˆ—è¡¨è¿­ä»£å™¨ã€‚ *æŒ‡å®šçš„ç´¢å¼•è¡¨ç¤ºåˆå§‹è°ƒç”¨å°†è¿”å›çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºnext ã€‚ åˆå§‹è°ƒç”¨previouså°†è¿”å›æŒ‡å®šç´¢å¼•å‡1çš„å…ƒç´ ã€‚ *è¿”å›çš„åˆ—è¡¨è¿­ä»£å™¨æ˜¯fail-fast ã€‚ */ public ListIterator\u003cE\u003e listIterator(int index) { if (index \u003c 0 || index \u003e size) throw new IndexOutOfBoundsException(\"Index: \"+index); return new ListItr(index); } /** *è¿”å›åˆ—è¡¨ä¸­çš„åˆ—è¡¨è¿­ä»£å™¨ï¼ˆæŒ‰é€‚å½“çš„é¡ºåºï¼‰ã€‚ *è¿”å›çš„åˆ—è¡¨è¿­ä»£å™¨æ˜¯fail-fast ã€‚ */ public ListIterator\u003cE\u003e listIterator() { return new ListItr(0); } /** *ä»¥æ­£ç¡®çš„é¡ºåºè¿”å›è¯¥åˆ—è¡¨ä¸­çš„å…ƒç´ çš„è¿­ä»£å™¨ã€‚ *è¿”å›çš„è¿­ä»£å™¨æ˜¯fail-fast ã€‚ */ public Iterator\u003cE\u003e iterator() { return new Itr(); } ArrayListæºç åˆ†æ System.arraycopy()å’ŒArrays.copyOf()æ–¹æ³• é€šè¿‡ä¸Šé¢æºç æˆ‘ä»¬å‘ç°è¿™ä¸¤ä¸ªå®ç°æ•°ç»„å¤åˆ¶çš„æ–¹æ³•è¢«å¹¿æ³›ä½¿ç”¨è€Œä¸”å¾ˆå¤šåœ°æ–¹éƒ½ç‰¹åˆ«å·§å¦™ã€‚æ¯”å¦‚ä¸‹é¢add(int index, E element)æ–¹æ³•å°±å¾ˆå·§å¦™çš„ç”¨åˆ°äº†arraycopy()æ–¹æ³•è®©æ•°ç»„è‡ªå·±å¤åˆ¶è‡ªå·±å®ç°è®©indexå¼€å§‹ä¹‹åçš„æ‰€æœ‰æˆå‘˜åç§»ä¸€ä¸ªä½ç½®:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 /** * åœ¨æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚ *å…ˆè°ƒç”¨ rangeCheckForAdd å¯¹indexè¿›è¡Œç•Œé™æ£€æŸ¥ï¼›ç„¶åè°ƒç”¨ ensureCapacityInternal æ–¹æ³•ä¿è¯capacityè¶³å¤Ÿå¤§ï¼› *å†å°†ä»indexå¼€å§‹ä¹‹åçš„æ‰€æœ‰æˆå‘˜åç§»ä¸€ä¸ªä½ç½®ï¼›å°†elementæ’å…¥indexä½ç½®ï¼›æœ€åsizeåŠ 1ã€‚ */ public void add(int index, E element) { rangeCheckForAdd(index); ensureCapacityInternal(size + 1); // Increments modCount!! //arraycopy()æ–¹æ³•å®ç°æ•°ç»„è‡ªå·±å¤åˆ¶è‡ªå·± //elementData:æºæ•°ç»„;index:æºæ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®;elementDataï¼šç›®æ ‡æ•°ç»„ï¼›index + 1ï¼šç›®æ ‡æ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®ï¼› size - indexï¼šè¦å¤åˆ¶çš„æ•°ç»„å…ƒç´ çš„æ•°é‡ï¼› System.arraycopy(elementData, index, elementData, index + 1, size - index); elementData[index] = element; size++; } åˆå¦‚toArray()æ–¹æ³•ä¸­ç”¨åˆ°äº†copyOf()æ–¹æ³•\n1 2 3 4 5 6 7 8 9 10 /** *ä»¥æ­£ç¡®çš„é¡ºåºï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰è¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ã€‚ *è¿”å›çš„æ•°ç»„å°†æ˜¯â€œå®‰å…¨çš„â€ï¼Œå› ä¸ºè¯¥åˆ—è¡¨ä¸ä¿ç•™å¯¹å®ƒçš„å¼•ç”¨ã€‚ ï¼ˆæ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å¿…é¡»åˆ†é…ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼‰ã€‚ *å› æ­¤ï¼Œè°ƒç”¨è€…å¯ä»¥è‡ªç”±åœ°ä¿®æ”¹è¿”å›çš„æ•°ç»„ã€‚ æ­¤æ–¹æ³•å……å½“åŸºäºé˜µåˆ—å’ŒåŸºäºé›†åˆçš„APIä¹‹é—´çš„æ¡¥æ¢ã€‚ */ public Object[] toArray() { //elementDataï¼šè¦å¤åˆ¶çš„æ•°ç»„ï¼›sizeï¼šè¦å¤åˆ¶çš„é•¿åº¦ return Arrays.copyOf(elementData, size); } ä¸¤è€…è”ç³»ä¸åŒºåˆ« è”ç³»ï¼š çœ‹ä¸¤è€…æºä»£ç å¯ä»¥å‘ç°copyOf()å†…éƒ¨è°ƒç”¨äº†System.arraycopy()æ–¹æ³• åŒºåˆ«ï¼š\narraycopy()éœ€è¦ç›®æ ‡æ•°ç»„ï¼Œå°†åŸæ•°ç»„æ‹·è´åˆ°ä½ è‡ªå·±å®šä¹‰çš„æ•°ç»„é‡Œï¼Œè€Œä¸”å¯ä»¥é€‰æ‹©æ‹·è´çš„èµ·ç‚¹å’Œé•¿åº¦ä»¥åŠæ”¾å…¥æ–°æ•°ç»„ä¸­çš„ä½ç½® copyOf()æ˜¯ç³»ç»Ÿè‡ªåŠ¨åœ¨å†…éƒ¨æ–°å»ºä¸€ä¸ªæ•°ç»„ï¼Œå¹¶è¿”å›è¯¥æ•°ç»„ã€‚ ArrayList æ ¸å¿ƒæ‰©å®¹æŠ€æœ¯ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 //ä¸‹é¢æ˜¯ArrayListçš„æ‰©å®¹æœºåˆ¶ //ArrayListçš„æ‰©å®¹æœºåˆ¶æé«˜äº†æ€§èƒ½ï¼Œå¦‚æœæ¯æ¬¡åªæ‰©å……ä¸€ä¸ªï¼Œ //é‚£ä¹ˆé¢‘ç¹çš„æ’å…¥ä¼šå¯¼è‡´é¢‘ç¹çš„æ‹·è´ï¼Œé™ä½æ€§èƒ½ï¼Œè€ŒArrayListçš„æ‰©å®¹æœºåˆ¶é¿å…äº†è¿™ç§æƒ…å†µã€‚ /** * å¦‚æœ‰å¿…è¦ï¼Œå¢åŠ æ­¤ArrayListå®ä¾‹çš„å®¹é‡ï¼Œä»¥ç¡®ä¿å®ƒè‡³å°‘èƒ½å®¹çº³å…ƒç´ çš„æ•°é‡ * @param minCapacity æ‰€éœ€çš„æœ€å°å®¹é‡ */ public void ensureCapacity(int minCapacity) { int minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA) // any size if not default element table ? 0 // larger than default for default empty table. It's already // supposed to be at default size. : DEFAULT_CAPACITY; if (minCapacity \u003e minExpand) { ensureExplicitCapacity(minCapacity); } } //å¾—åˆ°æœ€å°æ‰©å®¹é‡ private void ensureCapacityInternal(int minCapacity) { if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) { // è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼ minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity); } ensureExplicitCapacity(minCapacity); } //åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹,ä¸Šé¢ä¸¤ä¸ªæ–¹æ³•éƒ½è¦è°ƒç”¨ private void ensureExplicitCapacity(int minCapacity) { modCount++; // å¦‚æœè¯´minCapacityä¹Ÿå°±æ˜¯æ‰€éœ€çš„æœ€å°å®¹é‡å¤§äºä¿å­˜ArrayListæ•°æ®çš„æ•°ç»„çš„é•¿åº¦çš„è¯ï¼Œå°±éœ€è¦è°ƒç”¨grow(minCapacity)æ–¹æ³•æ‰©å®¹ã€‚ //è¿™ä¸ªminCapacityåˆ°åº•ä¸ºå¤šå°‘å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­åœ¨æ·»åŠ å…ƒç´ (add)æ–¹æ³•ä¸­è¿™ä¸ªminCapacityçš„å¤§å°å°±ä¸ºç°åœ¨æ•°ç»„çš„é•¿åº¦åŠ 1 if (minCapacity - elementData.length \u003e 0) //è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº† grow(minCapacity); } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 /** * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚ */ private void grow(int minCapacity) { //elementDataä¸ºä¿å­˜ArrayListæ•°æ®çš„æ•°ç»„ ///elementData.lengthæ±‚æ•°ç»„é•¿åº¦elementData.sizeæ˜¯æ±‚æ•°ç»„ä¸­çš„å…ƒç´ ä¸ªæ•° // oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡ int oldCapacity = elementData.length; //å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ //æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ int newCapacity = oldCapacity + (oldCapacity \u003e\u003e 1); //ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ if (newCapacity - minCapacity \u003c 0) newCapacity = minCapacity; //å†æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦è¶…å‡ºäº†ArrayListæ‰€å®šä¹‰çš„æœ€å¤§å®¹é‡ï¼Œ //è‹¥è¶…å‡ºäº†ï¼Œåˆ™è°ƒç”¨hugeCapacity()æ¥æ¯”è¾ƒminCapacityå’Œ MAX_ARRAY_SIZEï¼Œ //å¦‚æœminCapacityå¤§äºMAX_ARRAY_SIZEï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸ºInterger.MAX_VALUEï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZEã€‚ if (newCapacity - MAX_ARRAY_SIZE \u003e 0) newCapacity = hugeCapacity(minCapacity); // minCapacity is usually close to size, so this is a win: elementData = Arrays.copyOf(elementData, newCapacity); } æ‰©å®¹æœºåˆ¶ä»£ç å·²ç»åšäº†è¯¦ç»†çš„è§£é‡Šã€‚å¦å¤–å€¼å¾—æ³¨æ„çš„æ˜¯å¤§å®¶å¾ˆå®¹æ˜“å¿½ç•¥çš„ä¸€ä¸ªè¿ç®—ç¬¦ï¼šç§»ä½è¿ç®—ç¬¦ ç®€ä»‹ï¼šç§»ä½è¿ç®—ç¬¦å°±æ˜¯åœ¨äºŒè¿›åˆ¶çš„åŸºç¡€ä¸Šå¯¹æ•°å­—è¿›è¡Œå¹³ç§»ã€‚æŒ‰ç…§å¹³ç§»çš„æ–¹å‘å’Œå¡«å……æ•°å­—çš„è§„åˆ™åˆ†ä¸ºä¸‰ç§:\u003c\u003c(å·¦ç§»)ã€\u003e\u003e(å¸¦ç¬¦å·å³ç§»)å’Œ\u003e\u003e\u003e(æ— ç¬¦å·å³ç§»)ã€‚ ä½œç”¨ï¼šå¯¹äºå¤§æ•°æ®çš„2è¿›åˆ¶è¿ç®—,ä½ç§»è¿ç®—ç¬¦æ¯”é‚£äº›æ™®é€šè¿ç®—ç¬¦çš„è¿ç®—è¦å¿«å¾ˆå¤š,å› ä¸ºç¨‹åºä»…ä»…ç§»åŠ¨ä¸€ä¸‹è€Œå·²,ä¸å»è®¡ç®—,è¿™æ ·æé«˜äº†æ•ˆç‡,èŠ‚çœäº†èµ„æº æ¯”å¦‚è¿™é‡Œï¼šint newCapacity = oldCapacity + (oldCapacity \u003e\u003e 1); å³ç§»ä¸€ä½ç›¸å½“äºé™¤2ï¼Œå³ç§»nä½ç›¸å½“äºé™¤ä»¥ 2 çš„ n æ¬¡æ–¹ã€‚è¿™é‡Œ oldCapacity æ˜æ˜¾å³ç§»äº†1ä½æ‰€ä»¥ç›¸å½“äºoldCapacity /2ã€‚\nå¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼š\njava ä¸­çš„length å±æ€§æ˜¯é’ˆå¯¹æ•°ç»„è¯´çš„,æ¯”å¦‚è¯´ä½ å£°æ˜äº†ä¸€ä¸ªæ•°ç»„,æƒ³çŸ¥é“è¿™ä¸ªæ•°ç»„çš„é•¿åº¦åˆ™ç”¨åˆ°äº† length è¿™ä¸ªå±æ€§.\njava ä¸­çš„length()æ–¹æ³•æ˜¯é’ˆå¯¹å­—ç¬¦ä¸²Stringè¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦åˆ™ç”¨åˆ° length()è¿™ä¸ªæ–¹æ³•.\n.java ä¸­çš„size()æ–¹æ³•æ˜¯é’ˆå¯¹æ³›å‹é›†åˆè¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªæ³›å‹æœ‰å¤šå°‘ä¸ªå…ƒç´ ,å°±è°ƒç”¨æ­¤æ–¹æ³•æ¥æŸ¥çœ‹!\nå†…éƒ¨ç±» 1 2 3 4 (1)private class Itr implements Iterator\u003cE\u003e (2)private class ListItr extends Itr implements ListIterator\u003cE\u003e (3)private class SubList extends AbstractList\u003cE\u003e implements RandomAccess (4)static final class ArrayListSpliterator\u003cE\u003e implements Spliterator\u003cE\u003e ArrayListæœ‰å››ä¸ªå†…éƒ¨ç±»ï¼Œå…¶ä¸­çš„Itræ˜¯å®ç°äº†Iteratoræ¥å£ï¼ŒåŒæ—¶é‡å†™äº†é‡Œé¢çš„hasNext()ï¼Œnext()ï¼Œremove()ç­‰æ–¹æ³•ï¼›å…¶ä¸­çš„ListItrç»§æ‰¿Itrï¼Œå®ç°äº†ListIteratoræ¥å£ï¼ŒåŒæ—¶é‡å†™äº†hasPrevious()ï¼ŒnextIndex()ï¼ŒpreviousIndex()ï¼Œprevious()ï¼Œset(E e)ï¼Œ**add(E e)**ç­‰æ–¹æ³•ï¼Œæ‰€ä»¥è¿™ä¹Ÿå¯ä»¥çœ‹å‡ºäº† **Iteratorå’ŒListIteratorçš„åŒºåˆ«:**ListIteratoråœ¨Iteratorçš„åŸºç¡€ä¸Šå¢åŠ äº†æ·»åŠ å¯¹è±¡ï¼Œä¿®æ”¹å¯¹è±¡ï¼Œé€†å‘éå†ç­‰æ–¹æ³•ï¼Œè¿™äº›æ˜¯Iteratorä¸èƒ½å®ç°çš„ã€‚\nArrayListç»å…¸Demo 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 package list; import java.util.ArrayList; import java.util.Iterator; public class ArrayListDemo { public static void main(String[] srgs){ ArrayList\u003cInteger\u003e arrayList = new ArrayList\u003cInteger\u003e(); System.out.printf(\"Before add:arrayList.size() = %d\\n\",arrayList.size()); arrayList.add(1); arrayList.add(3); arrayList.add(5); arrayList.add(7); arrayList.add(9); System.out.printf(\"After add:arrayList.size() = %d\\n\",arrayList.size()); System.out.println(\"Printing elements of arrayList\"); // ä¸‰ç§éå†æ–¹å¼æ‰“å°å…ƒç´  // ç¬¬ä¸€ç§ï¼šé€šè¿‡è¿­ä»£å™¨éå† System.out.print(\"é€šè¿‡è¿­ä»£å™¨éå†:\"); Iterator\u003cInteger\u003e it = arrayList.iterator(); while(it.hasNext()){ System.out.print(it.next() + \" \"); } System.out.println(); // ç¬¬äºŒç§ï¼šé€šè¿‡ç´¢å¼•å€¼éå† System.out.print(\"é€šè¿‡ç´¢å¼•å€¼éå†:\"); for(int i = 0; i \u003c arrayList.size(); i++){ System.out.print(arrayList.get(i) + \" \"); } System.out.println(); // ç¬¬ä¸‰ç§ï¼šforå¾ªç¯éå† System.out.print(\"forå¾ªç¯éå†:\"); for(Integer number : arrayList){ System.out.print(number + \" \"); } // toArrayç”¨æ³• // ç¬¬ä¸€ç§æ–¹å¼(æœ€å¸¸ç”¨) Integer[] integer = arrayList.toArray(new Integer[0]); // ç¬¬äºŒç§æ–¹å¼(å®¹æ˜“ç†è§£) Integer[] integer1 = new Integer[arrayList.size()]; arrayList.toArray(integer1); // æŠ›å‡ºå¼‚å¸¸ï¼Œjavaä¸æ”¯æŒå‘ä¸‹è½¬å‹ //Integer[] integer2 = new Integer[arrayList.size()]; //integer2 = arrayList.toArray(); System.out.println(); // åœ¨æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´  arrayList.add(2,2); // åˆ é™¤æŒ‡å®šä½ç½®ä¸Šçš„å…ƒç´  arrayList.remove(2); // åˆ é™¤æŒ‡å®šå…ƒç´  arrayList.remove((Object)3); // åˆ¤æ–­arrayListæ˜¯å¦åŒ…å«5 System.out.println(\"ArrayList contains 5 is: \" + arrayList.contains(5)); // æ¸…ç©ºArrayList arrayList.clear(); // åˆ¤æ–­ArrayListæ˜¯å¦ä¸ºç©º System.out.println(\"ArrayList is empty: \" + arrayList.isEmpty()); } } ","description":"","tags":["array-list"],"title":"\u003cJavaå®¹å™¨\u003e ArrayList","uri":"/blog/posts/Java/ArrayList/"},{"categories":["Java"],"content":"ä¸€ å…ˆä» ArrayList çš„æ„é€ å‡½æ•°è¯´èµ· ArrayListæœ‰ä¸‰ç§æ–¹å¼æ¥åˆå§‹åŒ–ï¼Œæ„é€ æ–¹æ³•æºç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 /** * é»˜è®¤åˆå§‹å®¹é‡å¤§å° */ private static final int DEFAULT_CAPACITY = 10; private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {}; /** *é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½¿ç”¨åˆå§‹å®¹é‡10æ„é€ ä¸€ä¸ªç©ºåˆ—è¡¨(æ— å‚æ•°æ„é€ ) */ public ArrayList() { this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA; } /** * å¸¦åˆå§‹å®¹é‡å‚æ•°çš„æ„é€ å‡½æ•°ã€‚ï¼ˆç”¨æˆ·è‡ªå·±æŒ‡å®šå®¹é‡ï¼‰ */ public ArrayList(int initialCapacity) { if (initialCapacity \u003e 0) {//åˆå§‹å®¹é‡å¤§äº0 //åˆ›å»ºinitialCapacityå¤§å°çš„æ•°ç»„ this.elementData = new Object[initialCapacity]; } else if (initialCapacity == 0) {//åˆå§‹å®¹é‡ç­‰äº0 //åˆ›å»ºç©ºæ•°ç»„ this.elementData = EMPTY_ELEMENTDATA; } else {//åˆå§‹å®¹é‡å°äº0ï¼ŒæŠ›å‡ºå¼‚å¸¸ throw new IllegalArgumentException(\"Illegal Capacity: \"+ initialCapacity); } } /** *æ„é€ åŒ…å«æŒ‡å®šcollectionå…ƒç´ çš„åˆ—è¡¨ï¼Œè¿™äº›å…ƒç´ åˆ©ç”¨è¯¥é›†åˆçš„è¿­ä»£å™¨æŒ‰é¡ºåºè¿”å› *å¦‚æœæŒ‡å®šçš„é›†åˆä¸ºnullï¼Œthrows NullPointerExceptionã€‚ */ public ArrayList(Collection\u003c? extends E\u003e c) { elementData = c.toArray(); if ((size = elementData.length) != 0) { // c.toArray might (incorrectly) not return Object[] (see 6260652) if (elementData.getClass() != Object[].class) elementData = Arrays.copyOf(elementData, size, Object[].class); } else { // replace with empty array. this.elementData = EMPTY_ELEMENTDATA; } } ç»†å¿ƒçš„åŒå­¦ä¸€å®šä¼šå‘ç° ï¼šä»¥æ— å‚æ•°æ„é€ æ–¹æ³•åˆ›å»º ArrayList æ—¶ï¼Œå®é™…ä¸Šåˆå§‹åŒ–èµ‹å€¼çš„æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ã€‚å½“çœŸæ­£å¯¹æ•°ç»„è¿›è¡Œæ·»åŠ å…ƒç´ æ“ä½œæ—¶ï¼Œæ‰çœŸæ­£åˆ†é…å®¹é‡ã€‚å³å‘æ•°ç»„ä¸­æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæ•°ç»„å®¹é‡æ‰©ä¸º10ã€‚ ä¸‹é¢åœ¨æˆ‘ä»¬åˆ†æ ArrayList æ‰©å®¹æ—¶ä¼šè®²åˆ°è¿™ä¸€ç‚¹å†…å®¹ï¼\näºŒ ä¸€æ­¥ä¸€æ­¥åˆ†æ ArrayList æ‰©å®¹æœºåˆ¶ è¿™é‡Œä»¥æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„ ArrayList ä¸ºä¾‹åˆ†æ\n1. å…ˆæ¥çœ‹ add æ–¹æ³• 1 2 3 4 5 6 7 8 9 10 /** * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚ */ public boolean add(E e) { //æ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œå…ˆè°ƒç”¨ensureCapacityInternalæ–¹æ³• ensureCapacityInternal(size + 1); // Increments modCount!! //è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼ elementData[size++] = e; return true; } 2. å†æ¥çœ‹çœ‹ ensureCapacityInternal() æ–¹æ³• å¯ä»¥çœ‹åˆ° add æ–¹æ³• é¦–å…ˆè°ƒç”¨äº†ensureCapacityInternal(size + 1)\n1 2 3 4 5 6 7 8 9 //å¾—åˆ°æœ€å°æ‰©å®¹é‡ private void ensureCapacityInternal(int minCapacity) { if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) { // è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„è¾ƒå¤§å€¼ minCapacity = Math.max(DEFAULT_CAPACITY, minCapacity); } ensureExplicitCapacity(minCapacity); } å½“ è¦ add è¿›ç¬¬1ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacityä¸º1ï¼Œåœ¨Math.max()æ–¹æ³•æ¯”è¾ƒåï¼ŒminCapacity ä¸º10ã€‚\n3. ensureExplicitCapacity() æ–¹æ³• å¦‚æœè°ƒç”¨ ensureCapacityInternal() æ–¹æ³•å°±ä¸€å®šä¼šè¿›è¿‡ï¼ˆæ‰§è¡Œï¼‰è¿™ä¸ªæ–¹æ³•ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•çš„æºç ï¼\n1 2 3 4 5 6 7 8 9 //åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ private void ensureExplicitCapacity(int minCapacity) { modCount++; // overflow-conscious code if (minCapacity - elementData.length \u003e 0) //è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº† grow(minCapacity); } æˆ‘ä»¬æ¥ä»”ç»†åˆ†æä¸€ä¸‹ï¼š\nå½“æˆ‘ä»¬è¦ add è¿›ç¬¬1ä¸ªå…ƒç´ åˆ° ArrayList æ—¶ï¼ŒelementData.length ä¸º0 ï¼ˆå› ä¸ºè¿˜æ˜¯ä¸€ä¸ªç©ºçš„ listï¼‰ï¼Œå› ä¸ºæ‰§è¡Œäº† ensureCapacityInternal() æ–¹æ³• ï¼Œæ‰€ä»¥ minCapacity æ­¤æ—¶ä¸º10ã€‚æ­¤æ—¶ï¼ŒminCapacity - elementData.length \u003e 0 æˆç«‹ï¼Œæ‰€ä»¥ä¼šè¿›å…¥ grow(minCapacity) æ–¹æ³•ã€‚ å½“addç¬¬2ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º2ï¼Œæ­¤æ—¶e lementData.length(å®¹é‡)åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åæ‰©å®¹æˆ 10 äº†ã€‚æ­¤æ—¶ï¼ŒminCapacity - elementData.length \u003e 0 ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ ï¼ˆæ‰§è¡Œï¼‰grow(minCapacity) æ–¹æ³•ã€‚ æ·»åŠ ç¬¬3ã€4Â·Â·Â·åˆ°ç¬¬10ä¸ªå…ƒç´ æ—¶ï¼Œä¾ç„¶ä¸ä¼šæ‰§è¡Œgrowæ–¹æ³•ï¼Œæ•°ç»„å®¹é‡éƒ½ä¸º10ã€‚ ç›´åˆ°æ·»åŠ ç¬¬11ä¸ªå…ƒç´ ï¼ŒminCapacity(ä¸º11)æ¯”elementData.lengthï¼ˆä¸º10ï¼‰è¦å¤§ã€‚è¿›å…¥growæ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚\n4. grow() æ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 /** * è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å° */ private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8; /** * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚ */ private void grow(int minCapacity) { // oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡ int oldCapacity = elementData.length; //å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ //æˆ‘ä»¬çŸ¥é“ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ int newCapacity = oldCapacity + (oldCapacity \u003e\u003e 1); //ç„¶åæ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ if (newCapacity - minCapacity \u003c 0) newCapacity = minCapacity; // å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œ //å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚ if (newCapacity - MAX_ARRAY_SIZE \u003e 0) newCapacity = hugeCapacity(minCapacity); // minCapacity is usually close to size, so this is a win: elementData = Arrays.copyOf(elementData, newCapacity); } int newCapacity = oldCapacity + (oldCapacity \u003e\u003e 1),æ‰€ä»¥ ArrayList æ¯æ¬¡æ‰©å®¹ä¹‹åå®¹é‡éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ 1.5 å€ï¼ï¼ˆJDK1.6ç‰ˆæœ¬ä»¥åï¼‰ JDk1.6ç‰ˆæœ¬æ—¶ï¼Œæ‰©å®¹ä¹‹åå®¹é‡ä¸º 1.5 å€+1ï¼è¯¦æƒ…è¯·å‚è€ƒæºç \n\"\u003e\u003e\"ï¼ˆç§»ä½è¿ç®—ç¬¦ï¼‰ï¼š\u003e\u003e1 å³ç§»ä¸€ä½ç›¸å½“äºé™¤2ï¼Œå³ç§»nä½ç›¸å½“äºé™¤ä»¥ 2 çš„ n æ¬¡æ–¹ã€‚è¿™é‡Œ oldCapacity æ˜æ˜¾å³ç§»äº†1ä½æ‰€ä»¥ç›¸å½“äºoldCapacity /2ã€‚å¯¹äºå¤§æ•°æ®çš„2è¿›åˆ¶è¿ç®—,ä½ç§»è¿ç®—ç¬¦æ¯”é‚£äº›æ™®é€šè¿ç®—ç¬¦çš„è¿ç®—è¦å¿«å¾ˆå¤š,å› ä¸ºç¨‹åºä»…ä»…ç§»åŠ¨ä¸€ä¸‹è€Œå·²,ä¸å»è®¡ç®—,è¿™æ ·æé«˜äº†æ•ˆç‡,èŠ‚çœäº†èµ„æº æˆ‘ä»¬å†æ¥é€šè¿‡ä¾‹å­æ¢ç©¶ä¸€ä¸‹grow() æ–¹æ³• ï¼š\nå½“addç¬¬1ä¸ªå…ƒç´ æ—¶ï¼ŒoldCapacity ä¸º0ï¼Œç»æ¯”è¾ƒåç¬¬ä¸€ä¸ªifåˆ¤æ–­æˆç«‹ï¼ŒnewCapacity = minCapacity(ä¸º10)ã€‚ä½†æ˜¯ç¬¬äºŒä¸ªifåˆ¤æ–­ä¸ä¼šæˆç«‹ï¼Œå³newCapacity ä¸æ¯” MAX_ARRAY_SIZEå¤§ï¼Œåˆ™ä¸ä¼šè¿›å…¥ hugeCapacity æ–¹æ³•ã€‚æ•°ç»„å®¹é‡ä¸º10ï¼Œaddæ–¹æ³•ä¸­ return true,sizeå¢ä¸º1ã€‚ å½“addç¬¬11ä¸ªå…ƒç´ è¿›å…¥growæ–¹æ³•æ—¶ï¼ŒnewCapacityä¸º15ï¼Œæ¯”minCapacityï¼ˆä¸º11ï¼‰å¤§ï¼Œç¬¬ä¸€ä¸ªifåˆ¤æ–­ä¸æˆç«‹ã€‚æ–°å®¹é‡æ²¡æœ‰å¤§äºæ•°ç»„æœ€å¤§sizeï¼Œä¸ä¼šè¿›å…¥hugeCapacityæ–¹æ³•ã€‚æ•°ç»„å®¹é‡æ‰©ä¸º15ï¼Œaddæ–¹æ³•ä¸­return true,sizeå¢ä¸º11ã€‚ ä»¥æ­¤ç±»æ¨Â·Â·Â·Â·Â·Â· è¿™é‡Œè¡¥å……ä¸€ç‚¹æ¯”è¾ƒé‡è¦ï¼Œä½†æ˜¯å®¹æ˜“è¢«å¿½è§†æ‰çš„çŸ¥è¯†ç‚¹ï¼š\njava ä¸­çš„ length å±æ€§æ˜¯é’ˆå¯¹æ•°ç»„è¯´çš„,æ¯”å¦‚è¯´ä½ å£°æ˜äº†ä¸€ä¸ªæ•°ç»„,æƒ³çŸ¥é“è¿™ä¸ªæ•°ç»„çš„é•¿åº¦åˆ™ç”¨åˆ°äº† length è¿™ä¸ªå±æ€§. java ä¸­çš„ length() æ–¹æ³•æ˜¯é’ˆå¯¹å­—ç¬¦ä¸²è¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦åˆ™ç”¨åˆ° length() è¿™ä¸ªæ–¹æ³•. java ä¸­çš„ size() æ–¹æ³•æ˜¯é’ˆå¯¹æ³›å‹é›†åˆè¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªæ³›å‹æœ‰å¤šå°‘ä¸ªå…ƒç´ ,å°±è°ƒç”¨æ­¤æ–¹æ³•æ¥æŸ¥çœ‹! 5. hugeCapacity() æ–¹æ³•ã€‚ ä»ä¸Šé¢ grow() æ–¹æ³•æºç æˆ‘ä»¬çŸ¥é“ï¼š å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) hugeCapacity() æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œå¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸ºInteger.MAX_VALUEï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º Integer.MAX_VALUE - 8ã€‚\n1 2 3 4 5 6 7 8 9 10 11 private static int hugeCapacity(int minCapacity) { if (minCapacity \u003c 0) // overflow throw new OutOfMemoryError(); //å¯¹minCapacityå’ŒMAX_ARRAY_SIZEè¿›è¡Œæ¯”è¾ƒ //è‹¥minCapacityå¤§ï¼Œå°†Integer.MAX_VALUEä½œä¸ºæ–°æ•°ç»„çš„å¤§å° //è‹¥MAX_ARRAY_SIZEå¤§ï¼Œå°†MAX_ARRAY_SIZEä½œä¸ºæ–°æ•°ç»„çš„å¤§å° //MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8; return (minCapacity \u003e MAX_ARRAY_SIZE) ? Integer.MAX_VALUE : MAX_ARRAY_SIZE; } ä¸‰ System.arraycopy() å’Œ Arrays.copyOf()æ–¹æ³• é˜…è¯»æºç çš„è¯ï¼Œæˆ‘ä»¬å°±ä¼šå‘ç° ArrayList ä¸­å¤§é‡è°ƒç”¨äº†è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬ä¸Šé¢è®²çš„æ‰©å®¹æ“ä½œä»¥åŠadd(int index, E element)ã€toArray() ç­‰æ–¹æ³•ä¸­éƒ½ç”¨åˆ°äº†è¯¥æ–¹æ³•ï¼\n3.1 System.arraycopy() æ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 /** * åœ¨æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´ ã€‚ *å…ˆè°ƒç”¨ rangeCheckForAdd å¯¹indexè¿›è¡Œç•Œé™æ£€æŸ¥ï¼›ç„¶åè°ƒç”¨ ensureCapacityInternal æ–¹æ³•ä¿è¯capacityè¶³å¤Ÿå¤§ï¼› *å†å°†ä»indexå¼€å§‹ä¹‹åçš„æ‰€æœ‰æˆå‘˜åç§»ä¸€ä¸ªä½ç½®ï¼›å°†elementæ’å…¥indexä½ç½®ï¼›æœ€åsizeåŠ 1ã€‚ */ public void add(int index, E element) { rangeCheckForAdd(index); ensureCapacityInternal(size + 1); // Increments modCount!! //arraycopy()æ–¹æ³•å®ç°æ•°ç»„è‡ªå·±å¤åˆ¶è‡ªå·± //elementData:æºæ•°ç»„;index:æºæ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®;elementDataï¼šç›®æ ‡æ•°ç»„ï¼›index + 1ï¼šç›®æ ‡æ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®ï¼› size - indexï¼šè¦å¤åˆ¶çš„æ•°ç»„å…ƒç´ çš„æ•°é‡ï¼› System.arraycopy(elementData, index, elementData, index + 1, size - index); elementData[index] = element; size++; } æˆ‘ä»¬å†™ä¸€ä¸ªç®€å•çš„æ–¹æ³•æµ‹è¯•ä»¥ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 public class ArraycopyTest { public static void main(String[] args) { // TODO Auto-generated method stub int[] a = new int[10]; a[0] = 0; a[1] = 1; a[2] = 2; a[3] = 3; System.arraycopy(a, 2, a, 3, 3); a[2]=99; for (int i = 0; i \u003c a.length; i++) { System.out.println(a[i]); } } } ç»“æœï¼š\n0 1 99 2 3 0 0 0 0 0 3.2 Arrays.copyOf()æ–¹æ³• 1 2 3 4 5 6 7 /** ä»¥æ­£ç¡®çš„é¡ºåºè¿”å›ä¸€ä¸ªåŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰; è¿”å›çš„æ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹æ˜¯æŒ‡å®šæ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹ã€‚ */ public Object[] toArray() { //elementDataï¼šè¦å¤åˆ¶çš„æ•°ç»„ï¼›sizeï¼šè¦å¤åˆ¶çš„é•¿åº¦ return Arrays.copyOf(elementData, size); } ä¸ªäººè§‰å¾—ä½¿ç”¨ Arrays.copyOf()æ–¹æ³•ä¸»è¦æ˜¯ä¸ºäº†ç»™åŸæœ‰æ•°ç»„æ‰©å®¹ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 public class ArrayscopyOfTest { public static void main(String[] args) { int[] a = new int[3]; a[0] = 0; a[1] = 1; a[2] = 2; int[] b = Arrays.copyOf(a, 10); System.out.println(\"b.length\"+b.length); } } ç»“æœï¼š\n10 3.3 ä¸¤è€…è”ç³»å’ŒåŒºåˆ« è”ç³»ï¼š\nçœ‹ä¸¤è€…æºä»£ç å¯ä»¥å‘ç° copyOf() å†…éƒ¨å®é™…è°ƒç”¨äº† System.arraycopy() æ–¹æ³•\nåŒºåˆ«ï¼š\narraycopy() éœ€è¦ç›®æ ‡æ•°ç»„ï¼Œå°†åŸæ•°ç»„æ‹·è´åˆ°ä½ è‡ªå·±å®šä¹‰çš„æ•°ç»„é‡Œæˆ–è€…åŸæ•°ç»„ï¼Œè€Œä¸”å¯ä»¥é€‰æ‹©æ‹·è´çš„èµ·ç‚¹å’Œé•¿åº¦ä»¥åŠæ”¾å…¥æ–°æ•°ç»„ä¸­çš„ä½ç½® copyOf() æ˜¯ç³»ç»Ÿè‡ªåŠ¨åœ¨å†…éƒ¨æ–°å»ºä¸€ä¸ªæ•°ç»„ï¼Œå¹¶è¿”å›è¯¥æ•°ç»„ã€‚\nå›› ensureCapacityæ–¹æ³• ArrayList æºç ä¸­æœ‰ä¸€ä¸ª ensureCapacity æ–¹æ³•ä¸çŸ¥é“å¤§å®¶æ³¨æ„åˆ°æ²¡æœ‰ï¼Œè¿™ä¸ªæ–¹æ³• ArrayList å†…éƒ¨æ²¡æœ‰è¢«è°ƒç”¨è¿‡ï¼Œæ‰€ä»¥å¾ˆæ˜¾ç„¶æ˜¯æä¾›ç»™ç”¨æˆ·è°ƒç”¨çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 /** å¦‚æœ‰å¿…è¦ï¼Œå¢åŠ æ­¤ ArrayList å®ä¾‹çš„å®¹é‡ï¼Œä»¥ç¡®ä¿å®ƒè‡³å°‘å¯ä»¥å®¹çº³ç”±minimum capacityå‚æ•°æŒ‡å®šçš„å…ƒç´ æ•°ã€‚ * * @param minCapacity æ‰€éœ€çš„æœ€å°å®¹é‡ */ public void ensureCapacity(int minCapacity) { int minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA) // any size if not default element table ? 0 // larger than default for default empty table. It's already // supposed to be at default size. : DEFAULT_CAPACITY; if (minCapacity \u003e minExpand) { ensureExplicitCapacity(minCapacity); } } æœ€å¥½åœ¨ add å¤§é‡å…ƒç´ ä¹‹å‰ç”¨ ensureCapacity æ–¹æ³•ï¼Œä»¥å‡å°‘å¢é‡é‡æ–°åˆ†é…çš„æ¬¡æ•°\næˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä»£ç å®é™…æµ‹è¯•ä»¥ä¸‹è¿™ä¸ªæ–¹æ³•çš„æ•ˆæœï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 public class EnsureCapacityTest { public static void main(String[] args) { ArrayList\u003cObject\u003e list = new ArrayList\u003cObject\u003e(); final int N = 10000000; long startTime = System.currentTimeMillis(); for (int i = 0; i \u003c N; i++) { list.add(i); } long endTime = System.currentTimeMillis(); System.out.println(\"ä½¿ç”¨ensureCapacityæ–¹æ³•å‰ï¼š\"+(endTime - startTime)); list = new ArrayList\u003cObject\u003e(); long startTime1 = System.currentTimeMillis(); list.ensureCapacity(N); for (int i = 0; i \u003c N; i++) { list.add(i); } long endTime1 = System.currentTimeMillis(); System.out.println(\"ä½¿ç”¨ensureCapacityæ–¹æ³•åï¼š\"+(endTime1 - startTime1)); } } è¿è¡Œç»“æœï¼š\nä½¿ç”¨ensureCapacityæ–¹æ³•å‰ï¼š4637 ä½¿ç”¨ensureCapacityæ–¹æ³•åï¼š241 é€šè¿‡è¿è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºå‘ ArrayList æ·»åŠ å¤§é‡å…ƒç´ ä¹‹å‰æœ€å¥½å…ˆä½¿ç”¨ensureCapacity æ–¹æ³•ï¼Œä»¥å‡å°‘å¢é‡é‡æ–°åˆ†é…çš„æ¬¡æ•°\n","description":"","tags":["array-list"],"title":"\u003cJavaå®¹å™¨\u003e ArrayListæ‰©å®¹æºç åˆ†æ","uri":"/blog/posts/Java/ArrayList-Grow/"},{"categories":["Java"],"content":" HashMap ç®€ä»‹ åº•å±‚æ•°æ®ç»“æ„åˆ†æ JDK1.8ä¹‹å‰ JDK1.8ä¹‹å HashMapæºç åˆ†æ æ„é€ æ–¹æ³• putæ–¹æ³• getæ–¹æ³• resizeæ–¹æ³• HashMapå¸¸ç”¨æ–¹æ³•æµ‹è¯• æ„Ÿè°¢ changfubai å¯¹æœ¬æ–‡çš„æ”¹è¿›åšå‡ºçš„è´¡çŒ®ï¼\nHashMap ç®€ä»‹ HashMap ä¸»è¦ç”¨æ¥å­˜æ”¾é”®å€¼å¯¹ï¼Œå®ƒåŸºäºå“ˆå¸Œè¡¨çš„Mapæ¥å£å®ç°ï¼Œæ˜¯å¸¸ç”¨çš„Javaé›†åˆä¹‹ä¸€ã€‚\nJDK1.8 ä¹‹å‰ HashMap ç”± æ•°ç»„+é“¾è¡¨ ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼ˆâ€œæ‹‰é“¾æ³•â€è§£å†³å†²çªï¼‰.JDK1.8 ä»¥ååœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚\nåº•å±‚æ•°æ®ç»“æ„åˆ†æ JDK1.8ä¹‹å‰ JDK1.8 ä¹‹å‰ HashMap åº•å±‚æ˜¯ æ•°ç»„å’Œé“¾è¡¨ ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ä¹Ÿå°±æ˜¯ é“¾è¡¨æ•£åˆ—ã€‚HashMap é€šè¿‡ key çš„ hashCode ç»è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†è¿‡åå¾—åˆ° hash å€¼ï¼Œç„¶åé€šè¿‡ (n - 1) \u0026 hash åˆ¤æ–­å½“å‰å…ƒç´ å­˜æ”¾çš„ä½ç½®ï¼ˆè¿™é‡Œçš„ n æŒ‡çš„æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ï¼Œå¦‚æœå½“å‰ä½ç½®å­˜åœ¨å…ƒç´ çš„è¯ï¼Œå°±åˆ¤æ–­è¯¥å…ƒç´ ä¸è¦å­˜å…¥çš„å…ƒç´ çš„ hash å€¼ä»¥åŠ key æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒçš„è¯ï¼Œç›´æ¥è¦†ç›–ï¼Œä¸ç›¸åŒå°±é€šè¿‡æ‹‰é“¾æ³•è§£å†³å†²çªã€‚\næ‰€è°“æ‰°åŠ¨å‡½æ•°æŒ‡çš„å°±æ˜¯ HashMap çš„ hash æ–¹æ³•ã€‚ä½¿ç”¨ hash æ–¹æ³•ä¹Ÿå°±æ˜¯æ‰°åŠ¨å‡½æ•°æ˜¯ä¸ºäº†é˜²æ­¢ä¸€äº›å®ç°æ¯”è¾ƒå·®çš„ hashCode() æ–¹æ³• æ¢å¥è¯è¯´ä½¿ç”¨æ‰°åŠ¨å‡½æ•°ä¹‹åå¯ä»¥å‡å°‘ç¢°æ’ã€‚\nJDK 1.8 HashMap çš„ hash æ–¹æ³•æºç :\nJDK 1.8 çš„ hashæ–¹æ³• ç›¸æ¯”äº JDK 1.7 hash æ–¹æ³•æ›´åŠ ç®€åŒ–ï¼Œä½†æ˜¯åŸç†ä¸å˜ã€‚\n1 2 3 4 5 6 7 static final int hash(Object key) { int h; // key.hashCode()ï¼šè¿”å›æ•£åˆ—å€¼ä¹Ÿå°±æ˜¯hashcode // ^ ï¼šæŒ‰ä½å¼‚æˆ– // \u003e\u003e\u003e:æ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥0è¡¥é½ return (key == null) ? 0 : (h = key.hashCode()) ^ (h \u003e\u003e\u003e 16); } å¯¹æ¯”ä¸€ä¸‹ JDK1.7çš„ HashMap çš„ hash æ–¹æ³•æºç .\n1 2 3 4 5 6 7 8 static int hash(int h) { // This function ensures that hashCodes that differ only by // constant multiples at each bit position have a bounded // number of collisions (approximately 8 at default load factor). h ^= (h \u003e\u003e\u003e 20) ^ (h \u003e\u003e\u003e 12); return h ^ (h \u003e\u003e\u003e 7) ^ (h \u003e\u003e\u003e 4); } ç›¸æ¯”äº JDK1.8 çš„ hash æ–¹æ³• ï¼ŒJDK 1.7 çš„ hash æ–¹æ³•çš„æ€§èƒ½ä¼šç¨å·®ä¸€ç‚¹ç‚¹ï¼Œå› ä¸ºæ¯•ç«Ÿæ‰°åŠ¨äº† 4 æ¬¡ã€‚\næ‰€è°“ â€œæ‹‰é“¾æ³•â€ å°±æ˜¯ï¼šå°†é“¾è¡¨å’Œæ•°ç»„ç›¸ç»“åˆã€‚ä¹Ÿå°±æ˜¯è¯´åˆ›å»ºä¸€ä¸ªé“¾è¡¨æ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸€æ ¼å°±æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚è‹¥é‡åˆ°å“ˆå¸Œå†²çªï¼Œåˆ™å°†å†²çªçš„å€¼åŠ åˆ°é“¾è¡¨ä¸­å³å¯ã€‚\nJDK1.8ä¹‹å ç›¸æ¯”äºä¹‹å‰çš„ç‰ˆæœ¬ï¼Œjdk1.8åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º8ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚\nç±»çš„å±æ€§ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 public class HashMap\u003cK,V\u003e extends AbstractMap\u003cK,V\u003e implements Map\u003cK,V\u003e, Cloneable, Serializable { // åºåˆ—å· private static final long serialVersionUID = 362498820763181265L; // é»˜è®¤çš„åˆå§‹å®¹é‡æ˜¯16 static final int DEFAULT_INITIAL_CAPACITY = 1 \u003c\u003c 4; // æœ€å¤§å®¹é‡ static final int MAXIMUM_CAPACITY = 1 \u003c\u003c 30; // é»˜è®¤çš„å¡«å……å› å­ static final float DEFAULT_LOAD_FACTOR = 0.75f; // å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å¤§äºè¿™ä¸ªå€¼æ—¶ä¼šè½¬æˆçº¢é»‘æ ‘ static final int TREEIFY_THRESHOLD = 8; // å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å°äºè¿™ä¸ªå€¼æ—¶æ ‘è½¬é“¾è¡¨ static final int UNTREEIFY_THRESHOLD = 6; // æ¡¶ä¸­ç»“æ„è½¬åŒ–ä¸ºçº¢é»‘æ ‘å¯¹åº”çš„tableçš„æœ€å°å¤§å° static final int MIN_TREEIFY_CAPACITY = 64; // å­˜å‚¨å…ƒç´ çš„æ•°ç»„ï¼Œæ€»æ˜¯2çš„å¹‚æ¬¡å€ transient Node\u003ck,v\u003e[] table; // å­˜æ”¾å…·ä½“å…ƒç´ çš„é›† transient Set\u003cmap.entry\u003ck,v\u003e\u003e entrySet; // å­˜æ”¾å…ƒç´ çš„ä¸ªæ•°ï¼Œæ³¨æ„è¿™ä¸ªä¸ç­‰äºæ•°ç»„çš„é•¿åº¦ã€‚ transient int size; // æ¯æ¬¡æ‰©å®¹å’Œæ›´æ”¹mapç»“æ„çš„è®¡æ•°å™¨ transient int modCount; // ä¸´ç•Œå€¼ å½“å®é™…å¤§å°(å®¹é‡*å¡«å……å› å­)è¶…è¿‡ä¸´ç•Œå€¼æ—¶ï¼Œä¼šè¿›è¡Œæ‰©å®¹ int threshold; // åŠ è½½å› å­ final float loadFactor; } loadFactoråŠ è½½å› å­\nloadFactoråŠ è½½å› å­æ˜¯æ§åˆ¶æ•°ç»„å­˜æ”¾æ•°æ®çš„ç–å¯†ç¨‹åº¦ï¼ŒloadFactorè¶Šè¶‹è¿‘äº1ï¼Œé‚£ä¹ˆ æ•°ç»„ä¸­å­˜æ”¾çš„æ•°æ®(entry)ä¹Ÿå°±è¶Šå¤šï¼Œä¹Ÿå°±è¶Šå¯†ï¼Œä¹Ÿå°±æ˜¯ä¼šè®©é“¾è¡¨çš„é•¿åº¦å¢åŠ ï¼ŒloadFactorè¶Šå°ï¼Œä¹Ÿå°±æ˜¯è¶‹è¿‘äº0ï¼Œæ•°ç»„ä¸­å­˜æ”¾çš„æ•°æ®(entry)ä¹Ÿå°±è¶Šå°‘ï¼Œä¹Ÿå°±è¶Šç¨€ç–ã€‚\nloadFactorå¤ªå¤§å¯¼è‡´æŸ¥æ‰¾å…ƒç´ æ•ˆç‡ä½ï¼Œå¤ªå°å¯¼è‡´æ•°ç»„çš„åˆ©ç”¨ç‡ä½ï¼Œå­˜æ”¾çš„æ•°æ®ä¼šå¾ˆåˆ†æ•£ã€‚loadFactorçš„é»˜è®¤å€¼ä¸º0.75fæ˜¯å®˜æ–¹ç»™å‡ºçš„ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¸´ç•Œå€¼ã€‚\nç»™å®šçš„é»˜è®¤å®¹é‡ä¸º 16ï¼Œè´Ÿè½½å› å­ä¸º 0.75ã€‚Map åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸æ–­çš„å¾€é‡Œé¢å­˜æ”¾æ•°æ®ï¼Œå½“æ•°é‡è¾¾åˆ°äº† 16 * 0.75 = 12 å°±éœ€è¦å°†å½“å‰ 16 çš„å®¹é‡è¿›è¡Œæ‰©å®¹ï¼Œè€Œæ‰©å®¹è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ° rehashã€å¤åˆ¶æ•°æ®ç­‰æ“ä½œï¼Œæ‰€ä»¥éå¸¸æ¶ˆè€—æ€§èƒ½ã€‚\nthreshold\nthreshold = capacity * loadFactorï¼Œå½“Size\u003e=thresholdçš„æ—¶å€™ï¼Œé‚£ä¹ˆå°±è¦è€ƒè™‘å¯¹æ•°ç»„çš„æ‰©å¢äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªçš„æ„æ€å°±æ˜¯ è¡¡é‡æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å¢çš„ä¸€ä¸ªæ ‡å‡†ã€‚\nNodeèŠ‚ç‚¹ç±»æºç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 // ç»§æ‰¿è‡ª Map.Entry\u003cK,V\u003e static class Node\u003cK,V\u003e implements Map.Entry\u003cK,V\u003e { final int hash;// å“ˆå¸Œå€¼ï¼Œå­˜æ”¾å…ƒç´ åˆ°hashmapä¸­æ—¶ç”¨æ¥ä¸å…¶ä»–å…ƒç´ hashå€¼æ¯”è¾ƒ final K key;//é”® V value;//å€¼ // æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ Node\u003cK,V\u003e next; Node(int hash, K key, V value, Node\u003cK,V\u003e next) { this.hash = hash; this.key = key; this.value = value; this.next = next; } public final K getKey() { return key; } public final V getValue() { return value; } public final String toString() { return key + \"=\" + value; } // é‡å†™hashCode()æ–¹æ³• public final int hashCode() { return Objects.hashCode(key) ^ Objects.hashCode(value); } public final V setValue(V newValue) { V oldValue = value; value = newValue; return oldValue; } // é‡å†™ equals() æ–¹æ³• public final boolean equals(Object o) { if (o == this) return true; if (o instanceof Map.Entry) { Map.Entry\u003c?,?\u003e e = (Map.Entry\u003c?,?\u003e)o; if (Objects.equals(key, e.getKey()) \u0026\u0026 Objects.equals(value, e.getValue())) return true; } return false; } } æ ‘èŠ‚ç‚¹ç±»æºç :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 static final class TreeNode\u003cK,V\u003e extends LinkedHashMap.Entry\u003cK,V\u003e { TreeNode\u003cK,V\u003e parent; // çˆ¶ TreeNode\u003cK,V\u003e left; // å·¦ TreeNode\u003cK,V\u003e right; // å³ TreeNode\u003cK,V\u003e prev; // needed to unlink next upon deletion boolean red; // åˆ¤æ–­é¢œè‰² TreeNode(int hash, K key, V val, Node\u003cK,V\u003e next) { super(hash, key, val, next); } // è¿”å›æ ¹èŠ‚ç‚¹ final TreeNode\u003cK,V\u003e root() { for (TreeNode\u003cK,V\u003e r = this, p;;) { if ((p = r.parent) == null) return r; r = p; } HashMapæºç åˆ†æ æ„é€ æ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 // é»˜è®¤æ„é€ å‡½æ•°ã€‚ public HashMap() { this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted } // åŒ…å«å¦ä¸€ä¸ªâ€œMapâ€çš„æ„é€ å‡½æ•° public HashMap(Map\u003c? extends K, ? extends V\u003e m) { this.loadFactor = DEFAULT_LOAD_FACTOR; putMapEntries(m, false);//ä¸‹é¢ä¼šåˆ†æåˆ°è¿™ä¸ªæ–¹æ³• } // æŒ‡å®šâ€œå®¹é‡å¤§å°â€çš„æ„é€ å‡½æ•° public HashMap(int initialCapacity) { this(initialCapacity, DEFAULT_LOAD_FACTOR); } // æŒ‡å®šâ€œå®¹é‡å¤§å°â€å’Œâ€œåŠ è½½å› å­â€çš„æ„é€ å‡½æ•° public HashMap(int initialCapacity, float loadFactor) { if (initialCapacity \u003c 0) throw new IllegalArgumentException(\"Illegal initial capacity: \" + initialCapacity); if (initialCapacity \u003e MAXIMUM_CAPACITY) initialCapacity = MAXIMUM_CAPACITY; if (loadFactor \u003c= 0 || Float.isNaN(loadFactor)) throw new IllegalArgumentException(\"Illegal load factor: \" + loadFactor); this.loadFactor = loadFactor; this.threshold = tableSizeFor(initialCapacity); } putMapEntriesæ–¹æ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 final void putMapEntries(Map\u003c? extends K, ? extends V\u003e m, boolean evict) { int s = m.size(); if (s \u003e 0) { // åˆ¤æ–­tableæ˜¯å¦å·²ç»åˆå§‹åŒ– if (table == null) { // pre-size // æœªåˆå§‹åŒ–ï¼Œsä¸ºmçš„å®é™…å…ƒç´ ä¸ªæ•° float ft = ((float)s / loadFactor) + 1.0F; int t = ((ft \u003c (float)MAXIMUM_CAPACITY) ? (int)ft : MAXIMUM_CAPACITY); // è®¡ç®—å¾—åˆ°çš„tå¤§äºé˜ˆå€¼ï¼Œåˆ™åˆå§‹åŒ–é˜ˆå€¼ if (t \u003e threshold) threshold = tableSizeFor(t); } // å·²åˆå§‹åŒ–ï¼Œå¹¶ä¸”må…ƒç´ ä¸ªæ•°å¤§äºé˜ˆå€¼ï¼Œè¿›è¡Œæ‰©å®¹å¤„ç† else if (s \u003e threshold) resize(); // å°†mä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³HashMapä¸­ for (Map.Entry\u003c? extends K, ? extends V\u003e e : m.entrySet()) { K key = e.getKey(); V value = e.getValue(); putVal(hash(key), key, value, false, evict); } } } putæ–¹æ³• HashMapåªæä¾›äº†putç”¨äºæ·»åŠ å…ƒç´ ï¼ŒputValæ–¹æ³•åªæ˜¯ç»™putæ–¹æ³•è°ƒç”¨çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶æ²¡æœ‰æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚\nå¯¹putValæ–¹æ³•æ·»åŠ å…ƒç´ çš„åˆ†æå¦‚ä¸‹ï¼š\nâ‘ å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æ²¡æœ‰å…ƒç´  å°±ç›´æ¥æ’å…¥ã€‚ â‘¡å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æœ‰å…ƒç´ å°±å’Œè¦æ’å…¥çš„keyæ¯”è¾ƒï¼Œå¦‚æœkeyç›¸åŒå°±ç›´æ¥è¦†ç›–ï¼Œå¦‚æœkeyä¸ç›¸åŒï¼Œå°±åˆ¤æ–­pæ˜¯å¦æ˜¯ä¸€ä¸ªæ ‘èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯å°±è°ƒç”¨e = ((TreeNode\u003cK,V\u003e)p).putTreeVal(this, tab, hash, key, value)å°†å…ƒç´ æ·»åŠ è¿›å…¥ã€‚å¦‚æœä¸æ˜¯å°±éå†é“¾è¡¨æ’å…¥ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 public V put(K key, V value) { return putVal(hash(key), key, value, false, true); } final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node\u003cK,V\u003e[] tab; Node\u003cK,V\u003e p; int n, i; // tableæœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º0ï¼Œè¿›è¡Œæ‰©å®¹ if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; // (n - 1) \u0026 hash ç¡®å®šå…ƒç´ å­˜æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­ï¼Œæ¡¶ä¸ºç©ºï¼Œæ–°ç”Ÿæˆç»“ç‚¹æ”¾å…¥æ¡¶ä¸­(æ­¤æ—¶ï¼Œè¿™ä¸ªç»“ç‚¹æ˜¯æ”¾åœ¨æ•°ç»„ä¸­) if ((p = tab[i = (n - 1) \u0026 hash]) == null) tab[i] = newNode(hash, key, value, null); // æ¡¶ä¸­å·²ç»å­˜åœ¨å…ƒç´  else { Node\u003cK,V\u003e e; K k; // æ¯”è¾ƒæ¡¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ (æ•°ç»„ä¸­çš„ç»“ç‚¹)çš„hashå€¼ç›¸ç­‰ï¼Œkeyç›¸ç­‰ if (p.hash == hash \u0026\u0026 ((k = p.key) == key || (key != null \u0026\u0026 key.equals(k)))) // å°†ç¬¬ä¸€ä¸ªå…ƒç´ èµ‹å€¼ç»™eï¼Œç”¨eæ¥è®°å½• e = p; // hashå€¼ä¸ç›¸ç­‰ï¼Œå³keyä¸ç›¸ç­‰ï¼›ä¸ºçº¢é»‘æ ‘ç»“ç‚¹ else if (p instanceof TreeNode) // æ”¾å…¥æ ‘ä¸­ e = ((TreeNode\u003cK,V\u003e)p).putTreeVal(this, tab, hash, key, value); // ä¸ºé“¾è¡¨ç»“ç‚¹ else { // åœ¨é“¾è¡¨æœ€æœ«æ’å…¥ç»“ç‚¹ for (int binCount = 0; ; ++binCount) { // åˆ°è¾¾é“¾è¡¨çš„å°¾éƒ¨ if ((e = p.next) == null) { // åœ¨å°¾éƒ¨æ’å…¥æ–°ç»“ç‚¹ p.next = newNode(hash, key, value, null); // ç»“ç‚¹æ•°é‡è¾¾åˆ°é˜ˆå€¼ï¼Œè½¬åŒ–ä¸ºçº¢é»‘æ ‘ if (binCount \u003e= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); // è·³å‡ºå¾ªç¯ break; } // åˆ¤æ–­é“¾è¡¨ä¸­ç»“ç‚¹çš„keyå€¼ä¸æ’å…¥çš„å…ƒç´ çš„keyå€¼æ˜¯å¦ç›¸ç­‰ if (e.hash == hash \u0026\u0026 ((k = e.key) == key || (key != null \u0026\u0026 key.equals(k)))) // ç›¸ç­‰ï¼Œè·³å‡ºå¾ªç¯ break; // ç”¨äºéå†æ¡¶ä¸­çš„é“¾è¡¨ï¼Œä¸å‰é¢çš„e = p.nextç»„åˆï¼Œå¯ä»¥éå†é“¾è¡¨ p = e; } } // è¡¨ç¤ºåœ¨æ¡¶ä¸­æ‰¾åˆ°keyå€¼ã€hashå€¼ä¸æ’å…¥å…ƒç´ ç›¸ç­‰çš„ç»“ç‚¹ if (e != null) { // è®°å½•eçš„value V oldValue = e.value; // onlyIfAbsentä¸ºfalseæˆ–è€…æ—§å€¼ä¸ºnull if (!onlyIfAbsent || oldValue == null) //ç”¨æ–°å€¼æ›¿æ¢æ—§å€¼ e.value = value; // è®¿é—®åå›è°ƒ afterNodeAccess(e); // è¿”å›æ—§å€¼ return oldValue; } } // ç»“æ„æ€§ä¿®æ”¹ ++modCount; // å®é™…å¤§å°å¤§äºé˜ˆå€¼åˆ™æ‰©å®¹ if (++size \u003e threshold) resize(); // æ’å…¥åå›è°ƒ afterNodeInsertion(evict); return null; } æˆ‘ä»¬å†æ¥å¯¹æ¯”ä¸€ä¸‹ JDK1.7 putæ–¹æ³•çš„ä»£ç \nå¯¹äºputæ–¹æ³•çš„åˆ†æå¦‚ä¸‹ï¼š\nâ‘ å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æ²¡æœ‰å…ƒç´  å°±ç›´æ¥æ’å…¥ã€‚ â‘¡å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æœ‰å…ƒç´ ï¼Œéå†ä»¥è¿™ä¸ªå…ƒç´ ä¸ºå¤´ç»“ç‚¹çš„é“¾è¡¨ï¼Œä¾æ¬¡å’Œæ’å…¥çš„keyæ¯”è¾ƒï¼Œå¦‚æœkeyç›¸åŒå°±ç›´æ¥è¦†ç›–ï¼Œä¸åŒå°±é‡‡ç”¨å¤´æ’æ³•æ’å…¥å…ƒç´ ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 public V put(K key, V value) if (table == EMPTY_TABLE) { inflateTable(threshold); } if (key == null) return putForNullKey(value); int hash = hash(key); int i = indexFor(hash, table.length); for (Entry\u003cK,V\u003e e = table[i]; e != null; e = e.next) { // å…ˆéå† Object k; if (e.hash == hash \u0026\u0026 ((k = e.key) == key || key.equals(k))) { V oldValue = e.value; e.value = value; e.recordAccess(this); return oldValue; } } modCount++; addEntry(hash, key, value, i); // å†æ’å…¥ return null; } getæ–¹æ³• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 public V get(Object key) { Node\u003cK,V\u003e e; return (e = getNode(hash(key), key)) == null ? null : e.value; } final Node\u003cK,V\u003e getNode(int hash, Object key) { Node\u003cK,V\u003e[] tab; Node\u003cK,V\u003e first, e; int n; K k; if ((tab = table) != null \u0026\u0026 (n = tab.length) \u003e 0 \u0026\u0026 (first = tab[(n - 1) \u0026 hash]) != null) { // æ•°ç»„å…ƒç´ ç›¸ç­‰ if (first.hash == hash \u0026\u0026 // always check first node ((k = first.key) == key || (key != null \u0026\u0026 key.equals(k)))) return first; // æ¡¶ä¸­ä¸æ­¢ä¸€ä¸ªèŠ‚ç‚¹ if ((e = first.next) != null) { // åœ¨æ ‘ä¸­get if (first instanceof TreeNode) return ((TreeNode\u003cK,V\u003e)first).getTreeNode(hash, key); // åœ¨é“¾è¡¨ä¸­get do { if (e.hash == hash \u0026\u0026 ((k = e.key) == key || (key != null \u0026\u0026 key.equals(k)))) return e; } while ((e = e.next) != null); } } return null; } resizeæ–¹æ³• è¿›è¡Œæ‰©å®¹ï¼Œä¼šä¼´éšç€ä¸€æ¬¡é‡æ–°hashåˆ†é…ï¼Œå¹¶ä¸”ä¼šéå†hashè¡¨ä¸­æ‰€æœ‰çš„å…ƒç´ ï¼Œæ˜¯éå¸¸è€—æ—¶çš„ã€‚åœ¨ç¼–å†™ç¨‹åºä¸­ï¼Œè¦å°½é‡é¿å…resizeã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 final Node\u003cK,V\u003e[] resize() { Node\u003cK,V\u003e[] oldTab = table; int oldCap = (oldTab == null) ? 0 : oldTab.length; int oldThr = threshold; int newCap, newThr = 0; if (oldCap \u003e 0) { // è¶…è¿‡æœ€å¤§å€¼å°±ä¸å†æ‰©å……äº†ï¼Œå°±åªå¥½éšä½ ç¢°æ’å»å§ if (oldCap \u003e= MAXIMUM_CAPACITY) { threshold = Integer.MAX_VALUE; return oldTab; } // æ²¡è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€ else if ((newCap = oldCap \u003c\u003c 1) \u003c MAXIMUM_CAPACITY \u0026\u0026 oldCap \u003e= DEFAULT_INITIAL_CAPACITY) newThr = oldThr \u003c\u003c 1; // double threshold } else if (oldThr \u003e 0) // initial capacity was placed in threshold newCap = oldThr; else { // signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); } // è®¡ç®—æ–°çš„resizeä¸Šé™ if (newThr == 0) { float ft = (float)newCap * loadFactor; newThr = (newCap \u003c MAXIMUM_CAPACITY \u0026\u0026 ft \u003c (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); } threshold = newThr; @SuppressWarnings({\"rawtypes\",\"unchecked\"}) Node\u003cK,V\u003e[] newTab = (Node\u003cK,V\u003e[])new Node[newCap]; table = newTab; if (oldTab != null) { // æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­ for (int j = 0; j \u003c oldCap; ++j) { Node\u003cK,V\u003e e; if ((e = oldTab[j]) != null) { oldTab[j] = null; if (e.next == null) newTab[e.hash \u0026 (newCap - 1)] = e; else if (e instanceof TreeNode) ((TreeNode\u003cK,V\u003e)e).split(this, newTab, j, oldCap); else { Node\u003cK,V\u003e loHead = null, loTail = null; Node\u003cK,V\u003e hiHead = null, hiTail = null; Node\u003cK,V\u003e next; do { next = e.next; // åŸç´¢å¼• if ((e.hash \u0026 oldCap) == 0) { if (loTail == null) loHead = e; else loTail.next = e; loTail = e; } // åŸç´¢å¼•+oldCap else { if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; } } while ((e = next) != null); // åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ if (loTail != null) { loTail.next = null; newTab[j] = loHead; } // åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ if (hiTail != null) { hiTail.next = null; newTab[j + oldCap] = hiHead; } } } } } return newTab; } HashMapå¸¸ç”¨æ–¹æ³•æµ‹è¯• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 package map; import java.util.Collection; import java.util.HashMap; import java.util.Set; public class HashMapDemo { public static void main(String[] args) { HashMap\u003cString, String\u003e map = new HashMap\u003cString, String\u003e(); // é”®ä¸èƒ½é‡å¤ï¼Œå€¼å¯ä»¥é‡å¤ map.put(\"san\", \"å¼ ä¸‰\"); map.put(\"si\", \"æå››\"); map.put(\"wu\", \"ç‹äº”\"); map.put(\"wang\", \"è€ç‹\"); map.put(\"wang\", \"è€ç‹2\");// è€ç‹è¢«è¦†ç›– map.put(\"lao\", \"è€ç‹\"); System.out.println(\"-------ç›´æ¥è¾“å‡ºhashmap:-------\"); System.out.println(map); /** * éå†HashMap */ // 1.è·å–Mapä¸­çš„æ‰€æœ‰é”® System.out.println(\"-------foreachè·å–Mapä¸­æ‰€æœ‰çš„é”®:------\"); Set\u003cString\u003e keys = map.keySet(); for (String key : keys) { System.out.print(key+\" \"); } System.out.println();//æ¢è¡Œ // 2.è·å–Mapä¸­æ‰€æœ‰å€¼ System.out.println(\"-------foreachè·å–Mapä¸­æ‰€æœ‰çš„å€¼:------\"); Collection\u003cString\u003e values = map.values(); for (String value : values) { System.out.print(value+\" \"); } System.out.println();//æ¢è¡Œ // 3.å¾—åˆ°keyçš„å€¼çš„åŒæ—¶å¾—åˆ°keyæ‰€å¯¹åº”çš„å€¼ System.out.println(\"-------å¾—åˆ°keyçš„å€¼çš„åŒæ—¶å¾—åˆ°keyæ‰€å¯¹åº”çš„å€¼:-------\"); Set\u003cString\u003e keys2 = map.keySet(); for (String key : keys2) { System.out.print(key + \"ï¼š\" + map.get(key)+\" \"); } /** * å¦å¤–ä¸€ç§ä¸å¸¸ç”¨çš„éå†æ–¹å¼ */ // å½“æˆ‘è°ƒç”¨put(key,value)æ–¹æ³•çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæŠŠkeyå’Œvalueå°è£…åˆ° // Entryè¿™ä¸ªé™æ€å†…éƒ¨ç±»å¯¹è±¡ä¸­ï¼ŒæŠŠEntryå¯¹è±¡å†æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è·å– // mapä¸­çš„æ‰€æœ‰é”®å€¼å¯¹ï¼Œæˆ‘ä»¬åªè¦è·å–æ•°ç»„ä¸­çš„æ‰€æœ‰Entryå¯¹è±¡ï¼Œæ¥ä¸‹æ¥ // è°ƒç”¨Entryå¯¹è±¡ä¸­çš„getKey()å’ŒgetValue()æ–¹æ³•å°±èƒ½è·å–é”®å€¼å¯¹äº† Set\u003cjava.util.Map.Entry\u003cString, String\u003e\u003e entrys = map.entrySet(); for (java.util.Map.Entry\u003cString, String\u003e entry : entrys) { System.out.println(entry.getKey() + \"--\" + entry.getValue()); } /** * HashMapå…¶ä»–å¸¸ç”¨æ–¹æ³• */ System.out.println(\"after map.size()ï¼š\"+map.size()); System.out.println(\"after map.isEmpty()ï¼š\"+map.isEmpty()); System.out.println(map.remove(\"san\")); System.out.println(\"after map.remove()ï¼š\"+map); System.out.println(\"after map.get(si)ï¼š\"+map.get(\"si\")); System.out.println(\"after map.containsKey(si)ï¼š\"+map.containsKey(\"si\")); System.out.println(\"after containsValue(æå››)ï¼š\"+map.containsValue(\"æå››\")); System.out.println(map.replace(\"si\", \"æå››2\")); System.out.println(\"after map.replace(si, æå››2):\"+map); } } ","description":"","tags":["map","hashmap"],"title":"\u003cJavaå®¹å™¨\u003e HashMap","uri":"/blog/posts/Java/HashMap/"},{"categories":["Java"],"content":" ç®€ä»‹ å†…éƒ¨ç»“æ„åˆ†æ LinkedListæºç åˆ†æ æ„é€ æ–¹æ³• æ·»åŠ ï¼ˆaddï¼‰æ–¹æ³• æ ¹æ®ä½ç½®å–æ•°æ®çš„æ–¹æ³• æ ¹æ®å¯¹è±¡å¾—åˆ°ç´¢å¼•çš„æ–¹æ³• æ£€æŸ¥é“¾è¡¨æ˜¯å¦åŒ…å«æŸå¯¹è±¡çš„æ–¹æ³•ï¼š åˆ é™¤ï¼ˆremove/popï¼‰æ–¹æ³• LinkedListç±»å¸¸ç”¨æ–¹æ³•æµ‹è¯•ï¼š ç®€ä»‹ LinkedListæ˜¯ä¸€ä¸ªå®ç°äº†Listæ¥å£å’ŒDequeæ¥å£çš„åŒç«¯é“¾è¡¨ã€‚ LinkedListåº•å±‚çš„é“¾è¡¨ç»“æ„ä½¿å®ƒæ”¯æŒé«˜æ•ˆçš„æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œå¦å¤–å®ƒå®ç°äº†Dequeæ¥å£ï¼Œä½¿å¾—LinkedListç±»ä¹Ÿå…·æœ‰é˜Ÿåˆ—çš„ç‰¹æ€§; LinkedListä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¦‚æœæƒ³ä½¿LinkedListå˜æˆçº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥è°ƒç”¨é™æ€ç±»Collectionsç±»ä¸­çš„synchronizedListæ–¹æ³•ï¼š\n1 List list=Collections.synchronizedList(new LinkedList(...)); å†…éƒ¨ç»“æ„åˆ†æ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š çœ‹å®Œäº†å›¾ä¹‹åï¼Œæˆ‘ä»¬å†çœ‹LinkedListç±»ä¸­çš„ä¸€ä¸ªå†…éƒ¨ç§æœ‰ç±»Nodeå°±å¾ˆå¥½ç†è§£äº†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 private static class Node\u003cE\u003e { E item;//èŠ‚ç‚¹å€¼ Node\u003cE\u003e next;//åç»§èŠ‚ç‚¹ Node\u003cE\u003e prev;//å‰é©±èŠ‚ç‚¹ Node(Node\u003cE\u003e prev, E element, Node\u003cE\u003e next) { this.item = element; this.next = next; this.prev = prev; } } è¿™ä¸ªç±»å°±ä»£è¡¨åŒç«¯é“¾è¡¨çš„èŠ‚ç‚¹Nodeã€‚è¿™ä¸ªç±»æœ‰ä¸‰ä¸ªå±æ€§ï¼Œåˆ†åˆ«æ˜¯å‰é©±èŠ‚ç‚¹ï¼Œæœ¬èŠ‚ç‚¹çš„å€¼ï¼Œåç»§ç»“ç‚¹ã€‚\nLinkedListæºç åˆ†æ æ„é€ æ–¹æ³• ç©ºæ„é€ æ–¹æ³•ï¼š\n1 2 public LinkedList() { } ç”¨å·²æœ‰çš„é›†åˆåˆ›å»ºé“¾è¡¨çš„æ„é€ æ–¹æ³•ï¼š\n1 2 3 4 public LinkedList(Collection\u003c? extends E\u003e c) { this(); addAll(c); } addæ–¹æ³• add(E e) æ–¹æ³•ï¼šå°†å…ƒç´ æ·»åŠ åˆ°é“¾è¡¨å°¾éƒ¨\n1 2 3 4 public boolean add(E e) { linkLast(e);//è¿™é‡Œå°±åªè°ƒç”¨äº†è¿™ä¸€ä¸ªæ–¹æ³• return true; } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 /** * é“¾æ¥ä½¿eä½œä¸ºæœ€åä¸€ä¸ªå…ƒç´ ã€‚ */ void linkLast(E e) { final Node\u003cE\u003e l = last; final Node\u003cE\u003e newNode = new Node\u003c\u003e(l, e, null); last = newNode;//æ–°å»ºèŠ‚ç‚¹ if (l == null) first = newNode; else l.next = newNode;//æŒ‡å‘åç»§å…ƒç´ ä¹Ÿå°±æ˜¯æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´  size++; modCount++; } add(int index,E e)ï¼šåœ¨æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´ \n1 2 3 4 5 6 7 8 public void add(int index, E element) { checkPositionIndex(index); //æ£€æŸ¥ç´¢å¼•æ˜¯å¦å¤„äº[0-size]ä¹‹é—´ if (index == size)//æ·»åŠ åœ¨é“¾è¡¨å°¾éƒ¨ linkLast(element); else//æ·»åŠ åœ¨é“¾è¡¨ä¸­é—´ linkBefore(element, node(index)); } linkBeforeæ–¹æ³•éœ€è¦ç»™å®šä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ’å…¥èŠ‚ç‚¹çš„å€¼ï¼Œä¸€ä¸ªæŒ‡å®šçš„nodeï¼Œæ‰€ä»¥æˆ‘ä»¬åˆè°ƒç”¨äº†Node(index)å»æ‰¾åˆ°indexå¯¹åº”çš„node\naddAll(Collection c )ï¼šå°†é›†åˆæ’å…¥åˆ°é“¾è¡¨å°¾éƒ¨\n1 2 3 public boolean addAll(Collection\u003c? extends E\u003e c) { return addAll(size, c); } addAll(int index, Collection c)ï¼š å°†é›†åˆä»æŒ‡å®šä½ç½®å¼€å§‹æ’å…¥\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 public boolean addAll(int index, Collection\u003c? extends E\u003e c) { //1:æ£€æŸ¥indexèŒƒå›´æ˜¯å¦åœ¨sizeä¹‹å†… checkPositionIndex(index); //2:toArray()æ–¹æ³•æŠŠé›†åˆçš„æ•°æ®å­˜åˆ°å¯¹è±¡æ•°ç»„ä¸­ Object[] a = c.toArray(); int numNew = a.length; if (numNew == 0) return false; //3ï¼šå¾—åˆ°æ’å…¥ä½ç½®çš„å‰é©±èŠ‚ç‚¹å’Œåç»§èŠ‚ç‚¹ Node\u003cE\u003e pred, succ; //å¦‚æœæ’å…¥ä½ç½®ä¸ºå°¾éƒ¨ï¼Œå‰é©±èŠ‚ç‚¹ä¸ºlastï¼Œåç»§èŠ‚ç‚¹ä¸ºnull if (index == size) { succ = null; pred = last; } //å¦åˆ™ï¼Œè°ƒç”¨node()æ–¹æ³•å¾—åˆ°åç»§èŠ‚ç‚¹ï¼Œå†å¾—åˆ°å‰é©±èŠ‚ç‚¹ else { succ = node(index); pred = succ.prev; } // 4ï¼šéå†æ•°æ®å°†æ•°æ®æ’å…¥ for (Object o : a) { @SuppressWarnings(\"unchecked\") E e = (E) o; //åˆ›å»ºæ–°èŠ‚ç‚¹ Node\u003cE\u003e newNode = new Node\u003c\u003e(pred, e, null); //å¦‚æœæ’å…¥ä½ç½®åœ¨é“¾è¡¨å¤´éƒ¨ if (pred == null) first = newNode; else pred.next = newNode; pred = newNode; } //å¦‚æœæ’å…¥ä½ç½®åœ¨å°¾éƒ¨ï¼Œé‡ç½®lastèŠ‚ç‚¹ if (succ == null) { last = pred; } //å¦åˆ™ï¼Œå°†æ’å…¥çš„é“¾è¡¨ä¸å…ˆå‰é“¾è¡¨è¿æ¥èµ·æ¥ else { pred.next = succ; succ.prev = pred; } size += numNew; modCount++; return true; } ä¸Šé¢å¯ä»¥çœ‹å‡ºaddAllæ–¹æ³•é€šå¸¸åŒ…æ‹¬ä¸‹é¢å››ä¸ªæ­¥éª¤ï¼š\næ£€æŸ¥indexèŒƒå›´æ˜¯å¦åœ¨sizeä¹‹å†… toArray()æ–¹æ³•æŠŠé›†åˆçš„æ•°æ®å­˜åˆ°å¯¹è±¡æ•°ç»„ä¸­ å¾—åˆ°æ’å…¥ä½ç½®çš„å‰é©±å’Œåç»§èŠ‚ç‚¹ éå†æ•°æ®ï¼Œå°†æ•°æ®æ’å…¥åˆ°æŒ‡å®šä½ç½® addFirst(E e)ï¼š å°†å…ƒç´ æ·»åŠ åˆ°é“¾è¡¨å¤´éƒ¨\n1 2 3 public void addFirst(E e) { linkFirst(e); } 1 2 3 4 5 6 7 8 9 10 11 12 13 private void linkFirst(E e) { final Node\u003cE\u003e f = first; final Node\u003cE\u003e newNode = new Node\u003c\u003e(null, e, f);//æ–°å»ºèŠ‚ç‚¹ï¼Œä»¥å¤´èŠ‚ç‚¹ä¸ºåç»§èŠ‚ç‚¹ first = newNode; //å¦‚æœé“¾è¡¨ä¸ºç©ºï¼ŒlastèŠ‚ç‚¹ä¹ŸæŒ‡å‘è¯¥èŠ‚ç‚¹ if (f == null) last = newNode; //å¦åˆ™ï¼Œå°†å¤´èŠ‚ç‚¹çš„å‰é©±æŒ‡é’ˆæŒ‡å‘æ–°èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘å‰ä¸€ä¸ªå…ƒç´  else f.prev = newNode; size++; modCount++; } addLast(E e)ï¼š å°†å…ƒç´ æ·»åŠ åˆ°é“¾è¡¨å°¾éƒ¨ï¼Œä¸ add(E e) æ–¹æ³•ä¸€æ ·\n1 2 3 public void addLast(E e) { linkLast(e); } æ ¹æ®ä½ç½®å–æ•°æ®çš„æ–¹æ³• get(int index)ï¼š æ ¹æ®æŒ‡å®šç´¢å¼•è¿”å›æ•°æ®\n1 2 3 4 5 6 public E get(int index) { //æ£€æŸ¥indexèŒƒå›´æ˜¯å¦åœ¨sizeä¹‹å†… checkElementIndex(index); //è°ƒç”¨Node(index)å»æ‰¾åˆ°indexå¯¹åº”çš„nodeç„¶åè¿”å›å®ƒçš„å€¼ return node(index).item; } è·å–å¤´èŠ‚ç‚¹ï¼ˆindex=0ï¼‰æ•°æ®æ–¹æ³•:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 public E getFirst() { final Node\u003cE\u003e f = first; if (f == null) throw new NoSuchElementException(); return f.item; } public E element() { return getFirst(); } public E peek() { final Node\u003cE\u003e f = first; return (f == null) ? null : f.item; } public E peekFirst() { final Node\u003cE\u003e f = first; return (f == null) ? null : f.item; } åŒºåˆ«ï¼š getFirst(),element(),peek(),peekFirst() è¿™å››ä¸ªè·å–å¤´ç»“ç‚¹æ–¹æ³•çš„åŒºåˆ«åœ¨äºå¯¹é“¾è¡¨ä¸ºç©ºæ—¶çš„å¤„ç†ï¼Œæ˜¯æŠ›å‡ºå¼‚å¸¸è¿˜æ˜¯è¿”å›nullï¼Œå…¶ä¸­getFirst() å’Œelement() æ–¹æ³•å°†ä¼šåœ¨é“¾è¡¨ä¸ºç©ºæ—¶ï¼ŒæŠ›å‡ºå¼‚å¸¸\nelement()æ–¹æ³•çš„å†…éƒ¨å°±æ˜¯ä½¿ç”¨getFirst()å®ç°çš„ã€‚å®ƒä»¬ä¼šåœ¨é“¾è¡¨ä¸ºç©ºæ—¶ï¼ŒæŠ›å‡ºNoSuchElementException\nè·å–å°¾èŠ‚ç‚¹ï¼ˆindex=-1ï¼‰æ•°æ®æ–¹æ³•:\n1 2 3 4 5 6 7 8 9 10 public E getLast() { final Node\u003cE\u003e l = last; if (l == null) throw new NoSuchElementException(); return l.item; } public E peekLast() { final Node\u003cE\u003e l = last; return (l == null) ? null : l.item; } ä¸¤è€…åŒºåˆ«ï¼š getLast() æ–¹æ³•åœ¨é“¾è¡¨ä¸ºç©ºæ—¶ï¼Œä¼šæŠ›å‡ºNoSuchElementExceptionï¼Œè€ŒpeekLast() åˆ™ä¸ä¼šï¼Œåªæ˜¯ä¼šè¿”å› nullã€‚\næ ¹æ®å¯¹è±¡å¾—åˆ°ç´¢å¼•çš„æ–¹æ³• int indexOf(Object o)ï¼š ä»å¤´éå†æ‰¾\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public int indexOf(Object o) { int index = 0; if (o == null) { //ä»å¤´éå† for (Node\u003cE\u003e x = first; x != null; x = x.next) { if (x.item == null) return index; index++; } } else { //ä»å¤´éå† for (Node\u003cE\u003e x = first; x != null; x = x.next) { if (o.equals(x.item)) return index; index++; } } return -1; } int lastIndexOf(Object o)ï¼š ä»å°¾éå†æ‰¾\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public int lastIndexOf(Object o) { int index = size; if (o == null) { //ä»å°¾éå† for (Node\u003cE\u003e x = last; x != null; x = x.prev) { index--; if (x.item == null) return index; } } else { //ä»å°¾éå† for (Node\u003cE\u003e x = last; x != null; x = x.prev) { index--; if (o.equals(x.item)) return index; } } return -1; } æ£€æŸ¥é“¾è¡¨æ˜¯å¦åŒ…å«æŸå¯¹è±¡çš„æ–¹æ³•ï¼š contains(Object o)ï¼š æ£€æŸ¥å¯¹è±¡oæ˜¯å¦å­˜åœ¨äºé“¾è¡¨ä¸­\n1 2 3 public boolean contains(Object o) { return indexOf(o) != -1; } åˆ é™¤æ–¹æ³• remove() ,removeFirst(),pop(): åˆ é™¤å¤´èŠ‚ç‚¹\npublic E pop() { return removeFirst(); } public E remove() { return removeFirst(); } public E removeFirst() { final Node\u003cE\u003e f = first; if (f == null) throw new NoSuchElementException(); return unlinkFirst(f); } removeLast(),pollLast(): åˆ é™¤å°¾èŠ‚ç‚¹\n1 2 3 4 5 6 7 8 9 10 public E removeLast() { final Node\u003cE\u003e l = last; if (l == null) throw new NoSuchElementException(); return unlinkLast(l); } public E pollLast() { final Node\u003cE\u003e l = last; return (l == null) ? null : unlinkLast(l); } åŒºåˆ«ï¼š removeLast()åœ¨é“¾è¡¨ä¸ºç©ºæ—¶å°†æŠ›å‡ºNoSuchElementExceptionï¼Œè€ŒpollLast()æ–¹æ³•è¿”å›nullã€‚\nremove(Object o): åˆ é™¤æŒ‡å®šå…ƒç´ \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 public boolean remove(Object o) { //å¦‚æœåˆ é™¤å¯¹è±¡ä¸ºnull if (o == null) { //ä»å¤´å¼€å§‹éå† for (Node\u003cE\u003e x = first; x != null; x = x.next) { //æ‰¾åˆ°å…ƒç´  if (x.item == null) { //ä»é“¾è¡¨ä¸­ç§»é™¤æ‰¾åˆ°çš„å…ƒç´  unlink(x); return true; } } } else { //ä»å¤´å¼€å§‹éå† for (Node\u003cE\u003e x = first; x != null; x = x.next) { //æ‰¾åˆ°å…ƒç´  if (o.equals(x.item)) { //ä»é“¾è¡¨ä¸­ç§»é™¤æ‰¾åˆ°çš„å…ƒç´  unlink(x); return true; } } } return false; } å½“åˆ é™¤æŒ‡å®šå¯¹è±¡æ—¶ï¼Œåªéœ€è°ƒç”¨remove(Object o)å³å¯ï¼Œä¸è¿‡è¯¥æ–¹æ³•ä¸€æ¬¡åªä¼šåˆ é™¤ä¸€ä¸ªåŒ¹é…çš„å¯¹è±¡ï¼Œå¦‚æœåˆ é™¤äº†åŒ¹é…å¯¹è±¡ï¼Œè¿”å›trueï¼Œå¦åˆ™falseã€‚\nunlink(Node x) æ–¹æ³•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 E unlink(Node\u003cE\u003e x) { // assert x != null; final E element = x.item; final Node\u003cE\u003e next = x.next;//å¾—åˆ°åç»§èŠ‚ç‚¹ final Node\u003cE\u003e prev = x.prev;//å¾—åˆ°å‰é©±èŠ‚ç‚¹ //åˆ é™¤å‰é©±æŒ‡é’ˆ if (prev == null) { first = next;//å¦‚æœåˆ é™¤çš„èŠ‚ç‚¹æ˜¯å¤´èŠ‚ç‚¹,ä»¤å¤´èŠ‚ç‚¹æŒ‡å‘è¯¥èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ } else { prev.next = next;//å°†å‰é©±èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æŒ‡å‘åç»§èŠ‚ç‚¹ x.prev = null; } //åˆ é™¤åç»§æŒ‡é’ˆ if (next == null) { last = prev;//å¦‚æœåˆ é™¤çš„èŠ‚ç‚¹æ˜¯å°¾èŠ‚ç‚¹,ä»¤å°¾èŠ‚ç‚¹æŒ‡å‘è¯¥èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ } else { next.prev = prev; x.next = null; } x.item = null; size--; modCount++; return element; } remove(int index)ï¼šåˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ \n1 2 3 4 5 6 public E remove(int index) { //æ£€æŸ¥indexèŒƒå›´ checkElementIndex(index); //å°†èŠ‚ç‚¹åˆ é™¤ return unlink(node(index)); } LinkedListç±»å¸¸ç”¨æ–¹æ³•æµ‹è¯• 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 package list; import java.util.Iterator; import java.util.LinkedList; public class LinkedListDemo { public static void main(String[] srgs) { //åˆ›å»ºå­˜æ”¾intç±»å‹çš„linkedList LinkedList\u003cInteger\u003e linkedList = new LinkedList\u003c\u003e(); /************************** linkedListçš„åŸºæœ¬æ“ä½œ ************************/ linkedList.addFirst(0); // æ·»åŠ å…ƒç´ åˆ°åˆ—è¡¨å¼€å¤´ linkedList.add(1); // åœ¨åˆ—è¡¨ç»“å°¾æ·»åŠ å…ƒç´  linkedList.add(2, 2); // åœ¨æŒ‡å®šä½ç½®æ·»åŠ å…ƒç´  linkedList.addLast(3); // æ·»åŠ å…ƒç´ åˆ°åˆ—è¡¨ç»“å°¾ System.out.println(\"LinkedListï¼ˆç›´æ¥è¾“å‡ºçš„ï¼‰: \" + linkedList); System.out.println(\"getFirst()è·å¾—ç¬¬ä¸€ä¸ªå…ƒç´ : \" + linkedList.getFirst()); // è¿”å›æ­¤åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´  System.out.println(\"getLast()è·å¾—ç¬¬æœ€åä¸€ä¸ªå…ƒç´ : \" + linkedList.getLast()); // è¿”å›æ­¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´  System.out.println(\"removeFirst()åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ å¹¶è¿”å›: \" + linkedList.removeFirst()); // ç§»é™¤å¹¶è¿”å›æ­¤åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´  System.out.println(\"removeLast()åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›: \" + linkedList.removeLast()); // ç§»é™¤å¹¶è¿”å›æ­¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´  System.out.println(\"After remove:\" + linkedList); System.out.println(\"contains()æ–¹æ³•åˆ¤æ–­åˆ—è¡¨æ˜¯å¦åŒ…å«1è¿™ä¸ªå…ƒç´ :\" + linkedList.contains(1)); // åˆ¤æ–­æ­¤åˆ—è¡¨åŒ…å«æŒ‡å®šå…ƒç´ ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å›true System.out.println(\"è¯¥linkedListçš„å¤§å° : \" + linkedList.size()); // è¿”å›æ­¤åˆ—è¡¨çš„å…ƒç´ ä¸ªæ•° /************************** ä½ç½®è®¿é—®æ“ä½œ ************************/ System.out.println(\"-----------------------------------------\"); linkedList.set(1, 3); // å°†æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ æ›¿æ¢ä¸ºæŒ‡å®šçš„å…ƒç´  System.out.println(\"After set(1, 3):\" + linkedList); System.out.println(\"get(1)è·å¾—æŒ‡å®šä½ç½®ï¼ˆè¿™é‡Œä¸º1ï¼‰çš„å…ƒç´ : \" + linkedList.get(1)); // è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®å¤„çš„å…ƒç´  /************************** Searchæ“ä½œ ************************/ System.out.println(\"-----------------------------------------\"); linkedList.add(3); System.out.println(\"indexOf(3): \" + linkedList.indexOf(3)); // è¿”å›æ­¤åˆ—è¡¨ä¸­é¦–æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ çš„ç´¢å¼• System.out.println(\"lastIndexOf(3): \" + linkedList.lastIndexOf(3));// è¿”å›æ­¤åˆ—è¡¨ä¸­æœ€åå‡ºç°çš„æŒ‡å®šå…ƒç´ çš„ç´¢å¼• /************************** Queueæ“ä½œ ************************/ System.out.println(\"-----------------------------------------\"); System.out.println(\"peek(): \" + linkedList.peek()); // è·å–ä½†ä¸ç§»é™¤æ­¤åˆ—è¡¨çš„å¤´ System.out.println(\"element(): \" + linkedList.element()); // è·å–ä½†ä¸ç§»é™¤æ­¤åˆ—è¡¨çš„å¤´ linkedList.poll(); // è·å–å¹¶ç§»é™¤æ­¤åˆ—è¡¨çš„å¤´ System.out.println(\"After poll():\" + linkedList); linkedList.remove(); System.out.println(\"After remove():\" + linkedList); // è·å–å¹¶ç§»é™¤æ­¤åˆ—è¡¨çš„å¤´ linkedList.offer(4); System.out.println(\"After offer(4):\" + linkedList); // å°†æŒ‡å®šå…ƒç´ æ·»åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ /************************** Dequeæ“ä½œ ************************/ System.out.println(\"-----------------------------------------\"); linkedList.offerFirst(2); // åœ¨æ­¤åˆ—è¡¨çš„å¼€å¤´æ’å…¥æŒ‡å®šçš„å…ƒç´  System.out.println(\"After offerFirst(2):\" + linkedList); linkedList.offerLast(5); // åœ¨æ­¤åˆ—è¡¨æœ«å°¾æ’å…¥æŒ‡å®šçš„å…ƒç´  System.out.println(\"After offerLast(5):\" + linkedList); System.out.println(\"peekFirst(): \" + linkedList.peekFirst()); // è·å–ä½†ä¸ç§»é™¤æ­¤åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´  System.out.println(\"peekLast(): \" + linkedList.peekLast()); // è·å–ä½†ä¸ç§»é™¤æ­¤åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´  linkedList.pollFirst(); // è·å–å¹¶ç§»é™¤æ­¤åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´  System.out.println(\"After pollFirst():\" + linkedList); linkedList.pollLast(); // è·å–å¹¶ç§»é™¤æ­¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´  System.out.println(\"After pollLast():\" + linkedList); linkedList.push(2); // å°†å…ƒç´ æ¨å…¥æ­¤åˆ—è¡¨æ‰€è¡¨ç¤ºçš„å †æ ˆï¼ˆæ’å…¥åˆ°åˆ—è¡¨çš„å¤´ï¼‰ System.out.println(\"After push(2):\" + linkedList); linkedList.pop(); // ä»æ­¤åˆ—è¡¨æ‰€è¡¨ç¤ºçš„å †æ ˆå¤„å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼ˆè·å–å¹¶ç§»é™¤åˆ—è¡¨ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ System.out.println(\"After pop():\" + linkedList); linkedList.add(3); linkedList.removeFirstOccurrence(3); // ä»æ­¤åˆ—è¡¨ä¸­ç§»é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ ï¼ˆä»å¤´éƒ¨åˆ°å°¾éƒ¨éå†åˆ—è¡¨ï¼‰ System.out.println(\"After removeFirstOccurrence(3):\" + linkedList); linkedList.removeLastOccurrence(3); // ä»æ­¤åˆ—è¡¨ä¸­ç§»é™¤æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ ï¼ˆä»å¤´éƒ¨åˆ°å°¾éƒ¨éå†åˆ—è¡¨ï¼‰ System.out.println(\"After removeFirstOccurrence(3):\" + linkedList); /************************** éå†æ“ä½œ ************************/ System.out.println(\"-----------------------------------------\"); linkedList.clear(); for (int i = 0; i \u003c 100000; i++) { linkedList.add(i); } // è¿­ä»£å™¨éå† long start = System.currentTimeMillis(); Iterator\u003cInteger\u003e iterator = linkedList.iterator(); while (iterator.hasNext()) { iterator.next(); } long end = System.currentTimeMillis(); System.out.println(\"Iteratorï¼š\" + (end - start) + \" ms\"); // é¡ºåºéå†(éšæœºéå†) start = System.currentTimeMillis(); for (int i = 0; i \u003c linkedList.size(); i++) { linkedList.get(i); } end = System.currentTimeMillis(); System.out.println(\"forï¼š\" + (end - start) + \" ms\"); // å¦ä¸€ç§forå¾ªç¯éå† start = System.currentTimeMillis(); for (Integer i : linkedList) ; end = System.currentTimeMillis(); System.out.println(\"for2ï¼š\" + (end - start) + \" ms\"); // é€šè¿‡pollFirst()æˆ–pollLast()æ¥éå†LinkedList LinkedList\u003cInteger\u003e temp1 = new LinkedList\u003c\u003e(); temp1.addAll(linkedList); start = System.currentTimeMillis(); while (temp1.size() != 0) { temp1.pollFirst(); } end = System.currentTimeMillis(); System.out.println(\"pollFirst()æˆ–pollLast()ï¼š\" + (end - start) + \" ms\"); // é€šè¿‡removeFirst()æˆ–removeLast()æ¥éå†LinkedList LinkedList\u003cInteger\u003e temp2 = new LinkedList\u003c\u003e(); temp2.addAll(linkedList); start = System.currentTimeMillis(); while (temp2.size() != 0) { temp2.removeFirst(); } end = System.currentTimeMillis(); System.out.println(\"removeFirst()æˆ–removeLast()ï¼š\" + (end - start) + \" ms\"); } } ","description":"","tags":["linked-list"],"title":"\u003cJavaå®¹å™¨\u003e LinkedList","uri":"/blog/posts/Java/LinkedList/"},{"categories":["Java"],"content":"ä¸€ ä¸ºä»€ä¹ˆ Java ä¸­åªæœ‰å€¼ä¼ é€’ï¼Ÿ é¦–å…ˆå›é¡¾ä¸€ä¸‹åœ¨ç¨‹åºè®¾è®¡è¯­è¨€ä¸­æœ‰å…³å°†å‚æ•°ä¼ é€’ç»™æ–¹æ³•ï¼ˆæˆ–å‡½æ•°ï¼‰çš„ä¸€äº›ä¸“ä¸šæœ¯è¯­ã€‚æŒ‰å€¼è°ƒç”¨(call by value)è¡¨ç¤ºæ–¹æ³•æ¥æ”¶çš„æ˜¯è°ƒç”¨è€…æä¾›çš„å€¼ï¼Œè€ŒæŒ‰å¼•ç”¨è°ƒç”¨ï¼ˆcall by reference)è¡¨ç¤ºæ–¹æ³•æ¥æ”¶çš„æ˜¯è°ƒç”¨è€…æä¾›çš„å˜é‡åœ°å€ã€‚ä¸€ä¸ªæ–¹æ³•å¯ä»¥ä¿®æ”¹ä¼ é€’å¼•ç”¨æ‰€å¯¹åº”çš„å˜é‡å€¼ï¼Œè€Œä¸èƒ½ä¿®æ”¹ä¼ é€’å€¼è°ƒç”¨æ‰€å¯¹åº”çš„å˜é‡å€¼ã€‚ å®ƒç”¨æ¥æè¿°å„ç§ç¨‹åºè®¾è®¡è¯­è¨€ï¼ˆä¸åªæ˜¯Java)ä¸­æ–¹æ³•å‚æ•°ä¼ é€’æ–¹å¼ã€‚\nJavaç¨‹åºè®¾è®¡è¯­è¨€æ€»æ˜¯é‡‡ç”¨æŒ‰å€¼è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯æ‰€æœ‰å‚æ•°å€¼çš„ä¸€ä¸ªæ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¼ é€’ç»™å®ƒçš„ä»»ä½•å‚æ•°å˜é‡çš„å†…å®¹ã€‚\nä¸‹é¢é€šè¿‡ 3 ä¸ªä¾‹å­æ¥ç»™å¤§å®¶è¯´æ˜\nexample 1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 public static void main(String[] args) { int num1 = 10; int num2 = 20; swap(num1, num2); System.out.println(\"num1 = \" + num1); System.out.println(\"num2 = \" + num2); } public static void swap(int a, int b) { int temp = a; a = b; b = temp; System.out.println(\"a = \" + a); System.out.println(\"b = \" + b); } ç»“æœï¼š\na = 20 b = 10 num1 = 10 num2 = 20 è§£æï¼š\nåœ¨swapæ–¹æ³•ä¸­ï¼Œaã€bçš„å€¼è¿›è¡Œäº¤æ¢ï¼Œå¹¶ä¸ä¼šå½±å“åˆ° num1ã€num2ã€‚å› ä¸ºï¼Œaã€bä¸­çš„å€¼ï¼Œåªæ˜¯ä» num1ã€num2 çš„å¤åˆ¶è¿‡æ¥çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œaã€bç›¸å½“äºnum1ã€num2 çš„å‰¯æœ¬ï¼Œå‰¯æœ¬çš„å†…å®¹æ— è®ºæ€ä¹ˆä¿®æ”¹ï¼Œéƒ½ä¸ä¼šå½±å“åˆ°åŸä»¶æœ¬èº«ã€‚\né€šè¿‡ä¸Šé¢ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ä¸€ä¸ªæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„å‚æ•°ï¼Œè€Œå¯¹è±¡å¼•ç”¨ä½œä¸ºå‚æ•°å°±ä¸ä¸€æ ·ï¼Œè¯·çœ‹ example2.\nexample 2 1 2 3 4 5 6 7 8 9 10 11 public static void main(String[] args) { int[] arr = { 1, 2, 3, 4, 5 }; System.out.println(arr[0]); change(arr); System.out.println(arr[0]); } public static void change(int[] array) { // å°†æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ å˜ä¸º0 array[0] = 0; } ç»“æœï¼š\n1 0 è§£æï¼š\narray è¢«åˆå§‹åŒ– arr çš„æ‹·è´ä¹Ÿå°±æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ array å’Œ arr æŒ‡å‘çš„æ—¶åŒä¸€ä¸ªæ•°ç»„å¯¹è±¡ã€‚ å› æ­¤ï¼Œå¤–éƒ¨å¯¹å¼•ç”¨å¯¹è±¡çš„æ”¹å˜ä¼šåæ˜ åˆ°æ‰€å¯¹åº”çš„å¯¹è±¡ä¸Šã€‚\né€šè¿‡ example2 æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå®ç°ä¸€ä¸ªæ”¹å˜å¯¹è±¡å‚æ•°çŠ¶æ€çš„æ–¹æ³•å¹¶ä¸æ˜¯ä¸€ä»¶éš¾äº‹ã€‚ç†ç”±å¾ˆç®€å•ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯å¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œå¯¹è±¡å¼•ç”¨åŠå…¶ä»–çš„æ‹·è´åŒæ—¶å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ã€‚\nå¾ˆå¤šç¨‹åºè®¾è®¡è¯­è¨€ï¼ˆç‰¹åˆ«æ˜¯ï¼ŒC++å’ŒPascal)æä¾›äº†ä¸¤ç§å‚æ•°ä¼ é€’çš„æ–¹å¼ï¼šå€¼è°ƒç”¨å’Œå¼•ç”¨è°ƒç”¨ã€‚æœ‰äº›ç¨‹åºå‘˜ï¼ˆç”šè‡³æœ¬ä¹¦çš„ä½œè€…ï¼‰è®¤ä¸ºJavaç¨‹åºè®¾è®¡è¯­è¨€å¯¹å¯¹è±¡é‡‡ç”¨çš„æ˜¯å¼•ç”¨è°ƒç”¨ï¼Œå®é™…ä¸Šï¼Œè¿™ç§ç†è§£æ˜¯ä¸å¯¹çš„ã€‚ç”±äºè¿™ç§è¯¯è§£å…·æœ‰ä¸€å®šçš„æ™®éæ€§ï¼Œæ‰€ä»¥ä¸‹é¢ç»™å‡ºä¸€ä¸ªåä¾‹æ¥è¯¦ç»†åœ°é˜è¿°ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚\nexample 3 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 public class Test { public static void main(String[] args) { // TODO Auto-generated method stub Student s1 = new Student(\"å°å¼ \"); Student s2 = new Student(\"å°æ\"); Test.swap(s1, s2); System.out.println(\"s1:\" + s1.getName()); System.out.println(\"s2:\" + s2.getName()); } public static void swap(Student x, Student y) { Student temp = x; x = y; y = temp; System.out.println(\"x:\" + x.getName()); System.out.println(\"y:\" + y.getName()); } } ç»“æœï¼š\nx:å°æ y:å°å¼  s1:å°å¼  s2:å°æ è§£æï¼š\näº¤æ¢ä¹‹å‰ï¼š\näº¤æ¢ä¹‹åï¼š\né€šè¿‡ä¸Šé¢ä¸¤å¼ å›¾å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹å‡ºï¼š æ–¹æ³•å¹¶æ²¡æœ‰æ”¹å˜å­˜å‚¨åœ¨å˜é‡ s1 å’Œ s2 ä¸­çš„å¯¹è±¡å¼•ç”¨ã€‚swapæ–¹æ³•çš„å‚æ•°xå’Œyè¢«åˆå§‹åŒ–ä¸ºä¸¤ä¸ªå¯¹è±¡å¼•ç”¨çš„æ‹·è´ï¼Œè¿™ä¸ªæ–¹æ³•äº¤æ¢çš„æ˜¯è¿™ä¸¤ä¸ªæ‹·è´\næ€»ç»“ Javaç¨‹åºè®¾è®¡è¯­è¨€å¯¹å¯¹è±¡é‡‡ç”¨çš„ä¸æ˜¯å¼•ç”¨è°ƒç”¨ï¼Œå®é™…ä¸Šï¼Œå¯¹è±¡å¼•ç”¨æ˜¯æŒ‰ å€¼ä¼ é€’çš„ã€‚\nä¸‹é¢å†æ€»ç»“ä¸€ä¸‹Javaä¸­æ–¹æ³•å‚æ•°çš„ä½¿ç”¨æƒ…å†µï¼š\nä¸€ä¸ªæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„å‚æ•°ï¼ˆå³æ•°å€¼å‹æˆ–å¸ƒå°”å‹ã€‹ ä¸€ä¸ªæ–¹æ³•å¯ä»¥æ”¹å˜ä¸€ä¸ªå¯¹è±¡å‚æ•°çš„çŠ¶æ€ã€‚ ä¸€ä¸ªæ–¹æ³•ä¸èƒ½è®©å¯¹è±¡å‚æ•°å¼•ç”¨ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚ å‚è€ƒï¼š ã€ŠJavaæ ¸å¿ƒæŠ€æœ¯å·â… ã€‹åŸºç¡€çŸ¥è¯†ç¬¬åç‰ˆç¬¬å››ç« 4.5å°èŠ‚\näºŒ ==ä¸equals(é‡è¦) == : å®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯ä¸æ˜¯ç›¸ç­‰ã€‚å³ï¼Œåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚(åŸºæœ¬æ•°æ®ç±»å‹==æ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¼•ç”¨æ•°æ®ç±»å‹==æ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€)\nequals() : å®ƒçš„ä½œç”¨ä¹Ÿæ˜¯åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸ç­‰ã€‚ä½†å®ƒä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š\næƒ…å†µ1ï¼šç±»æ²¡æœ‰è¦†ç›–equals()æ–¹æ³•ã€‚åˆ™é€šè¿‡equals()æ¯”è¾ƒè¯¥ç±»çš„ä¸¤ä¸ªå¯¹è±¡æ—¶ï¼Œç­‰ä»·äºé€šè¿‡â€œ==â€æ¯”è¾ƒè¿™ä¸¤ä¸ªå¯¹è±¡ã€‚ æƒ…å†µ2ï¼šç±»è¦†ç›–äº†equals()æ–¹æ³•ã€‚ä¸€èˆ¬ï¼Œæˆ‘ä»¬éƒ½è¦†ç›–equals()æ–¹æ³•æ¥ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹ç›¸ç­‰ï¼›è‹¥å®ƒä»¬çš„å†…å®¹ç›¸ç­‰ï¼Œåˆ™è¿”å›true(å³ï¼Œè®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰)ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 public class test1 { public static void main(String[] args) { String a = new String(\"ab\"); // a ä¸ºä¸€ä¸ªå¼•ç”¨ String b = new String(\"ab\"); // bä¸ºå¦ä¸€ä¸ªå¼•ç”¨,å¯¹è±¡çš„å†…å®¹ä¸€æ · String aa = \"ab\"; // æ”¾åœ¨å¸¸é‡æ± ä¸­ String bb = \"ab\"; // ä»å¸¸é‡æ± ä¸­æŸ¥æ‰¾ if (aa == bb) // true System.out.println(\"aa==bb\"); if (a == b) // falseï¼ŒéåŒä¸€å¯¹è±¡ System.out.println(\"a==b\"); if (a.equals(b)) // true System.out.println(\"aEQb\"); if (42 == 42.0) { // true System.out.println(\"true\"); } } } è¯´æ˜ï¼š\nStringä¸­çš„equalsæ–¹æ³•æ˜¯è¢«é‡å†™è¿‡çš„ï¼Œå› ä¸ºobjectçš„equalsæ–¹æ³•æ˜¯æ¯”è¾ƒçš„å¯¹è±¡çš„å†…å­˜åœ°å€ï¼Œè€ŒStringçš„equalsæ–¹æ³•æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å€¼ã€‚ å½“åˆ›å»ºStringç±»å‹çš„å¯¹è±¡æ—¶ï¼Œè™šæ‹Ÿæœºä¼šåœ¨å¸¸é‡æ± ä¸­æŸ¥æ‰¾æœ‰æ²¡æœ‰å·²ç»å­˜åœ¨çš„å€¼å’Œè¦åˆ›å»ºçš„å€¼ç›¸åŒçš„å¯¹è±¡ï¼Œå¦‚æœæœ‰å°±æŠŠå®ƒèµ‹ç»™å½“å‰å¼•ç”¨ã€‚å¦‚æœæ²¡æœ‰å°±åœ¨å¸¸é‡æ± ä¸­é‡æ–°åˆ›å»ºä¸€ä¸ªStringå¯¹è±¡ã€‚ ä¸‰ hashCodeä¸equalsï¼ˆé‡è¦ï¼‰ é¢è¯•å®˜å¯èƒ½ä¼šé—®ä½ ï¼šâ€œä½ é‡å†™è¿‡ hashcode å’Œ equals ä¹ˆï¼Œä¸ºä»€ä¹ˆé‡å†™equalsæ—¶å¿…é¡»é‡å†™hashCodeæ–¹æ³•ï¼Ÿâ€\nhashCodeï¼ˆï¼‰ä»‹ç» hashCode() çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ï¼›å®ƒå®é™…ä¸Šæ˜¯è¿”å›ä¸€ä¸ªintæ•´æ•°ã€‚è¿™ä¸ªå“ˆå¸Œç çš„ä½œç”¨æ˜¯ç¡®å®šè¯¥å¯¹è±¡åœ¨å“ˆå¸Œè¡¨ä¸­çš„ç´¢å¼•ä½ç½®ã€‚hashCode() å®šä¹‰åœ¨JDKçš„Object.javaä¸­ï¼Œè¿™å°±æ„å‘³ç€Javaä¸­çš„ä»»ä½•ç±»éƒ½åŒ…å«æœ‰hashCode() å‡½æ•°ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼š Object çš„ hashcode æ–¹æ³•æ˜¯æœ¬åœ°æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨ c è¯­è¨€æˆ– c++ å®ç°çš„ï¼Œè¯¥æ–¹æ³•é€šå¸¸ç”¨æ¥å°†å¯¹è±¡çš„ å†…å­˜åœ°å€ è½¬æ¢ä¸ºæ•´æ•°ä¹‹åè¿”å›ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 /** * Returns a hash code value for the object. This method is * supported for the benefit of hash tables such as those provided by * {@link java.util.HashMap}. * \u003cp\u003e * As much as is reasonably practical, the hashCode method defined by * class {@code Object} does return distinct integers for distinct * objects. (This is typically implemented by converting the internal * address of the object into an integer, but this implementation * technique is not required by the * Java\u0026trade; programming language.) * * @return a hash code value for this object. * @see java.lang.Object#equals(java.lang.Object) * @see java.lang.System#identityHashCode */ public native int hashCode(); æ•£åˆ—è¡¨å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹(key-value)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šèƒ½æ ¹æ®â€œé”®â€å¿«é€Ÿçš„æ£€ç´¢å‡ºå¯¹åº”çš„â€œå€¼â€ã€‚è¿™å…¶ä¸­å°±åˆ©ç”¨åˆ°äº†æ•£åˆ—ç ï¼ï¼ˆå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€è¦çš„å¯¹è±¡ï¼‰\nä¸ºä»€ä¹ˆè¦æœ‰hashCode æˆ‘ä»¬ä»¥â€œHashSetå¦‚ä½•æ£€æŸ¥é‡å¤â€ä¸ºä¾‹å­æ¥è¯´æ˜ä¸ºä»€ä¹ˆè¦æœ‰hashCodeï¼š\nå½“ä½ æŠŠå¯¹è±¡åŠ å…¥HashSetæ—¶ï¼ŒHashSetä¼šå…ˆè®¡ç®—å¯¹è±¡çš„hashcodeå€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸å…¶ä»–å·²ç»åŠ å…¥çš„å¯¹è±¡çš„hashcodeå€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„hashcodeï¼ŒHashSetä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒhashcodeå€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨equalsï¼ˆï¼‰æ–¹æ³•æ¥æ£€æŸ¥hashcodeç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼ŒHashSetå°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚ï¼ˆæ‘˜è‡ªæˆ‘çš„Javaå¯è’™ä¹¦ã€ŠHead fist javaã€‹ç¬¬äºŒç‰ˆï¼‰ã€‚è¿™æ ·æˆ‘ä»¬å°±å¤§å¤§å‡å°‘äº†equalsçš„æ¬¡æ•°ï¼Œç›¸åº”å°±å¤§å¤§æé«˜äº†æ‰§è¡Œé€Ÿåº¦ã€‚\nhashCodeï¼ˆï¼‰ä¸equalsï¼ˆï¼‰çš„ç›¸å…³è§„å®š å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œåˆ™hashcodeä¸€å®šä¹Ÿæ˜¯ç›¸åŒçš„ ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰,å¯¹ä¸¤ä¸ªå¯¹è±¡åˆ†åˆ«è°ƒç”¨equalsæ–¹æ³•éƒ½è¿”å›true ä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„hashcodeå€¼ï¼Œå®ƒä»¬ä¹Ÿä¸ä¸€å®šæ˜¯ç›¸ç­‰çš„ å› æ­¤ï¼Œequalsæ–¹æ³•è¢«è¦†ç›–è¿‡ï¼Œåˆ™hashCodeæ–¹æ³•ä¹Ÿå¿…é¡»è¢«è¦†ç›– hashCode()çš„é»˜è®¤è¡Œä¸ºæ˜¯å¯¹å †ä¸Šçš„å¯¹è±¡äº§ç”Ÿç‹¬ç‰¹å€¼ã€‚å¦‚æœæ²¡æœ‰é‡å†™hashCode()ï¼Œåˆ™è¯¥classçš„ä¸¤ä¸ªå¯¹è±¡æ— è®ºå¦‚ä½•éƒ½ä¸ä¼šç›¸ç­‰ï¼ˆå³ä½¿è¿™ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘ç›¸åŒçš„æ•°æ®ï¼‰ ä¸ºä»€ä¹ˆä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„hashcodeå€¼ï¼Œå®ƒä»¬ä¹Ÿä¸ä¸€å®šæ˜¯ç›¸ç­‰çš„ï¼Ÿ åœ¨è¿™é‡Œè§£é‡Šä¸€ä½å°ä¼™ä¼´çš„é—®é¢˜ã€‚ä»¥ä¸‹å†…å®¹æ‘˜è‡ªã€ŠHead Fisrt Javaã€‹ã€‚\nå› ä¸ºhashCode() æ‰€ä½¿ç”¨çš„æ‚å‡‘ç®—æ³•ä¹Ÿè®¸åˆšå¥½ä¼šè®©å¤šä¸ªå¯¹è±¡ä¼ å›ç›¸åŒçš„æ‚å‡‘å€¼ã€‚è¶Šç³Ÿç³•çš„æ‚å‡‘ç®—æ³•è¶Šå®¹æ˜“ç¢°æ’ï¼Œä½†è¿™ä¹Ÿä¸æ•°æ®å€¼åŸŸåˆ†å¸ƒçš„ç‰¹æ€§æœ‰å…³ï¼ˆæ‰€è°“ç¢°æ’ä¹Ÿå°±æ˜¯æŒ‡çš„æ˜¯ä¸åŒçš„å¯¹è±¡å¾—åˆ°ç›¸åŒçš„ hashCodeï¼‰ã€‚\næˆ‘ä»¬åˆšåˆšä¹Ÿæåˆ°äº† HashSet,å¦‚æœ HashSet åœ¨å¯¹æ¯”çš„æ—¶å€™ï¼ŒåŒæ ·çš„ hashcode æœ‰å¤šä¸ªå¯¹è±¡ï¼Œå®ƒä¼šä½¿ç”¨ equals() æ¥åˆ¤æ–­æ˜¯å¦çœŸçš„ç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ hashcode åªæ˜¯ç”¨æ¥ç¼©å°æŸ¥æ‰¾æˆæœ¬ã€‚\nå‚è€ƒï¼š\nhttps://blog.csdn.net/zhzhao999/article/details/53449504\nhttps://www.cnblogs.com/skywang12345/p/3324958.html\nhttps://www.cnblogs.com/skywang12345/p/3324958.html\nhttps://www.cnblogs.com/Eason-S/p/5524837.html\n","description":"","tags":["interview-questions"],"title":"Javaå¸¸è§é—®é¢˜æ±‡æ€»-1","uri":"/blog/posts/Java/common-questions/"},{"categories":["Java"],"content":"Stringå’ŒStringBufferã€StringBuilderçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼ŸStringä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„ï¼Ÿ Stringå’ŒStringBufferã€StringBuilderçš„åŒºåˆ« å¯å˜æ€§ ç®€å•çš„æ¥è¯´ï¼šString ç±»ä¸­ä½¿ç”¨ final å…³é”®å­—å­—ç¬¦æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²ï¼Œprivateã€€finalã€€charã€€value[]ï¼Œæ‰€ä»¥ String å¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚è€ŒStringBuilder ä¸ StringBuffer éƒ½ç»§æ‰¿è‡ª AbstractStringBuilder ç±»ï¼Œåœ¨ AbstractStringBuilder ä¸­ä¹Ÿæ˜¯ä½¿ç”¨å­—ç¬¦æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²char[]value ä½†æ˜¯æ²¡æœ‰ç”¨ final å…³é”®å­—ä¿®é¥°ï¼Œæ‰€ä»¥è¿™ä¸¤ç§å¯¹è±¡éƒ½æ˜¯å¯å˜çš„ã€‚\nStringBuilder ä¸ StringBuffer çš„æ„é€ æ–¹æ³•éƒ½æ˜¯è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•ä¹Ÿå°±æ˜¯ AbstractStringBuilder å®ç°çš„ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡ŒæŸ¥é˜…æºç ã€‚\nAbstractStringBuilder.java\n1 2 3 4 5 6 7 8 abstract class AbstractStringBuilder implements Appendable, CharSequence { char[] value; int count; AbstractStringBuilder() { } AbstractStringBuilder(int capacity) { value = new char[capacity]; } çº¿ç¨‹å®‰å…¨æ€§\nString ä¸­çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±å¯ä»¥ç†è§£ä¸ºå¸¸é‡ï¼Œçº¿ç¨‹å®‰å…¨ã€‚AbstractStringBuilder æ˜¯ StringBuilder ä¸ StringBuffer çš„å…¬å…±çˆ¶ç±»ï¼Œå®šä¹‰äº†ä¸€äº›å­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œï¼Œå¦‚ expandCapacityã€appendã€insertã€indexOf ç­‰å…¬å…±æ–¹æ³•ã€‚StringBuffer å¯¹æ–¹æ³•åŠ äº†åŒæ­¥é”æˆ–è€…å¯¹è°ƒç”¨çš„æ–¹æ³•åŠ äº†åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚StringBuilder å¹¶æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡ŒåŠ åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚ æ€§èƒ½\næ¯æ¬¡å¯¹ String ç±»å‹è¿›è¡Œæ”¹å˜çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ String å¯¹è±¡ï¼Œç„¶åå°†æŒ‡é’ˆæŒ‡å‘æ–°çš„ String å¯¹è±¡ã€‚StringBuffer æ¯æ¬¡éƒ½ä¼šå¯¹ StringBuffer å¯¹è±¡æœ¬èº«è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯ç”Ÿæˆæ–°çš„å¯¹è±¡å¹¶æ”¹å˜å¯¹è±¡å¼•ç”¨ã€‚ç›¸åŒæƒ…å†µä¸‹ä½¿ç”¨ StirngBuilder ç›¸æ¯”ä½¿ç”¨ StringBuffer ä»…èƒ½è·å¾— 10%~15% å·¦å³çš„æ€§èƒ½æå‡ï¼Œä½†å´è¦å†’å¤šçº¿ç¨‹ä¸å®‰å…¨çš„é£é™©ã€‚\nå¯¹äºä¸‰è€…ä½¿ç”¨çš„æ€»ç»“ï¼š\næ“ä½œå°‘é‡çš„æ•°æ® = String å•çº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ® = StringBuilder å¤šçº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ® = StringBuffer Stringä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„å—ï¼Ÿ ç®€å•æ¥è¯´å°±æ˜¯Stringç±»åˆ©ç”¨äº†finalä¿®é¥°çš„charç±»å‹æ•°ç»„å­˜å‚¨å­—ç¬¦ï¼Œæºç å¦‚ä¸‹å›¾æ‰€ä»¥ï¼š\n1 2 /** The value is used for character storage. */ private final char value[]; StringçœŸçš„æ˜¯ä¸å¯å˜çš„å—ï¼Ÿ æˆ‘è§‰å¾—å¦‚æœåˆ«äººé—®è¿™ä¸ªé—®é¢˜çš„è¯ï¼Œå›ç­”ä¸å¯å˜å°±å¯ä»¥äº†ã€‚ ä¸‹é¢åªæ˜¯ç»™å¤§å®¶çœ‹ä¸¤ä¸ªæœ‰ä»£è¡¨æ€§çš„ä¾‹å­ï¼š\n1) Stringä¸å¯å˜ä½†ä¸ä»£è¡¨å¼•ç”¨ä¸å¯ä»¥å˜\n1 2 3 String str = \"Hello\"; str = str + \" World\"; System.out.println(\"str=\" + str); ç»“æœï¼š\nstr=Hello World è§£æï¼š\nå®é™…ä¸Šï¼ŒåŸæ¥Stringçš„å†…å®¹æ˜¯ä¸å˜çš„ï¼Œåªæ˜¯strç”±åŸæ¥æŒ‡å‘\"Hello\"çš„å†…å­˜åœ°å€è½¬ä¸ºæŒ‡å‘\"Hello World\"çš„å†…å­˜åœ°å€è€Œå·²ï¼Œä¹Ÿå°±æ˜¯è¯´å¤šå¼€è¾Ÿäº†ä¸€å—å†…å­˜åŒºåŸŸç»™\"Hello World\"å­—ç¬¦ä¸²ã€‚\n2) é€šè¿‡åå°„æ˜¯å¯ä»¥ä¿®æ”¹æ‰€è°“çš„â€œä¸å¯å˜â€å¯¹è±¡\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 // åˆ›å»ºå­—ç¬¦ä¸²\"Hello World\"ï¼Œ å¹¶èµ‹ç»™å¼•ç”¨s String s = \"Hello World\"; System.out.println(\"s = \" + s); // Hello World // è·å–Stringç±»ä¸­çš„valueå­—æ®µ Field valueFieldOfString = String.class.getDeclaredField(\"value\"); // æ”¹å˜valueå±æ€§çš„è®¿é—®æƒé™ valueFieldOfString.setAccessible(true); // è·å–så¯¹è±¡ä¸Šçš„valueå±æ€§çš„å€¼ char[] value = (char[]) valueFieldOfString.get(s); // æ”¹å˜valueæ‰€å¼•ç”¨çš„æ•°ç»„ä¸­çš„ç¬¬5ä¸ªå­—ç¬¦ value[5] = '_'; System.out.println(\"s = \" + s); // Hello_World ç»“æœï¼š\ns = Hello World s = Hello_World è§£æï¼š\nç”¨åå°„å¯ä»¥è®¿é—®ç§æœ‰æˆå‘˜ï¼Œ ç„¶ååå°„å‡ºStringå¯¹è±¡ä¸­çš„valueå±æ€§ï¼Œ è¿›è€Œæ”¹å˜é€šè¿‡è·å¾—çš„valueå¼•ç”¨æ”¹å˜æ•°ç»„çš„ç»“æ„ã€‚ä½†æ˜¯ä¸€èˆ¬æˆ‘ä»¬ä¸ä¼šè¿™ä¹ˆåšï¼Œè¿™é‡Œåªæ˜¯ç®€å•æä¸€ä¸‹æœ‰è¿™ä¸ªä¸œè¥¿ã€‚\nä»€ä¹ˆæ˜¯åå°„æœºåˆ¶ï¼Ÿåå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ åå°„æœºåˆ¶ä»‹ç» JAVAåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–çš„ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚\né™æ€ç¼–è¯‘å’ŒåŠ¨æ€ç¼–è¯‘ **é™æ€ç¼–è¯‘ï¼š**åœ¨ç¼–è¯‘æ—¶ç¡®å®šç±»å‹ï¼Œç»‘å®šå¯¹è±¡ **åŠ¨æ€ç¼–è¯‘ï¼š**è¿è¡Œæ—¶ç¡®å®šç±»å‹ï¼Œç»‘å®šå¯¹è±¡ åå°„æœºåˆ¶ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼š è¿è¡ŒæœŸç±»å‹çš„åˆ¤æ–­ï¼ŒåŠ¨æ€åŠ è½½ç±»ï¼Œæé«˜ä»£ç çµæ´»åº¦ã€‚ ç¼ºç‚¹ï¼š æ€§èƒ½ç“¶é¢ˆï¼šåå°„ç›¸å½“äºä¸€ç³»åˆ—è§£é‡Šæ“ä½œï¼Œé€šçŸ¥ JVM è¦åšçš„äº‹æƒ…ï¼Œæ€§èƒ½æ¯”ç›´æ¥çš„javaä»£ç è¦æ…¢å¾ˆå¤šã€‚ åå°„çš„åº”ç”¨åœºæ™¯ åå°„æ˜¯æ¡†æ¶è®¾è®¡çš„çµé­‚ã€‚\nåœ¨æˆ‘ä»¬å¹³æ—¶çš„é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼ŒåŸºæœ¬ä¸Šå¾ˆå°‘ä¼šç›´æ¥ä½¿ç”¨åˆ°åå°„æœºåˆ¶ï¼Œä½†è¿™ä¸èƒ½è¯´æ˜åå°„æœºåˆ¶æ²¡æœ‰ç”¨ï¼Œå®é™…ä¸Šæœ‰å¾ˆå¤šè®¾è®¡ã€å¼€å‘éƒ½ä¸åå°„æœºåˆ¶æœ‰å…³ï¼Œä¾‹å¦‚æ¨¡å—åŒ–çš„å¼€å‘ï¼Œé€šè¿‡åå°„å»è°ƒç”¨å¯¹åº”çš„å­—èŠ‚ç ï¼›åŠ¨æ€ä»£ç†è®¾è®¡æ¨¡å¼ä¹Ÿé‡‡ç”¨äº†åå°„æœºåˆ¶ï¼Œè¿˜æœ‰æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„ Springï¼Hibernate ç­‰æ¡†æ¶ä¹Ÿå¤§é‡ä½¿ç”¨åˆ°äº†åå°„æœºåˆ¶ã€‚\nä¸¾ä¾‹ï¼šâ‘ æˆ‘ä»¬åœ¨ä½¿ç”¨JDBCè¿æ¥æ•°æ®åº“æ—¶ä½¿ç”¨Class.forName()é€šè¿‡åå°„åŠ è½½æ•°æ®åº“çš„é©±åŠ¨ç¨‹åºï¼›â‘¡Springæ¡†æ¶ä¹Ÿç”¨åˆ°å¾ˆå¤šåå°„æœºåˆ¶ï¼Œæœ€ç»å…¸çš„å°±æ˜¯xmlçš„é…ç½®æ¨¡å¼ã€‚Spring é€šè¿‡ XML é…ç½®æ¨¡å¼è£…è½½ Bean çš„è¿‡ç¨‹ï¼š1) å°†ç¨‹åºå†…æ‰€æœ‰ XML æˆ– Properties é…ç½®æ–‡ä»¶åŠ è½½å…¥å†…å­˜ä¸­; 2)Javaç±»é‡Œé¢è§£æxmlæˆ–propertiesé‡Œé¢çš„å†…å®¹ï¼Œå¾—åˆ°å¯¹åº”å®ä½“ç±»çš„å­—èŠ‚ç å­—ç¬¦ä¸²ä»¥åŠç›¸å…³çš„å±æ€§ä¿¡æ¯; 3)ä½¿ç”¨åå°„æœºåˆ¶ï¼Œæ ¹æ®è¿™ä¸ªå­—ç¬¦ä¸²è·å¾—æŸä¸ªç±»çš„Classå®ä¾‹; 4)åŠ¨æ€é…ç½®å®ä¾‹çš„å±æ€§\næ¨èé˜…è¯»ï¼š\nReflectionï¼šJavaåå°„æœºåˆ¶çš„åº”ç”¨åœºæ™¯ JavaåŸºç¡€ä¹‹â€”åå°„ï¼ˆéå¸¸é‡è¦ï¼‰ ä»€ä¹ˆæ˜¯JDK?ä»€ä¹ˆæ˜¯JREï¼Ÿä»€ä¹ˆæ˜¯JVMï¼Ÿä¸‰è€…ä¹‹é—´çš„è”ç³»ä¸åŒºåˆ« è¿™å‡ ä¸ªæ˜¯Javaä¸­å¾ˆåŸºæœ¬å¾ˆåŸºæœ¬çš„ä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡ä¸€å®šè¿˜æœ‰å¾ˆå¤šäººæä¸æ¸…æ¥šï¼ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬å¤§å¤šæ•°æ—¶å€™åœ¨ä½¿ç”¨ç°æˆçš„ç¼–è¯‘å·¥å…·ä»¥åŠç¯å¢ƒçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰å»è€ƒè™‘è¿™äº›ä¸œè¥¿ã€‚\nJDK: é¡¾åæ€ä¹‰å®ƒæ˜¯ç»™å¼€å‘è€…æä¾›çš„å¼€å‘å·¥å…·ç®±,æ˜¯ç»™ç¨‹åºå¼€å‘è€…ç”¨çš„ã€‚å®ƒé™¤äº†åŒ…æ‹¬å®Œæ•´çš„JREï¼ˆJava Runtime Environmentï¼‰ï¼ŒJavaè¿è¡Œç¯å¢ƒï¼Œè¿˜åŒ…å«äº†å…¶ä»–ä¾›å¼€å‘è€…ä½¿ç”¨çš„å·¥å…·åŒ…ã€‚\nJRE: æ™®é€šç”¨æˆ·è€Œåªéœ€è¦å®‰è£…JREï¼ˆJava Runtime Environmentï¼‰æ¥è¿è¡ŒJavaç¨‹åºã€‚è€Œç¨‹åºå¼€å‘è€…å¿…é¡»å®‰è£…JDKæ¥ç¼–è¯‘ã€è°ƒè¯•ç¨‹åºã€‚\nJVMï¼š å½“æˆ‘ä»¬è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼ŒJVMè´Ÿè´£å°†å­—èŠ‚ç è½¬æ¢ä¸ºç‰¹å®šæœºå™¨ä»£ç ï¼ŒJVMæä¾›äº†å†…å­˜ç®¡ç†/åƒåœ¾å›æ”¶å’Œå®‰å…¨æœºåˆ¶ç­‰ã€‚è¿™ç§ç‹¬ç«‹äºç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿï¼Œæ­£æ˜¯javaç¨‹åºå¯ä»¥ä¸€æ¬¡ç¼–å†™å¤šå¤„æ‰§è¡Œçš„åŸå› ã€‚\nåŒºåˆ«ä¸è”ç³»ï¼š\nJDKç”¨äºå¼€å‘ï¼ŒJREç”¨äºè¿è¡Œjavaç¨‹åº ï¼› JDKå’ŒJREä¸­éƒ½åŒ…å«JVM ï¼› JVMæ˜¯javaç¼–ç¨‹è¯­è¨€çš„æ ¸å¿ƒå¹¶ä¸”å…·æœ‰å¹³å°ç‹¬ç«‹æ€§ã€‚ ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼Ÿé‡‡ç”¨å­—èŠ‚ç çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ å…ˆçœ‹ä¸‹javaä¸­çš„ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨ï¼š Javaä¸­å¼•å…¥äº†è™šæ‹Ÿæœºçš„æ¦‚å¿µï¼Œå³åœ¨æœºå™¨å’Œç¼–è¯‘ç¨‹åºä¹‹é—´åŠ å…¥äº†ä¸€å±‚æŠ½è±¡çš„è™šæ‹Ÿçš„æœºå™¨ã€‚è¿™å°è™šæ‹Ÿçš„æœºå™¨åœ¨ä»»ä½•å¹³å°ä¸Šéƒ½æä¾›ç»™ç¼–è¯‘ç¨‹åºä¸€ä¸ªçš„å…±åŒçš„æ¥å£ã€‚ç¼–è¯‘ç¨‹åºåªéœ€è¦é¢å‘è™šæ‹Ÿæœºï¼Œç”Ÿæˆè™šæ‹Ÿæœºèƒ½å¤Ÿç†è§£çš„ä»£ç ï¼Œç„¶åç”±è§£é‡Šå™¨æ¥å°†è™šæ‹Ÿæœºä»£ç è½¬æ¢ä¸ºç‰¹å®šç³»ç»Ÿçš„æœºå™¨ç æ‰§è¡Œã€‚åœ¨Javaä¸­ï¼Œè¿™ç§ä¾›è™šæ‹Ÿæœºç†è§£çš„ä»£ç å«åšå­—èŠ‚ç ï¼ˆå³æ‰©å±•åä¸º.classçš„æ–‡ä»¶ï¼‰ï¼Œå®ƒä¸é¢å‘ä»»ä½•ç‰¹å®šçš„å¤„ç†å™¨ï¼Œåªé¢å‘è™šæ‹Ÿæœºã€‚æ¯ä¸€ç§å¹³å°çš„è§£é‡Šå™¨æ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯å®ç°çš„è™šæ‹Ÿæœºæ˜¯ç›¸åŒçš„ã€‚Javaæºç¨‹åºç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘åå˜æˆå­—èŠ‚ç ï¼Œå­—èŠ‚ç ç”±è™šæ‹Ÿæœºè§£é‡Šæ‰§è¡Œï¼Œè™šæ‹Ÿæœºå°†æ¯ä¸€æ¡è¦æ‰§è¡Œçš„å­—èŠ‚ç é€ç»™è§£é‡Šå™¨ï¼Œè§£é‡Šå™¨å°†å…¶ç¿»è¯‘æˆç‰¹å®šæœºå™¨ä¸Šçš„æœºå™¨ç ï¼Œç„¶ååœ¨ç‰¹å®šçš„æœºå™¨ä¸Šè¿è¡Œã€‚è¿™ä¹Ÿå°±æ˜¯è§£é‡Šäº†Javaçš„ç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜çš„ç‰¹ç‚¹ã€‚\nJavaæºä»£ç ----\u003eç¼–è¯‘å™¨----\u003ejvmå¯æ‰§è¡Œçš„Javaå­—èŠ‚ç (å³è™šæ‹ŸæŒ‡ä»¤)----\u003ejvm----\u003ejvmä¸­è§£é‡Šå™¨-----\u003eæœºå™¨å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æœºå™¨ç ----\u003eç¨‹åºè¿è¡Œã€‚\né‡‡ç”¨å­—èŠ‚ç çš„å¥½å¤„ï¼š Javaè¯­è¨€é€šè¿‡å­—èŠ‚ç çš„æ–¹å¼ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†ä¼ ç»Ÿè§£é‡Šå‹è¯­è¨€æ‰§è¡Œæ•ˆç‡ä½çš„é—®é¢˜ï¼ŒåŒæ—¶åˆä¿ç•™äº†è§£é‡Šå‹è¯­è¨€å¯ç§»æ¤çš„ç‰¹ç‚¹ã€‚æ‰€ä»¥Javaç¨‹åºè¿è¡Œæ—¶æ¯”è¾ƒé«˜æ•ˆï¼Œè€Œä¸”ï¼Œç”±äºå­—èŠ‚ç å¹¶ä¸ä¸“å¯¹ä¸€ç§ç‰¹å®šçš„æœºå™¨ï¼Œå› æ­¤ï¼ŒJavaç¨‹åºæ— é¡»é‡æ–°ç¼–è¯‘ä¾¿å¯åœ¨å¤šç§ä¸åŒçš„è®¡ç®—æœºä¸Šè¿è¡Œã€‚\nJavaå’ŒC++çš„åŒºåˆ« æˆ‘çŸ¥é“å¾ˆå¤šäººæ²¡å­¦è¿‡C++ï¼Œä½†æ˜¯é¢è¯•å®˜å°±æ˜¯æ²¡äº‹å–œæ¬¢æ‹¿å’±ä»¬Javaå’ŒC++æ¯”å‘€ï¼æ²¡åŠæ³•ï¼ï¼ï¼å°±ç®—æ²¡å­¦è¿‡C++ï¼Œä¹Ÿè¦è®°ä¸‹æ¥ï¼\néƒ½æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œéƒ½æ”¯æŒå°è£…ã€ç»§æ‰¿å’Œå¤šæ€ Javaä¸æä¾›æŒ‡é’ˆæ¥ç›´æ¥è®¿é—®å†…å­˜ï¼Œç¨‹åºå†…å­˜æ›´åŠ å®‰å…¨ Javaçš„ç±»æ˜¯å•ç»§æ‰¿çš„ï¼ŒC++æ”¯æŒå¤šé‡ç»§æ‰¿ï¼›è™½ç„¶Javaçš„ç±»ä¸å¯ä»¥å¤šç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¤šç»§æ‰¿ã€‚ Javaæœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾æ— ç”¨å†…å­˜ æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ æ¥å£çš„æ–¹æ³•é»˜è®¤æ˜¯publicï¼Œæ‰€æœ‰æ–¹æ³•åœ¨æ¥å£ä¸­ä¸èƒ½æœ‰å®ç°ï¼ŒæŠ½è±¡ç±»å¯ä»¥æœ‰éæŠ½è±¡çš„æ–¹æ³• æ¥å£ä¸­çš„å®ä¾‹å˜é‡é»˜è®¤æ˜¯finalç±»å‹çš„ï¼Œè€ŒæŠ½è±¡ç±»ä¸­åˆ™ä¸ä¸€å®š ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼Œä½†æœ€å¤šåªèƒ½å®ç°ä¸€ä¸ªæŠ½è±¡ç±» ä¸€ä¸ªç±»å®ç°æ¥å£çš„è¯è¦å®ç°æ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼Œè€ŒæŠ½è±¡ç±»ä¸ä¸€å®š æ¥å£ä¸èƒ½ç”¨newå®ä¾‹åŒ–ï¼Œä½†å¯ä»¥å£°æ˜ï¼Œä½†æ˜¯å¿…é¡»å¼•ç”¨ä¸€ä¸ªå®ç°è¯¥æ¥å£çš„å¯¹è±¡ ä»è®¾è®¡å±‚é¢æ¥è¯´ï¼ŒæŠ½è±¡æ˜¯å¯¹ç±»çš„æŠ½è±¡ï¼Œæ˜¯ä¸€ç§æ¨¡æ¿è®¾è®¡ï¼Œæ¥å£æ˜¯è¡Œä¸ºçš„æŠ½è±¡ï¼Œæ˜¯ä¸€ç§è¡Œä¸ºçš„è§„èŒƒã€‚ æ³¨æ„ï¼šJava8 åæ¥å£å¯ä»¥æœ‰é»˜è®¤å®ç°( default )ã€‚\næˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰é‚£äº›ï¼Ÿ ä»è¯­æ³•å½¢å¼ä¸Šï¼Œçœ‹æˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œè€Œå±€éƒ¨å˜é‡æ˜¯åœ¨æ–¹æ³•ä¸­å®šä¹‰çš„å˜é‡æˆ–æ˜¯æ–¹æ³•çš„å‚æ•°ï¼›æˆå‘˜å˜é‡å¯ä»¥è¢«public,private,staticç­‰ä¿®é¥°ç¬¦æ‰€ä¿®é¥°ï¼Œè€Œå±€éƒ¨å˜é‡ä¸èƒ½è¢«è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦åŠstaticæ‰€ä¿®é¥°ï¼›ä½†æ˜¯ï¼Œæˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡éƒ½èƒ½è¢«finalæ‰€ä¿®é¥°ï¼› ä»å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼æ¥çœ‹ï¼Œæˆå‘˜å˜é‡æ˜¯å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œè€Œå¯¹è±¡å­˜åœ¨äºå †å†…å­˜ï¼Œå±€éƒ¨å˜é‡å­˜åœ¨äºæ ˆå†…å­˜ ä»å˜é‡åœ¨å†…å­˜ä¸­çš„ç”Ÿå­˜æ—¶é—´ä¸Šçœ‹ï¼Œæˆå‘˜å˜é‡æ˜¯å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒéšç€å¯¹è±¡çš„åˆ›å»ºè€Œå­˜åœ¨ï¼Œè€Œå±€éƒ¨å˜é‡éšç€æ–¹æ³•çš„è°ƒç”¨è€Œè‡ªåŠ¨æ¶ˆå¤±ã€‚ æˆå‘˜å˜é‡å¦‚æœæ²¡æœ‰è¢«èµ‹åˆå€¼ï¼Œåˆ™ä¼šè‡ªåŠ¨ä»¥ç±»å‹çš„é»˜è®¤å€¼è€Œèµ‹å€¼ï¼ˆä¸€ç§æƒ…å†µä¾‹å¤–è¢«finalä¿®é¥°ä½†æ²¡æœ‰è¢«staticä¿®é¥°çš„æˆå‘˜å˜é‡å¿…é¡»æ˜¾ç¤ºåœ°èµ‹å€¼ï¼‰ï¼›è€Œå±€éƒ¨å˜é‡åˆ™ä¸ä¼šè‡ªåŠ¨èµ‹å€¼ã€‚ é‡è½½å’Œé‡å†™çš„åŒºåˆ« é‡è½½ï¼š å‘ç”Ÿåœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•åå¿…é¡»ç›¸åŒï¼Œå‚æ•°ç±»å‹ä¸åŒã€ä¸ªæ•°ä¸åŒã€é¡ºåºä¸åŒï¼Œæ–¹æ³•è¿”å›å€¼å’Œè®¿é—®ä¿®é¥°ç¬¦å¯ä»¥ä¸åŒï¼Œå‘ç”Ÿåœ¨ç¼–è¯‘æ—¶ã€‚ é‡å†™ï¼š å‘ç”Ÿåœ¨çˆ¶å­ç±»ä¸­ï¼Œæ–¹æ³•åã€å‚æ•°åˆ—è¡¨å¿…é¡»ç›¸åŒï¼Œè¿”å›å€¼èŒƒå›´å°äºç­‰äºçˆ¶ç±»ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸èŒƒå›´å°äºç­‰äºçˆ¶ç±»ï¼Œè®¿é—®ä¿®é¥°ç¬¦èŒƒå›´å¤§äºç­‰äºçˆ¶ç±»ï¼›å¦‚æœçˆ¶ç±»æ–¹æ³•è®¿é—®ä¿®é¥°ç¬¦ä¸ºprivateåˆ™å­ç±»å°±ä¸èƒ½é‡å†™è¯¥æ–¹æ³•ã€‚\nå­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡çš„åŒºåˆ« å½¢å¼ä¸Š: å­—ç¬¦å¸¸é‡æ˜¯å•å¼•å·å¼•èµ·çš„ä¸€ä¸ªå­—ç¬¦ å­—ç¬¦ä¸²å¸¸é‡æ˜¯åŒå¼•å·å¼•èµ·çš„è‹¥å¹²ä¸ªå­—ç¬¦ å«ä¹‰ä¸Š: å­—ç¬¦å¸¸é‡ç›¸å½“äºä¸€ä¸ªæ•´å½¢å€¼(ASCIIå€¼),å¯ä»¥å‚åŠ è¡¨è¾¾å¼è¿ç®— å­—ç¬¦ä¸²å¸¸é‡ä»£è¡¨ä¸€ä¸ªåœ°å€å€¼(è¯¥å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­å­˜æ”¾ä½ç½®) å å†…å­˜å¤§å° å­—ç¬¦å¸¸é‡åªå ä¸€ä¸ªå­—èŠ‚ å­—ç¬¦ä¸²å¸¸é‡å è‹¥å¹²ä¸ªå­—èŠ‚(è‡³å°‘ä¸€ä¸ªå­—ç¬¦ç»“æŸæ ‡å¿—) ","description":"","tags":["interview-questions"],"title":"Javaå¸¸è§é—®é¢˜æ±‡æ€»-2","uri":"/blog/posts/Java/string/"},{"categories":["Java"],"content":"1. ç®€è¿°çº¿ç¨‹ï¼Œç¨‹åºã€è¿›ç¨‹çš„åŸºæœ¬æ¦‚å¿µã€‚ä»¥åŠä»–ä»¬ä¹‹é—´å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ çº¿ç¨‹ä¸è¿›ç¨‹ç›¸ä¼¼ï¼Œä½†çº¿ç¨‹æ˜¯ä¸€ä¸ªæ¯”è¿›ç¨‹æ›´å°çš„æ‰§è¡Œå•ä½ã€‚ä¸€ä¸ªè¿›ç¨‹åœ¨å…¶æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å¯ä»¥äº§ç”Ÿå¤šä¸ªçº¿ç¨‹ã€‚ä¸è¿›ç¨‹ä¸åŒçš„æ˜¯åŒç±»çš„å¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€å—å†…å­˜ç©ºé—´å’Œä¸€ç»„ç³»ç»Ÿèµ„æºï¼Œæ‰€ä»¥ç³»ç»Ÿåœ¨äº§ç”Ÿä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ–æ˜¯åœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´ä½œåˆ‡æ¢å·¥ä½œæ—¶ï¼Œè´Ÿæ‹…è¦æ¯”è¿›ç¨‹å°å¾—å¤šï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œçº¿ç¨‹ä¹Ÿè¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ã€‚\nç¨‹åºæ˜¯å«æœ‰æŒ‡ä»¤å’Œæ•°æ®çš„æ–‡ä»¶ï¼Œè¢«å­˜å‚¨åœ¨ç£ç›˜æˆ–å…¶ä»–çš„æ•°æ®å­˜å‚¨è®¾å¤‡ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ç¨‹åºæ˜¯é™æ€çš„ä»£ç ã€‚\nè¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œæ˜¯ç³»ç»Ÿè¿è¡Œç¨‹åºçš„åŸºæœ¬å•ä½ï¼Œå› æ­¤è¿›ç¨‹æ˜¯åŠ¨æ€çš„ã€‚ç³»ç»Ÿè¿è¡Œä¸€ä¸ªç¨‹åºå³æ˜¯ä¸€ä¸ªè¿›ç¨‹ä»åˆ›å»ºï¼Œè¿è¡Œåˆ°æ¶ˆäº¡çš„è¿‡ç¨‹ã€‚ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªè¿›ç¨‹å°±æ˜¯ä¸€ä¸ªæ‰§è¡Œä¸­çš„ç¨‹åºï¼Œå®ƒåœ¨è®¡ç®—æœºä¸­ä¸€ä¸ªæŒ‡ä»¤æ¥ç€ä¸€ä¸ªæŒ‡ä»¤åœ°æ‰§è¡Œç€ï¼ŒåŒæ—¶ï¼Œæ¯ä¸ªè¿›ç¨‹è¿˜å æœ‰æŸäº›ç³»ç»Ÿèµ„æºå¦‚CPUæ—¶é—´ï¼Œå†…å­˜ç©ºé—´ï¼Œæ–‡ä»¶ï¼Œæ–‡ä»¶ï¼Œè¾“å…¥è¾“å‡ºè®¾å¤‡çš„ä½¿ç”¨æƒç­‰ç­‰ã€‚æ¢å¥è¯è¯´ï¼Œå½“ç¨‹åºåœ¨æ‰§è¡Œæ—¶ï¼Œå°†ä¼šè¢«æ“ä½œç³»ç»Ÿè½½å…¥å†…å­˜ä¸­ã€‚\nçº¿ç¨‹ æ˜¯ è¿›ç¨‹ åˆ’åˆ†æˆçš„æ›´å°çš„è¿è¡Œå•ä½ã€‚çº¿ç¨‹å’Œè¿›ç¨‹æœ€å¤§çš„ä¸åŒåœ¨äºåŸºæœ¬ä¸Šå„è¿›ç¨‹æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œå„çº¿ç¨‹åˆ™ä¸ä¸€å®šï¼Œå› ä¸ºåŒä¸€è¿›ç¨‹ä¸­çš„çº¿ç¨‹ææœ‰å¯èƒ½ä¼šç›¸äº’å½±å“ã€‚ä»å¦ä¸€è§’åº¦æ¥è¯´ï¼Œè¿›ç¨‹å±äºæ“ä½œç³»ç»Ÿçš„èŒƒç•´ï¼Œä¸»è¦æ˜¯åŒä¸€æ®µæ—¶é—´å†…ï¼Œå¯ä»¥åŒæ—¶æ‰§è¡Œä¸€ä¸ªä»¥ä¸Šçš„ç¨‹åºï¼Œè€Œçº¿ç¨‹åˆ™æ˜¯åœ¨åŒä¸€ç¨‹åºå†…å‡ ä¹åŒæ—¶æ‰§è¡Œä¸€ä¸ªä»¥ä¸Šçš„ç¨‹åºæ®µã€‚\nçº¿ç¨‹ä¸Šä¸‹æ–‡çš„åˆ‡æ¢æ¯”è¿›ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢è¦å¿«å¾ˆå¤š\nè¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œæ¶‰åŠåˆ°å½“å‰è¿›ç¨‹çš„CPUç¯å¢ƒçš„ä¿å­˜å’Œæ–°è¢«è°ƒåº¦è¿è¡Œè¿›ç¨‹çš„CPUç¯å¢ƒçš„è®¾ç½®ã€‚ çº¿ç¨‹åˆ‡æ¢ä»…éœ€è¦ä¿å­˜å’Œè®¾ç½®å°‘é‡çš„å¯„å­˜å™¨å†…å®¹ï¼Œä¸æ¶‰åŠå­˜å‚¨ç®¡ç†æ–¹é¢çš„æ“ä½œã€‚ 2. çº¿ç¨‹æœ‰å“ªäº›åŸºæœ¬çŠ¶æ€ï¼Ÿè¿™äº›çŠ¶æ€æ˜¯å¦‚ä½•å®šä¹‰çš„? æ–°å»º(new)ï¼šæ–°åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚ å¯è¿è¡Œ(runnable)ï¼šçº¿ç¨‹å¯¹è±¡åˆ›å»ºåï¼Œå…¶ä»–çº¿ç¨‹(æ¯”å¦‚mainçº¿ç¨‹ï¼‰è°ƒç”¨äº†è¯¥å¯¹è±¡çš„start()æ–¹æ³•ã€‚è¯¥çŠ¶æ€çš„çº¿ç¨‹ä½äºå¯è¿è¡Œçº¿ç¨‹æ± ä¸­ï¼Œç­‰å¾…è¢«çº¿ç¨‹è°ƒåº¦é€‰ä¸­ï¼Œè· å–cpuçš„ä½¿ç”¨æƒã€‚ è¿è¡Œ(running)ï¼šå¯è¿è¡ŒçŠ¶æ€(runnable)çš„çº¿ç¨‹è·å¾—äº†cpuæ—¶é—´ç‰‡ï¼ˆtimesliceï¼‰ï¼Œæ‰§è¡Œç¨‹åºä»£ç ã€‚ é˜»å¡(block)ï¼šé˜»å¡çŠ¶æ€æ˜¯æŒ‡çº¿ç¨‹å› ä¸ºæŸç§åŸå› æ”¾å¼ƒäº†cpuä½¿ç”¨æƒï¼Œä¹Ÿå³è®©å‡ºäº†cpu timesliceï¼Œæš‚æ—¶åœæ­¢è¿è¡Œã€‚ç›´åˆ°çº¿ç¨‹è¿›å…¥å¯è¿è¡Œ(runnable)çŠ¶æ€ï¼Œæ‰æœ‰ æœºä¼šå†æ¬¡è·å¾—cpu timesliceè½¬åˆ°è¿è¡Œ(running)çŠ¶æ€ã€‚é˜»å¡çš„æƒ…å†µåˆ†ä¸‰ç§ï¼š (ä¸€). ç­‰å¾…é˜»å¡ï¼šè¿è¡Œ(running)çš„çº¿ç¨‹æ‰§è¡Œo.wait()æ–¹æ³•ï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹æ”¾ å…¥ç­‰å¾…é˜Ÿåˆ—(waiting queue)ä¸­ã€‚ (äºŒ). åŒæ­¥é˜»å¡ï¼šè¿è¡Œ(running)çš„çº¿ç¨‹åœ¨è·å–å¯¹è±¡çš„åŒæ­¥é”æ—¶ï¼Œè‹¥è¯¥åŒæ­¥ é” è¢«åˆ«çš„çº¿ç¨‹å ç”¨ï¼Œåˆ™JVMä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥é”æ± (lock pool)ä¸­ã€‚ (ä¸‰). å…¶ä»–é˜»å¡: è¿è¡Œ(running)çš„çº¿ç¨‹æ‰§è¡ŒThread.sleep(long ms)æˆ–t.join()æ–¹æ³•ï¼Œæˆ–è€…å‘å‡ºäº†I/Oè¯·æ±‚æ—¶ï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹ç½®ä¸ºé˜»å¡çŠ¶æ€ã€‚å½“sleep()çŠ¶æ€è¶…æ—¶join()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ã€æˆ–è€…I/Oå¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å¯è¿è¡Œ(runnable)çŠ¶æ€ã€‚ æ­»äº¡(dead)ï¼šçº¿ç¨‹run()ã€main()æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œæˆ–è€…å› å¼‚å¸¸é€€å‡ºäº†run()æ–¹æ³•ï¼Œåˆ™è¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚æ­»äº¡çš„çº¿ç¨‹ä¸å¯å†æ¬¡å¤ç”Ÿã€‚ å¤‡æ³¨ï¼š å¯ä»¥ç”¨æ—©èµ·ååœ°é“æ¥æ¯”å–»è¿™ä¸ªè¿‡ç¨‹ï¼ˆä¸‹é¢å‚è€ƒè‡ªç‰›å®¢ç½‘æŸä½åŒå­¦çš„å›ç­”ï¼‰ï¼š\nè¿˜æ²¡èµ·åºŠï¼šsleeping èµ·åºŠæ”¶æ‹¾å¥½äº†ï¼Œéšæ—¶å¯ä»¥ååœ°é“å‡ºå‘ï¼šRunnable ç­‰åœ°é“æ¥ï¼šWaiting åœ°é“æ¥äº†ï¼Œä½†è¦æ’é˜Ÿä¸Šåœ°é“ï¼šI/Oé˜»å¡ ä¸Šäº†åœ°é“ï¼Œå‘ç°æš‚æ—¶æ²¡åº§ä½ï¼šsynchronizedé˜»å¡ åœ°é“ä¸Šæ‰¾åˆ°åº§ä½ï¼šRunning åˆ°è¾¾ç›®çš„åœ°ï¼šDead 3. ä½•ä¸ºå¤šçº¿ç¨‹ï¼Ÿ å¤šçº¿ç¨‹å°±æ˜¯å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œæˆ–äº¤æ›¿è¿è¡Œã€‚å•æ ¸CPUçš„è¯æ˜¯é¡ºåºæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯äº¤æ›¿è¿è¡Œã€‚å¤šæ ¸CPUçš„è¯ï¼Œå› ä¸ºæ¯ä¸ªCPUæœ‰è‡ªå·±çš„è¿ç®—å™¨ï¼Œæ‰€ä»¥åœ¨å¤šä¸ªCPUä¸­å¯ä»¥åŒæ—¶è¿è¡Œã€‚\n4. ä¸ºä»€ä¹ˆå¤šçº¿ç¨‹æ˜¯å¿…è¦çš„ï¼Ÿ ä½¿ç”¨çº¿ç¨‹å¯ä»¥æŠŠå æ®é•¿æ—¶é—´çš„ç¨‹åºä¸­çš„ä»»åŠ¡æ”¾åˆ°åå°å»å¤„ç†ã€‚ ç”¨æˆ·ç•Œé¢å¯ä»¥æ›´åŠ å¸å¼•äººï¼Œè¿™æ ·æ¯”å¦‚ç”¨æˆ·ç‚¹å‡»äº†ä¸€ä¸ªæŒ‰é’®å»è§¦å‘æŸäº›äº‹ä»¶çš„å¤„ç†ï¼Œå¯ä»¥å¼¹å‡ºä¸€ä¸ªè¿›åº¦æ¡æ¥æ˜¾ç¤ºå¤„ç†çš„è¿›åº¦ã€‚ ç¨‹åºçš„è¿è¡Œé€Ÿåº¦å¯èƒ½åŠ å¿«ã€‚ 5 ä½¿ç”¨å¤šçº¿ç¨‹å¸¸è§çš„ä¸‰ç§æ–¹å¼ â‘ ç»§æ‰¿Threadç±» MyThread.java\n1 2 3 4 5 6 7 public class MyThread extends Thread { @Override public void run() { super.run(); System.out.println(\"MyThread\"); } } Run.java\n1 2 3 4 5 6 7 8 9 public class Run { public static void main(String[] args) { MyThread mythread = new MyThread(); mythread.start(); System.out.println(\"è¿è¡Œç»“æŸ\"); } } è¿è¡Œç»“æœï¼š ä»ä¸Šé¢çš„è¿è¡Œç»“æœå¯ä»¥çœ‹å‡ºï¼šçº¿ç¨‹æ˜¯ä¸€ä¸ªå­ä»»åŠ¡ï¼ŒCPUä»¥ä¸ç¡®å®šçš„æ–¹å¼ï¼Œæˆ–è€…è¯´æ˜¯ä»¥éšæœºçš„æ—¶é—´æ¥è°ƒç”¨çº¿ç¨‹ä¸­çš„runæ–¹æ³•ã€‚\nâ‘¡å®ç°Runnableæ¥å£ æ¨èå®ç°Runnableæ¥å£æ–¹å¼å¼€å‘å¤šçº¿ç¨‹ï¼Œå› ä¸ºJavaå•ç»§æ‰¿ä½†æ˜¯å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚\nMyRunnable.java\n1 2 3 4 5 6 public class MyRunnable implements Runnable { @Override public void run() { System.out.println(\"MyRunnable\"); } } Run.java\n1 2 3 4 5 6 7 8 9 10 public class Run { public static void main(String[] args) { Runnable runnable=new MyRunnable(); Thread thread=new Thread(runnable); thread.start(); System.out.println(\"è¿è¡Œç»“æŸï¼\"); } } è¿è¡Œç»“æœï¼š â‘¢ä½¿ç”¨çº¿ç¨‹æ±  åœ¨ã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹â€œå¹¶å‘å¤„ç†â€è¿™ä¸€ç« èŠ‚ï¼Œæ˜ç¡®æŒ‡å‡ºçº¿ç¨‹èµ„æºå¿…é¡»é€šè¿‡çº¿ç¨‹æ± æä¾›ï¼Œä¸å…è®¸åœ¨åº”ç”¨ä¸­è‡ªè¡Œæ˜¾ç¤ºåˆ›å»ºçº¿ç¨‹ã€‚\nä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\nä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„æ˜¯å‡å°‘åœ¨åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ä¸Šæ‰€æ¶ˆè€—çš„æ—¶é—´ä»¥åŠç³»ç»Ÿèµ„æºå¼€é”€ï¼Œè§£å†³èµ„æºä¸è¶³çš„é—®é¢˜ã€‚å¦‚æœä¸ä½¿ç”¨çº¿ç¨‹æ± ï¼Œæœ‰å¯èƒ½ä¼šé€ æˆç³»ç»Ÿåˆ›å»ºå¤§é‡åŒç±»çº¿ç¨‹è€Œå¯¼è‡´æ¶ˆè€—å®Œå†…å­˜æˆ–è€…â€œè¿‡åº¦åˆ‡æ¢â€çš„é—®é¢˜ã€‚\nå¦å¤–ã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹ä¸­å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ Executors å»åˆ›å»ºï¼Œè€Œæ˜¯é€šè¿‡ ThreadPoolExecutor çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©\nExecutors è¿”å›çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹ï¼š\nFixedThreadPool å’Œ SingleThreadExecutor ï¼š å…è®¸è¯·æ±‚çš„é˜Ÿåˆ—é•¿åº¦ä¸º Integer.MAX_VALUE,å¯èƒ½å †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´OOMã€‚ CachedThreadPool å’Œ ScheduledThreadPool ï¼š å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸º Integer.MAX_VALUE ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´OOMã€‚ å¯¹äºçº¿ç¨‹æ± æ„Ÿå…´è¶£çš„å¯ä»¥æŸ¥çœ‹æˆ‘çš„è¿™ç¯‡æ–‡ç« ï¼šã€ŠJavaå¤šçº¿ç¨‹å­¦ä¹ ï¼ˆå…«ï¼‰çº¿ç¨‹æ± ä¸Executor æ¡†æ¶ã€‹ ç‚¹å‡»é˜…è¯»åŸæ–‡å³å¯æŸ¥çœ‹åˆ°è¯¥æ–‡ç« çš„æœ€æ–°ç‰ˆã€‚\n6 çº¿ç¨‹çš„ä¼˜å…ˆçº§ æ¯ä¸ªçº¿ç¨‹éƒ½å…·æœ‰å„è‡ªçš„ä¼˜å…ˆçº§ï¼Œçº¿ç¨‹çš„ä¼˜å…ˆçº§å¯ä»¥åœ¨ç¨‹åºä¸­è¡¨æ˜è¯¥çº¿ç¨‹çš„é‡è¦æ€§ï¼Œå¦‚æœæœ‰å¾ˆå¤šçº¿ç¨‹å¤„äºå°±ç»ªçŠ¶æ€ï¼Œç³»ç»Ÿä¼šæ ¹æ®ä¼˜å…ˆçº§æ¥å†³å®šé¦–å…ˆä½¿å“ªä¸ªçº¿ç¨‹è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚ä½†è¿™ä¸ªå¹¶ä¸æ„å‘³ç€ä½ ä¼˜å…ˆçº§çš„çº¿ç¨‹å¾—ä¸åˆ°è¿è¡Œï¼Œè€Œåªæ˜¯å®ƒè¿è¡Œçš„å‡ ç‡æ¯”è¾ƒå°ï¼Œå¦‚åƒåœ¾å›æ”¶æœºåˆ¶çº¿ç¨‹çš„ä¼˜å…ˆçº§å°±æ¯”è¾ƒä½ã€‚æ‰€ä»¥å¾ˆå¤šåƒåœ¾å¾—ä¸åˆ°åŠæ—¶çš„å›æ”¶å¤„ç†ã€‚\nçº¿ç¨‹ä¼˜å…ˆçº§å…·æœ‰ç»§æ‰¿ç‰¹æ€§ã€‚ æ¯”å¦‚Açº¿ç¨‹å¯åŠ¨Bçº¿ç¨‹ï¼Œåˆ™Bçº¿ç¨‹çš„ä¼˜å…ˆçº§å’ŒAæ˜¯ä¸€æ ·çš„ã€‚\nçº¿ç¨‹ä¼˜å…ˆçº§å…·æœ‰éšæœºæ€§ã€‚ ä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹ä¼˜å…ˆçº§é«˜çš„ä¸ä¸€å®šæ¯ä¸€æ¬¡éƒ½å…ˆæ‰§è¡Œå®Œã€‚\nThreadç±»ä¸­åŒ…å«çš„æˆå‘˜å˜é‡ä»£è¡¨äº†çº¿ç¨‹çš„æŸäº›ä¼˜å…ˆçº§ã€‚å¦‚Thread.MIN_PRIORITYï¼ˆå¸¸æ•°1ï¼‰ï¼ŒThread.NORM_PRIORITYï¼ˆå¸¸æ•°5ï¼‰, Thread.MAX_PRIORITYï¼ˆå¸¸æ•°10ï¼‰ã€‚å…¶ä¸­æ¯ä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§éƒ½åœ¨Thread.MIN_PRIORITYï¼ˆå¸¸æ•°1ï¼‰ åˆ°Thread.MAX_PRIORITYï¼ˆå¸¸æ•°10ï¼‰ ä¹‹é—´ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ä¼˜å…ˆçº§éƒ½æ˜¯Thread.NORM_PRIORITYï¼ˆå¸¸æ•°5ï¼‰ã€‚\nå­¦è¿‡æ“ä½œç³»ç»Ÿè¿™é—¨è¯¾ç¨‹çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å¤šçº¿ç¨‹ä¼˜å…ˆçº§æˆ–å¤šæˆ–å°‘å€Ÿé‰´äº†æ“ä½œç³»ç»Ÿå¯¹è¿›ç¨‹çš„ç®¡ç†ã€‚\n7 Javaå¤šçº¿ç¨‹åˆ†ç±» ç”¨æˆ·çº¿ç¨‹ è¿è¡Œåœ¨å‰å°ï¼Œæ‰§è¡Œå…·ä½“çš„ä»»åŠ¡ï¼Œå¦‚ç¨‹åºçš„ä¸»çº¿ç¨‹ã€è¿æ¥ç½‘ç»œçš„å­çº¿ç¨‹ç­‰éƒ½æ˜¯ç”¨æˆ·çº¿ç¨‹\nå®ˆæŠ¤çº¿ç¨‹ è¿è¡Œåœ¨åå°ï¼Œä¸ºå…¶ä»–å‰å°çº¿ç¨‹æœåŠ¡.ä¹Ÿå¯ä»¥è¯´å®ˆæŠ¤çº¿ç¨‹æ˜¯JVMä¸­éå®ˆæŠ¤çº¿ç¨‹çš„ â€œä½£äººâ€ã€‚\nç‰¹ç‚¹ï¼š ä¸€æ—¦æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹éƒ½ç»“æŸè¿è¡Œï¼Œå®ˆæŠ¤çº¿ç¨‹ä¼šéšJVMä¸€èµ·ç»“æŸå·¥ä½œ åº”ç”¨ï¼š æ•°æ®åº“è¿æ¥æ± ä¸­çš„æ£€æµ‹çº¿ç¨‹ï¼ŒJVMè™šæ‹Ÿæœºå¯åŠ¨åçš„æ£€æµ‹çº¿ç¨‹ æœ€å¸¸è§çš„å®ˆæŠ¤çº¿ç¨‹ï¼š åƒåœ¾å›æ”¶çº¿ç¨‹ å¦‚ä½•è®¾ç½®å®ˆæŠ¤çº¿ç¨‹ï¼Ÿ\nå¯ä»¥é€šè¿‡è°ƒç”¨ Thead ç±»çš„ setDaemon(true) æ–¹æ³•è®¾ç½®å½“å‰çš„çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚\næ³¨æ„äº‹é¡¹ï¼š\n1. setDaemon(true)å¿…é¡»åœ¨startï¼ˆï¼‰æ–¹æ³•å‰æ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ›å‡ºIllegalThreadStateExceptionå¼‚å¸¸ 2. åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­äº§ç”Ÿçš„æ–°çº¿ç¨‹ä¹Ÿæ˜¯å®ˆæŠ¤çº¿ç¨‹ 3. ä¸æ˜¯æ‰€æœ‰çš„ä»»åŠ¡éƒ½å¯ä»¥åˆ†é…ç»™å®ˆæŠ¤çº¿ç¨‹æ¥æ‰§è¡Œï¼Œæ¯”å¦‚è¯»å†™æ“ä½œæˆ–è€…è®¡ç®—é€»è¾‘ 8 sleep()æ–¹æ³•å’Œwait()æ–¹æ³•ç®€å•å¯¹æ¯” ä¸¤è€…æœ€ä¸»è¦çš„åŒºåˆ«åœ¨äºï¼šsleepæ–¹æ³•æ²¡æœ‰é‡Šæ”¾é”ï¼Œè€Œwaitæ–¹æ³•é‡Šæ”¾äº†é” ã€‚ ä¸¤è€…éƒ½å¯ä»¥æš‚åœçº¿ç¨‹çš„æ‰§è¡Œã€‚ Waité€šå¸¸è¢«ç”¨äºçº¿ç¨‹é—´äº¤äº’/é€šä¿¡ï¼Œsleepé€šå¸¸è¢«ç”¨äºæš‚åœæ‰§è¡Œã€‚ wait()æ–¹æ³•è¢«è°ƒç”¨åï¼Œçº¿ç¨‹ä¸ä¼šè‡ªåŠ¨è‹é†’ï¼Œéœ€è¦åˆ«çš„çº¿ç¨‹è°ƒç”¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šçš„notify()æˆ–è€…notifyAll()æ–¹æ³•ã€‚sleep()æ–¹æ³•æ‰§è¡Œå®Œæˆåï¼Œçº¿ç¨‹ä¼šè‡ªåŠ¨è‹é†’ã€‚ 9 ä¸ºä»€ä¹ˆæˆ‘ä»¬è°ƒç”¨start()æ–¹æ³•æ—¶ä¼šæ‰§è¡Œrun()æ–¹æ³•ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ç›´æ¥è°ƒç”¨run()æ–¹æ³•ï¼Ÿ è¿™æ˜¯å¦ä¸€ä¸ªéå¸¸ç»å…¸çš„javaå¤šçº¿ç¨‹é¢è¯•é—®é¢˜ï¼Œè€Œä¸”åœ¨é¢è¯•ä¸­ä¼šç»å¸¸è¢«é—®åˆ°ã€‚å¾ˆç®€å•ï¼Œä½†æ˜¯å¾ˆå¤šäººéƒ½ä¼šç­”ä¸ä¸Šæ¥ï¼\nnewä¸€ä¸ªThreadï¼Œçº¿ç¨‹è¿›å…¥äº†æ–°å»ºçŠ¶æ€;è°ƒç”¨start()æ–¹æ³•ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥äº†å°±ç»ªçŠ¶æ€ï¼Œå½“åˆ†é…åˆ°æ—¶é—´ç‰‡åå°±å¯ä»¥å¼€å§‹è¿è¡Œäº†ã€‚ start()ä¼šæ‰§è¡Œçº¿ç¨‹çš„ç›¸åº”å‡†å¤‡å·¥ä½œï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œrun()æ–¹æ³•çš„å†…å®¹ï¼Œè¿™æ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹å·¥ä½œã€‚ è€Œç›´æ¥æ‰§è¡Œrun()æ–¹æ³•ï¼Œä¼šæŠŠrunæ–¹æ³•å½“æˆä¸€ä¸ªmiançº¿ç¨‹ä¸‹çš„æ™®é€šæ–¹æ³•å»æ‰§è¡Œï¼Œå¹¶ä¸ä¼šåœ¨æŸä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®ƒï¼Œæ‰€ä»¥è¿™å¹¶ä¸æ˜¯å¤šçº¿ç¨‹å·¥ä½œã€‚\næ€»ç»“ï¼š è°ƒç”¨startæ–¹æ³•æ–¹å¯å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œè€Œrunæ–¹æ³•åªæ˜¯threadçš„ä¸€ä¸ªæ™®é€šæ–¹æ³•è°ƒç”¨ï¼Œè¿˜æ˜¯åœ¨ä¸»çº¿ç¨‹é‡Œæ‰§è¡Œã€‚\n","description":"","tags":["multithread","interview"],"title":"é—®é¢˜æ¢³ç†-Javaå¤šçº¿ç¨‹","uri":"/blog/posts/Java/questiones-multithread-in-java/"},{"categories":["Algorithm"],"content":"é¢˜ç›®æè¿° è¾“å…¥ä¸€ä¸ªé“¾è¡¨ï¼ŒæŒ‰é“¾è¡¨å€¼ä»å°¾åˆ°å¤´çš„é¡ºåºè¿”å›ä¸€ä¸ªArrayListã€‚\nç®—æ³•åˆ†æ ä½¿ç”¨é€’å½’çš„æ–¹æ³•ï¼š\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨é€’å½’å‡½æ•°ï¼Œheadå’Œhead-\u003enextå­˜åœ¨çš„æ—¶å€™è¿›å…¥ä¸‹ä¸€å±‚ï¼Œå½“è¿›å…¥æœ€åä¸€å±‚çš„æ—¶å€™å¼€å§‹ä»å°¾éƒ¨è¿”å›ã€‚\nä½¿ç”¨æ ˆçš„æ–¹æ³•ï¼š\né¦–å…ˆéå†ä¸€éé“¾è¡¨ï¼Œå°†é¡ºåºçš„å€¼å‹æ ˆï¼Œç„¶ååˆ©ç”¨æ ˆçš„æ€§è´¨ï¼ˆåè¿›å…ˆå‡ºï¼‰è¿›è¡Œæ‰“å°ã€‚\nä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 /** * struct ListNode { * int val; * struct ListNode *next; * ListNode(int x) : * val(x), next(NULL) { * } * }; */ // é€’å½’ class Solution { public: vector\u003cint\u003e printListFromTailToHead(ListNode* head) { vector\u003cint\u003e result; helper(head, result); return result; } private: void helper(ListNode* head, vector\u003cint\u003e \u0026result){ if(head){ if(head -\u003e next){ helper(head -\u003e next, result); } result.push_back(head -\u003e val); } } }; // æ ˆ class Solution { public: vector\u003cint\u003e printListFromTailToHead(ListNode* head) { vector\u003cint\u003e res; stack\u003cint\u003e st; while (head) { st.push(head-\u003eval); head = head-\u003enext; } while (!st.empty()) { res.push_back(st.top()); st.pop(); } return res; } }; ","description":"","tags":["algorithm","linked-list"],"title":"ã€å‰‘æŒ‡offerã€‘ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨","uri":"/blog/posts/Algorithm/sword-refers-to-offer-print-the-linked-list-from-end-beginning/"},{"categories":["Algorithm"],"content":"é¢˜ç›®æè¿° åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åºï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åºã€‚è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å«æœ‰è¯¥æ•´æ•°ã€‚\nç®—æ³•åˆ†æ æˆ‘ä»¬å¯ä»¥è§‚å¯ŸäºŒç»´æ•°ç»„ï¼ˆmï¼Œnï¼‰ä¸­çš„4ä¸ªé¡¶ç‚¹ã€‚\nå·¦ä¸Šè§’ï¼ˆ0ï¼Œ0ï¼‰ï¼Œå‘å³å’Œå‘ä¸‹éƒ½æ˜¯é€’å¢ã€‚å³ä¸‹è§’ï¼ˆmï¼Œnï¼‰ï¼Œå‘å·¦å’Œå‘ä¸Šéƒ½æ˜¯é€’å¢ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•ç¡®è®¤å“ªä¸€ä¸ªæ–¹å‘èƒ½æ›´å¿«æ‰¾åˆ°ç›®æ ‡å€¼ã€‚\nè€ƒè™‘å·¦ä¸‹è§’ï¼ˆmï¼Œ0ï¼‰ï¼Œå‘å³æ˜¯é€’å¢çš„ï¼Œå‘ä¸Šçš„é€’å‡çš„ï¼Œæ‰€ä»¥é€šè¿‡æ¯”è¾ƒ target å’Œ current value å¤§å°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­å…¶æ‰€åœ¨çš„ç›¸å¯¹æ–¹å‘ã€‚åŒç†å³ä¸Šè§’ã€‚\nä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 class Solution { public: bool Find(int target, vector\u003cvector\u003cint\u003e \u003e array) { int row = array.size(); int col = array[0].size(); int i, j; // èµ·å§‹ç‚¹åœ¨å·¦ä¸‹è§’ for(i = row - 1, j = 0; i \u003e= 0 \u0026\u0026 j \u003c col;) { if(target == array[i][j]) return true; if(target \u003c array[i][j]){ i--; continue; } if(target \u003e array[i][j]){ j++; continue; } } // æˆ–è€…èµ·å§‹ç‚¹åœ¨å³ä¸Šè§’ // for(i = 0, j = col - 1; i \u003c row \u0026\u0026 j \u003e= 0;) { // if(target == array[i][j]) // return true; // if(target \u003c array[i][j]){ // j--; // continue; // } // if(target \u003e array[i][j]){ // // i++; // continue; // } // } return false; } }; ","description":"","tags":["algorithm","array"],"title":"ã€å‰‘æŒ‡offerã€‘äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾","uri":"/blog/posts/Algorithm/sword-refers-to-offer-search-in-a-twodimensional-array/"},{"categories":["Algorithm"],"content":"é¢˜ç›®æè¿° è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œå°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ç©ºæ ¼æ›¿æ¢æˆâ€œ%20â€ã€‚ä¾‹å¦‚ï¼Œå½“å­—ç¬¦ä¸²ä¸ºWe Are Happy.åˆ™ç»è¿‡æ›¿æ¢ä¹‹åçš„å­—ç¬¦ä¸²ä¸ºWe%20Are%20Happyã€‚\nç®—æ³•åˆ†æ é¦–å…ˆå¤åˆ¶ä¸€ä»½å­—ç¬¦ä¸²çš„å¤‡ä»½ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å­—ç¬¦ä¸²åŸå§‹é•¿åº¦ï¼Œç©ºæ ¼æ•°æ¥è®¡ç®—æ›¿æ¢åå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä¹‹åå°±åªéœ€è¦æ ¹æ®å­—ç¬¦ä¸²åŸå§‹é•¿åº¦å’Œæ–°é•¿åº¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ‹·è´ã€‚\nä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 class Solution { public: void replaceSpace(char *str,int length) { char *t = str; int strLen = 0, newStrLen = 0, spaceCount = 0; int p,q; if(str == NULL || length \u003c0) return; // é¦–å…ˆåˆ¤å®šè¿›å…¥ç®—æ³•çš„æœ‰æ•ˆæ¡ä»¶ while(*t != '\\0'){ strLen++; if(*t == ' ') spaceCount++; t++; }\t// å–å­—ç¬¦ä¸²é•¿åº¦ï¼Œ ç©ºæ ¼çš„ä¸ªæ•° newStrLen = strLen + 2 * spaceCount; // æ–°çš„å­—ç¬¦ä¸²çš„é•¿åº¦ if(newStrLen \u003e length) return ; for(p = strLen, q = newStrLen; p \u003e= 0; p-- ){ if(str[p] == ' '){ str[q--] = '0'; str[q--] = '2'; str[q--] = '%'; } else { str[q--] = str[p]; } } } }; ","description":"","tags":["algorithm","string"],"title":"ã€å‰‘æŒ‡offerã€‘æ›¿æ¢ç©ºæ ¼","uri":"/blog/posts/Algorithm/replace-spaces/"},{"categories":["Algorithm"],"content":"é¢˜ç›®æè¿° æŠŠä¸€ä¸ªæ•°ç»„æœ€å¼€å§‹çš„è‹¥å¹²ä¸ªå…ƒç´ æ¬åˆ°æ•°ç»„çš„æœ«å°¾ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ•°ç»„çš„æ—‹è½¬ã€‚ è¾“å…¥ä¸€ä¸ªéé€’å‡æ’åºçš„æ•°ç»„çš„ä¸€ä¸ªæ—‹è½¬ï¼Œè¾“å‡ºæ—‹è½¬æ•°ç»„çš„æœ€å°å…ƒç´ ã€‚ ä¾‹å¦‚æ•°ç»„{3,4,5,1,2}ä¸º{1,2,3,4,5}çš„ä¸€ä¸ªæ—‹è½¬ï¼Œè¯¥æ•°ç»„çš„æœ€å°å€¼ä¸º1ã€‚ NOTEï¼šç»™å‡ºçš„æ‰€æœ‰å…ƒç´ éƒ½å¤§äº0ï¼Œè‹¥æ•°ç»„å¤§å°ä¸º0ï¼Œè¯·è¿”å›0ã€‚\nç®—æ³•åˆ†æ æˆ‘è§‰å¾—è¿™é“é¢˜ç›®æŒºæ²¡æœ‰æ„æ€ï¼Œæœ€ç›´æ¥çš„ä¸€ä¸ªåšæ³•æ˜¯éå†æ•´ä¸ªæ•°ç»„ï¼Œå®ƒä¸¾äº†ä¸€ä¸ªé€’å‡æ’åºçš„æ•°ç»„ï¼Œè¿™é‡Œåªéœ€è¦æ‰¾åˆ°æ—‹è½¬ç‚¹æ˜¯å¯ä»¥ç”¨äºŒåˆ†çš„ï¼Œä¸ç¡®å®šæ—‹è½¬æ•°ç»„æ˜¯å¦æ˜¯æœ‰åºçš„è¯ï¼Œå°±åªèƒ½ç”¨ç¬¬ä¸€ä¸ªæ–¹æ³•äº†ã€‚\nä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 class Solution { public: int minNumberInRotateArray(vector\u003cint\u003e rotateArray) { if(rotateArray.size() == 0){ return 0; } else{ int first = rotateArray[0]; int i = 1; while(rotateArray[i] != '\\0'){ if(rotateArray[i] \u003c first){ break; //return rotateArray[i]; } i++; } return rotateArray[i]; } } }; class Solution { public: int minNumberInRotateArray(vector\u003cint\u003e rotateArray) { int n = rotateArray.size(); if (n == 0) return 0; else { int min = rotateArray[0]; for (auto i : rotateArray) { if (i \u003c min) min = i; } return min; } } }; ","description":"","tags":["algorithm","search"],"title":"ã€å‰‘æŒ‡offerã€‘æ—‹è½¬æ•°ç»„çš„æœ€å°æ•°å­—","uri":"/blog/posts/Algorithm/rotate-the-smallest-number-of-array/"},{"categories":["Algorithm"],"content":"é¢˜ç›®æè¿° ç”¨ä¸¤ä¸ªæ ˆæ¥å®ç°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå®Œæˆé˜Ÿåˆ—çš„Pushå’ŒPopæ“ä½œã€‚ é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ºintç±»å‹ã€‚\nç®—æ³•åˆ†æ é˜Ÿåˆ—å…·æœ‰å…ˆè¿›å…ˆå‡ºçš„æ€§è´¨ï¼Œæ ˆå…·æœ‰åè¿›å…ˆå‡ºçš„æ€§è´¨ï¼Œæ ¹æ®ä»–ä»¬æ€§è´¨çš„è”ç³»ï¼Œä½¿ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—çš„æ€è·¯å¦‚ä¸‹ï¼š\npushæ“ä½œç”¨ä¸€ä¸ªæ ˆè¿›è¡Œå­˜å‚¨ï¼Œpopæ“ä½œç”¨å­˜å‚¨æ•°æ®çš„æ ˆå‘å¦ä¸€æ ˆè¿›è¡Œå­˜æ”¾ï¼Œè¿™æ ·æ•°æ®ä¸¤æ¬¡å€’è½¬ä¸å˜ï¼Œ\nç¬¬äºŒä¸ªæ ˆçš„æ ˆé¡¶å…ƒç´ ä½œä¸ºè¿”å›å€¼ï¼Œç„¶ååœ¨å€’è½¬å›ç¬¬ä¸€ä¸ªæ ˆã€‚\nä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 class Solution { public: void push(int node) { stack1.push(node); } int pop() { int res; while (!stack1.empty()) { stack2.push(stack1.top()); stack1.pop(); } res = stack2.top(); stack2.pop(); while (!stack2.empty()) { stack1.push(stack2.top()); stack2.pop(); } return res; } private: stack\u003cint\u003e stack1; stack\u003cint\u003e stack2; }; ","description":"","tags":["algorithm","queue","stack"],"title":"ã€å‰‘æŒ‡offerã€‘æ ˆå®ç°é˜Ÿåˆ—","uri":"/blog/posts/Algorithm/%E6%A0%88%E5%AE%9E%E7%8E%B0%E9%98%9F%E5%88%97/"},{"categories":["Algorithm"],"content":"é—®é¢˜æè¿° è¾“å…¥æŸäºŒå‰æ ‘çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœï¼Œè¯·é‡å»ºå‡ºè¯¥äºŒå‰æ ‘ã€‚å‡è®¾è¾“å…¥çš„å‰åºéå†å’Œä¸­åºéå†çš„ç»“æœä¸­éƒ½ä¸å«é‡å¤çš„æ•°å­—ã€‚ä¾‹å¦‚è¾“å…¥å‰åºéå†åºåˆ—{1,2,4,7,3,5,6,8}å’Œä¸­åºéå†åºåˆ—{4,7,2,1,5,3,8,6}ï¼Œåˆ™é‡å»ºäºŒå‰æ ‘å¹¶è¿”å›ã€‚\nç®—æ³•åˆ†æ ç®—æ³•çš„åŸºæœ¬æ€è·¯æ˜¯åˆ†æ²»æ³•ï¼Œdivide and conquerï¼Œå¯ä»¥æ‹†è§£è¿™ä¸ªä¸ºç›¸ä¼¼çš„å°é—®é¢˜ï¼Œpreçš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æ ¹èŠ‚ç‚¹ï¼Œæ ‘æˆ–è€…å­æ ‘ï¼Œç„¶åå¯ä»¥æ‹†è§£ä¸ºå·¦å³å­æ ‘çš„preå’Œvinï¼Œè¿›è¡ŒåŒæ ·çš„è¿‡ç¨‹\nä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 /** * Definition for binary tree * struct TreeNode { * int val; * TreeNode *left; * TreeNode *right; * TreeNode(int x) : val(x), left(NULL), right(NULL) {} * }; */ class Solution { public: TreeNode* reConstructBinaryTree(vector\u003cint\u003e pre,vector\u003cint\u003e vin) { if (pre.size() == 0) return NULL; else if (pre.size() == 1){ TreeNode* root = new TreeNode(pre.back()); root -\u003e left = NULL; root -\u003e right = NULL; return root; } else { TreeNode* root = new TreeNode(pre.at(0)); vector\u003cint\u003e::iterator it = vin.begin(); while(it != vin.end() \u0026\u0026 *it != pre.at(0)) ++it; int dis = it - vin.begin(); vector\u003cint\u003e subPreLeft(pre.begin() + 1, pre.begin() + dis + 1); vector\u003cint\u003e subPreRight(pre.begin() + dis + 1, pre.end()); vector\u003cint\u003e subVinLeft(vin.begin(), it); vector\u003cint\u003e subVinRight(it + 1, vin.end() ); root -\u003e left = reConstructBinaryTree(subPreLeft, subVinLeft); root -\u003e right = reConstructBinaryTree(subPreRight, subVinRight); return root; } } }; ","description":"","tags":["algorithm","binary-tree"],"title":"ã€å‰‘æŒ‡offerã€‘é‡å»ºäºŒå‰æ ‘","uri":"/blog/posts/Algorithm/sword-refers-to-offer-rebuild-the-binary-tree/"},{"categories":["Java"],"content":"Cè¯­è¨€å‡½æ•°è°ƒç”¨å®ç° é€šè¿‡ä¸€ä¸ªç®€å•çš„Cè¯­è¨€ç¨‹åºåˆ†æ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #include \u003cstdio.h\u003e int add(); int main(int argc, char const *argv[]) { int c = add(); printf(\"%d\", c); return 0; } int add() { int z = 1 + 2; return z; } å°†è¿™æ®µCç¨‹åºç¼–è¯‘æˆæ±‡ç¼–ç¨‹åºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 .file\t\".\\\\sampleAdd.c\" .section\t.rodata .LC0: .string\t\"%d\" .text .globl\tmain .type\tmain, @function main: .LFB13: .cfi_startproc pushq\t%rbp .cfi_def_cfa_offset 16 .cfi_offset 6, -16 movq\t%rsp, %rbp .cfi_def_cfa_register 6 subq\t$32, %rsp movl\t%edi, -20(%rbp) movq\t%rsi, -32(%rbp) movl\t$0, %eax call\tadd movl\t%eax, -4(%rbp) movl\t-4(%rbp), %eax movl\t%eax, %esi movl\t$.LC0, %edi movl\t$0, %eax call\tprintf movl\t$0, %eax leave .cfi_def_cfa 7, 8 ret .cfi_endproc .LFE13: .size\tmain, .-main .globl\tadd .type\tadd, @function add: .LFB14: .cfi_startproc pushq\t%rbp .cfi_def_cfa_offset 16 .cfi_offset 6, -16 movq\t%rsp, %rbp .cfi_def_cfa_register 6 movl\t$3, -4(%rbp) movl\t-4(%rbp), %eax popq\t%rbp .cfi_def_cfa 7, 8 ret .cfi_endproc .LFE14: .size\tadd, .-add .ident\t\"GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609\" .section\t.note.GNU-stack,\"\",@progbits å»é™¤å®å®šä¹‰ï¼Œä¿ç•™ä¸»è¦æŒ‡ä»¤å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 main: pushq\t%rbp movq\t%rsp, %rbp subq\t$32, %rsp movl\t%edi, -20(%rbp) movq\t%rsi, -32(%rbp) movl\t$0, %eax call\tadd movl\t%eax, -4(%rbp) movl\t-4(%rbp), %eax movl\t%eax, %esi movl\t$.LC0, %edi movl\t$0, %eax call\tprintf movl\t$0, %eax leave ret add: pushq\t%rbp movq\t%rsp, %rbp movl\t$3, -4(%rbp) movl\t-4(%rbp), %eax popq\t%rbp ret æ±‡ç¼–ç¨‹åºæœ‰ä¸¤ä¸ªæ ‡å·main, addã€‚è¿™ä¸æ˜¯å·§åˆï¼Œè€Œæ˜¯ç¼–è¯‘å™¨å¤„ç†çš„ç»“æœï¼Œç¼–è¯‘å™¨ä¼šæŠŠå‡½æ•°åå¤„ç†æˆæ±‡ç¼–ç¨‹åºä¸­çš„æ ‡å·ã€‚ æœ‰äº†æ ‡å·ï¼Œæ±‡ç¼–ç¨‹åºå°±èƒ½æ‰§è¡Œå‡½æ•°è°ƒç”¨ï¼Œå³callæŒ‡ä»¤ï¼Œæœ‰ä¸€æ¡call andæŒ‡ä»¤ï¼Œå°±æ˜¯æ±‡ç¼–ä¸­æ‰§è¡Œå‡½æ•°è°ƒç”¨çš„æŒ‡ä»¤ã€‚\næ¥ä¸‹æ¥é€æ®µåˆ†æï¼š\n1 2 3 4 # ä¿å­˜è°ƒç”¨è€…æ ˆåŸºåœ°å€ï¼Œå¹¶ä¸ºmain()å‡½æ•°åˆ†é…æ–°æ ˆç©ºé—´ pushq\t%rbp\tmovq\t%rsp, %rbp subq\t$32, %rsp\t# åˆ†é…æ–°æ ˆï¼Œä¸€å…±32å­—èŠ‚ åœ¨mianï¼Œaddä»£ç æ®µçš„å¼€å§‹éƒ½åŒ…å«è¿™3æ¡æŒ‡ä»¤ï¼Œaddä»£ç æ®µç¬¬3è¡Œæ˜¯movl\t$3, -4(%rbp)è¯¥æŒ‡ä»¤ä¸mianä»£ç æ®µçš„subq\t$32, %rspä½œç”¨æ˜¯ç›¸åŒçš„â€”â€”åˆ†é…æ ˆç©ºé—´ã€‚\nè¿™3æ¡æŒ‡ä»¤çš„ä½œç”¨ä¸ºï¼šä¿å­˜æ®µè°ƒç”¨è€…åŸºå€ï¼Œä¸ºæ–°æ–¹æ³•åˆ†é…æ–¹æ³•æ ˆã€‚è¿™å‡ ä¹æ˜¯æ±‡ç¼–ç¨‹åºæ‰§è¡Œæ–¹æ³•è°ƒç”¨çš„æ ‡å‡†å®šå¼ã€‚\nmain() å‡½æ•°çš„æ–¹æ³•æ ˆå†…å­˜å¸ƒå±€å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\n// è¿™é‡Œéœ€è¦æ’å…¥ä¸€å¼ å›¾ç‰‡\nå¸¦å…¥å‚çš„Cç¨‹åº 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #include \u003cstdio.h\u003e int add(int a, int b); int main(int argc, char const *argv[]) { int a = 5, b = 3; int c = add(a, b); return 0; } int add(int a, int b) { int z = 1 + 2; return z; } å°†è¿™æ®µCç¨‹åºç¼–è¯‘æˆæ±‡ç¼–ç¨‹åº(å»é™¤å®å®šä¹‰ï¼Œä¿ç•™ä¸»è¦æŒ‡ä»¤)ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 main: pushq\t%rbp movq\t%rsp, %rbp subq\t$32, %rsp movl\t%edi, -20(%rbp) movq\t%rsi, -32(%rbp) movl\t$5, -12(%rbp) movl\t$3, -8(%rbp) movl\t-8(%rbp), %edx movl\t-12(%rbp), %eax movl\t%edx, %esi movl\t%eax, %edi call\tadd movl\t%eax, -4(%rbp) movl\t$0, %eax leave ret add: pushq\t%rbp movq\t%rsp, %rbp movl\t%edi, -20(%rbp) movl\t%esi, -24(%rbp) movl\t$3, -4(%rbp) movl\t-4(%rbp), %eax popq\t%rbp ret Cè¯­è¨€å‡½æ•°çš„è°ƒç”¨æœºåˆ¶ å‹æ ˆ mainå‡½æ•°è°ƒç”¨add()å‡½æ•°ä¹‹å‰ï¼Œä¼šå°†ä¸¤ä¸ªå…¥å‚å‹æ ˆï¼ˆå‹å…¥è°ƒç”¨è€…çš„æ ˆï¼‰ï¼Œå‹æ ˆä¹‹åadd()å°±å¯ä»¥è·å–è¿™ä¸¤ä¸ªå…¥å‚ã€‚ å‚æ•°ä¼ é€’é¡ºåº Linuxå¹³å°ï¼Œè°ƒç”¨è€…å‡½æ•°å‘è¢«è°ƒç”¨è€…å‡½æ•°ä¼ é€’å‚æ•°ï¼Œé‡‡ç”¨é€†å‘é¡ºåºå‹æ ˆï¼Œå³æœ€åä¸€ä¸ªå‚æ•°ç¬¬ä¸€ä¸ªå‹æ ˆï¼Œç¬¬ä¸€ä¸ªå‚æ•°æœ€åå‹æ ˆ è¯»å–å…¥å‚ è¯»å–å…¥å‚çš„æ–¹å¼æ˜¯ï¼šé€šè¿‡add()å‡½æ•°çš„æ ˆåŸºåœ°å€rbpçš„ç›¸å¯¹åœ°å€ï¼Œä»main()å‡½æ•°ä¸­è¯»å–ï¼Œæœ€åä¸€ä½å…¥å‚åœ¨8(%rbp)ï¼Œä¾æ¬¡12(%rbp)...... çœŸå®ç‰©ç†æœºå™¨ä¸Šæ‰§è¡Œå‡½æ•°è°ƒç”¨çš„æ­¥éª¤ï¼š ä¿å­˜è°ƒç”¨è€…æ ˆåŸºåœ°å€ï¼Œå½“å‰IPå¯„å­˜å™¨å…¥æ ˆ è°ƒç”¨å‡½æ•°æ—¶ï¼Œåœ¨x86å¹³å°å‚æ•°ä»å³åˆ°å·¦ä¾æ¬¡å…¥æ ˆ ä¸€ä¸ªæ–¹æ³•æ‰€åˆ†é…çš„æ ˆç©ºé—´å¤§å°ï¼Œå–å†³äºæ–¹æ³•å†…éƒ¨å±€éƒ¨å˜é‡ç©ºé—´ã€ä¸ºè¢«è°ƒç”¨è€…æ‰€ä¼ é€’çš„å…¥å‚å¤§å° è¢«è°ƒç”¨è€…åœ¨æ¥æ”¶å…¥å‚æ—¶ï¼Œä»8(%rbp)å¤„å¼€å§‹ï¼Œå¾€ä¸Šé€ä¸ªè·å–å‚æ•° è¢«è°ƒç”¨è€…å°†è¿”å›ç»“æœä¿å­˜åœ¨eaxå¯„å­˜å™¨ä¸­ï¼Œè°ƒç”¨è€…ä»è¯¥å¯„å­˜å™¨å–å€¼ è¡¥å……ï¼ˆå…³äºå¯„å­˜å™¨ï¼‰ %rax ä½œä¸ºå‡½æ•°è¿”å›å€¼ä½¿ç”¨ã€‚ %rsp æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼ŒæŒ‡å‘æ ˆé¡¶ %rdiï¼Œ%rsiï¼Œ%rdxï¼Œ%rcxï¼Œ%r8ï¼Œ%r9 ç”¨ä½œå‡½æ•°å‚æ•°ï¼Œä¾æ¬¡å¯¹åº”ç¬¬1å‚æ•°ï¼Œç¬¬2å‚æ•°ã€‚ã€‚ã€‚ %rbxï¼Œ%rbpï¼Œ%r12ï¼Œ%r13ï¼Œ%14ï¼Œ%15 ç”¨ä½œæ•°æ®å­˜å‚¨ï¼Œéµå¾ªè¢«è°ƒç”¨è€…ä½¿ç”¨è§„åˆ™ï¼Œç®€å•è¯´å°±æ˜¯éšä¾¿ç”¨ï¼Œè°ƒç”¨å­å‡½æ•°ä¹‹å‰è¦å¤‡ä»½å®ƒï¼Œä»¥é˜²ä»–è¢«ä¿®æ”¹ %r10ï¼Œ%r11 ç”¨ä½œæ•°æ®å­˜å‚¨ï¼Œéµå¾ªè°ƒç”¨è€…ä½¿ç”¨è§„åˆ™ï¼Œç®€å•è¯´å°±æ˜¯ä½¿ç”¨ä¹‹å‰è¦å…ˆä¿å­˜åŸå€¼ Reference X86-64å¯„å­˜å™¨å’Œæ ˆå¸§\næ­ç§˜Javaè™šæ‹Ÿæœº\n","description":"","tags":["jvm"],"title":"\u003cæ·±å…¥ç†è§£JVM\u003e å‡½æ•°è°ƒç”¨æœºåˆ¶","uri":"/blog/posts/Java/implement-function-call-in-c/"},{"categories":["Algorithm"],"content":"ç®€ä»‹ å¹³è¡¡æ ‘ï¼ˆAVLTreeï¼‰\nåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒAVLæ ‘æ˜¯æœ€å…ˆå‘æ˜çš„è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ã€‚åœ¨AVLæ ‘ä¸­ä»»ä½•èŠ‚ç‚¹çš„ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦æœ€å¤§å·®åˆ«ä¸º1ï¼Œæ‰€ä»¥å®ƒä¹Ÿè¢«ç§°ä¸ºé«˜åº¦å¹³è¡¡æ ‘ã€‚æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤åœ¨å¹³å‡å’Œæœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ã€‚å¢åŠ å’Œåˆ é™¤å¯èƒ½éœ€è¦é€šè¿‡ä¸€æ¬¡æˆ–å¤šæ¬¡æ ‘æ—‹è½¬æ¥é‡æ–°å¹³è¡¡è¿™ä¸ªæ ‘ã€‚AVLæ ‘å¾—åäºå®ƒçš„å‘æ˜è€…G. M. Adelson-Velskyå’ŒE. M. Landisï¼Œä»–ä»¬åœ¨1962å¹´çš„è®ºæ–‡ã€ŠAn algorithm for the organization of informationã€‹ä¸­å‘è¡¨äº†å®ƒã€‚\nèŠ‚ç‚¹çš„å¹³è¡¡å› å­æ˜¯å®ƒçš„å·¦å­æ ‘çš„é«˜åº¦å‡å»å®ƒçš„å³å­æ ‘çš„é«˜åº¦ï¼ˆæœ‰æ—¶ç›¸åï¼‰ã€‚å¸¦æœ‰å¹³è¡¡å› å­1ã€0æˆ– -1çš„èŠ‚ç‚¹è¢«è®¤ä¸ºæ˜¯å¹³è¡¡çš„ã€‚å¸¦æœ‰å¹³è¡¡å› å­ -2æˆ–2çš„èŠ‚ç‚¹è¢«è®¤ä¸ºæ˜¯ä¸å¹³è¡¡çš„ï¼Œå¹¶éœ€è¦é‡æ–°å¹³è¡¡è¿™ä¸ªæ ‘ã€‚å¹³è¡¡å› å­å¯ä»¥ç›´æ¥å­˜å‚¨åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­ï¼Œæˆ–ä»å¯èƒ½å­˜å‚¨åœ¨èŠ‚ç‚¹ä¸­çš„å­æ ‘é«˜åº¦è®¡ç®—å‡ºæ¥ã€‚\näºŒå‰æŸ¥æ‰¾æ ‘ç»™æˆ‘ä»¬å¸¦æ¥äº†å¾ˆå¤šæ–¹ä¾¿ï¼Œä½†æ˜¯ç”±äºå…¶åœ¨æœ‰åºåºåˆ—æ’å…¥æ—¶å°±ä¼šé€€åŒ–æˆå•é“¾è¡¨ï¼ˆæ—¶é—´å¤æ‚åº¦é€€åŒ–æˆ O(n)ï¼ŒAVL-treeå°±å…‹æœäº†ä¸Šè¿°å›°éš¾ã€‚AVL-treeæ˜¯ä¸€ä¸ªâ€œåŠ ä¸Šäº†å¹³è¡¡æ¡ä»¶çš„â€äºŒå‰æœç´¢æ ‘ï¼Œå¹³è¡¡æ¡ä»¶ç¡®ä¿æ•´æ£µæ ‘çš„æ·±åº¦ä¸ºO(log n)ã€‚\nAVLæ ‘æ˜¯æœ€å…ˆå‘æ˜çš„è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ã€‚åœ¨AVLæ ‘ä¸­ä»»ä½•èŠ‚ç‚¹çš„ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦æœ€å¤§å·®åˆ«ä¸ºä¸€ï¼Œæ‰€ä»¥å®ƒä¹Ÿè¢«ç§°ä¸ºé«˜åº¦å¹³è¡¡æ ‘ã€‚æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤åœ¨å¹³å‡å’Œæœ€åæƒ…å†µä¸‹éƒ½æ˜¯ O(log n)ã€‚å¢åŠ å’Œåˆ é™¤å¯èƒ½éœ€è¦é€šè¿‡ä¸€æ¬¡æˆ–å¤šæ¬¡æ ‘æ—‹è½¬æ¥é‡æ–°å¹³è¡¡è¿™ä¸ªæ ‘ã€‚\nAVLæ ‘çš„æ‰€æœ‰æ“ä½œéƒ½ä¸äºŒå‰æŸ¥æ‰¾æ ‘ç›¸åŒï¼Œä¸åŒçš„æ˜¯ï¼Œè¿™é‡ŒAVLæ ‘éœ€è¦åšâ€œAVLæ—‹è½¬â€ã€‚\nAVLæ—‹è½¬ AVLæ ‘æœ€é‡è¦çš„æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯AVLæ—‹è½¬äº†ï¼Œè¿™éƒ¨åˆ†æˆ‘çš„æ„Ÿè§¦æ˜¯ï¼Œå•åšæ—‹è½¬è¿˜æ˜¯æŒºå¥½ç†è§£çš„ï¼Œåªä¸è¿‡å†™èµ·ä»£ç æ¥æœ‰ç‚¹å¤æ‚ï¼Œä¹¦ä¸­ä»¥æ’å…¥èŠ‚ç‚¹ä¸ºä¾‹ï¼Œåˆ é™¤èŠ‚ç‚¹çš„éƒ¨åˆ†æŠ˜è…¾äº†å¥½ä¹…ã€‚\nåœ¨ç†è§£AVLæ—‹è½¬ä¹‹å‰ï¼Œé¦–å…ˆå¾—çŸ¥é“ä»¥ä¸‹å‡ ä¸ªæ¦‚å¿µï¼š\nAVL æ ‘èŠ‚ç‚¹çš„æ’å…¥æ€»æ˜¯åœ¨å¶å­èŠ‚ç‚¹ã€‚ AVL æ ‘åœ¨æ’å…¥èŠ‚ç‚¹ä¹‹å‰æ€»æ˜¯æ»¡è¶³å¹³è¡¡æ¡ä»¶çš„ã€‚ æ’å…¥æ–°èŠ‚ç‚¹åæœ‰å¯èƒ½æ»¡è¶³å¹³è¡¡æ¡ä»¶ä¹Ÿæœ‰å¯èƒ½ä¸æ»¡è¶³ã€‚ å½“ä¸æ»¡è¶³å¹³è¡¡æ¡ä»¶åï¼Œæˆ‘ä»¬å°±éœ€è¦å¯¹æ–°çš„æ ‘è¿›è¡Œæ—‹è½¬ã€‚ æ—‹è½¬ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ‰¾åˆ°ä¸€ä¸ªXèŠ‚ç‚¹ï¼Œè¿™ä¸ªXèŠ‚ç‚¹åšå¦‚ä¸‹å®šä¹‰ï¼š\nå‡å¦‚æˆ‘ä»¬åœ¨æŸä¸€ä¸ªå¶å­èŠ‚ç‚¹å¤„æ’å…¥ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹åï¼Œæ­¤æ—¶è¿™æ£µæ ‘çš„æŸäº›èŠ‚ç‚¹çš„å¹³è¡¡æ€§ä¼šå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä»å¶å­èŠ‚ç‚¹å‘ä¸Šåˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šç¬¬ä¸€ä¸ªå¹³è¡¡æ€§å‘ç”Ÿå˜åŒ–çš„èŠ‚ç‚¹ã€‚\nåŸºäºè¿™ä¸ªXèŠ‚ç‚¹ï¼Œè€ƒè™‘ä¸€ä»¶äº‹æƒ…ï¼š è¿™ä¸ªXèŠ‚ç‚¹åˆ†ä¸ºå·¦å³å­æ ‘ï¼Œå·¦å³å­æ ‘åˆæœ‰å·¦å³å­æ ‘ï¼Œ1åˆ†2ï¼Œ2åˆ†4ï¼Œæ‰€ä»¥ä»¥è¿™ä¸ªXèŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„è¯ï¼Œæ–°æ’å…¥çš„èŠ‚ç‚¹å¯èƒ½å‡ºç°çš„ä½ç½®æœ‰ï¼š\nXçš„å·¦å­©å­èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸Š**(left-left)** Xçš„å³å­©å­èŠ‚ç‚¹çš„å³å­æ ‘ä¸Š**(right-right)** Xçš„å·¦å­©å­èŠ‚ç‚¹çš„å³å­æ ‘ä¸Š**(left-right)** Xçš„å³å­©å­èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸Š**(right-left)**\næ ¹æ®ä¸Šè¿°æƒ…å†µå°±å»¶ç”Ÿå‡ºäº†4ç§æ—‹è½¬ï¼š 1.left-left Rotation 2.right-right Rotation 3.left-right Rotation 4.right-left Rotation\nå‰ä¸¤ç§å±äºå•æ—‹è½¬ï¼Œåä¸¤ç§å±äºåŒæ—‹è½¬ï¼ŒåŒæ—‹è½¬çš„æ“ä½œå¯ä»¥ç”±ä¸¤æ¬¡å•æ—‹è½¬ç»„æˆã€‚\nPS:AVLæ ‘çš„æ—‹è½¬è¿˜æ˜¯å¾—ç”»å›¾æ¥ç†è§£ï¼Œè¿™é‡Œç›´æ¥è´´å‡ºä¹¦ä¸­çš„å›¾äº†ã€‚\nå›¾ç‰‡æ¥è‡ª Cå°åŠ çš„åšå®¢\n6èŠ‚ç‚¹çš„å·¦å­æ ‘3èŠ‚ç‚¹é«˜åº¦æ¯”å³å­æ ‘7èŠ‚ç‚¹å¤§2ï¼Œå·¦å­æ ‘3èŠ‚ç‚¹çš„å·¦å­æ ‘1èŠ‚ç‚¹é«˜åº¦å¤§äºå³å­æ ‘4èŠ‚ç‚¹ï¼Œè¿™ç§æƒ…å†µæˆä¸ºå·¦å·¦ï¼ˆLLï¼‰ã€‚ 6èŠ‚ç‚¹çš„å·¦å­æ ‘2èŠ‚ç‚¹é«˜åº¦æ¯”å³å­æ ‘7èŠ‚ç‚¹å¤§2ï¼Œå·¦å­æ ‘2èŠ‚ç‚¹çš„å·¦å­æ ‘1èŠ‚ç‚¹é«˜åº¦å°äºå³å­æ ‘4èŠ‚ç‚¹ï¼Œè¿™ç§æƒ…å†µæˆä¸ºå·¦å³ï¼ˆLRï¼‰ã€‚ 2èŠ‚ç‚¹çš„å·¦å­æ ‘1èŠ‚ç‚¹é«˜åº¦æ¯”å³å­æ ‘5èŠ‚ç‚¹å°2ï¼Œå³å­æ ‘5èŠ‚ç‚¹çš„å·¦å­æ ‘3èŠ‚ç‚¹é«˜åº¦å¤§äºå³å­æ ‘6èŠ‚ç‚¹ï¼Œè¿™ç§æƒ…å†µæˆä¸ºå³å·¦ï¼ˆRLï¼‰ã€‚ 2èŠ‚ç‚¹çš„å·¦å­æ ‘1èŠ‚ç‚¹é«˜åº¦æ¯”å³å­æ ‘4èŠ‚ç‚¹å°2ï¼Œå³å­æ ‘4èŠ‚ç‚¹çš„å·¦å­æ ‘3èŠ‚ç‚¹é«˜åº¦å°äºå³å­æ ‘6èŠ‚ç‚¹ï¼Œè¿™ç§æƒ…å†µæˆä¸ºå³å³ï¼ˆRRï¼‰ã€‚ ä»å›¾2ä¸­å¯ä»¥å¯ä»¥çœ‹å‡ºï¼Œ1å’Œ4ä¸¤ç§æƒ…å†µæ˜¯å¯¹ç§°çš„ï¼Œè¿™ä¸¤ç§æƒ…å†µçš„æ—‹è½¬ç®—æ³•æ˜¯ä¸€è‡´çš„ï¼Œåªéœ€è¦ç»è¿‡ä¸€æ¬¡æ—‹è½¬å°±å¯ä»¥è¾¾åˆ°ç›®æ ‡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå•æ—‹è½¬ã€‚2å’Œ3ä¸¤ç§æƒ…å†µä¹Ÿæ˜¯å¯¹ç§°çš„ï¼Œè¿™ä¸¤ç§æƒ…å†µçš„æ—‹è½¬ç®—æ³•ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼Œéœ€è¦è¿›è¡Œä¸¤æ¬¡æ—‹è½¬ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåŒæ—‹è½¬ã€‚\né‚£ä¹ˆä¸ºä»€ä¹ˆéœ€è¦åŒæ—‹è½¬å‘¢ï¼Ÿ\nè¿™é‡Œæˆ‘åšå‡ºæˆ‘ä¸ªäººçš„è§£é‡Šï¼Œåœ¨ LL æƒ…å†µä¸­ï¼Œè¦è¾¾åˆ°å¹³è¡¡ï¼Œæ˜¯éœ€è¦å°†å¤±è¡¡èŠ‚ç‚¹åˆ’åˆ†åˆ°å³è¾¹ï¼Œå¤±è¡¡èŠ‚ç‚¹çš„å·¦å­©å­è¡¥ä¸Šå¤±è¡¡èŠ‚ç‚¹çš„ä½ç½®ã€‚è¿™æ ·å·¦å­æ ‘çš„é«˜åº¦ -1ï¼Œ å³è¾¹çš„é«˜åº¦ +1ï¼Œè¿™æ ·å·¦å³ä¸¤è¾¹çš„ä¸ªæ•°å°±å¹³è¡¡äº†ã€‚å½“ç„¶æ ¹æ®BSTçš„æ€§è´¨ï¼Œå¦‚æœå¤±è¡¡èŠ‚ç‚¹å­˜åœ¨å³å­©å­çš„è¯åº”è¯¥åˆ’ä¹Ÿè¦åˆ†åˆ°å³è¾¹ã€‚RR æƒ…å†µä¸ LL æƒ…å†µå¯¹ç§°ã€‚\nè€Œåœ¨ LR æƒ…å†µä¸­ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦æŠŠå¤±è¡¡èŠ‚ç‚¹åˆ’åˆ°å³è¾¹ï¼Œå¤±è¡¡èŠ‚ç‚¹çš„å·¦å­©å­çš„å³å­©å­æ›¿è¡¥å¤±è¡¡èŠ‚ç‚¹åŸæ¥çš„ä½ç½®ã€‚ä½†æˆ‘ä»¬çš„èŠ‚ç‚¹å­˜å‚¨ç»“æ„æœ‰ä¸èƒ½è·å¾—å‰é©±èŠ‚ç‚¹çš„é™åˆ¶ï¼Œæˆ‘ä»¬åªæœ‰åç»§å…³ç³»ï¼Œå³æˆ‘ä»¬åªèƒ½é€šè¿‡å¤±è¡¡èŠ‚ç‚¹è®¿é—®å…¶ä»–èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥æŠŠLRå­©å­æ”¾ä¸Šæ¥ï¼Œè€Œæ˜¯åˆ†æˆä¸¤æ­¥è°ƒæ•´ã€‚\n// è¿™é‡Œçš„æè¿°å¤ªé‚£å•¥äº†ï¼Œå¾—æç‚¹å›¾è¯´æ˜ä¸‹\nAVL-Treeå®ç° AVL-Treeæ˜¯ä¸€ä¸ªäºŒå‰æ’åºæ ‘ï¼Œå…¶åŸºæœ¬æ“ä½œä¹Ÿè·Ÿå®ƒç±»ä¼¼ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯åœ¨æ’å…¥ï¼Œåˆ é™¤èŠ‚ç‚¹åï¼Œéœ€è¦å¯¹æ ‘è¿›è¡Œè°ƒæ•´ï¼Œè®©æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ä¿æŒå¹³è¡¡ã€‚\nèŠ‚ç‚¹çš„å¹³è¡¡å› å­æ˜¯é€šè¿‡è®¡ç®—å…¶å·¦å­æ ‘å’Œå³å­æ ‘çš„å·®å¾—æ¥çš„ï¼Œè¿™é‡Œæœ‰ä¸¤ç§è€ƒè™‘æ–¹å¼ï¼š\næ¯æ¬¡éƒ½è®¡ç®—ä¸€æ¬¡ï¼ˆé€’å½’æ±‚æ·±åº¦ï¼‰ã€‚ å°†å¹³è¡¡å› å­ä½œä¸ºä¸€ä¸ªæˆå‘˜å˜é‡ä¿å­˜åœ¨èŠ‚ç‚¹ä¸­ï¼Œå¹³è¡¡æ€§å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ›´æ–°ã€‚ æœ¬æ–‡é‡‡å–çš„æ˜¯ç¬¬ä¸€ç§æ–¹å¼ï¼Œå…³äºä¸¤ç§æ–¹å¼åˆ©å¼Šçš„æ¯”è¾ƒï¼š\n// ä¸æƒ³å†™ï¼Ÿè‡ªå·±ç™¾åº¦å§ï¼Œåæ­£å°±æ˜¯ç¬¬ä¸€ç§æ–¹æ³•ä»ä¸Šåˆ°ä¸‹é€’å½’å­˜åœ¨é‡å¤è°ƒç”¨å¢åŠ æ—¶é—´å¼€é”€ï¼Œç¬¬äºŒç§å¹³è¡¡æ€§å˜åŒ–æ—¶å€™éœ€è¦update å¤±è¡¡ä½ç½® balanceFactor\nå¦å¤–ï¼Œè¿™é‡Œæˆ‘ç”¨äº†C++ç±»å°è£…ï¼Œä¸ºäº†å­¦ä¹ è¿˜é¡ºä¾¿ä½¿ç”¨äº†æ¨¡æ¿ï¼Œæ‰€ä»¥ç±»çš„å£°æ˜å’Œå®ç°éƒ½æ”¾åœ¨äº†ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ„Ÿè§‰å†…å®¹å¤ªå¤šï¼Œè¿˜æ˜¯åˆ†å¼€æ¥æ¯”è¾ƒå¥½ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 // AVLNode.h #ifndef __AVLNODE_H__ #define __AVLNODE_H__ #include \u003ciostream\u003e #include \u003cvector\u003e #include \u003calgorithm\u003e template \u003ctypename KeyType\u003e class AVLNode{ public: KeyType key; AVLNode * left; AVLNode * right; AVLNode() : key(0), left(NULL), right(NULL) {} AVLNode(KeyType k) :key(k), left(NULL), right(NULL) {} }; #endif 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 // AVLTree.h #ifndef AVLTREE_AVLTREE_H #define AVLTREE_AVLTREE_H #include \"AVLNode.h\" //AVLæ ‘çš„æ¨¡æ¿å®ç° template \u003ctypename KeyType\u003e class AVLTree { //ç±»å‹å®šä¹‰ typedef AVLNode\u003cKeyType\u003e AVLNode; typedef AVLTree\u003cKeyType\u003e AVLTree; private: AVLNode * avlroot; //æ±‚æ ‘çš„é«˜åº¦ int __height(const AVLNode *root); //é«˜åº¦å·®ï¼ˆå¹³è¡¡å› å­ï¼‰ int __diff(const AVLNode*root); //AVL4ç§æ—‹è½¬ï¼šå·¦å·¦ï¼Œå·¦å³ï¼Œå³å³ï¼Œå³å·¦ //Xå®šä¹‰ä¸ºæ’å…¥ä½ç½®èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·¯å¾„ä¸Šå¹³è¡¡æ¡ä»¶è¢«æ”¹å˜çš„èŠ‚ç‚¹ä¸­æœ€æ·±çš„é‚£ä¸ªèŠ‚ç‚¹ //Xé€šè¿‡é€’å½’è¿”å›çš„æ–¹å¼æ‰¾åˆ° //å·¦å·¦ï¼šæ’å…¥ç‚¹ä½äºXçš„å·¦å­©å­èŠ‚ç‚¹çš„å·¦å­æ ‘ //å·¦å³ï¼šæ’å…¥ç‚¹ä½äºXçš„å·¦å­©å­èŠ‚ç‚¹çš„å³å­æ ‘ //å³å³ï¼šæ’å…¥ç‚¹ä½äºXçš„å³å­©å­èŠ‚ç‚¹çš„å³å­æ ‘ //å³å·¦ï¼šæ’å…¥ç‚¹ä½äºXçš„å³å­©å­èŠ‚ç‚¹çš„å·¦å­æ ‘ //å•æ—‹è½¬ AVLNode * __ll_Rotation(AVLNode *root);//left-left rotation AVLNode * __rr_Rotation(AVLNode *root);//right-right rotation //åŒæ—‹è½¬ AVLNode * __lr_Rotation(AVLNode *root);//left-right rotation AVLNode * __rl_Rotation(AVLNode *root);//right-left rotation //å¹³è¡¡æ“ä½œ AVLNode * __Balance(AVLNode *root); //æ’å…¥çš„å†…éƒ¨å®ç° AVLNode * __Insert(AVLNode *root, const KeyType \u0026k); //ä¸­åºéå†çš„ä¸¤ç§é‡è½½ // 1. ç›´æ¥è¾“å‡ºä¸­åºéå†èŠ‚ç‚¹ void __InorderTraversal(const AVLNode* root); // 2. ç»“æœä¿å­˜åˆ°vectorä¸­ void __InorderTraversal(const AVLNode*root, std::vector\u003cKeyType\u003e\u0026vec); //åˆ¤æ–­æ˜¯å¦æ˜¯å¶å­èŠ‚ç‚¹ bool __isLeaf(AVLNode* const \u0026node) {return (node-\u003eleft == nullptr \u0026\u0026 node-\u003eright == nullptr) ? true : false}; //åˆ¤æ–­æ˜¯å¦æœ‰ä¸¤ä¸ªå­©å­ bool __isNodeWithTwoChild(AVLNode * const \u0026node); //æŸ¥æ‰¾çš„å†…éƒ¨å®ç° AVLNode* __search(AVLNode *const root, const KeyType \u0026k); //åˆ é™¤æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ void __deleteTree(AVLNode * root); //åˆ é™¤èŠ‚ç‚¹ AVLNode* __Delete(AVLNode * root, const KeyType\u0026 k); //æ±‚å½“å‰æ ¹èŠ‚ç‚¹æœ€å°ï¼ˆä¸€è·¯å‘å·¦ï¼‰ AVLNode* __treeMin(AVLNode *root); //æ±‚å½“å‰æ ¹èŠ‚ç‚¹çš„æœ€å¤§ï¼ˆä¸€è·¯å‘å³ï¼‰ AVLNode* __treeMax(AVLNode *root); public: AVLTree(){ avlroot = nullptr; }//é»˜è®¤æ„é€ å‡½æ•° ~AVLTree();//ææ„å‡½æ•°åˆ é™¤æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹ AVLTree(const std::vector\u003cKeyType\u003e\u0026);//æ„é€ å‡½æ•°ï¼Œå®¹å™¨æ„é€  AVLTree(const KeyType * arr, size_t len);//æ„é€ å‡½æ•°ï¼Œæ•°ç»„æ„é€  void InorderTraversal();//ä¸­åºéå†å¤–éƒ¨æ¥å£ void InorderTraversal(std::vector\u003cKeyType\u003e\u0026);//ä¸­åºéå†å¤–éƒ¨æ¥å£é‡è½½2 bool Delete(const KeyType \u0026k);//åˆ é™¤èŠ‚ç‚¹çš„å¤–éƒ¨æ¥å£ void Insert(const KeyType \u0026 k);//æ’å…¥èŠ‚ç‚¹çš„å¤–éƒ¨æ¥å£ bool IsEmpty(){ return avlroot == nullptr; } //æ ‘ç©ºï¼Ÿ bool search(const KeyType \u0026k);//æŸ¥è¯¢å¤–éƒ¨æ¥å£ }; #endif //AVLTREE_AVLTREE_H æ—‹è½¬æ“ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 template \u003ctypename KeyType\u003e AVLNode * AVLTree::__ll_Rotation(AVLNode *root) { AVLNode * tmp; tmp = root-\u003eleft; root-\u003eleft = tmp-\u003eright; tmp-\u003eright = root; return tmp; } template \u003ctypename KeyType\u003e AVLNode * AVLTree::__rr_Rotation(AVLNode *root) { AVLNode* tmp; tmp = root-\u003eright; root-\u003eright = tmp-\u003eleft; tmp-\u003eleft = root; return tmp; } template \u003ctypename KeyType\u003e AVLNode * AVLTree::__lr_Rotation(AVLNode *root) { AVLNode * tmp; tmp = root-\u003eleft; root-\u003eleft = __rr_Rotation(tmp); return __ll_Rotation(root); } template \u003ctypename KeyType\u003e AVLNode * AVLTree::__rl_Rotation(AVLNode *root) { AVLNode * tmp; tmp = root-\u003eright; root-\u003eright = __ll_Rotation(tmp); return __rr_Rotation(root); } AVLTree æ’å…¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 template \u003ctypename KeyType\u003e AVLNode * AVLTree::__Insert(AVLNode * root, const KeyType\u0026 k) { if (nullptr == root) { root = new AVLNode(k); return root; }//é€’å½’è¿”å›æ¡ä»¶ else if (k \u003c root-\u003ekey) { root-\u003eleft = __Insert(root-\u003eleft, k);//é€’å½’å·¦å­æ ‘ //balance operation root = __Balance(root);//å¹³è¡¡æ“ä½œåŒ…å«äº†å››ç§æ—‹è½¬ } else if (k\u003eroot-\u003ekey) { root-\u003eright = __Insert(root-\u003eright, k);//é€’å½’å³å­æ ‘ //balance operation root = __Balance(root);//å¹³è¡¡æ“ä½œåŒ…å«äº†å››ç§æ—‹è½¬ } return root; } AVLTree åˆ é™¤ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 //åˆ é™¤èŠ‚ç‚¹çš„ç§æœ‰æˆå‘˜å®ç° template \u003ctypename KeyType\u003e AVLNode * AVLTree::__Delete(AVLNode *root, const KeyType\u0026 k) { if (nullptr == root) return root; if (!search(k))//æŸ¥æ‰¾åˆ é™¤å…ƒç´ æ˜¯å¦å­˜åœ¨ { std::cerr \u003c\u003c \"Delete error , key not find\" \u003c\u003c std::endl; return root; } if (k == root-\u003ekey)//æ ¹èŠ‚ç‚¹ { if (__isNodeWithTwoChild(root))//å·¦å³å­æ ‘éƒ½éç©º { if (__diff(root) \u003e 0)//å·¦å­æ ‘æ›´é«˜ï¼Œåœ¨å·¦è¾¹åˆ é™¤ { root-\u003ekey = __treeMax(root-\u003eleft)-\u003ekey;//ä»¥å·¦å­æ ‘çš„æœ€å¤§å€¼æ›¿æ¢å½“å‰å€¼ root-\u003eleft = __Delete(root-\u003eleft, root-\u003ekey);//åˆ é™¤å·¦å­æ ‘ä¸­å·²ç»æ›¿æ¢ä¸Šå»çš„èŠ‚ç‚¹ } else//å³å­æ ‘æ›´é«˜ï¼Œåœ¨å³è¾¹åˆ é™¤ { root-\u003ekey = __treeMin(root-\u003eright)-\u003ekey; root-\u003eright = __Delete(root-\u003eright, root-\u003ekey); } } else//æœ‰ä¸€ä¸ªå­©å­ã€å¶å­èŠ‚ç‚¹çš„æƒ…å†µåˆå¹¶ { //if (!__isLeaf(root)) AVLNode * tmp = root; root = (root-\u003eleft) ? (root-\u003eleft) :( root-\u003eright); delete tmp; tmp = nullptr; } }//end-if else if (k \u003c root-\u003ekey)//å¾€å·¦è¾¹åˆ é™¤ { root-\u003eleft = __Delete(root-\u003eleft, k);//å·¦å­æ ‘ä¸­é€’å½’åˆ é™¤ //åˆ¤æ–­å¹³è¡¡çš„æ¡ä»¶ä¸åœ¨æ’å…¥æ—¶æƒ…å†µç±»ä¼¼ if (__diff(root) \u003c -1)//ä¸æ»¡è¶³å¹³è¡¡æ¡ä»¶ï¼Œåˆ é™¤å·¦è¾¹çš„åï¼Œå³å­æ ‘å˜é«˜ { if (__diff(root-\u003eright) \u003e 0) { root = __rl_Rotation(root); } else { root = __rr_Rotation(root); } } }//end else if else { root-\u003eright = __Delete(root-\u003eright, k); if (__diff(root) \u003e 1)//ä¸æ»¡è¶³å¹³è¡¡æ¡ä»¶ { if (__diff(root-\u003eleft) \u003c 0) { root = __lr_Rotation(root); } else { root = __ll_Rotation(root); } } } return root; } é™„ï¼šå®Œæ•´ä»£ç \nå‚è€ƒ STLæºç ç¬”è®°ï¼ˆ18ï¼‰â€”å¹³è¡¡äºŒå‰æ ‘AVLï¼ˆC++å°è£…+æ¨¡æ¿ï¼‰\nå¹³è¡¡äºŒå‰æ ‘,AVLæ ‘ä¹‹å›¾è§£ç¯‡\nä¸€æ­¥ä¸€æ­¥å†™å¹³è¡¡äºŒå‰æ ‘ï¼ˆAVLæ ‘ï¼‰\nå¹³è¡¡äºŒå‰æ ‘(avl)åˆ†æä¸å®ç°\n","description":"","tags":["algorithm","tree"],"title":"å¹³è¡¡äºŒå‰æ ‘å°è£…+æ¨¡æ¿å®ç°","uri":"/blog/posts/Algorithm/%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91%E5%B0%81%E8%A3%85%E4%B8%8E%E6%A8%A1%E6%9D%BF%E5%AE%9E%E7%8E%B0/"},{"categories":["Algorithm"],"content":" All Topological Sortsï¼Œåœ¨å‰ä¸€ç« ä¸­Topological Sortingï¼Œå·²ç»è®¨è®ºäº†æ‹“æ‰‘æ’åºçš„åŸç†åŠå…¶å®ç°ç®—æ³•ï¼Œä½†åªæ˜¯å®ç°äº†ä»å•ä¸€ä¸€ä¸ªå…¥åº¦ä¸º0çš„èŠ‚ç‚¹è¿›è¡Œçš„æ‹“æ‰‘æ’åºã€‚æœ¬ç« ä¸»è¦æ¥è®¨è®ºä¸€ä¸‹ï¼Œå¦‚ä½•æ±‚ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾çš„æ‰€æœ‰æ‹“æ‰‘æ’åºåºåˆ—ã€‚\né—®é¢˜æè¿° å› ä¸ºåœ¨ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ä¸­ï¼Œå¹¶éæ‰€æœ‰é¡¶ç‚¹é—´éƒ½æœ‰è·¯å¾„å¯è¾¾ï¼Œè€Œä¸”å¯èƒ½æœ‰äº›ç‚¹æ˜¯å­¤ç«‹ç‚¹ï¼Œè¿™å¯¼è‡´äº†åŒä¸€ä¸ªæœ‰å‘å›¾å¯èƒ½ä¼šæœ‰å¤šä¸ªæ‹“æ‰‘æ’åºï¼Œå› ä¸ºæ˜¾ç„¶å­¤ç«‹ç‚¹åœ¨æ‹“æ‰‘åºåˆ—ä¸­çš„ä½ç½®æ˜¯ä»»æ„çš„ï¼Œå„å­è¿é€šå­å›¾é—´çš„å…ˆåæ¬¡åºä¹Ÿå¯ä»¥äº’æ¢ã€‚\né‚£ä¹ˆå¦‚ä½•æ¥æ±‚ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾çš„æ‰€æœ‰æ‹“æ‰‘æ’åºåºåˆ—å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹å‰ä¸€ç¯‡æ–‡ç« ä¸­çš„ç®—æ³•è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œå³åœ¨åŸæœ‰æ‹“æ‰‘æ’åºè¿‡ç¨‹çš„åŸºç¡€ä¸Šï¼ŒåŠ ä¸Šå›æº¯æ³•ï¼Œå¹¶å¯¹æ‰€æœ‰å…¥åº¦ä¸º0çš„é¡¶ç‚¹åº”ç”¨è¿™ä¸ªå¸¦å›æº¯çš„æ‹“æ‰‘æ’åºç®—æ³•ï¼Œ\nç®—æ³•æ€è·¯ åˆå§‹åŒ–æ‰€æœ‰é¡¶ç‚¹ä¸ºæœªè®¿é—®çŠ¶æ€ï¼› ä¾æ¬¡å¯¹æ‰€æœ‰å…¥åº¦ä¸º0çš„é¡¶ç‚¹ï¼Œå…ˆæŠŠå…¶å…¥åº¦é™1ï¼Œç„¶åæŠŠè¯¥é¡¶ç‚¹æ”¾åˆ°æ’åºåºåˆ—ä¸­ï¼Œç„¶åé€’å½’è®¿é—®å®ƒçš„æ‰€æœ‰é‚»æ¥ç‚¹ï¼Œæœ€åå›æº¯ï¼› åœ¨å‡½æ•°æœ€ç»ˆè¿”å›åï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªæ‹“æ‰‘åºåˆ—ï¼Œç„¶åé‡ç½®è®¿é—®çŠ¶æ€å’Œå…¥åº¦ï¼Œç»§ç»­å¯»æ‰¾å…¶å®ƒæ‹“æ‰‘åºåˆ—ã€‚ ä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 #include \u003cbits/stdc++.h\u003e using namespace std; class Graph { int V; // No. of vertices // Pointer to an array containing adjacency list list\u003cint\u003e *adj; // Vector to store indegree of vertices vector\u003cint\u003e indegree; // A function used by alltopologicalSort void alltopologicalSortUtil(vector\u003cint\u003e\u0026 res, bool visited[]); public: Graph(int V); // Constructor // function to add an edge to graph void addEdge(int v, int w); // Prints all Topological Sorts void alltopologicalSort(); }; // Constructor of graph Graph::Graph(int V) { this-\u003eV = V; adj = new list\u003cint\u003e[V]; // Initialising all indegree with 0 for (int i = 0; i \u003c V; i++) indegree.push_back(0); } // Utility function to add edge void Graph::addEdge(int v, int w) { adj[v].push_back(w); // Add w to v's list. // increasing inner degree of w by 1 indegree[w]++; } // Main recursive function to print all possible // topological sorts void Graph::alltopologicalSortUtil(vector\u003cint\u003e\u0026 res, bool visited[]) { // To indicate whether all topological are found // or not bool flag = false; for (int i = 0; i \u003c V; i++) { // If indegree is 0 and not yet visited then // only choose that vertex if (indegree[i] == 0 \u0026\u0026 !visited[i]) { // reducing indegree of adjacent vertices list\u003cint\u003e:: iterator j; for (j = adj[i].begin(); j != adj[i].end(); j++) indegree[*j]--; // including in result res.push_back(i); visited[i] = true; alltopologicalSortUtil(res, visited); // resetting visited, res and indegree for // backtracking visited[i] = false; res.erase(res.end() - 1); for (j = adj[i].begin(); j != adj[i].end(); j++) indegree[*j]++; flag = true; } } // We reach here if all vertices are visited. // So we print the solution here if (!flag) { for (int i = 0; i \u003c res.size(); i++) cout \u003c\u003c res[i] \u003c\u003c \" \"; cout \u003c\u003c endl; } } // The function does all Topological Sort. // It uses recursive alltopologicalSortUtil() void Graph::alltopologicalSort() { // Mark all the vertices as not visited bool *visited = new bool[V]; for (int i = 0; i \u003c V; i++) visited[i] = false; vector\u003cint\u003e res; alltopologicalSortUtil(res, visited); } int main() { // Create a graph given in the above diagram Graph g(6); g.addEdge(5, 2); g.addEdge(5, 0); g.addEdge(4, 0); g.addEdge(4, 1); g.addEdge(2, 3); g.addEdge(3, 1); cout \u003c\u003c \"All Topological sorts\\\\n\"; g.alltopologicalSort(); return 0; } ","description":"","tags":["algorithm","graph","topological-sort"],"title":"æ±‚æœ‰å‘å›¾å…¨éƒ¨æ‹“æ‰‘åºåˆ—","uri":"/blog/posts/Algorithm/%E6%B1%82%E6%9C%89%E5%90%91%E5%9B%BE%E5%85%A8%E9%83%A8%E6%8B%93%E6%89%91%E5%BA%8F%E5%88%97/"},{"categories":["Algorithm"],"content":"ç®€ä»‹ æ‹“æ‰‘æ’åº ï¼ˆTopological Sortingï¼‰\nåœ¨è®¡ç®—æœºç§‘å­¦é¢†åŸŸï¼Œæœ‰å‘å›¾çš„æ‹“æ‰‘æ’åºæˆ–æ‹“æ‰‘æ’åºæ˜¯å…¶é¡¶ç‚¹çš„çº¿æ€§æ’åºï¼Œä½¿å¾—å¯¹äºä»é¡¶ç‚¹uåˆ°é¡¶ç‚¹vçš„æ¯ä¸ªæœ‰å‘è¾¹uvï¼Œuåœ¨æ’åºä¸­éƒ½åœ¨vä¹‹å‰ã€‚ä¾‹å¦‚ï¼Œå›¾å½¢çš„é¡¶ç‚¹å¯ä»¥è¡¨ç¤ºè¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶ä¸”è¾¹ç¼˜å¯ä»¥è¡¨ç¤ºä¸€ä¸ªä»»åŠ¡å¿…é¡»åœ¨å¦ä¸€ä¸ªä»»åŠ¡ä¹‹å‰æ‰§è¡Œçš„çº¦æŸï¼›åœ¨è¿™ä¸ªåº”ç”¨ä¸­ï¼Œæ‹“æ‰‘æ’åºåªæ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ä»»åŠ¡é¡ºåºã€‚å¦‚æœå½“å›¾å½¢æ²¡æœ‰å®šå‘å¾ªç¯ï¼Œå³å¦‚æœå®ƒæ˜¯æœ‰å‘æ— ç¯å›¾ï¼ˆDirected Acyclic Graphï¼Œå³DAGï¼‰ï¼Œåˆ™æ‹“æ‰‘æ’åºæ˜¯å¯èƒ½çš„ã€‚ä»»ä½•DAGå…·æœ‰è‡³å°‘ä¸€ä¸ªæ‹“æ‰‘æ’åºï¼Œå¹¶ä¸”å·²çŸ¥æœ‰äº›ç®—æ³•ç”¨äºåœ¨çº¿æ€§æ—¶é—´å†…æ„å»ºä»»ä½•DAGçš„æ‹“æ‰‘æ’åºã€‚ åœ¨å›¾è®ºä¸­ï¼Œç”±ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾çš„é¡¶ç‚¹ç»„æˆçš„åºåˆ—ï¼Œå½“ä¸”ä»…å½“æ»¡è¶³ä¸‹åˆ—æ¡ä»¶æ—¶ï¼Œç§°ä¸ºè¯¥å›¾çš„ä¸€ä¸ªæ‹“æ‰‘æ’åºï¼ˆTopological sortingï¼‰ã€‚\næ¯ä¸ªé¡¶ç‚¹å‡ºç°ä¸”åªå‡ºç°ä¸€æ¬¡ï¼› è‹¥Aåœ¨åºåˆ—ä¸­æ’åœ¨Bçš„å‰é¢ï¼Œåˆ™åœ¨å›¾ä¸­ä¸å­˜åœ¨ä»Båˆ°Açš„è¾¹ã€‚ ä¹Ÿå¯ä»¥å®šä¹‰ä¸ºï¼šæ‹“æ‰‘æ’åºæ˜¯å¯¹æœ‰å‘æ— ç¯å›¾çš„é¡¶ç‚¹çš„ä¸€ç§æ’åºï¼Œå®ƒä½¿å¾—å¦‚æœå­˜åœ¨ä¸€æ¡ä»é¡¶ç‚¹Aåˆ°é¡¶ç‚¹Bçš„è·¯å¾„ï¼Œé‚£ä¹ˆåœ¨æ’åºä¸­Bå‡ºç°åœ¨Açš„åé¢ã€‚\né—®é¢˜æè¿° ä¸€èˆ¬å¯ä»¥ç”¨æœ‰å‘å›¾è¡¨ç¤ºä¸€ä¸ªå·¥ç¨‹ã€‚åœ¨è¿™ç§æœ‰å‘å›¾ä¸­ï¼Œç”¨é¡¶ç‚¹è¡¨ç¤ºæ´»åŠ¨ï¼Œç”¨å¼§ \u003ci, j\u003e è¡¨ç¤ºæ´»åŠ¨ i å¿…é¡»åœ¨æ´»åŠ¨ j å¼€å§‹ä¹‹å‰å®Œæˆã€‚è¿™ç§æœ‰å‘å›¾å«åšç”¨é¡¶ç‚¹è¡¨ç¤ºæ´»åŠ¨çš„ç½‘ç»œï¼ˆActivity on Vertexï¼‰ï¼Œè®°ä½œ AOVç½‘ç»œã€‚\nåœ¨AOVç½‘ç»œä¸­ä¸èƒ½å­˜åœ¨æœ‰å‘å›è·¯ï¼Œå³æœ‰å‘ç¯ã€‚å› ä¸ºå¦‚æœå‡ºç°äº†æœ‰å‘ç¯ï¼Œæ„å‘³ç€æŸé¡¹æ´»åŠ¨è¦ä»¥è‡ªå·±çš„å®Œæˆä½œä¸ºå…ˆå†³æ¡ä»¶ã€‚æ˜¾ç„¶è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚æ‰€ä»¥å¯¹ç»™å®šçš„AOVç½‘ç»œï¼Œå¿…é¡»å…ˆåˆ¤æ–­å®ƒæ˜¯å¦å­˜åœ¨æœ‰å‘ç¯ã€‚\nä¸€ç§æ–¹æ³•æ˜¯å¯¹AOVç½‘ç»œæ„é€ å®ƒçš„æ‹“æ‰‘æœ‰åºåºåˆ—ã€‚å³å°†æ‰€æœ‰çš„é¡¶ç‚¹èƒ½å¤Ÿæˆä¸€ä¸ªçº¿æ€§æœ‰åºçš„åºåˆ—ï¼Œä½¿å¾—AOVç½‘ç»œæ‰€æœ‰çš„å‰é©±å’Œåç»§å…³ç³»å¾—åˆ°æ»¡è¶³ï¼Œè¿™ç§æ„é€ AOVç½‘ç»œå…¨éƒ¨é¡¶ç‚¹çš„æ‹“æ‰‘æœ‰åºåºåˆ—çš„è¿ç®—å°±å«æ‹“æ‰‘æ’åºã€‚\nä¾‹å¦‚ï¼Œä¸‹é¢æœ‰ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼Œâ€œ5 4 2 3 1 0â€æ˜¯å®ƒçš„ä¸€ä¸ªæ‹“æ‰‘æ’åºã€‚ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾å¯ä»¥æœ‰å¤šä¸ªæ‹“æ‰‘æ’åºï¼Œå¦‚ä¸‹å›¾çš„å¦ä¸€ä¸ªæ‹“æ‰‘æ’åºä¸ºâ€œ4 5 2 3 1 0â€ï¼Œæ‹“æ‰‘æ’åºä¸­çš„ç¬¬ä¸€ä¸ªé¡¶ç‚¹æ€»æ˜¯å…¥åº¦ä¸º0çš„é¡¶ç‚¹ï¼ˆå³æ²¡æœ‰ä»»ä½•ä¸€æ¡æœ‰å‘è¾¹ä»¥å®ƒä¸ºç»ˆç‚¹ï¼‰ã€‚ ç®—æ³•æ€è·¯ åœ¨AOVç½‘ç»œä¸­é€‰ä¸€ä¸ªæ²¡æœ‰ç›´æ¥å‰é©±çš„é¡¶ç‚¹vï¼Œå¹¶è¾“å‡º ä»å›¾ä¸­åˆ é™¤è¯¥é¡¶ç‚¹ï¼ŒåŒæ—¶åˆ å»æ‰€æœ‰ä»é¡¶ç‚¹vå‘å‡ºçš„å¼§ é‡å¤æ­¥éª¤1,2. ç›´åˆ°æ²¡æœ‰ç›´æ¥å‰é©±çš„é¡¶ç‚¹å…¨éƒ¨è¾“å‡º ç®—æ³•æ­¥éª¤ ç”¨äºŒç»´listé“¾è¡¨å­˜å‚¨å›¾çš„é¢†æ¥è¡¨\nå»ºç«‹å…¥åº¦ä¸º0çš„é¡¶ç‚¹æ ˆ å½“å…¥åº¦ä¸º0çš„é¡¶ç‚¹æ ˆä¸ºç©ºæ—¶ï¼Œè½¬åˆ°æ­¥éª¤6ï¼Œå¦åˆ™æ­¥éª¤3 ä»å…¥åº¦ä¸º0çš„é¡¶ç‚¹æ ˆé¡¶å…ƒç´ vå‡ºæ ˆï¼Œå¹¶è¾“å‡ºé¡¶ç‚¹v ä»AOVç½‘ç»œåˆ å»é¡¶ç‚¹vå’Œæ‰€æœ‰é¡¶ç‚¹vå‘å‡ºçš„å¼§ \u003cv, j\u003eï¼Œ å¹¶å°†é¡¶ç‚¹ j çš„å…¥åº¦ -1 å¦‚æœé¡¶ç‚¹ j çš„å…¥åº¦ = 0ï¼Œåˆ™å°†è¯¥é¡¶ç‚¹ç½®å…¥å…¥åº¦ä¸º0çš„é¡¶ç‚¹æ ˆï¼Œè½¬åˆ°æ­¥éª¤2 å¦‚æœè¾“å‡ºé¡¶ç‚¹ä¸ªæ•° \u003c AOVç½‘ç»œé¡¶ç‚¹æ•°ï¼Œåˆ™å›¾ä¸­å­˜åœ¨æœ‰å‘ç¯ å¤æ‚åº¦åˆ†æ Topological Sorting via Depth First Search(DFS) åœ¨DFSä¸­ï¼Œæˆ‘ä»¬å…ˆæ‰“å°ä¸€ä¸ªé¡¶ç‚¹ï¼Œç„¶åé€’å½’çš„å¯¹å®ƒçš„é‚»æ¥ç‚¹è°ƒç”¨DFSã€‚ä½†æ˜¯åœ¨æ‹“æ‰‘æ’åºä¸­ï¼Œä»»ä½•ä¸€ä¸ªé¡¶ç‚¹æ€»è¦å…ˆäºå®ƒçš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹æ‰“å°ï¼Œå¦‚ä¸Šé¢çš„å›¾ï¼Œé¡¶ç‚¹5å’Œ4å¿…é¡»å…ˆäºé¡¶ç‚¹0æ‰“å°ã€‚æ‰€ä»¥æ‹“æ‰‘æ’åºå’ŒDFSæ˜¯ä¸åŒçš„ï¼Œä¾‹å¦‚â€œ5 2 3 1 0 4â€æ˜¯ä¸Šå›¾çš„ä¸€ä¸ªDFSåºåˆ—ï¼Œä½†æ˜¯è¿™ä¸ªåºåˆ—å¹¶ä¸æ˜¯æ‹“æ‰‘æ’åºã€‚\nåœ¨DFSä¸­ï¼Œæˆ‘ä»¬ä»ä»»æ„ä¸€ä¸ªé¡¶ç‚¹å‡ºå‘ï¼Œæ‰“å°å®ƒç„¶åå¯¹å®ƒçš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹é€’å½’è°ƒç”¨DFSã€‚è€Œåœ¨æ‹“æ‰‘æ’åºä¸­ï¼Œæˆ‘ä»¬åŒæ ·è°ƒç”¨DFSè¿‡ç¨‹ï¼Œä½†æ˜¯åœ¨é€’å½’è°ƒç”¨DFSçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸ç›´æ¥æ‰“å°é¡¶ç‚¹ï¼Œè€Œæ˜¯æŠŠé¡¶ç‚¹ push åˆ°æ ˆé‡Œï¼Œç­‰åˆ°é€’å½’å®Œæˆåï¼Œæ‰€æœ‰é¡¶ç‚¹å°±å…¨éƒ½åœ¨æ ˆé‡Œäº†ã€‚æ³¨æ„ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å½“ä¸”ä»…å½“ä¸€ä¸ªé¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹å…¥æ ˆåï¼Œæ‰åˆ°å½“å‰é¡¶ç‚¹å…¥æ ˆï¼Œè¿™å°±ä¿è¯å®ƒä»¬èƒ½æ»¡è¶³æ‹“æ‰‘æ’åºçš„æ¬¡åºè¦æ±‚ã€‚æ‰€ä»¥æœ€åæ ˆé‡Œçš„å†…å®¹ï¼Œä»æ ˆé¡¶åˆ°æ ˆåº•ï¼Œå°±æ˜¯ä¸€ä¸ªæ‹“æ‰‘æ’åºåºåˆ—ï¼Œæˆ‘ä»¬ä¸æ–­å‡ºæ ˆå¹¶æ‰“å°å®ƒä»¬å³å¯ã€‚\nå› ä¸ºè¿™ä¸ªç®—æ³•åªæ˜¯ç®€å•çš„è°ƒç”¨äº†ä¸‹DFSï¼Œå¹¶å€ŸåŠ©æ ˆåšä¸ºè¾…åŠ©ï¼Œæ‰€ä»¥å…¶å¤æ‚åº¦å’ŒDFSä¸€æ ·æ˜¯O(V+E)ã€‚\nä»£ç å®ç° C++ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 #include\u003ciostream\u003e #include \u003clist\u003e #include \u003cstack\u003e using namespace std; // Class to represent a graph class Graph { int V; // No. of vertices' // Pointer to an array containing adjacency listsList list\u003cint\u003e *adj; // A function used by topologicalSort void topologicalSortUtil(int v, bool visited[], stack\u003cint\u003e \u0026Stack); public: Graph(int V); // Constructor // function to add an edge to graph void addEdge(int v, int w); // prints a Topological Sort of the complete graph void topologicalSort(); }; Graph::Graph(int V) { this-\u003eV = V; adj = new list\u003cint\u003e[V]; } void Graph::addEdge(int v, int w) { adj[v].push_back(w); // Add w to vâ€™s list. } // A recursive function used by topologicalSort void Graph::topologicalSortUtil(int v, bool visited[], stack\u003cint\u003e \u0026Stack) { // Mark the current node as visited. visited[v] = true; // Recur for all the vertices adjacent to this vertex list\u003cint\u003e::iterator i; for (i = adj[v].begin(); i != adj[v].end(); ++i) if (!visited[*i]) topologicalSortUtil(*i, visited, Stack); // Push current vertex to stack which stores result Stack.push(v); } // The function to do Topological Sort. It uses recursive // topologicalSortUtil() void Graph::topologicalSort() { stack\u003cint\u003e Stack; // Mark all the vertices as not visited bool *visited = new bool[V]; for (int i = 0; i \u003c V; i++) visited[i] = false; // Call the recursive helper function to store Topological // Sort starting from all vertices one by one for (int i = 0; i \u003c V; i++) if (visited[i] == false) topologicalSortUtil(i, visited, Stack); // Print contents of stack while (Stack.empty() == false) { cout \u003c\u003c Stack.top() \u003c\u003c \" \"; Stack.pop(); } } int main() { // Create a graph given in the above diagram Graph g(6); g.addEdge(5, 2); g.addEdge(5, 0); g.addEdge(4, 0); g.addEdge(4, 1); g.addEdge(2, 3); g.addEdge(3, 1); cout \u003c\u003c \"Following is a Topological Sort of the given graph n\"; g.topologicalSort(); return 0; } Java 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 import java.io.*; import java.util.*; // This class represents a directed graph using adjacency // list representation class Graph { private int V; // No. of vertices private LinkedList\u003cInteger\u003e adj[]; // Adjacency List //Constructor Graph(int v) { V = v; adj = new LinkedList[v]; for (int i=0; i\u003cv; ++i) adj[i] = new LinkedList(); } // Function to add an edge into the graph void addEdge(int v,int w) { adj[v].add(w); } // A recursive function used by topologicalSort void topologicalSortUtil(int v, boolean visited[], Stack stack) { // Mark the current node as visited. visited[v] = true; Integer i; // Recur for all the vertices adjacent to this // vertex Iterator\u003cInteger\u003e it = adj[v].iterator(); while (it.hasNext()) { i = it.next(); if (!visited[i]) topologicalSortUtil(i, visited, stack); } // Push current vertex to stack which stores result stack.push(new Integer(v)); } // The function to do Topological Sort. It uses // recursive topologicalSortUtil() void topologicalSort() { Stack stack = new Stack(); // Mark all the vertices as not visited boolean visited[] = new boolean[V]; for (int i = 0; i \u003c V; i++) visited[i] = false; // Call the recursive helper function to store // Topological Sort starting from all vertices // one by one for (int i = 0; i \u003c V; i++) if (visited[i] == false) topologicalSortUtil(i, visited, stack); // Print contents of stack while (stack.empty()==false) System.out.print(stack.pop() + \" \"); } public static void main(String args[]) { // Create a graph given in the above diagram Graph g = new Graph(6); g.addEdge(5, 2); g.addEdge(5, 0); g.addEdge(4, 0); g.addEdge(4, 1); g.addEdge(2, 3); g.addEdge(3, 1); System.out.println(\"Following is a Topological \" + \"sort of the given graph\"); g.topologicalSort(); } } ","description":"","tags":["graph","topological-sort"],"title":"æ±‚å›¾çš„æ‹“æ‰‘æ’åº","uri":"/blog/posts/Algorithm/%E5%9B%BE%E7%9A%84%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/"},{"categories":["Algorithm"],"content":"é—®é¢˜æè¿° å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­ä¸€æ£µäºŒå‰æ ‘æ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘ã€‚\nç®—æ³•æ€è·¯ äºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†åºåˆ—æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥åªéœ€æ±‚å‡ºä¸­åºéå†ç»“æœï¼Œå†ä¾æ¬¡åˆ¤æ–­è¯¥åºåˆ—æ˜¯å¦æœ‰åºå³å¯ã€‚ ä¸Šè¿°æ–¹æ³•éœ€è¦é¢å¤–çº¿ç¨‹ç©ºé—´ä¿å­˜éå†ç»“æœï¼Œåœ¨æ­¤å¯ä»¥çœå»è¯¥ç©ºé—´å¼€é”€ï¼Œåªéœ€ä¸€ä¸ªå˜é‡ä¿å­˜è®¿é—®å½“å‰èŠ‚ç‚¹æ—¶ä¸Šä¸€èŠ‚ç‚¹çš„å€¼å³å¯ã€‚ åŸºäºleft \u003c current \u003c rightçš„ç‰¹æ€§ï¼Œå¯ä»¥é€’å½’ç”¨å¤§å°å€¼æ¯”è¾ƒè¿›è¡Œåˆ¤æ–­ ä»£ç å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 /* é¢˜ç›®æè¿° è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œæ£€æŸ¥ä¸€æ£µäºŒå‰æ ‘æ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘ã€‚ ç»™å®šæ ‘çš„æ ¹ç»“ç‚¹æŒ‡é’ˆTreeNode* rootï¼Œè¯·è¿”å›ä¸€ä¸ªboolï¼Œä»£è¡¨è¯¥æ ‘æ˜¯å¦ä¸ºäºŒå‰æœç´¢æ ‘ã€‚ */ #include \u003ciostream\u003e #include \u003ccstdlib\u003e #include \u003cvector\u003e #include \u003cqueue\u003e using namespace std; /*äºŒå‰æ ‘èŠ‚ç‚¹æ•°æ®ç»“æ„*/ struct TreeNode { int val; struct TreeNode *left; struct TreeNode *right; TreeNode(int x) : val(x), left(NULL), right(NULL) { } }; const int flag = INT_MAX; TreeNode *generateTree(vector\u003cint\u003e \u0026nums) { if (nums.empty()) return NULL; TreeNode *root = new TreeNode(nums[0]); queue\u003cTreeNode *\u003e que; que.push(root); //æ±‚å‡ºæ‰€ç»™å…ƒç´ ä¸ªæ•°ï¼Œå¯¹åº”äºŒå‰æŸ¥æ‰¾æ ‘èŠ‚ç‚¹ä¸ªæ•° int size = nums.size(); for (int i = 1; i \u003c size; i += 2) { //å¤„ç†é˜Ÿé¦–èŠ‚ç‚¹çš„å·¦å³å­æ ‘ TreeNode *tmp = que.front(); TreeNode *left = NULL, *right = NULL; //å®šä¹‰éç©ºå·¦å­æ ‘ if (nums[i] != flag) { left = new TreeNode(nums[i]); que.push(left); } //å®šä¹‰éç©ºå³å­æ ‘ if (i + 1 \u003c size \u0026\u0026 nums[i + 1] != flag) { right = new TreeNode(nums[i + 1]); que.push(right); } tmp-\u003eleft = left; tmp-\u003eright = right; //å¼¹å‡ºå½“å‰å¤„ç†çš„èŠ‚ç‚¹ que.pop(); } return root; } class Checker { public: /*æ–¹æ³•ä¸€ï¼Œå°†ä¸­åºéå†ç»“æœä¿å­˜åˆ°æ•°ç»„ T(n)=O(n) S(n)=O(n)*/ void inOrder(TreeNode *root,vector\u003cint\u003e \u0026v) { if (root == NULL) return; inOrder(root-\u003eleft, v); v.push_back(root-\u003eval); inOrder(root-\u003eright, v); } bool checkBST1(TreeNode* root) { vector\u003cint\u003e ret; inOrder(root, ret); for (auto i = ret.begin()+1; i != ret.end(); ++i) { if (*i \u003c *(i - 1)) return false; } return true; } /*æ–¹æ³•äºŒã€çœæ‰çº¿æ€§ç©ºé—´ï¼Œä¿å­˜éå†çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹*/ int lastVal = INT_MIN; bool checkBST2(TreeNode* root) { // write code here if (!root) return true; /*é€’å½’æ£€æŸ¥å·¦å­æ ‘*/ if (!checkBST2(root-\u003eleft)) return false; /*æ¯”è¾ƒå½“å‰èŠ‚ç‚¹ï¼Œå¹¶æ›´æ–°å·²éå†èŠ‚ç‚¹æœ€åçš„å€¼*/ if (root-\u003eval \u003c= lastVal) return false; lastVal = root-\u003eval; /*é€’å½’æ£€æŸ¥å³å­æ ‘*/ if (!checkBST2(root-\u003eright)) return false; return true; } /*æ–¹æ³•ä¸‰ï¼Œæœ€å¤§æœ€å°å€¼æ³•*/ bool checkBST3(TreeNode* root) { // write code here if (!root) return true; return checkBST3(root, INT_MAX, INT_MIN); } bool checkBST3(TreeNode *root, int maxVal, int minVal) { if (!root) return true; if (root-\u003eval \u003c minVal || root-\u003eval \u003e= maxVal) return false; if (!checkBST3(root-\u003eleft, root-\u003eval, minVal) || !checkBST3(root-\u003eright, maxVal, root-\u003eval)) return false; return true; } }; int main() { vector\u003cint\u003e v = { 7, 6, flag, 4, flag, 2, 5, 8, 3, flag, flag, flag, flag, flag, flag }; TreeNode *root = generateTree(v); Checker c; bool ret = c.checkBST1(root); cout \u003c\u003c ret \u003c\u003c endl; ret = c.checkBST2(root); cout \u003c\u003c ret \u003c\u003c endl; ret = c.checkBST3(root); cout \u003c\u003c ret \u003c\u003c endl; system(\"pause\"); return 0; } ","description":"","tags":["algorithm","tree"],"title":"ã€å‰‘æŒ‡offerã€‘åˆ¤æ–­äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰","uri":"/blog/posts/Algorithm/%E5%88%A4%E6%96%AD%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91/"},{"categories":["Algorithm"],"content":"ã€Šç®—æ³•ã€‹ Chap-1 ç¬”è®° ç®—æ³•ï¼šé€‚åˆç”¨è®¡ç®—æœºå®ç°çš„è§£å†³é—®é¢˜çš„æ–¹æ³•\næ•°æ®ç»“æ„ï¼šä¾¿äºç®—æ³•æ“ä½œçš„ç»„ç»‡æ•°æ®çš„æ–¹æ³•ã€‚\nåŸºç¡€ç¼–ç¨‹æ¨¡å‹ï¼šå®ç°ç®—æ³•ç”¨åˆ°çš„è¯­è¨€ç‰¹æ€§ï¼Œè½¯ä»¶åº“å’Œæ“ä½œç³»ç»Ÿç‰¹æ€§çš„æ€»ç§°\næ•°æ®æŠ½è±¡ï¼š\næŠ½è±¡æ•°æ®ç±»å‹ï¼ˆADTï¼‰\næ¨¡å—åŒ–ç¼–ç¨‹\nåº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰\n","description":"","tags":null,"title":"Yuechuan's Blog","uri":"/blog/posts/Algorithm/algorithm-chap1-notes/"},{"categories":null,"content":"åæ§½ batch fileï¼Œèµ„æ–™éå¸¸é›¶æ•£ï¼Œæ•´ç†å®˜æ–¹æ–‡æ¡£çš„ä¸œè¥¿ï¼Œå»ºç«‹ç´¢å¼•\nå“ªé‡Œèƒ½æ‰¾åˆ°å‘½ä»¤çš„ help æ–‡æ¡£ï¼Ÿ\nWindows å‘½ä»¤å®˜æ–¹æ–‡æ¡£\nä¸€äº›å¸¸ç”¨çš„ä¾‹å­ï¼Ÿæ—¢ç„¶æ˜¯ä½œä»‹ç»ï¼Œé‚£ä¹ˆéœ€è¦å“ªäº›ä¸œè¥¿ï¼Ÿ\nå‘½ä»¤çš„ä»‹ç»ï¼Œä¸€å¥è¯ å‘½ä»¤çš„ usageï¼Ÿéå…¨éƒ¨ï¼Œå¸¸ç”¨çš„å³å¯ï¼Œä¸è¡Œå†æŸ¥ ä¸€äº› sampleï¼Œä»£ç ç‰‡æ®µ ä¸€äº›å®é™…ä¾‹å­ï¼š\nè·å–æ—¶é—´æˆ³ä»¥åŠæ ¼å¼åŒ– set yyyy=%date:~,4% set mm=%date:~5,2% set dd=%date:~8,2% set YYYYmmdd=%yyyy%%mm%%dd% set filename=sdkgui_%YYYYmmdd% å‹ç¼©ã€è§£å‹ç¼© ç½‘ç»œæŒ‚è½½-æŒ‚è½½ç›˜ç¬¦ æ–‡ä»¶æ“ä½œ\nåˆ é™¤ï¼š\ndel/erase åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ rd/rmdir åˆ é™¤æ–‡ä»¶å¤¹ åˆ›å»ºï¼š\nmd/mkdir æ–°å»ºæ–‡ä»¶å¤¹ æ–‡ä»¶æ‹·è´ï¼š\ncopy xcopy robocopy æ‰“å¼€æ–‡ä»¶\nstart ç³»ç»Ÿä¿¡æ¯\ndate æŸ¥çœ‹ç³»ç»Ÿè½¯ç¡¬ä»¶ä¿¡æ¯ ç½‘ç»œç›¸å…³\nä»»åŠ¡\nç¡¬ç›˜\n","description":"","tags":null,"title":"Yuechuan's Blog","uri":"/blog/posts/BAT-%E6%93%8D%E4%BD%9C%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"èƒŒæ™¯ï¼ŒæŠ›å‡ºé—®é¢˜\nå†…å®¹ç»„ç»‡ èµ„æ–™å¤‡ä»½ï¼Œæœ¬åœ°ä»¥åŠè¿œç«¯ã€‚ å›¾ç‰‡çš„æ ¼å¼å‰ªè£ï¼Œå°ºå¯¸ä¼˜åŒ–ï¼Œ æ–‡æœ¬å†…å®¹çš„åˆ›ä½œ èµ„æºæ–‡ä»¶ç®¡ç† å‘å¸ƒæµç¨‹ç®¡ç† å†…å®¹ç»„ç»‡ã€‚ å†™åšå®¢æ–‡ç« çš„æ—¶å€™ï¼Œå¾€å¾€ä¼šå¸¦æœ‰èµ„æºæ–‡ä»¶ï¼Œå¦‚ä½•å»ç®¡ç†è¿™äº›èµ„æºæ–‡ä»¶ï¼Ÿ\nä»£ç ç‰‡æ®µ å›¾ç‰‡ éŸ³è§†é¢‘ è¿™é‡Œçš„ç»„ç»‡å¯ä»¥é€šè¿‡æ”¾ç½®åœ¨åŒçº§ç›®å½•ä¸‹æ¥ç®¡ç†ã€‚ç±»ä¼¼äº\ncontent â””â”€â”€ post â”œâ”€â”€ first-post â”‚ â”œâ”€â”€ images â”‚ â”‚ â”œâ”€â”€ a.jpg â”‚ â”‚ â”œâ”€â”€ b.jpg â”‚ â”‚ â””â”€â”€ c.jpg â”‚ â”œâ”€â”€ index.md (root of page bundle) â”‚ â”œâ”€â”€ latest.html â”‚ â”œâ”€â”€ manual.json â”‚ â”œâ”€â”€ notice.md â”‚ â”œâ”€â”€ office.mp3 â”‚ â”œâ”€â”€ pocket.mp4 â”‚ â”œâ”€â”€ rating.pdf â”‚ â””â”€â”€ safety.txt â””â”€â”€ second-post â””â”€â”€ index.md (root of page bundle) ä¸è¿‡è¿™é‡Œä¼šæœ‰ä¸ªç—›ç‚¹ï¼Œå°±æ˜¯ git repo é‡Œé¢åªé€‚åˆç®¡ç†ä»£ç æˆ–è€…æ–‡æœ¬ï¼Œå¯¹äºç±» mediaçš„æ˜¯ä¸åˆé€‚çš„ï¼Œä»¥åŠå»è¦å»åŠ è½½media è€ƒè™‘å›½å†…çš„ç½‘ç»œç¯å¢ƒæ˜¯éå¸¸æ…¢çš„ã€‚\næ‰€ä»¥éœ€è¦ä¸€ä¸ªåœ°æ–¹å»æ‰˜ç®¡èµ„æºæ–‡ä»¶ï¼Œè¿™äº›èµ„æºæ–‡ä»¶ä¹Ÿéœ€è¦ä¸€å®šå±‚çº§çš„ç»„ç»‡ï¼Œä¸æ–‡æ¡£çš„å†…å®¹å¯¹åº”ã€‚\nå‘å¸ƒæµç¨‹ ä¸ªäººæ¥è¯´æ˜¯æƒ³æŠŠ hugo çš„ä»£ç å’Œå†…å®¹è¿›è¡Œåˆ†å¼€ï¼Œè¿™æ ·ä¸¤è¾¹çš„æ”¹åŠ¨æ˜¯å„è‡ªç‹¬ç«‹çš„ï¼Œè°ƒè¯•çš„æ—¶å€™åº”è¯¥æ˜¯æŠŠå†…å®¹è¦†ç›–è¿›å»ï¼Œå†å®é™…çœ‹çœ‹ï¼Œç¡®è®¤æ— è¯¯ä¹‹ååšå‘å¸ƒã€‚\nå› ä¸ºæä¸€ä¸‹æ¯å¤©éƒ½è‡ªåŠ¨æäº¤ï¼Œè¿˜è¦åŠ ä¸€ä¸ª daily build\néœ€è¦æ‹†åˆ† site å’Œ articles ä¸¤ä¸ª repoã€‚\nhugo æä¾›ä»€ä¹ˆæ ·çš„åŠŸèƒ½å’Œæ–¹å¼\n","description":"","tags":null,"title":"Yuechuan's Blog","uri":"/blog/posts/hugo-%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/"},{"categories":null,"content":"å¯¼å›¾\nå‘½ä»¤è¡Œå·¥å…·\nå›¾å½¢åŒ–å·¥å…·\nåˆ†ç±»\næ¯ä¸ªå·¥å…·ä¸€å¥è¯ç®€å•ä»‹ç»ï¼Œå®˜ç½‘ä»¥åŠå®˜æ–¹æ–‡æ¡£\né…å›¾ï¼Œæˆ–è€… GIF å¤§æ¦‚æ¼”ç¤º\nç®€å•è¯´æ˜ï¼Œè¯¦ç»†ä½¿ç”¨æŠ€å·§å•ç‹¬ä»‹ç»\n","description":"","tags":null,"title":"Yuechuan's Blog","uri":"/blog/posts/%E5%B7%A5%E5%85%B7%E9%9B%86%E4%BB%8B%E7%BB%8D/"}]
